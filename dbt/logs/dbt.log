[0m13:26:07.391728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae0bd3a250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae0b8a3d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae0d2f8650>]}


============================== 13:26:07.415463 | 9207b07e-ef6d-4784-9e5c-08f2c82b5cee ==============================
[0m13:26:07.415463 [info ] [MainThread]: Running with dbt=1.7.0
[0m13:26:07.424975 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /app/dbt', 'send_anonymous_usage_stats': 'True'}
[0m13:26:08.632657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9207b07e-ef6d-4784-9e5c-08f2c82b5cee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae0b792e50>]}
[0m13:26:09.265206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9207b07e-ef6d-4784-9e5c-08f2c82b5cee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae0a00cf50>]}
[0m13:26:09.288931 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m13:26:09.311705 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m13:26:09.326878 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.1328437, "process_user_time": 9.478178, "process_kernel_time": 1.252521, "process_mem_max_rss": "112152", "process_out_blocks": "1880", "command_success": false, "process_in_blocks": "0"}
[0m13:26:09.343726 [debug] [MainThread]: Command `dbt run` failed at 13:26:09.343255 after 2.15 seconds
[0m13:26:09.360931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae10211450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae10211690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae09ebd290>]}
[0m13:26:09.379048 [debug] [MainThread]: Flushing usage events
[0m13:26:10.086310 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m13:43:09.398184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1355d59d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc134f86f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc134187dd0>]}


============================== 13:43:09.469110 | dc8b84b2-3120-43fd-85ab-bb6be2bb98f1 ==============================
[0m13:43:09.469110 [info ] [MainThread]: Running with dbt=1.7.0
[0m13:43:09.478058 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /app/dbt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:43:11.562970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4203f0b8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4203d4a710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4203d4a490>]}


============================== 13:43:11.578453 | 0b856ba6-e3c1-493f-accd-a3a427c96f56 ==============================
[0m13:43:11.578453 [info ] [MainThread]: Running with dbt=1.7.0
[0m13:43:11.588271 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /app/dbt', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:43:12.893819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b856ba6-e3c1-493f-accd-a3a427c96f56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4202693290>]}
[0m13:43:12.894004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc8b84b2-3120-43fd-85ab-bb6be2bb98f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1340583d0>]}
[0m13:43:13.109334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dc8b84b2-3120-43fd-85ab-bb6be2bb98f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1340583d0>]}
[0m13:43:13.117977 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m13:43:13.126883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b856ba6-e3c1-493f-accd-a3a427c96f56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42049b0e90>]}
[0m13:43:13.128346 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m13:43:13.135620 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m13:43:13.146851 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m13:43:13.311953 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.8944513, "process_user_time": 5.919123, "process_kernel_time": 0.361166, "process_mem_max_rss": "111436", "process_in_blocks": "32", "command_success": false, "process_out_blocks": "0"}
[0m13:43:13.312083 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.9951644, "process_user_time": 6.875055, "process_kernel_time": 0.670493, "process_mem_max_rss": "111744", "process_in_blocks": "21432", "process_out_blocks": "1880", "command_success": false}
[0m13:43:13.320772 [debug] [MainThread]: Command `dbt run` failed at 13:43:13.320406 after 5.00 seconds
[0m13:43:13.320698 [debug] [MainThread]: Command `dbt run` failed at 13:43:13.320338 after 1.90 seconds
[0m13:43:13.329509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42042ac5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4208745410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f420637e490>]}
[0m13:43:13.329347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc134147ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc134146b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1327ac810>]}
[0m13:43:13.338608 [debug] [MainThread]: Flushing usage events
[0m13:43:13.338634 [debug] [MainThread]: Flushing usage events
[0m13:43:14.224575 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m13:43:14.224500 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m13:44:17.504990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdded6a8910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdded6db890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdded6ab310>]}


============================== 13:44:17.518669 | 1e190f0a-db03-4653-80b6-79d469816633 ==============================
[0m13:44:17.518669 [info ] [MainThread]: Running with dbt=1.7.0
[0m13:44:17.527224 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/app/dbt/logs', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /app/dbt', 'send_anonymous_usage_stats': 'True'}
[0m13:44:18.096306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e190f0a-db03-4653-80b6-79d469816633', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdded70af50>]}
[0m13:44:18.338377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e190f0a-db03-4653-80b6-79d469816633', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddee114290>]}
[0m13:44:18.347034 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m13:44:18.356210 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m13:44:18.366744 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.0678302, "process_user_time": 8.436184, "process_kernel_time": 0.985777, "process_mem_max_rss": "111896", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:44:18.375127 [debug] [MainThread]: Command `dbt run` failed at 13:44:18.374702 after 1.08 seconds
[0m13:44:18.383524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddf2061450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddf2061650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddebd14210>]}
[0m13:44:18.392466 [debug] [MainThread]: Flushing usage events
[0m13:44:21.526689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0140dba10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0140db910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0140dbd50>]}


============================== 13:44:21.540584 | 9598ba97-d7ef-4142-ad02-d4561e23a591 ==============================
[0m13:44:21.540584 [info ] [MainThread]: Running with dbt=1.7.0
[0m13:44:21.551693 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps --project-dir /app/dbt', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:44:21.848863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9598ba97-d7ef-4142-ad02-d4561e23a591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb014b43090>]}
[0m13:44:21.928632 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-03oi1mrc'
[0m13:44:21.937034 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:44:22.661378 [debug] [MainThread]: External call exception: HTTPSConnectionPool(host='hub.getdbt.com', port=443): Max retries exceeded with url: /api/v1/index.json (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7fb0140d9850>: Failed to establish a new connection: [Errno -5] No address associated with hostname'))
[0m13:44:22.670152 [debug] [MainThread]: Retrying external call. Attempt: 0 Max attempts: 5
[0m13:44:51.581802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a229b7150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a229d1bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a22a022d0>]}


============================== 13:44:51.594604 | d1dabcca-a3ba-4360-bd3c-1189316806f3 ==============================
[0m13:44:51.594604 [info ] [MainThread]: Running with dbt=1.7.0
[0m13:44:51.604012 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /app/dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:44:52.533154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1dabcca-a3ba-4360-bd3c-1189316806f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a211715d0>]}
[0m13:44:52.987585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd1dabcca-a3ba-4360-bd3c-1189316806f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a21282b90>]}
[0m13:44:53.003902 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m13:44:53.021867 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m13:44:53.036073 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.8664935, "process_user_time": 6.324382, "process_kernel_time": 0.556545, "process_mem_max_rss": "111632", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:44:53.054061 [debug] [MainThread]: Command `dbt run` failed at 13:44:53.053566 after 1.88 seconds
[0m13:44:53.086147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a274f9710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a27389450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a27389650>]}
[0m13:44:53.101250 [debug] [MainThread]: Flushing usage events
[0m13:45:18.555928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdad18a2f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdad18eee90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdad1d59990>]}


============================== 13:45:18.570196 | e651e359-cb1f-4719-b0c7-07db72b1f8e5 ==============================
[0m13:45:18.570196 [info ] [MainThread]: Running with dbt=1.7.0
[0m13:45:18.580959 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/app/dbt/logs', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /app/dbt', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:45:19.118754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e651e359-cb1f-4719-b0c7-07db72b1f8e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdad00721d0>]}
[0m13:45:19.386810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e651e359-cb1f-4719-b0c7-07db72b1f8e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdad01b6790>]}
[0m13:45:19.395340 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m13:45:19.404999 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m13:45:19.415310 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.0959436, "process_user_time": 10.377012, "process_kernel_time": 0.722321, "process_mem_max_rss": "111812", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:45:19.428024 [debug] [MainThread]: Command `dbt run` failed at 13:45:19.427577 after 1.11 seconds
[0m13:45:19.436619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdad18f6050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdad63f1710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdad6285690>]}
[0m13:45:19.443828 [debug] [MainThread]: Flushing usage events
[0m18:45:36.124817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44690a2e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44690a2e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44690a0990>]}


============================== 18:45:36.140566 | 2eb28a6b-d9a8-4f88-8a7b-9a40ed3e142e ==============================
[0m18:45:36.140566 [info ] [MainThread]: Running with dbt=1.7.0
[0m18:45:36.148559 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/app/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /app/dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:45:36.579542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2eb28a6b-d9a8-4f88-8a7b-9a40ed3e142e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44690e8950>]}
[0m18:45:36.839582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2eb28a6b-d9a8-4f88-8a7b-9a40ed3e142e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4468fa2b50>]}
[0m18:45:36.849141 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m18:45:36.859636 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m18:45:36.871197 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.0028944, "process_user_time": 10.022946, "process_kernel_time": 1.161195, "process_mem_max_rss": "112156", "process_in_blocks": "40", "process_out_blocks": "1880", "command_success": false}
[0m18:45:36.886544 [debug] [MainThread]: Command `dbt run` failed at 18:45:36.886262 after 1.02 seconds
[0m18:45:36.894589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4469576050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44677f42d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4467706810>]}
[0m18:45:36.903660 [debug] [MainThread]: Flushing usage events
[0m18:47:27.921184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3be0af7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3bdeee550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3be0ad290>]}


============================== 18:47:27.937118 | 8dcb5302-4446-4fa5-81f5-270d4c33aba6 ==============================
[0m18:47:27.937118 [info ] [MainThread]: Running with dbt=1.7.0
[0m18:47:27.947015 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'profiles_dir': '/app', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /app/dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:47:28.581234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8dcb5302-4446-4fa5-81f5-270d4c33aba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3bc85bad0>]}
[0m18:47:28.894192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8dcb5302-4446-4fa5-81f5-270d4c33aba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3bc7b6710>]}
[0m18:47:28.907497 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m18:47:28.920461 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m18:47:28.932646 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.2174721, "process_user_time": 9.611403, "process_kernel_time": 0.737783, "process_mem_max_rss": "111728", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:47:28.941357 [debug] [MainThread]: Command `dbt run` failed at 18:47:28.941020 after 1.23 seconds
[0m18:47:28.952203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3be0ae350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3c28e9610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3bc725510>]}
[0m18:47:28.963692 [debug] [MainThread]: Flushing usage events
[0m18:47:30.016162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f502452d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f52e63910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f5023a490>]}


============================== 18:47:30.039044 | 7fff749a-080e-4b6b-ba4a-960f0eff5f0b ==============================
[0m18:47:30.039044 [info ] [MainThread]: Running with dbt=1.7.0
[0m18:47:30.049673 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/app/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir /app/dbt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:47:31.084889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7fff749a-080e-4b6b-ba4a-960f0eff5f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f4eb74d10>]}
[0m18:47:31.590986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7fff749a-080e-4b6b-ba4a-960f0eff5f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f4ea13f90>]}
[0m18:47:31.603233 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m18:47:31.621874 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m18:47:31.655059 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.777535, "process_user_time": 7.856825, "process_kernel_time": 0.696813, "process_mem_max_rss": "111960", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:47:31.673778 [debug] [MainThread]: Command `dbt run` failed at 18:47:31.673251 after 1.80 seconds
[0m18:47:31.697221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f50bc4e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f5028de90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f54c0d6d0>]}
[0m18:47:31.708494 [debug] [MainThread]: Flushing usage events
[0m18:48:03.576761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff04429c310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0442cb050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff04429de50>]}


============================== 18:48:03.589091 | 5988461a-affc-4a0c-a171-fd3613bf122e ==============================
[0m18:48:03.589091 [info ] [MainThread]: Running with dbt=1.7.0
[0m18:48:03.597452 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/app', 'log_path': '/app/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /app/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:48:04.090882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5988461a-affc-4a0c-a171-fd3613bf122e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0442cb650>]}
[0m18:48:04.447223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5988461a-affc-4a0c-a171-fd3613bf122e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff042a53a50>]}
[0m18:48:04.457311 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m18:48:04.467045 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m18:48:04.477264 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.0905433, "process_user_time": 6.363628, "process_kernel_time": 0.523589, "process_mem_max_rss": "111956", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:48:04.485624 [debug] [MainThread]: Command `dbt run` failed at 18:48:04.485111 after 1.10 seconds
[0m18:48:04.494799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0450e6950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff04428b910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff04428a310>]}
[0m18:48:04.502732 [debug] [MainThread]: Flushing usage events
[0m19:15:52.279652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25125ee690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25117b5190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2511c75e10>]}
[0m19:15:52.279485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a27638d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a27633dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a27672310>]}


============================== 19:15:52.378540 | 89ddab27-2865-4016-aa48-ebffa86ebee7 ==============================
[0m19:15:52.378540 [info ] [MainThread]: Running with dbt=1.7.0


============================== 19:15:52.382747 | 85d8ecea-b0c1-4c58-8328-145ca94a055e ==============================
[0m19:15:52.382747 [info ] [MainThread]: Running with dbt=1.7.0
[0m19:15:52.388397 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/app/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug --project-dir /app/dbt', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:15:52.390817 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/app/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /app/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:15:52.409425 [info ] [MainThread]: dbt version: 1.7.0
[0m19:15:52.418874 [info ] [MainThread]: python version: 3.11.13
[0m19:15:52.427275 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m19:15:52.438251 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m19:15:57.126670 [info ] [MainThread]: Using profiles dir at /app
[0m19:15:57.149506 [info ] [MainThread]: Using profiles.yml file at /app/profiles.yml
[0m19:15:57.187044 [info ] [MainThread]: Using dbt_project.yml file at /app/dbt/dbt_project.yml
[0m19:15:57.235400 [info ] [MainThread]: adapter type: postgres
[0m19:15:57.257660 [info ] [MainThread]: adapter version: 1.7.0
[0m19:15:57.792426 [info ] [MainThread]: Configuration:
[0m19:15:57.858906 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:15:57.894703 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:15:57.938146 [info ] [MainThread]: Required dependencies:
[0m19:15:57.974260 [debug] [MainThread]: Executing "git --help"
[0m19:16:00.275071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '85d8ecea-b0c1-4c58-8328-145ca94a055e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a27b06090>]}
[0m19:16:00.665757 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:16:00.708641 [debug] [MainThread]: STDERR: "b''"
[0m19:16:00.724397 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:16:00.743675 [info ] [MainThread]: Connection:
[0m19:16:00.784451 [info ] [MainThread]:   host: postgres
[0m19:16:00.854136 [info ] [MainThread]:   port: 5432
[0m19:16:00.883392 [info ] [MainThread]:   user: postgres
[0m19:16:00.894893 [info ] [MainThread]:   database: crypto_warehouse
[0m19:16:00.927211 [info ] [MainThread]:   schema: public
[0m19:16:00.949818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '85d8ecea-b0c1-4c58-8328-145ca94a055e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a27566dd0>]}
[0m19:16:00.949812 [info ] [MainThread]:   connect_timeout: 10
[0m19:16:00.964048 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m19:16:00.977798 [info ] [MainThread]:   role: None
[0m19:16:00.989801 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m19:16:00.994820 [info ] [MainThread]:   search_path: None
[0m19:16:01.007616 [info ] [MainThread]:   keepalives_idle: 0
[0m19:16:01.017305 [info ] [MainThread]:   sslmode: None
[0m19:16:01.025911 [info ] [MainThread]:   sslcert: None
[0m19:16:01.036088 [info ] [MainThread]:   sslkey: None
[0m19:16:01.047964 [info ] [MainThread]:   sslrootcert: None
[0m19:16:01.060090 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 9.370029, "process_user_time": 9.635491, "process_kernel_time": 1.35039, "process_mem_max_rss": "111600", "process_in_blocks": "56032", "process_out_blocks": "1872", "command_success": false}
[0m19:16:01.056515 [info ] [MainThread]:   application_name: dbt
[0m19:16:01.069869 [debug] [MainThread]: Command `dbt run` failed at 19:16:01.069338 after 9.38 seconds
[0m19:16:01.071220 [info ] [MainThread]:   retries: 1
[0m19:16:01.082161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a2763ae50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a2763bed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a27c33390>]}
[0m19:16:01.082199 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m19:16:01.091883 [debug] [MainThread]: Flushing usage events
[0m19:16:01.095063 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m19:16:01.103467 [debug] [MainThread]: Using postgres connection "debug"
[0m19:16:01.111904 [debug] [MainThread]: On debug: select 1 as id
[0m19:16:01.122570 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:16:01.252275 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m19:16:01.262803 [debug] [MainThread]: On debug: Close
[0m19:16:01.274418 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:16:01.286709 [info ] [MainThread]: [32mAll checks passed![0m
[0m19:16:01.296890 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 9.613662, "process_user_time": 9.064649, "process_kernel_time": 1.15059, "process_mem_max_rss": "111004", "process_in_blocks": "24288", "process_out_blocks": "816"}
[0m19:16:01.307022 [debug] [MainThread]: Command `dbt debug` succeeded at 19:16:01.306582 after 9.62 seconds
[0m19:16:01.316309 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:16:01.324839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f250ff63d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2512e01c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25117b91d0>]}
[0m19:16:01.334693 [debug] [MainThread]: Flushing usage events
[0m19:16:01.842169 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m19:16:01.842169 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m19:16:32.427458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbad4d8810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbad50e310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbad4ce210>]}


============================== 19:16:32.444045 | 10f9f412-efac-4d8e-b350-b8bb64e9d424 ==============================
[0m19:16:32.444045 [info ] [MainThread]: Running with dbt=1.7.0
[0m19:16:32.453828 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /app/dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:16:32.999640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '10f9f412-efac-4d8e-b350-b8bb64e9d424', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbabdb6610>]}
[0m19:16:33.243796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '10f9f412-efac-4d8e-b350-b8bb64e9d424', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbad520190>]}
[0m19:16:33.257335 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m19:16:33.269245 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m19:16:33.280631 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.0297443, "process_user_time": 9.823647, "process_kernel_time": 0.867092, "process_mem_max_rss": "111744", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:16:33.290349 [debug] [MainThread]: Command `dbt run` failed at 19:16:33.289990 after 1.04 seconds
[0m19:16:33.304109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbad520310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbad4da350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbad4d8c10>]}
[0m19:16:33.314443 [debug] [MainThread]: Flushing usage events
[0m19:20:27.420130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25f9345b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25f97fdb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25f98dc490>]}


============================== 19:20:27.436644 | 2fdf206a-325b-4f5c-9f53-534e6c2a9129 ==============================
[0m19:20:27.436644 [info ] [MainThread]: Running with dbt=1.7.0
[0m19:20:27.447003 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /app/dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:20:28.389237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2fdf206a-325b-4f5c-9f53-534e6c2a9129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25f7c7fd50>]}
[0m19:20:28.740078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2fdf206a-325b-4f5c-9f53-534e6c2a9129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25f7c5dd50>]}
[0m19:20:28.756497 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m19:20:28.771039 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m19:20:28.783749 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.6018043, "process_user_time": 10.94414, "process_kernel_time": 1.218271, "process_mem_max_rss": "111744", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:20:28.802972 [debug] [MainThread]: Command `dbt run` failed at 19:20:28.802462 after 1.62 seconds
[0m19:20:28.829885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25f9962c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25f9354dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25fd6d6150>]}
[0m19:20:28.840560 [debug] [MainThread]: Flushing usage events
[0m19:20:29.453854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19fb5cb8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19fb5ee210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19fc416e50>]}


============================== 19:20:29.466620 | acaaa5e3-7c17-4788-8f31-d014d5337167 ==============================
[0m19:20:29.466620 [info ] [MainThread]: Running with dbt=1.7.0
[0m19:20:29.476756 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'profiles_dir': '/app/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select int_crypto_hourly_aggs', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:20:29.890391 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m19:20:30.027843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'acaaa5e3-7c17-4788-8f31-d014d5337167', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19f9e12250>]}
[0m19:20:30.438979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'acaaa5e3-7c17-4788-8f31-d014d5337167', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19f9ea4690>]}
[0m19:20:30.455488 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m19:20:30.470030 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m19:20:30.487251 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.2687212, "process_user_time": 10.113851, "process_kernel_time": 0.578224, "process_mem_max_rss": "111768", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:20:30.506907 [debug] [MainThread]: Command `dbt run` failed at 19:20:30.506564 after 1.29 seconds
[0m19:20:30.559460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19fb5ba390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19fbb636d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19fff81250>]}
[0m19:20:30.574812 [debug] [MainThread]: Flushing usage events
[0m19:21:43.096758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f424de64f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f424de92910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f424de92650>]}


============================== 19:21:43.111344 | 047d04d4-834d-4f90-b3da-2cf292415a01 ==============================
[0m19:21:43.111344 [info ] [MainThread]: Running with dbt=1.7.0
[0m19:21:43.120783 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/app/dbt/logs', 'debug': 'False', 'profiles_dir': '/app', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /app/dbt', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:21:43.643060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '047d04d4-834d-4f90-b3da-2cf292415a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f424c61f690>]}
[0m19:21:43.992728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '047d04d4-834d-4f90-b3da-2cf292415a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f424c606090>]}
[0m19:21:44.004121 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m19:21:44.021401 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m19:21:44.031950 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.1051222, "process_user_time": 9.222118, "process_kernel_time": 0.507825, "process_mem_max_rss": "111460", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:21:44.040894 [debug] [MainThread]: Command `dbt run` failed at 19:21:44.040539 after 1.11 seconds
[0m19:21:44.051853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f424ecae950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f424c4d1e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4252819490>]}
[0m19:21:44.061048 [debug] [MainThread]: Flushing usage events
[0m19:21:44.464093 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m19:22:58.629465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55b6545350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55b6387690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55b63864d0>]}


============================== 19:22:58.644652 | 76fc194c-8dbe-4e05-b43a-d3e6a4c0bdce ==============================
[0m19:22:58.644652 [info ] [MainThread]: Running with dbt=1.7.0
[0m19:22:58.654170 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /app/dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:22:59.514964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '76fc194c-8dbe-4e05-b43a-d3e6a4c0bdce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55b6ebf510>]}
[0m19:22:59.774674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '76fc194c-8dbe-4e05-b43a-d3e6a4c0bdce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55b4c4ea50>]}
[0m19:22:59.784021 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m19:22:59.795832 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m19:22:59.809851 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.3793678, "process_user_time": 13.004898, "process_kernel_time": 1.138818, "process_mem_max_rss": "111792", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:22:59.826512 [debug] [MainThread]: Command `dbt run` failed at 19:22:59.826110 after 1.40 seconds
[0m19:22:59.837388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55b634bad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55b6350050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55bad81610>]}
[0m19:22:59.846861 [debug] [MainThread]: Flushing usage events
[0m19:23:01.681054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3c8c8a910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3cbb22450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3ca1f3a10>]}


============================== 19:23:01.692581 | 2f88612e-68ff-4f55-b463-9e785839f61f ==============================
[0m19:23:01.692581 [info ] [MainThread]: Running with dbt=1.7.0
[0m19:23:01.703335 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/app/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:23:02.208823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f88612e-68ff-4f55-b463-9e785839f61f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3c8c3e790>]}
[0m19:23:02.553175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2f88612e-68ff-4f55-b463-9e785839f61f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3c7417d90>]}
[0m19:23:02.562194 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m19:23:02.581021 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m19:23:02.594336 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.1046606, "process_user_time": 8.355768, "process_kernel_time": 0.805006, "process_mem_max_rss": "111776", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:23:02.623413 [debug] [MainThread]: Command `dbt run` failed at 19:23:02.622961 after 1.13 seconds
[0m19:23:02.666851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3c8c49fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3c9aa6950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3cd6110d0>]}
[0m19:23:02.680072 [debug] [MainThread]: Flushing usage events
[0m19:26:49.070171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff426be3650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff426bcf610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff426bcf550>]}


============================== 19:26:49.081736 | 10593e41-6807-44e9-a94d-3c7780b545a3 ==============================
[0m19:26:49.081736 [info ] [MainThread]: Running with dbt=1.7.0
[0m19:26:49.090928 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'debug': 'False', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /app/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:26:49.665873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '10593e41-6807-44e9-a94d-3c7780b545a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff426c0f3d0>]}
[0m19:26:50.173044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '10593e41-6807-44e9-a94d-3c7780b545a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4254d6150>]}
[0m19:26:50.182190 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m19:26:50.207469 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m19:26:50.247283 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.3542863, "process_user_time": 8.45939, "process_kernel_time": 0.692405, "process_mem_max_rss": "111644", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:26:50.264569 [debug] [MainThread]: Command `dbt run` failed at 19:26:50.264187 after 1.37 seconds
[0m19:26:50.277426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff42b5a5490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff42b5a4a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff426bc29d0>]}
[0m19:26:50.287245 [debug] [MainThread]: Flushing usage events
[0m19:26:51.285326 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m19:26:51.800319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81b3f3ced0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81b3f3cd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81b3f3e9d0>]}


============================== 19:26:51.814860 | 66c770d9-1ccb-4d26-876a-f393d7d230fa ==============================
[0m19:26:51.814860 [info ] [MainThread]: Running with dbt=1.7.0
[0m19:26:51.834446 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/app/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:27:11.909423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2a192ba50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2a1957410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2a192a090>]}


============================== 19:27:11.924140 | 08227c4b-4f6c-45e1-b763-596b4f115506 ==============================
[0m19:27:11.924140 [info ] [MainThread]: Running with dbt=1.7.0
[0m19:27:11.933056 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/app/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir /app/dbt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:27:12.840543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08227c4b-4f6c-45e1-b763-596b4f115506', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2a02242d0>]}
[0m19:27:13.180145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '08227c4b-4f6c-45e1-b763-596b4f115506', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2a021e2d0>]}
[0m19:27:13.193120 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m19:27:13.208390 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m19:27:13.221395 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.4930031, "process_user_time": 7.460248, "process_kernel_time": 0.583933, "process_mem_max_rss": "111516", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:27:13.239189 [debug] [MainThread]: Command `dbt run` failed at 19:27:13.238697 after 1.51 seconds
[0m19:27:13.252613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2a19163d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2a62ed590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2a62ed810>]}
[0m19:27:13.267453 [debug] [MainThread]: Flushing usage events
[0m19:46:49.318594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1dcc37c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1dcc37d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1dcc3e850>]}


============================== 19:46:49.337900 | a7521693-7fa2-4be5-bc19-166171369e3e ==============================
[0m19:46:49.337900 [info ] [MainThread]: Running with dbt=1.7.0
[0m19:46:49.347461 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/app', 'log_path': '/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /app/dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:46:49.828195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7521693-7fa2-4be5-bc19-166171369e3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1dcb52090>]}
[0m19:46:50.050986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a7521693-7fa2-4be5-bc19-166171369e3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1dcb52090>]}
[0m19:46:50.057149 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m19:46:50.161751 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m19:46:50.190189 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:46:50.198778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a7521693-7fa2-4be5-bc19-166171369e3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1dcc84290>]}
[0m19:46:52.014778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45c1c44b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45c0818d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45bf292190>]}


============================== 19:46:52.025348 | 3b407859-3355-4af6-90f8-a7022c1bef0b ==============================
[0m19:46:52.025348 [info ] [MainThread]: Running with dbt=1.7.0
[0m19:46:52.035323 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'profiles_dir': '/app/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:46:52.511250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b407859-3355-4af6-90f8-a7022c1bef0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45bf2568d0>]}
[0m19:46:53.292932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b407859-3355-4af6-90f8-a7022c1bef0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45c0cf0c90>]}
[0m19:46:53.305552 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m19:46:53.352958 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m19:46:53.431053 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:46:53.447852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3b407859-3355-4af6-90f8-a7022c1bef0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45bdb33fd0>]}
[0m19:46:56.961243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a7521693-7fa2-4be5-bc19-166171369e3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1db0e4450>]}
[0m19:46:57.090254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a7521693-7fa2-4be5-bc19-166171369e3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1da678310>]}
[0m19:46:57.099743 [info ] [MainThread]: Found 7 models, 9 tests, 2 sources, 0 exposures, 0 metrics, 403 macros, 0 groups, 0 semantic models
[0m19:46:57.108784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7521693-7fa2-4be5-bc19-166171369e3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1da842110>]}
[0m19:46:57.120355 [info ] [MainThread]:
[0m19:46:57.128990 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:46:57.139703 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse'
[0m19:46:57.144648 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse'
[0m19:46:57.177589 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse"
[0m19:46:57.183211 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse"
[0m19:46:57.193338 [debug] [ThreadPool]: On list_crypto_warehouse: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse"} */

    select distinct nspname from pg_namespace

[0m19:46:57.201211 [debug] [ThreadPool]: On list_crypto_warehouse: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse"} */

    select distinct nspname from pg_namespace

[0m19:46:57.209419 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:46:57.216932 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:46:57.234864 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m19:46:57.247666 [debug] [ThreadPool]: On list_crypto_warehouse: Close
[0m19:46:57.254876 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m19:46:57.269197 [debug] [ThreadPool]: On list_crypto_warehouse: Close
[0m19:46:57.281232 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_warehouse, now create_crypto_warehouse_public_staging)
[0m19:46:57.282989 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_warehouse, now create_crypto_warehouse_public_marts)
[0m19:46:57.299188 [debug] [ThreadPool]: Creating schema "database: "crypto_warehouse"
schema: "public_staging"
"
[0m19:46:57.309140 [debug] [ThreadPool]: Creating schema "database: "crypto_warehouse"
schema: "public_marts"
"
[0m19:46:57.333800 [debug] [ThreadPool]: Using postgres connection "create_crypto_warehouse_public_staging"
[0m19:46:57.342895 [debug] [ThreadPool]: Using postgres connection "create_crypto_warehouse_public_marts"
[0m19:46:57.349791 [debug] [ThreadPool]: On create_crypto_warehouse_public_staging: BEGIN
[0m19:46:57.356479 [debug] [ThreadPool]: On create_crypto_warehouse_public_marts: BEGIN
[0m19:46:57.364784 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:46:57.373412 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:46:57.388198 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:46:57.399717 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:46:57.401186 [debug] [ThreadPool]: Using postgres connection "create_crypto_warehouse_public_staging"
[0m19:46:57.412400 [debug] [ThreadPool]: Using postgres connection "create_crypto_warehouse_public_marts"
[0m19:46:57.422142 [debug] [ThreadPool]: On create_crypto_warehouse_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "create_crypto_warehouse_public_staging"} */
create schema if not exists "public_staging"
[0m19:46:57.432071 [debug] [ThreadPool]: On create_crypto_warehouse_public_marts: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "create_crypto_warehouse_public_marts"} */
create schema if not exists "public_marts"
[0m19:46:57.548982 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m19:46:57.550171 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m19:46:57.626542 [debug] [ThreadPool]: On create_crypto_warehouse_public_marts: COMMIT
[0m19:46:57.686717 [debug] [ThreadPool]: On create_crypto_warehouse_public_staging: COMMIT
[0m19:46:57.723751 [debug] [ThreadPool]: Using postgres connection "create_crypto_warehouse_public_marts"
[0m19:46:57.738633 [debug] [ThreadPool]: Using postgres connection "create_crypto_warehouse_public_staging"
[0m19:46:57.754435 [debug] [ThreadPool]: On create_crypto_warehouse_public_marts: COMMIT
[0m19:46:57.808574 [debug] [ThreadPool]: On create_crypto_warehouse_public_staging: COMMIT
[0m19:46:57.899496 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m19:46:57.912182 [debug] [ThreadPool]: On create_crypto_warehouse_public_marts: Close
[0m19:46:57.967665 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m19:46:58.005455 [debug] [ThreadPool]: On create_crypto_warehouse_public_staging: Close
[0m19:46:58.035159 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_warehouse_public_marts, now list_crypto_warehouse_public_staging)
[0m19:46:58.037861 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_warehouse_public_staging, now list_crypto_warehouse_public_dbt_test__audit)
[0m19:46:58.040397 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse_public_marts'
[0m19:46:58.087575 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_staging"
[0m19:46:58.101490 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_dbt_test__audit"
[0m19:46:58.131874 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: BEGIN
[0m19:46:58.122627 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: BEGIN
[0m19:46:58.111204 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_marts"
[0m19:46:58.143453 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:46:58.156757 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:46:58.168700 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: BEGIN
[0m19:46:58.188455 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:46:58.201663 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:46:58.230872 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_staging"
[0m19:46:58.219891 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_dbt_test__audit"
[0m19:46:58.210151 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:46:58.239240 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_staging"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'

[0m19:46:58.249753 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_dbt_test__audit"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'

[0m19:46:58.266814 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:46:58.289126 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_marts"
[0m19:46:58.318456 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_marts"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'

[0m19:46:58.469161 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m19:46:58.470175 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m19:46:58.471082 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m19:46:58.489330 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: ROLLBACK
[0m19:46:58.506135 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: ROLLBACK
[0m19:46:58.521610 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: ROLLBACK
[0m19:46:58.536709 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: Close
[0m19:46:58.552237 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: Close
[0m19:46:58.570095 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: Close
[0m19:46:58.655293 [debug] [MainThread]: Using postgres connection "master"
[0m19:46:58.681951 [debug] [MainThread]: On master: BEGIN
[0m19:46:58.701495 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:46:58.735355 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:46:58.752006 [debug] [MainThread]: Using postgres connection "master"
[0m19:46:58.767718 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:46:58.959737 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m19:46:58.977318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7521693-7fa2-4be5-bc19-166171369e3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1db0cf390>]}
[0m19:46:58.986551 [debug] [MainThread]: On master: ROLLBACK
[0m19:46:58.995317 [debug] [MainThread]: Using postgres connection "master"
[0m19:46:59.005035 [debug] [MainThread]: On master: BEGIN
[0m19:46:59.014683 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:46:59.022658 [debug] [MainThread]: On master: COMMIT
[0m19:46:59.033879 [debug] [MainThread]: Using postgres connection "master"
[0m19:46:59.044826 [debug] [MainThread]: On master: COMMIT
[0m19:46:59.060436 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:46:59.069851 [debug] [MainThread]: On master: Close
[0m19:46:59.085048 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:46:59.095418 [info ] [MainThread]:
[0m19:46:59.127299 [debug] [Thread-1 (]: Began running node model.crypto_analytics.stg_crypto_prices
[0m19:46:59.128417 [debug] [Thread-2 (]: Began running node model.crypto_analytics.stg_pipeline_runs
[0m19:46:59.137371 [info ] [Thread-1 (]: 1 of 5 START sql table model public_staging.stg_crypto_prices .................. [RUN]
[0m19:46:59.145790 [info ] [Thread-2 (]: 2 of 5 START sql view model public_staging.stg_pipeline_runs ................... [RUN]
[0m19:46:59.155543 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_marts, now model.crypto_analytics.stg_crypto_prices)
[0m19:46:59.165011 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_staging, now model.crypto_analytics.stg_pipeline_runs)
[0m19:46:59.171697 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics.stg_crypto_prices
[0m19:46:59.179424 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics.stg_pipeline_runs
[0m19:46:59.211782 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics.stg_crypto_prices"
[0m19:46:59.219163 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics.stg_pipeline_runs"
[0m19:46:59.290051 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.stg_crypto_prices (compile): 19:46:59.189074 => 19:46:59.289195
[0m19:46:59.298667 [debug] [Thread-1 (]: Began executing node model.crypto_analytics.stg_crypto_prices
[0m19:46:59.302561 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.stg_pipeline_runs (compile): 19:46:59.212934 => 19:46:59.301834
[0m19:46:59.351786 [debug] [Thread-2 (]: Began executing node model.crypto_analytics.stg_pipeline_runs
[0m19:46:59.476800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b407859-3355-4af6-90f8-a7022c1bef0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45bce0a550>]}
[0m19:46:59.507932 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics.stg_crypto_prices"
[0m19:46:59.511815 [debug] [Thread-2 (]: Writing runtime sql for node "model.crypto_analytics.stg_pipeline_runs"
[0m19:46:59.575552 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m19:46:59.584626 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: BEGIN
[0m19:46:59.588092 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m19:46:59.593878 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:46:59.602420 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: BEGIN
[0m19:46:59.619595 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:46:59.629780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b407859-3355-4af6-90f8-a7022c1bef0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45bcd5a710>]}
[0m19:46:59.624860 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:46:59.637856 [info ] [MainThread]: Found 7 models, 9 tests, 2 sources, 0 exposures, 0 metrics, 403 macros, 0 groups, 0 semantic models
[0m19:46:59.632993 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m19:46:59.649976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b407859-3355-4af6-90f8-a7022c1bef0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45bcdc9610>]}
[0m19:46:59.648851 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:46:59.651950 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */




  create  table "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_tmp"


    as

  (


WITH source_data AS (
    SELECT
        id as price_id,
        UPPER(TRIM(symbol)) as symbol,
        TRIM(name) as crypto_name,
        current_price as price_usd,
        market_cap,
        total_volume as volume_24h,
        price_change_24h,
        price_change_percentage_24h as price_change_pct_24h,
        market_cap_rank,
        extracted_at,
        created_at,

        CASE WHEN current_price <= 0 THEN TRUE ELSE FALSE END as is_invalid_price,
        CASE WHEN market_cap <= 0 THEN TRUE ELSE FALSE END as is_invalid_market_cap
    FROM "crypto_warehouse"."public"."crypto_prices_raw"
),

cleaned_data AS (
    SELECT
        *,
        DATE(extracted_at) as extraction_date,
        DATE_TRUNC('hour', extracted_at) as extraction_hour,
        CASE
            WHEN LAG(price_usd) OVER (
                PARTITION BY symbol ORDER BY extracted_at
            ) IS NOT NULL THEN
                ((price_usd - LAG(price_usd) OVER (
                    PARTITION BY symbol ORDER BY extracted_at
                )) / LAG(price_usd) OVER (
                    PARTITION BY symbol ORDER BY extracted_at
                )) * 100
        END as price_change_pct_from_previous
    FROM source_data
    WHERE NOT is_invalid_price
)

SELECT * FROM cleaned_data
  );

[0m19:46:59.661498 [info ] [MainThread]:
[0m19:46:59.675484 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:46:59.660066 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m19:46:59.686559 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */

  create view "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_tmp"


  as (
    SELECT
    id as run_id,
    run_id as run_identifier,
    stage,
    status,
    records_processed,
    error_message,
    started_at,
    completed_at,
    CASE
        WHEN completed_at IS NOT NULL
        THEN EXTRACT(EPOCH FROM (completed_at - started_at))
        ELSE NULL
    END as duration_seconds
FROM "crypto_warehouse"."public"."pipeline_runs"
  );
[0m19:46:59.688755 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse'
[0m19:46:59.704143 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse'
[0m19:46:59.756914 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse"
[0m19:46:59.767482 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse"
[0m19:46:59.784622 [debug] [ThreadPool]: On list_crypto_warehouse: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse"} */

    select distinct nspname from pg_namespace

[0m19:46:59.796697 [debug] [ThreadPool]: On list_crypto_warehouse: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse"} */

    select distinct nspname from pg_namespace

[0m19:46:59.811458 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:46:59.821215 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:46:59.837982 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m19:46:59.850328 [debug] [ThreadPool]: On list_crypto_warehouse: Close
[0m19:46:59.853403 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m19:46:59.869217 [debug] [ThreadPool]: On list_crypto_warehouse: Close
[0m19:46:59.881332 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_warehouse, now list_crypto_warehouse_public_marts)
[0m19:46:59.883359 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_warehouse, now list_crypto_warehouse_public_staging)
[0m19:46:59.885745 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse_public_dbt_test__audit'
[0m19:46:59.904682 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_marts"
[0m19:46:59.913599 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_staging"
[0m19:46:59.926630 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_dbt_test__audit"
[0m19:46:59.939134 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: BEGIN
[0m19:46:59.962479 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: BEGIN
[0m19:46:59.975361 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: BEGIN
[0m19:46:59.990215 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:47:00.121384 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:47:00.149183 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:47:00.185450 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:47:00.251045 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:47:00.270346 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:47:00.276957 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_marts"
[0m19:47:00.292303 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_staging"
[0m19:47:00.374599 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 1.0 seconds
[0m19:47:00.330006 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_dbt_test__audit"
[0m19:47:00.360253 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_marts"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'

[0m19:47:00.378212 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_staging"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'

[0m19:47:00.415078 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m19:47:00.396254 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_dbt_test__audit"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'

[0m19:47:00.425327 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */
alter table "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_tmp" rename to "stg_pipeline_runs"
[0m19:47:00.412074 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m19:47:00.443439 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:47:00.431821 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m19:47:00.436815 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m19:47:00.450916 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: ROLLBACK
[0m19:47:00.444542 [debug] [Thread-1 (]: SQL status: SELECT 15 in 1.0 seconds
[0m19:47:00.471313 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: ROLLBACK
[0m19:47:00.482812 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: ROLLBACK
[0m19:47:00.493698 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: Close
[0m19:47:00.507839 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: Close
[0m19:47:00.539997 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m19:47:00.514976 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: Close
[0m19:47:00.570267 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: COMMIT
[0m19:47:00.588990 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */
alter table "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_tmp" rename to "stg_crypto_prices"
[0m19:47:00.632105 [debug] [MainThread]: Using postgres connection "master"
[0m19:47:00.626903 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m19:47:00.693910 [debug] [MainThread]: On master: BEGIN
[0m19:47:00.652804 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:47:00.754126 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:47:00.714576 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: COMMIT
[0m19:47:00.826581 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:47:00.788108 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m19:47:00.870638 [debug] [MainThread]: Using postgres connection "master"
[0m19:47:00.884604 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */

        CREATE INDEX IF NOT EXISTS idx_stg_crypto_prices_symbol_time ON "crypto_warehouse"."public_staging"."stg_crypto_prices" (symbol, extracted_at)

[0m19:47:00.911673 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:47:00.971914 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m19:47:01.011038 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m19:47:01.033355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b407859-3355-4af6-90f8-a7022c1bef0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45bce49dd0>]}
[0m19:47:01.071370 [debug] [MainThread]: On master: ROLLBACK
[0m19:47:01.095521 [debug] [Thread-2 (]: Applying DROP to: "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_backup"
[0m19:47:01.100476 [debug] [MainThread]: Using postgres connection "master"
[0m19:47:01.146261 [debug] [MainThread]: On master: BEGIN
[0m19:47:01.169244 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m19:47:01.216723 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:47:01.194783 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m19:47:01.245505 [debug] [MainThread]: On master: COMMIT
[0m19:47:01.226743 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */
drop view if exists "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_backup" cascade
[0m19:47:01.270222 [debug] [MainThread]: Using postgres connection "master"
[0m19:47:01.265815 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: COMMIT
[0m19:47:01.296563 [debug] [MainThread]: On master: COMMIT
[0m19:47:01.297419 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:47:01.321942 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:47:01.320045 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m19:47:01.386112 [debug] [MainThread]: On master: Close
[0m19:47:01.389536 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.stg_pipeline_runs (execute): 19:46:59.377681 => 19:47:01.388765
[0m19:47:01.415849 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:47:01.412653 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: COMMIT
[0m19:47:01.440122 [info ] [MainThread]:
[0m19:47:01.437381 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: Close
[0m19:47:01.463853 [debug] [Thread-1 (]: Began running node model.crypto_analytics.stg_crypto_prices
[0m19:47:01.491228 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7521693-7fa2-4be5-bc19-166171369e3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1da5bc490>]}
[0m19:47:01.465005 [debug] [Thread-2 (]: Began running node model.crypto_analytics.stg_pipeline_runs
[0m19:47:01.511991 [info ] [Thread-2 (]: 2 of 5 OK created sql view model public_staging.stg_pipeline_runs .............. [[32mCREATE VIEW[0m in 2.33s]
[0m19:47:01.498073 [info ] [Thread-1 (]: 1 of 5 START sql table model public_staging.stg_crypto_prices .................. [RUN]
[0m19:47:01.521424 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:47:01.519380 [info ] [Thread-2 (]: 2 of 5 START sql view model public_staging.stg_pipeline_runs ................... [RUN]
[0m19:47:01.534843 [debug] [Thread-2 (]: Finished running node model.crypto_analytics.stg_pipeline_runs
[0m19:47:01.538306 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_dbt_test__audit, now model.crypto_analytics.stg_crypto_prices)
[0m19:47:01.562781 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_staging, now model.crypto_analytics.stg_pipeline_runs)
[0m19:47:01.572942 [debug] [Thread-1 (]: Applying DROP to: "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_backup"
[0m19:47:01.588897 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics.stg_crypto_prices
[0m19:47:01.585912 [debug] [Thread-4 (]: Began running node model.crypto_analytics.mart_pipeline_monitoring
[0m19:47:01.624298 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m19:47:01.605764 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics.stg_pipeline_runs
[0m19:47:01.666387 [info ] [Thread-4 (]: 3 of 5 START sql table model public_marts.mart_pipeline_monitoring ............. [RUN]
[0m19:47:01.715745 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics.stg_crypto_prices"
[0m19:47:01.750539 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */
drop table if exists "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_backup" cascade
[0m19:47:01.772957 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics.stg_pipeline_runs"
[0m19:47:01.796784 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.crypto_analytics.mart_pipeline_monitoring'
[0m19:47:01.849758 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:47:01.875061 [debug] [Thread-4 (]: Began compiling node model.crypto_analytics.mart_pipeline_monitoring
[0m19:47:01.899018 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.stg_crypto_prices (execute): 19:46:59.307162 => 19:47:01.898376
[0m19:47:01.932110 [debug] [Thread-4 (]: Writing injected SQL for node "model.crypto_analytics.mart_pipeline_monitoring"
[0m19:47:01.955731 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: Close
[0m19:47:01.981800 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.stg_crypto_prices (compile): 19:47:01.665370 => 19:47:01.980912
[0m19:47:02.001364 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7521693-7fa2-4be5-bc19-166171369e3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1da5aa9d0>]}
[0m19:47:02.021916 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public_staging.stg_crypto_prices ............. [[32mSELECT 15[0m in 2.85s]
[0m19:47:01.993219 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.stg_pipeline_runs (compile): 19:47:01.764255 => 19:47:01.992133
[0m19:47:02.030951 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.stg_crypto_prices
[0m19:47:02.012545 [debug] [Thread-1 (]: Began executing node model.crypto_analytics.stg_crypto_prices
[0m19:47:02.043831 [debug] [Thread-2 (]: Began running node model.crypto_analytics.int_crypto_daily_aggs
[0m19:47:02.038527 [debug] [Thread-2 (]: Began executing node model.crypto_analytics.stg_pipeline_runs
[0m19:47:02.045315 [debug] [Thread-3 (]: Began running node model.crypto_analytics.int_crypto_hourly_aggs
[0m19:47:02.046740 [debug] [Thread-1 (]: Began running node model.crypto_analytics.mart_crypto_latest_prices
[0m19:47:02.063042 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.stg_pipeline_runs, now model.crypto_analytics.int_crypto_daily_aggs)
[0m19:47:02.094512 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_dbt_test__audit, now model.crypto_analytics.int_crypto_hourly_aggs)
[0m19:47:02.098593 [debug] [Thread-4 (]: Timing info for model.crypto_analytics.mart_pipeline_monitoring (compile): 19:47:01.919786 => 19:47:02.097789
[0m19:47:02.134115 [info ] [Thread-1 (]: 4 of 5 START sql table model public_marts.mart_crypto_latest_prices ............ [RUN]
[0m19:47:02.182183 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics.int_crypto_daily_aggs
[0m19:47:02.208768 [debug] [Thread-3 (]: Began compiling node model.crypto_analytics.int_crypto_hourly_aggs
[0m19:47:02.246555 [debug] [Thread-4 (]: Began executing node model.crypto_analytics.mart_pipeline_monitoring
[0m19:47:02.351780 [debug] [Thread-2 (]: Writing runtime sql for node "model.crypto_analytics.stg_pipeline_runs"
[0m19:47:02.379211 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics.stg_crypto_prices"
[0m19:47:02.306760 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.stg_crypto_prices, now model.crypto_analytics.mart_crypto_latest_prices)
[0m19:47:02.336466 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics.int_crypto_daily_aggs"
[0m19:47:02.393038 [debug] [Thread-3 (]: Writing injected SQL for node "model.crypto_analytics.int_crypto_hourly_aggs"
[0m19:47:02.429105 [debug] [Thread-4 (]: Writing runtime sql for node "model.crypto_analytics.mart_pipeline_monitoring"
[0m19:47:02.456706 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics.mart_crypto_latest_prices
[0m19:47:02.736415 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics.mart_crypto_latest_prices"
[0m19:47:02.748921 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m19:47:02.847483 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: BEGIN
[0m19:47:02.848607 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m19:47:02.946443 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:47:03.049390 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m19:47:03.181560 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: BEGIN
[0m19:47:03.028542 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: BEGIN
[0m19:47:03.203028 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:47:03.289076 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.int_crypto_daily_aggs (compile): 19:47:02.327928 => 19:47:03.288219
[0m19:47:03.487888 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:47:03.472334 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:47:03.550441 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m19:47:03.508958 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.mart_crypto_latest_prices (compile): 19:47:02.724700 => 19:47:03.508160
[0m19:47:03.614772 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:47:03.568682 [debug] [Thread-2 (]: Finished running node model.crypto_analytics.int_crypto_daily_aggs
[0m19:47:03.677716 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */

  create view "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_tmp"


  as (
    SELECT
    id as run_id,
    run_id as run_identifier,
    stage,
    status,
    records_processed,
    error_message,
    started_at,
    completed_at,
    CASE
        WHEN completed_at IS NOT NULL
        THEN EXTRACT(EPOCH FROM (completed_at - started_at))
        ELSE NULL
    END as duration_seconds
FROM "crypto_warehouse"."public"."pipeline_runs"
  );
[0m19:47:03.677756 [debug] [Thread-3 (]: Timing info for model.crypto_analytics.int_crypto_hourly_aggs (compile): 19:47:02.384388 => 19:47:03.676966
[0m19:47:03.687185 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m19:47:03.761559 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m19:47:03.746275 [debug] [Thread-1 (]: Began executing node model.crypto_analytics.mart_crypto_latest_prices
[0m19:47:03.877212 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:47:03.890281 [debug] [Thread-3 (]: Finished running node model.crypto_analytics.int_crypto_hourly_aggs
[0m19:47:03.971398 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */




  create  table "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_tmp"


    as

  (


WITH source_data AS (
    SELECT
        id as price_id,
        UPPER(TRIM(symbol)) as symbol,
        TRIM(name) as crypto_name,
        current_price as price_usd,
        market_cap,
        total_volume as volume_24h,
        price_change_24h,
        price_change_percentage_24h as price_change_pct_24h,
        market_cap_rank,
        extracted_at,
        created_at,

        CASE WHEN current_price <= 0 THEN TRUE ELSE FALSE END as is_invalid_price,
        CASE WHEN market_cap <= 0 THEN TRUE ELSE FALSE END as is_invalid_market_cap
    FROM "crypto_warehouse"."public"."crypto_prices_raw"
),

cleaned_data AS (
    SELECT
        *,
        DATE(extracted_at) as extraction_date,
        DATE_TRUNC('hour', extracted_at) as extraction_hour,
        CASE
            WHEN LAG(price_usd) OVER (
                PARTITION BY symbol ORDER BY extracted_at
            ) IS NOT NULL THEN
                ((price_usd - LAG(price_usd) OVER (
                    PARTITION BY symbol ORDER BY extracted_at
                )) / LAG(price_usd) OVER (
                    PARTITION BY symbol ORDER BY extracted_at
                )) * 100
        END as price_change_pct_from_previous
    FROM source_data
    WHERE NOT is_invalid_price
)

SELECT * FROM cleaned_data
  );

[0m19:47:03.960805 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m19:47:04.049186 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m19:47:04.020604 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics.mart_crypto_latest_prices"
[0m19:47:04.088683 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */
alter table "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_tmp" rename to "stg_pipeline_runs"
[0m19:47:04.055523 [debug] [Thread-2 (]: Began running node model.crypto_analytics.mart_crypto_hourly_performance
[0m19:47:04.080600 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */




  create  table "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_tmp"


    as

  (


WITH pipeline_metrics AS (
    SELECT
        run_id,
        stage,
        status,
        records_processed,
        error_message,
        started_at,
        completed_at,
        EXTRACT(EPOCH FROM completed_at - started_at) AS duration_seconds,

        -- Flag to compute success rate
        CASE WHEN status = 'success' THEN 1 ELSE 0 END AS is_success,

        -- Classify performance
        CASE
            WHEN completed_at IS NULL THEN 'Running'
            WHEN EXTRACT(EPOCH FROM completed_at - started_at) < 30 THEN 'Fast'
            WHEN EXTRACT(EPOCH FROM completed_at - started_at) < 120 THEN 'Normal'
            ELSE 'Slow'
        END AS performance_category

    FROM "crypto_warehouse"."public_staging"."stg_pipeline_runs"
),

latest_status_per_day_stage AS (
    SELECT
        DATE(started_at) AS run_date,
        stage,
        FIRST_VALUE(status) OVER (
            PARTITION BY DATE(started_at), stage
            ORDER BY started_at DESC
        ) AS latest_run_status
    FROM pipeline_metrics
),

daily_summary AS (
    SELECT
        DATE(started_at) AS run_date,
        stage,

        COUNT(*) AS total_runs,
        SUM(is_success) AS successful_runs,
        SUM(records_processed) AS total_records_processed,
        AVG(duration_seconds) AS avg_duration_seconds,
        MAX(duration_seconds) AS max_duration_seconds,
        ROUND(((SUM(is_success)::FLOAT / COUNT(*)) * 100)::NUMERIC, 2) AS success_rate_pct


    FROM pipeline_metrics
    WHERE started_at >= CURRENT_DATE - INTERVAL '30 days'
    GROUP BY DATE(started_at), stage
)

-- Final result combining metrics with latest run status
SELECT
    ds.*,
    ls.latest_run_status
FROM daily_summary ds
LEFT JOIN latest_status_per_day_stage ls
  ON ds.run_date = ls.run_date AND ds.stage = ls.stage
  );

[0m19:47:04.123956 [info ] [Thread-2 (]: 5 of 5 START sql table model public_marts.mart_crypto_hourly_performance ....... [RUN]
[0m19:47:04.152525 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.int_crypto_daily_aggs, now model.crypto_analytics.mart_crypto_hourly_performance)
[0m19:47:04.169845 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics.mart_crypto_hourly_performance
[0m19:47:04.268916 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "stg_pipeline_runs" already exists

[0m19:47:04.283297 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics.mart_crypto_hourly_performance"
[0m19:47:04.323509 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: ROLLBACK
[0m19:47:04.299341 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m19:47:04.396186 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: BEGIN
[0m19:47:04.394778 [debug] [Thread-2 (]: Postgres adapter: Error running SQL: macro rename_relation
[0m19:47:04.414723 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:47:04.401924 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.0 seconds
[0m19:47:04.446588 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:47:04.424437 [debug] [Thread-2 (]: Postgres adapter: Rolling back transaction.
[0m19:47:04.453069 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m19:47:04.481625 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m19:47:04.482242 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.stg_pipeline_runs (execute): 19:47:02.096903 => 19:47:04.481431
[0m19:47:04.499717 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */




  create  table "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_tmp"


    as

  (


WITH latest_prices AS (
    SELECT
        symbol,
        crypto_name,
        price_usd,
        market_cap,
        volume_24h,
        price_change_24h,
        price_change_pct_24h,
        market_cap_rank,
        extracted_at,

        ROW_NUMBER() OVER (
            PARTITION BY symbol
            ORDER BY extracted_at DESC
        ) as rn

    FROM "crypto_warehouse"."public_staging"."stg_crypto_prices"
    WHERE extraction_date = CURRENT_DATE
),

price_changes AS (
    SELECT
        symbol,
        crypto_name,
        price_usd as current_price,
        market_cap,
        volume_24h,
        price_change_24h,
        price_change_pct_24h,
        market_cap_rank,
        extracted_at as last_updated,

        -- Calculate additional metrics
        CASE
            WHEN price_change_pct_24h > 10 THEN 'Strong Gain'
            WHEN price_change_pct_24h > 5 THEN 'Moderate Gain'
            WHEN price_change_pct_24h > 0 THEN 'Slight Gain'
            WHEN price_change_pct_24h > -5 THEN 'Slight Loss'
            WHEN price_change_pct_24h > -10 THEN 'Moderate Loss'
            ELSE 'Strong Loss'
        END as price_trend_category,

        -- Market cap category
        CASE
            WHEN market_cap_rank <= 10 THEN 'Large Cap'
            WHEN market_cap_rank <= 50 THEN 'Mid Cap'
            WHEN market_cap_rank <= 100 THEN 'Small Cap'
            ELSE 'Micro Cap'
        END as market_cap_category

    FROM latest_prices
    WHERE rn = 1
)

SELECT * FROM price_changes
  );

[0m19:47:04.501736 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */
alter table "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_tmp" rename to "stg_crypto_prices"
[0m19:47:04.514141 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: Close
[0m19:47:04.525512 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "stg_crypto_prices" already exists

[0m19:47:04.546231 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.mart_crypto_hourly_performance (compile): 19:47:04.188943 => 19:47:04.545389
[0m19:47:04.547731 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: ROLLBACK
[0m19:47:04.556699 [debug] [Thread-2 (]: Began executing node model.crypto_analytics.mart_crypto_hourly_performance
[0m19:47:04.557947 [debug] [Thread-1 (]: Postgres adapter: Error running SQL: macro rename_relation
[0m19:47:04.567192 [debug] [Thread-1 (]: Postgres adapter: Rolling back transaction.
[0m19:47:04.575988 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.stg_crypto_prices (execute): 19:47:02.047475 => 19:47:04.574962
[0m19:47:04.597775 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: Close
[0m19:47:04.608291 [debug] [Thread-2 (]: Writing runtime sql for node "model.crypto_analytics.mart_crypto_hourly_performance"
[0m19:47:04.691738 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m19:47:04.705880 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: BEGIN
[0m19:47:04.712666 [debug] [Thread-4 (]: SQL status: SELECT 6 in 1.0 seconds
[0m19:47:04.722276 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:47:04.738036 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m19:47:04.774684 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:47:04.791797 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */
alter table "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_tmp" rename to "mart_pipeline_monitoring"
[0m19:47:04.807767 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m19:47:04.828850 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:47:04.859771 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */




  create  table "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_tmp"


    as

  (


WITH  __dbt__cte__int_crypto_hourly_aggs as (


WITH base_data AS (
    SELECT
        symbol,
        crypto_name,
        DATE_TRUNC('hour', extracted_at) AS extraction_hour,
        price_usd,
        volume_24h,
        market_cap,
        CASE WHEN price_usd <= 0 THEN 1 ELSE 0 END AS is_invalid
    FROM "crypto_warehouse"."public_staging"."stg_crypto_prices"
)

SELECT
    symbol,
    crypto_name,
    extraction_hour,
    COUNT(*) AS total_records,
    SUM(is_invalid) AS invalid_price_records,
    AVG(price_usd) AS avg_price_usd,
    MIN(price_usd) AS min_price_usd,
    MAX(price_usd) AS max_price_usd,
    STDDEV(price_usd) AS price_volatility,
    AVG(volume_24h) AS avg_volume_24h,
    AVG(market_cap) AS avg_market_cap
FROM base_data
GROUP BY symbol, crypto_name, extraction_hour
), hourly_data AS (
    SELECT
        symbol,
        crypto_name,
        extraction_hour,
        avg_price_usd,
        min_price_usd,
        max_price_usd,
        price_volatility,
        avg_volume_24h,
        avg_market_cap,
        total_records,

        -- Calculate hourly change
        LAG(avg_price_usd) OVER (
            PARTITION BY symbol
            ORDER BY extraction_hour
        ) as previous_hour_price,

        -- Data quality score
        (1.0 - (invalid_price_records::FLOAT / GREATEST(total_records, 1))) * 100 as data_quality_score

    FROM __dbt__cte__int_crypto_hourly_aggs
),

performance_metrics AS (
    SELECT
        *,
        CASE
            WHEN previous_hour_price IS NOT NULL AND previous_hour_price > 0 THEN
                ((avg_price_usd - previous_hour_price) / previous_hour_price) * 100
            ELSE NULL
        END as hourly_change_pct,

        -- Volatility category
        CASE
            WHEN price_volatility IS NULL THEN 'Unknown'
            WHEN price_volatility < avg_price_usd * 0.01 THEN 'Low Volatility'
            WHEN price_volatility < avg_price_usd * 0.05 THEN 'Medium Volatility'
            ELSE 'High Volatility'
        END as volatility_category

    FROM hourly_data
)

SELECT * FROM performance_metrics
  );

[0m19:47:04.868983 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.0 seconds
[0m19:47:04.939597 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m19:47:04.976939 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m19:47:04.992564 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */

    create  index if not exists
  "4595ee65c553fbac917748a90f8d98f3"
  on "crypto_warehouse"."public_marts"."mart_pipeline_monitoring" using btree
  (run_date);

[0m19:47:05.006216 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_tmp" rename to "mart_crypto_latest_prices"
[0m19:47:05.024191 [debug] [Thread-1 (]: Database Error in model stg_crypto_prices (models/staging/stg_crypto_prices.sql)
  relation "stg_crypto_prices" already exists
  compiled Code at target/run/crypto_analytics/models/staging/stg_crypto_prices.sql
[0m19:47:05.055118 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:47:05.029467 [debug] [Thread-2 (]: Database Error in model stg_pipeline_runs (models/staging/stg_pipeline_runs.sql)
  relation "stg_pipeline_runs" already exists
  compiled Code at target/run/crypto_analytics/models/staging/stg_pipeline_runs.sql
[0m19:47:05.055134 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b407859-3355-4af6-90f8-a7022c1bef0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45bd79c890>]}
[0m19:47:05.076771 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m19:47:05.073658 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b407859-3355-4af6-90f8-a7022c1bef0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45bce87690>]}
[0m19:47:05.096381 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */

    create  index if not exists
  "950beaa0419e2d20734392eed434ca01"
  on "crypto_warehouse"."public_marts"."mart_crypto_latest_prices" using btree
  (symbol);

[0m19:47:05.090451 [error] [Thread-1 (]: 1 of 5 ERROR creating sql table model public_staging.stg_crypto_prices ......... [[31mERROR[0m in 3.52s]
[0m19:47:05.115724 [debug] [Thread-2 (]: SQL status: SELECT 15 in 0.0 seconds
[0m19:47:05.109366 [error] [Thread-2 (]: 2 of 5 ERROR creating sql view model public_staging.stg_pipeline_runs .......... [[31mERROR[0m in 3.51s]
[0m19:47:05.130710 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.stg_crypto_prices
[0m19:47:05.162802 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m19:47:05.162793 [debug] [Thread-2 (]: Finished running node model.crypto_analytics.stg_pipeline_runs
[0m19:47:05.314628 [debug] [Thread-4 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m19:47:05.479320 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_tmp" rename to "mart_crypto_hourly_performance"
[0m19:47:05.476773 [debug] [Thread-4 (]: Began running node model.crypto_analytics.int_crypto_daily_aggs
[0m19:47:05.512731 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m19:47:05.477947 [debug] [Thread-3 (]: Began running node model.crypto_analytics.int_crypto_hourly_aggs
[0m19:47:05.479060 [debug] [Thread-1 (]: Began running node model.crypto_analytics.mart_crypto_latest_prices
[0m19:47:05.530902 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m19:47:05.564265 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:47:05.526238 [debug] [Thread-2 (]: Began running node model.crypto_analytics.mart_pipeline_monitoring
[0m19:47:05.602635 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m19:47:05.575943 [debug] [Thread-4 (]: Finished running node model.crypto_analytics.int_crypto_daily_aggs
[0m19:47:05.631948 [debug] [Thread-3 (]: Finished running node model.crypto_analytics.int_crypto_hourly_aggs
[0m19:47:05.693876 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */

    create  index if not exists
  "573ddcd99f0aaef01517ab545396154d"
  on "crypto_warehouse"."public_marts"."mart_pipeline_monitoring" using btree
  (stage);

[0m19:47:05.730063 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m19:47:05.693967 [info ] [Thread-1 (]: 3 of 5 SKIP relation public_marts.mart_crypto_latest_prices .................... [[33mSKIP[0m]
[0m19:47:05.760055 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */

    create  index if not exists
  "8eb2607b4e77da820d8826bccdbcbddd"
  on "crypto_warehouse"."public_marts"."mart_crypto_latest_prices" using btree
  (market_cap_rank);

[0m19:47:05.738497 [info ] [Thread-2 (]: 4 of 5 SKIP relation public_marts.mart_pipeline_monitoring ..................... [[33mSKIP[0m]
[0m19:47:05.892771 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */

    create  index if not exists
  "e0cb4c4a496fa7efbbbdf3b1bf311e12"
  on "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance" using btree
  (symbol, extraction_hour);

[0m19:47:05.807291 [debug] [Thread-4 (]: Began running node model.crypto_analytics.mart_crypto_hourly_performance
[0m19:47:05.979189 [debug] [Thread-4 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m19:47:05.895346 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.mart_crypto_latest_prices
[0m19:47:06.012989 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: COMMIT
[0m19:47:05.940445 [debug] [Thread-2 (]: Finished running node model.crypto_analytics.mart_pipeline_monitoring
[0m19:47:06.030302 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m19:47:05.988448 [info ] [Thread-4 (]: 5 of 5 SKIP relation public_marts.mart_crypto_hourly_performance ............... [[33mSKIP[0m]
[0m19:47:06.051403 [debug] [Thread-4 (]: Finished running node model.crypto_analytics.mart_crypto_hourly_performance
[0m19:47:06.051297 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: COMMIT
[0m19:47:06.066789 [debug] [MainThread]: Using postgres connection "master"
[0m19:47:06.079406 [debug] [MainThread]: On master: BEGIN
[0m19:47:06.095645 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:47:06.123478 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m19:47:06.133330 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:47:06.157503 [debug] [MainThread]: On master: COMMIT
[0m19:47:06.161174 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: COMMIT
[0m19:47:06.172629 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m19:47:06.180894 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: COMMIT
[0m19:47:06.175965 [debug] [MainThread]: Using postgres connection "master"
[0m19:47:06.192568 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m19:47:06.197850 [debug] [MainThread]: On master: COMMIT
[0m19:47:06.216265 [debug] [Thread-4 (]: Applying DROP to: "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_backup"
[0m19:47:06.218740 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:47:06.231383 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m19:47:06.233202 [debug] [MainThread]: On master: Close
[0m19:47:06.239933 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */
drop table if exists "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_backup" cascade
[0m19:47:06.272667 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:47:06.273938 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:47:06.290849 [debug] [MainThread]: Connection 'model.crypto_analytics.stg_pipeline_runs' was properly closed.
[0m19:47:06.291032 [debug] [Thread-4 (]: Timing info for model.crypto_analytics.mart_pipeline_monitoring (execute): 19:47:02.407241 => 19:47:06.290412
[0m19:47:06.304700 [debug] [MainThread]: Connection 'list_crypto_warehouse_public_marts' was properly closed.
[0m19:47:06.308210 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: Close
[0m19:47:06.323278 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:47:06.323414 [debug] [MainThread]: Connection 'model.crypto_analytics.stg_crypto_prices' was properly closed.
[0m19:47:06.340465 [info ] [MainThread]:
[0m19:47:06.329825 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7521693-7fa2-4be5-bc19-166171369e3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1da7413d0>]}
[0m19:47:06.349053 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 6.67 seconds (6.67s).
[0m19:47:06.334375 [debug] [Thread-2 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m19:47:06.361828 [debug] [MainThread]: Command end result
[0m19:47:06.348409 [debug] [Thread-1 (]: Applying DROP to: "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_backup"
[0m19:47:06.354878 [info ] [Thread-4 (]: 3 of 5 OK created sql table model public_marts.mart_pipeline_monitoring ........ [[32mSELECT 6[0m in 4.53s]
[0m19:47:06.366788 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m19:47:06.434974 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m19:47:06.457879 [debug] [Thread-4 (]: Finished running node model.crypto_analytics.mart_pipeline_monitoring
[0m19:47:06.494936 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */

    create  index if not exists
  "7f20ca5a9ca15a0683f72ba46ebe6e15"
  on "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance" using btree
  (extraction_hour);

[0m19:47:06.541214 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */
drop table if exists "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_backup" cascade
[0m19:47:06.596651 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:47:06.620203 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.mart_crypto_latest_prices (execute): 19:47:03.999409 => 19:47:06.619608
[0m19:47:06.633759 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: Close
[0m19:47:06.645110 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7521693-7fa2-4be5-bc19-166171369e3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1da5ea3d0>]}
[0m19:47:06.659338 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public_marts.mart_crypto_latest_prices ....... [[32mSELECT 5[0m in 4.34s]
[0m19:47:06.677758 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.mart_crypto_latest_prices
[0m19:47:06.691749 [info ] [MainThread]:
[0m19:47:06.701129 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m19:47:06.712001 [debug] [Thread-2 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m19:47:06.715364 [info ] [MainThread]:
[0m19:47:06.730124 [error] [MainThread]:   Database Error in model stg_crypto_prices (models/staging/stg_crypto_prices.sql)
  relation "stg_crypto_prices" already exists
  compiled Code at target/run/crypto_analytics/models/staging/stg_crypto_prices.sql
[0m19:47:06.742683 [info ] [MainThread]:
[0m19:47:06.731687 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: COMMIT
[0m19:47:06.762777 [error] [MainThread]:   Database Error in model stg_pipeline_runs (models/staging/stg_pipeline_runs.sql)
  relation "stg_pipeline_runs" already exists
  compiled Code at target/run/crypto_analytics/models/staging/stg_pipeline_runs.sql
[0m19:47:06.777538 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m19:47:06.791511 [info ] [MainThread]:
[0m19:47:06.793954 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: COMMIT
[0m19:47:06.807928 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=3 TOTAL=5
[0m19:47:06.855872 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 15.013201, "process_user_time": 11.488381, "process_kernel_time": 0.862129, "process_mem_max_rss": "126784", "process_in_blocks": "408", "command_success": false, "process_out_blocks": "0"}
[0m19:47:06.867099 [debug] [MainThread]: Command `dbt run` failed at 19:47:06.866651 after 15.02 seconds
[0m19:47:06.878086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45bf2937d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45c00ae950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45c3c193d0>]}
[0m19:47:06.890151 [debug] [MainThread]: Flushing usage events
[0m19:47:06.914288 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m19:47:06.947267 [debug] [Thread-2 (]: Applying DROP to: "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_backup"
[0m19:47:06.957111 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m19:47:06.966769 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */
drop table if exists "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_backup" cascade
[0m19:47:06.975604 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:47:06.986626 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.mart_crypto_hourly_performance (execute): 19:47:04.565564 => 19:47:06.985908
[0m19:47:06.994505 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: Close
[0m19:47:07.004160 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7521693-7fa2-4be5-bc19-166171369e3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1db08f910>]}
[0m19:47:07.013781 [info ] [Thread-2 (]: 5 of 5 OK created sql table model public_marts.mart_crypto_hourly_performance .. [[32mSELECT 15[0m in 2.85s]
[0m19:47:07.026090 [debug] [Thread-2 (]: Finished running node model.crypto_analytics.mart_crypto_hourly_performance
[0m19:47:07.044193 [debug] [MainThread]: Using postgres connection "master"
[0m19:47:07.053226 [debug] [MainThread]: On master: BEGIN
[0m19:47:07.061666 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:47:07.076920 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:47:07.087411 [debug] [MainThread]: On master: COMMIT
[0m19:47:07.095658 [debug] [MainThread]: Using postgres connection "master"
[0m19:47:07.104641 [debug] [MainThread]: On master: COMMIT
[0m19:47:07.115452 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:47:07.124988 [debug] [MainThread]: On master: Close
[0m19:47:07.134520 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:47:07.144292 [debug] [MainThread]: Connection 'model.crypto_analytics.int_crypto_hourly_aggs' was properly closed.
[0m19:47:07.154593 [debug] [MainThread]: Connection 'model.crypto_analytics.mart_crypto_hourly_performance' was properly closed.
[0m19:47:07.165623 [debug] [MainThread]: Connection 'model.crypto_analytics.mart_crypto_latest_prices' was properly closed.
[0m19:47:07.174504 [debug] [MainThread]: Connection 'model.crypto_analytics.mart_pipeline_monitoring' was properly closed.
[0m19:47:07.185057 [info ] [MainThread]:
[0m19:47:07.193173 [info ] [MainThread]: Finished running 1 view model, 4 table models in 0 hours 0 minutes and 10.06 seconds (10.06s).
[0m19:47:07.204992 [debug] [MainThread]: Command end result
[0m19:47:07.334769 [info ] [MainThread]:
[0m19:47:07.346991 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:47:07.374957 [info ] [MainThread]:
[0m19:47:07.433572 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m19:47:07.451002 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 18.293777, "process_user_time": 13.538704, "process_kernel_time": 1.062252, "process_mem_max_rss": "129084", "process_in_blocks": "2032", "process_out_blocks": "1976"}
[0m19:47:07.477314 [debug] [MainThread]: Command `dbt run` succeeded at 19:47:07.476850 after 18.32 seconds
[0m19:47:07.488652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1dcc55310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1dcd65ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1dd112050>]}
[0m19:47:07.499180 [debug] [MainThread]: Flushing usage events
[0m19:51:59.184405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc49bbeef90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc49bbefb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc49bbef750>]}


============================== 19:51:59.232535 | f6f4f78d-b436-4f62-b209-5111899124c2 ==============================
[0m19:51:59.232535 [info ] [MainThread]: Running with dbt=1.7.0
[0m19:51:59.250108 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/app/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /app/dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:52:00.144232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6f4f78d-b436-4f62-b209-5111899124c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc49a53e650>]}
[0m19:52:00.539632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f6f4f78d-b436-4f62-b209-5111899124c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc49bc03490>]}
[0m19:52:00.548878 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m19:52:00.619864 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m19:52:00.729043 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:52:00.742503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f6f4f78d-b436-4f62-b209-5111899124c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc49a399050>]}
[0m19:52:08.941703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f6f4f78d-b436-4f62-b209-5111899124c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc49a26c790>]}
[0m19:52:09.262738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f6f4f78d-b436-4f62-b209-5111899124c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc49987a590>]}
[0m19:52:09.273343 [info ] [MainThread]: Found 7 models, 9 tests, 2 sources, 0 exposures, 0 metrics, 403 macros, 0 groups, 0 semantic models
[0m19:52:09.285476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6f4f78d-b436-4f62-b209-5111899124c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc499994590>]}
[0m19:52:09.300240 [info ] [MainThread]:
[0m19:52:09.310499 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:52:09.321243 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse'
[0m19:52:09.323677 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse'
[0m19:52:09.355835 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse"
[0m19:52:09.361391 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse"
[0m19:52:09.369012 [debug] [ThreadPool]: On list_crypto_warehouse: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse"} */

    select distinct nspname from pg_namespace

[0m19:52:09.376725 [debug] [ThreadPool]: On list_crypto_warehouse: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse"} */

    select distinct nspname from pg_namespace

[0m19:52:09.384767 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:52:09.393299 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:52:09.419862 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m19:52:09.430914 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m19:52:09.434697 [debug] [ThreadPool]: On list_crypto_warehouse: Close
[0m19:52:09.446801 [debug] [ThreadPool]: On list_crypto_warehouse: Close
[0m19:52:09.469378 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_warehouse, now list_crypto_warehouse_public_marts)
[0m19:52:09.471898 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_warehouse, now list_crypto_warehouse_public_staging)
[0m19:52:09.474801 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse_public_dbt_test__audit'
[0m19:52:09.495907 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_marts"
[0m19:52:09.506483 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_staging"
[0m19:52:09.518622 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_dbt_test__audit"
[0m19:52:09.527051 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: BEGIN
[0m19:52:09.536665 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: BEGIN
[0m19:52:09.544435 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: BEGIN
[0m19:52:09.553188 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:52:09.561406 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:52:09.570229 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:52:09.585982 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:52:09.609350 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:52:09.617273 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_marts"
[0m19:52:09.629079 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:52:09.652675 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_dbt_test__audit"
[0m19:52:09.663288 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_dbt_test__audit"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'

[0m19:52:09.629963 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_staging"
[0m19:52:09.640329 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_marts"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'

[0m19:52:09.681365 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m19:52:09.685050 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_staging"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'

[0m19:52:09.700230 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m19:52:09.704416 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: ROLLBACK
[0m19:52:09.720043 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m19:52:09.756973 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: ROLLBACK
[0m19:52:09.739440 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: Close
[0m19:52:09.729031 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: ROLLBACK
[0m19:52:09.772354 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: Close
[0m19:52:09.802292 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: Close
[0m19:52:09.874111 [debug] [MainThread]: Using postgres connection "master"
[0m19:52:09.910933 [debug] [MainThread]: On master: BEGIN
[0m19:52:09.925619 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:52:09.943236 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:52:09.952830 [debug] [MainThread]: Using postgres connection "master"
[0m19:52:09.963696 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:52:09.985991 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m19:52:09.999080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6f4f78d-b436-4f62-b209-5111899124c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc499703090>]}
[0m19:52:10.009620 [debug] [MainThread]: On master: ROLLBACK
[0m19:52:10.018838 [debug] [MainThread]: Using postgres connection "master"
[0m19:52:10.027821 [debug] [MainThread]: On master: BEGIN
[0m19:52:10.037265 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:52:10.047161 [debug] [MainThread]: On master: COMMIT
[0m19:52:10.054941 [debug] [MainThread]: Using postgres connection "master"
[0m19:52:10.062346 [debug] [MainThread]: On master: COMMIT
[0m19:52:10.071566 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:52:10.079553 [debug] [MainThread]: On master: Close
[0m19:52:10.089683 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:52:10.099702 [info ] [MainThread]:
[0m19:52:10.114449 [debug] [Thread-1 (]: Began running node model.crypto_analytics.stg_crypto_prices
[0m19:52:10.115732 [debug] [Thread-2 (]: Began running node model.crypto_analytics.stg_pipeline_runs
[0m19:52:10.124926 [info ] [Thread-1 (]: 1 of 5 START sql table model public_staging.stg_crypto_prices .................. [RUN]
[0m19:52:10.133387 [info ] [Thread-2 (]: 2 of 5 START sql view model public_staging.stg_pipeline_runs ................... [RUN]
[0m19:52:10.143307 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_marts, now model.crypto_analytics.stg_crypto_prices)
[0m19:52:10.163939 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_staging, now model.crypto_analytics.stg_pipeline_runs)
[0m19:52:10.174211 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics.stg_crypto_prices
[0m19:52:10.183401 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics.stg_pipeline_runs
[0m19:52:10.214955 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics.stg_crypto_prices"
[0m19:52:10.224904 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics.stg_pipeline_runs"
[0m19:52:10.266826 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.stg_crypto_prices (compile): 19:52:10.191206 => 19:52:10.266016
[0m19:52:10.261054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6babb30d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6bb065b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6bb065b90>]}
[0m19:52:10.276168 [debug] [Thread-1 (]: Began executing node model.crypto_analytics.stg_crypto_prices


============================== 19:52:10.278471 | 4be6a5be-379e-4915-a439-8702aaa12cc7 ==============================
[0m19:52:10.278471 [info ] [MainThread]: Running with dbt=1.7.0
[0m19:52:10.289679 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'debug': 'False', 'profiles_dir': '/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:52:10.281138 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.stg_pipeline_runs (compile): 19:52:10.215509 => 19:52:10.280255
[0m19:52:10.317443 [debug] [Thread-2 (]: Began executing node model.crypto_analytics.stg_pipeline_runs
[0m19:52:10.519605 [debug] [Thread-2 (]: Writing runtime sql for node "model.crypto_analytics.stg_pipeline_runs"
[0m19:52:10.530849 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics.stg_crypto_prices"
[0m19:52:10.579627 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m19:52:10.590544 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m19:52:10.591836 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: BEGIN
[0m19:52:10.600906 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: BEGIN
[0m19:52:10.612393 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:52:10.625185 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:52:10.640467 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:52:10.658267 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:52:10.663296 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m19:52:10.673294 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m19:52:10.681667 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */

  create view "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_tmp"


  as (
    SELECT
    id as run_id,
    run_id as run_identifier,
    stage,
    status,
    records_processed,
    error_message,
    started_at,
    completed_at,
    CASE
        WHEN completed_at IS NOT NULL
        THEN EXTRACT(EPOCH FROM (completed_at - started_at))
        ELSE NULL
    END as duration_seconds
FROM "crypto_warehouse"."public"."pipeline_runs"
  );
[0m19:52:10.691375 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */




  create  table "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_tmp"


    as

  (


WITH source_data AS (
    SELECT
        id as price_id,
        UPPER(TRIM(symbol)) as symbol,
        TRIM(name) as crypto_name,
        current_price as price_usd,
        market_cap,
        total_volume as volume_24h,
        price_change_24h,
        price_change_percentage_24h as price_change_pct_24h,
        market_cap_rank,
        extracted_at,
        created_at,

        CASE WHEN current_price <= 0 THEN TRUE ELSE FALSE END as is_invalid_price,
        CASE WHEN market_cap <= 0 THEN TRUE ELSE FALSE END as is_invalid_market_cap
    FROM "crypto_warehouse"."public"."crypto_prices_raw"
),

cleaned_data AS (
    SELECT
        *,
        DATE(extracted_at) as extraction_date,
        DATE_TRUNC('hour', extracted_at) as extraction_hour,
        CASE
            WHEN LAG(price_usd) OVER (
                PARTITION BY symbol ORDER BY extracted_at
            ) IS NOT NULL THEN
                ((price_usd - LAG(price_usd) OVER (
                    PARTITION BY symbol ORDER BY extracted_at
                )) / LAG(price_usd) OVER (
                    PARTITION BY symbol ORDER BY extracted_at
                )) * 100
        END as price_change_pct_from_previous
    FROM source_data
    WHERE NOT is_invalid_price
)

SELECT * FROM cleaned_data
  );

[0m19:52:10.702295 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:52:10.734516 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m19:52:10.743729 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */
alter table "crypto_warehouse"."public_staging"."stg_pipeline_runs" rename to "stg_pipeline_runs__dbt_backup"
[0m19:52:10.753005 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:52:10.768448 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m19:52:10.776692 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */
alter table "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_tmp" rename to "stg_pipeline_runs"
[0m19:52:10.785813 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:52:10.849184 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: COMMIT
[0m19:52:10.863904 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m19:52:10.881879 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: COMMIT
[0m19:52:10.894771 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.0 seconds
[0m19:52:10.914400 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m19:52:10.925468 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */
alter table "crypto_warehouse"."public_staging"."stg_crypto_prices" rename to "stg_crypto_prices__dbt_backup"
[0m19:52:10.937364 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:52:10.966501 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m19:52:10.978165 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */
alter table "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_tmp" rename to "stg_crypto_prices"
[0m19:52:10.985366 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:52:11.014986 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m19:52:11.025805 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m19:52:11.032295 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */

        CREATE INDEX IF NOT EXISTS idx_stg_crypto_prices_symbol_time ON "crypto_warehouse"."public_staging"."stg_crypto_prices" (symbol, extracted_at)

[0m19:52:11.096192 [debug] [Thread-2 (]: Applying DROP to: "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_backup"
[0m19:52:11.099946 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m19:52:11.163570 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m19:52:11.206490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4be6a5be-379e-4915-a439-8702aaa12cc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6babff790>]}
[0m19:52:11.191019 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: COMMIT
[0m19:52:11.204967 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */
drop view if exists "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_backup" cascade
[0m19:52:11.231999 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m19:52:11.266167 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: COMMIT
[0m19:52:11.359353 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:52:11.393923 [debug] [Thread-1 (]: Applying DROP to: "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_backup"
[0m19:52:11.440892 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m19:52:11.448955 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */
drop table if exists "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_backup" cascade
[0m19:52:11.507249 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:52:11.523625 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.stg_pipeline_runs (execute): 19:52:10.376162 => 19:52:11.522918
[0m19:52:11.537606 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: Close
[0m19:52:11.549811 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6f4f78d-b436-4f62-b209-5111899124c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4998b71d0>]}
[0m19:52:11.560098 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:52:11.565821 [info ] [Thread-2 (]: 2 of 5 OK created sql view model public_staging.stg_pipeline_runs .............. [[32mCREATE VIEW[0m in 1.39s]
[0m19:52:11.580650 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.stg_crypto_prices (execute): 19:52:10.287329 => 19:52:11.579994
[0m19:52:11.594320 [debug] [Thread-2 (]: Finished running node model.crypto_analytics.stg_pipeline_runs
[0m19:52:11.606541 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: Close
[0m19:52:11.616441 [debug] [Thread-4 (]: Began running node model.crypto_analytics.mart_pipeline_monitoring
[0m19:52:11.633060 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6f4f78d-b436-4f62-b209-5111899124c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc49a3c3850>]}
[0m19:52:11.646417 [info ] [Thread-4 (]: 3 of 5 START sql table model public_marts.mart_pipeline_monitoring ............. [RUN]
[0m19:52:11.660460 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public_staging.stg_crypto_prices ............. [[32mSELECT 15[0m in 1.49s]
[0m19:52:11.669213 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.crypto_analytics.mart_pipeline_monitoring'
[0m19:52:11.681552 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.stg_crypto_prices
[0m19:52:11.705315 [debug] [Thread-4 (]: Began compiling node model.crypto_analytics.mart_pipeline_monitoring
[0m19:52:11.724848 [debug] [Thread-2 (]: Began running node model.crypto_analytics.int_crypto_daily_aggs
[0m19:52:11.726081 [debug] [Thread-3 (]: Began running node model.crypto_analytics.int_crypto_hourly_aggs
[0m19:52:11.727183 [debug] [Thread-1 (]: Began running node model.crypto_analytics.mart_crypto_latest_prices
[0m19:52:11.780861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4be6a5be-379e-4915-a439-8702aaa12cc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6b94a7c90>]}
[0m19:52:11.759962 [debug] [Thread-4 (]: Writing injected SQL for node "model.crypto_analytics.mart_pipeline_monitoring"
[0m19:52:11.791539 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m19:52:11.765006 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.stg_pipeline_runs, now model.crypto_analytics.int_crypto_daily_aggs)
[0m19:52:11.774856 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_dbt_test__audit, now model.crypto_analytics.int_crypto_hourly_aggs)
[0m19:52:11.787483 [info ] [Thread-1 (]: 4 of 5 START sql table model public_marts.mart_crypto_latest_prices ............ [RUN]
[0m19:52:11.830678 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics.int_crypto_daily_aggs
[0m19:52:11.847973 [debug] [Thread-3 (]: Began compiling node model.crypto_analytics.int_crypto_hourly_aggs
[0m19:52:11.865470 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.stg_crypto_prices, now model.crypto_analytics.mart_crypto_latest_prices)
[0m19:52:11.917837 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m19:52:11.898843 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics.int_crypto_daily_aggs"
[0m19:52:11.916742 [debug] [Thread-3 (]: Writing injected SQL for node "model.crypto_analytics.int_crypto_hourly_aggs"
[0m19:52:11.943884 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics.mart_crypto_latest_prices
[0m19:52:11.958638 [debug] [Thread-4 (]: Timing info for model.crypto_analytics.mart_pipeline_monitoring (compile): 19:52:11.732620 => 19:52:11.957783
[0m19:52:11.992187 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics.mart_crypto_latest_prices"
[0m19:52:11.999652 [debug] [Thread-4 (]: Began executing node model.crypto_analytics.mart_pipeline_monitoring
[0m19:52:12.014634 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.int_crypto_daily_aggs (compile): 19:52:11.890394 => 19:52:12.013855
[0m19:52:12.029731 [debug] [Thread-3 (]: Timing info for model.crypto_analytics.int_crypto_hourly_aggs (compile): 19:52:11.907619 => 19:52:12.028772
[0m19:52:12.063959 [debug] [Thread-4 (]: Writing runtime sql for node "model.crypto_analytics.mart_pipeline_monitoring"
[0m19:52:12.066897 [debug] [Thread-2 (]: Finished running node model.crypto_analytics.int_crypto_daily_aggs
[0m19:52:12.075445 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.mart_crypto_latest_prices (compile): 19:52:11.979366 => 19:52:12.074677
[0m19:52:12.082861 [debug] [Thread-3 (]: Finished running node model.crypto_analytics.int_crypto_hourly_aggs
[0m19:52:12.111113 [debug] [Thread-1 (]: Began executing node model.crypto_analytics.mart_crypto_latest_prices
[0m19:52:12.124189 [debug] [Thread-2 (]: Began running node model.crypto_analytics.mart_crypto_hourly_performance
[0m19:52:12.156657 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics.mart_crypto_latest_prices"
[0m19:52:12.164414 [info ] [Thread-2 (]: 5 of 5 START sql table model public_marts.mart_crypto_hourly_performance ....... [RUN]
[0m19:52:12.171104 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m19:52:12.186913 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.int_crypto_daily_aggs, now model.crypto_analytics.mart_crypto_hourly_performance)
[0m19:52:12.199516 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: BEGIN
[0m19:52:12.210019 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics.mart_crypto_hourly_performance
[0m19:52:12.224280 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:52:12.296851 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m19:52:12.309066 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m19:52:12.317476 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics.mart_crypto_hourly_performance"
[0m19:52:12.320587 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m19:52:12.329775 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: BEGIN
[0m19:52:12.346162 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */




  create  table "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_tmp"


    as

  (


WITH pipeline_metrics AS (
    SELECT
        run_id,
        stage,
        status,
        records_processed,
        error_message,
        started_at,
        completed_at,
        EXTRACT(EPOCH FROM completed_at - started_at) AS duration_seconds,

        -- Flag to compute success rate
        CASE WHEN status = 'success' THEN 1 ELSE 0 END AS is_success,

        -- Classify performance
        CASE
            WHEN completed_at IS NULL THEN 'Running'
            WHEN EXTRACT(EPOCH FROM completed_at - started_at) < 30 THEN 'Fast'
            WHEN EXTRACT(EPOCH FROM completed_at - started_at) < 120 THEN 'Normal'
            ELSE 'Slow'
        END AS performance_category

    FROM "crypto_warehouse"."public_staging"."stg_pipeline_runs"
),

latest_status_per_day_stage AS (
    SELECT
        DATE(started_at) AS run_date,
        stage,
        FIRST_VALUE(status) OVER (
            PARTITION BY DATE(started_at), stage
            ORDER BY started_at DESC
        ) AS latest_run_status
    FROM pipeline_metrics
),

daily_summary AS (
    SELECT
        DATE(started_at) AS run_date,
        stage,

        COUNT(*) AS total_runs,
        SUM(is_success) AS successful_runs,
        SUM(records_processed) AS total_records_processed,
        AVG(duration_seconds) AS avg_duration_seconds,
        MAX(duration_seconds) AS max_duration_seconds,
        ROUND(((SUM(is_success)::FLOAT / COUNT(*)) * 100)::NUMERIC, 2) AS success_rate_pct


    FROM pipeline_metrics
    WHERE started_at >= CURRENT_DATE - INTERVAL '30 days'
    GROUP BY DATE(started_at), stage
)

-- Final result combining metrics with latest run status
SELECT
    ds.*,
    ls.latest_run_status
FROM daily_summary ds
LEFT JOIN latest_status_per_day_stage ls
  ON ds.run_date = ls.run_date AND ds.stage = ls.stage
  );

[0m19:52:12.355960 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:52:12.384627 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:52:12.397249 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m19:52:12.408306 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */




  create  table "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_tmp"


    as

  (


WITH latest_prices AS (
    SELECT
        symbol,
        crypto_name,
        price_usd,
        market_cap,
        volume_24h,
        price_change_24h,
        price_change_pct_24h,
        market_cap_rank,
        extracted_at,

        ROW_NUMBER() OVER (
            PARTITION BY symbol
            ORDER BY extracted_at DESC
        ) as rn

    FROM "crypto_warehouse"."public_staging"."stg_crypto_prices"
    WHERE extraction_date = CURRENT_DATE
),

price_changes AS (
    SELECT
        symbol,
        crypto_name,
        price_usd as current_price,
        market_cap,
        volume_24h,
        price_change_24h,
        price_change_pct_24h,
        market_cap_rank,
        extracted_at as last_updated,

        -- Calculate additional metrics
        CASE
            WHEN price_change_pct_24h > 10 THEN 'Strong Gain'
            WHEN price_change_pct_24h > 5 THEN 'Moderate Gain'
            WHEN price_change_pct_24h > 0 THEN 'Slight Gain'
            WHEN price_change_pct_24h > -5 THEN 'Slight Loss'
            WHEN price_change_pct_24h > -10 THEN 'Moderate Loss'
            ELSE 'Strong Loss'
        END as price_trend_category,

        -- Market cap category
        CASE
            WHEN market_cap_rank <= 10 THEN 'Large Cap'
            WHEN market_cap_rank <= 50 THEN 'Mid Cap'
            WHEN market_cap_rank <= 100 THEN 'Small Cap'
            ELSE 'Micro Cap'
        END as market_cap_category

    FROM latest_prices
    WHERE rn = 1
)

SELECT * FROM price_changes
  );

[0m19:52:12.415611 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.mart_crypto_hourly_performance (compile): 19:52:12.234449 => 19:52:12.414624
[0m19:52:12.451849 [debug] [Thread-2 (]: Began executing node model.crypto_analytics.mart_crypto_hourly_performance
[0m19:52:12.607394 [debug] [Thread-2 (]: Writing runtime sql for node "model.crypto_analytics.mart_crypto_hourly_performance"
[0m19:52:12.663671 [debug] [Thread-4 (]: SQL status: SELECT 6 in 0.0 seconds
[0m19:52:12.701096 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m19:52:12.725723 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */
alter table "crypto_warehouse"."public_marts"."mart_pipeline_monitoring" rename to "mart_pipeline_monitoring__dbt_backup"
[0m19:52:12.757656 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:52:12.759090 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m19:52:12.794124 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m19:52:12.800197 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: BEGIN
[0m19:52:12.815971 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.0 seconds
[0m19:52:12.832034 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */
alter table "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_tmp" rename to "mart_pipeline_monitoring"
[0m19:52:12.845038 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:52:12.872719 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m19:52:12.880189 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:52:12.903569 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:52:12.975063 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_latest_prices" rename to "mart_crypto_latest_prices__dbt_backup"
[0m19:52:13.079571 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m19:52:13.095611 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m19:52:13.116145 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:52:13.139407 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */

    create  index if not exists
  "2d477181e10d708b17b6ba5fc8dfd77b"
  on "crypto_warehouse"."public_marts"."mart_pipeline_monitoring" using btree
  (run_date);

[0m19:52:13.162440 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */




  create  table "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_tmp"


    as

  (


WITH  __dbt__cte__int_crypto_hourly_aggs as (


WITH base_data AS (
    SELECT
        symbol,
        crypto_name,
        DATE_TRUNC('hour', extracted_at) AS extraction_hour,
        price_usd,
        volume_24h,
        market_cap,
        CASE WHEN price_usd <= 0 THEN 1 ELSE 0 END AS is_invalid
    FROM "crypto_warehouse"."public_staging"."stg_crypto_prices"
)

SELECT
    symbol,
    crypto_name,
    extraction_hour,
    COUNT(*) AS total_records,
    SUM(is_invalid) AS invalid_price_records,
    AVG(price_usd) AS avg_price_usd,
    MIN(price_usd) AS min_price_usd,
    MAX(price_usd) AS max_price_usd,
    STDDEV(price_usd) AS price_volatility,
    AVG(volume_24h) AS avg_volume_24h,
    AVG(market_cap) AS avg_market_cap
FROM base_data
GROUP BY symbol, crypto_name, extraction_hour
), hourly_data AS (
    SELECT
        symbol,
        crypto_name,
        extraction_hour,
        avg_price_usd,
        min_price_usd,
        max_price_usd,
        price_volatility,
        avg_volume_24h,
        avg_market_cap,
        total_records,

        -- Calculate hourly change
        LAG(avg_price_usd) OVER (
            PARTITION BY symbol
            ORDER BY extraction_hour
        ) as previous_hour_price,

        -- Data quality score
        (1.0 - (invalid_price_records::FLOAT / GREATEST(total_records, 1))) * 100 as data_quality_score

    FROM __dbt__cte__int_crypto_hourly_aggs
),

performance_metrics AS (
    SELECT
        *,
        CASE
            WHEN previous_hour_price IS NOT NULL AND previous_hour_price > 0 THEN
                ((avg_price_usd - previous_hour_price) / previous_hour_price) * 100
            ELSE NULL
        END as hourly_change_pct,

        -- Volatility category
        CASE
            WHEN price_volatility IS NULL THEN 'Unknown'
            WHEN price_volatility < avg_price_usd * 0.01 THEN 'Low Volatility'
            WHEN price_volatility < avg_price_usd * 0.05 THEN 'Medium Volatility'
            ELSE 'High Volatility'
        END as volatility_category

    FROM hourly_data
)

SELECT * FROM performance_metrics
  );

[0m19:52:13.213343 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m19:52:13.379753 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_tmp" rename to "mart_crypto_latest_prices"
[0m19:52:13.403483 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:52:13.426757 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m19:52:13.460822 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */

    create  index if not exists
  "5a1438e4d1ebc5381084a853b20e6faa"
  on "crypto_warehouse"."public_marts"."mart_crypto_latest_prices" using btree
  (symbol);

[0m19:52:13.482123 [debug] [Thread-4 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m19:52:13.585567 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m19:52:13.637743 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */

    create  index if not exists
  "697369cf1ef9fd1b44a223f717468503"
  on "crypto_warehouse"."public_marts"."mart_pipeline_monitoring" using btree
  (stage);

[0m19:52:13.749444 [debug] [Thread-2 (]: SQL status: SELECT 15 in 0.0 seconds
[0m19:52:13.971361 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m19:52:14.007017 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m19:52:14.093177 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m19:52:14.138227 [debug] [Thread-4 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m19:52:14.190575 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance" rename to "mart_crypto_hourly_performance__dbt_backup"
[0m19:52:14.219212 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */

    create  index if not exists
  "80231bd3a07115e2f64d23b9ea22bfd8"
  on "crypto_warehouse"."public_marts"."mart_crypto_latest_prices" using btree
  (market_cap_rank);

[0m19:52:14.244209 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: COMMIT
[0m19:52:14.260928 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:52:14.284509 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m19:52:14.300553 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m19:52:14.305571 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: COMMIT
[0m19:52:14.318959 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_tmp" rename to "mart_crypto_hourly_performance"
[0m19:52:14.337259 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:52:14.351840 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m19:52:14.367831 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */

    create  index if not exists
  "924550f9f614398508db8dba6f5b8078"
  on "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance" using btree
  (symbol, extraction_hour);

[0m19:52:14.502056 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m19:52:14.517577 [debug] [Thread-4 (]: Applying DROP to: "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_backup"
[0m19:52:14.531488 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m19:52:14.542639 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */
drop table if exists "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_backup" cascade
[0m19:52:14.556374 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m19:52:14.571788 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: COMMIT
[0m19:52:14.583586 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m19:52:14.599127 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: COMMIT
[0m19:52:14.782132 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:52:14.783676 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:52:14.799129 [debug] [Thread-1 (]: Applying DROP to: "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_backup"
[0m19:52:14.806977 [debug] [Thread-4 (]: Timing info for model.crypto_analytics.mart_pipeline_monitoring (execute): 19:52:12.030995 => 19:52:14.806384
[0m19:52:14.820461 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m19:52:14.829154 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: Close
[0m19:52:14.838980 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */
drop table if exists "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_backup" cascade
[0m19:52:14.841079 [debug] [Thread-2 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m19:52:14.849218 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6f4f78d-b436-4f62-b209-5111899124c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4995e0750>]}
[0m19:52:14.867517 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m19:52:14.875835 [info ] [Thread-4 (]: 3 of 5 OK created sql table model public_marts.mart_pipeline_monitoring ........ [[32mSELECT 6[0m in 3.18s]
[0m19:52:14.884050 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */

    create  index if not exists
  "a83c39e0451b1218422f9cf532cbd3f7"
  on "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance" using btree
  (extraction_hour);

[0m19:52:14.895637 [debug] [Thread-4 (]: Finished running node model.crypto_analytics.mart_pipeline_monitoring
[0m19:52:15.072472 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:52:15.080317 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:52:15.103257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4be6a5be-379e-4915-a439-8702aaa12cc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6b915db90>]}
[0m19:52:15.105441 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:52:15.116506 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.mart_crypto_latest_prices (execute): 19:52:12.133856 => 19:52:15.115877
[0m19:52:15.124056 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: Close
[0m19:52:15.134804 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6f4f78d-b436-4f62-b209-5111899124c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4996ec5d0>]}
[0m19:52:15.143737 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public_marts.mart_crypto_latest_prices ....... [[32mSELECT 5[0m in 3.27s]
[0m19:52:15.151622 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.mart_crypto_latest_prices
[0m19:52:15.171609 [debug] [Thread-2 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m19:52:15.183533 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: COMMIT
[0m19:52:15.192705 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m19:52:15.200870 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: COMMIT
[0m19:52:15.248966 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m19:52:15.252011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4be6a5be-379e-4915-a439-8702aaa12cc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6b927add0>]}
[0m19:52:15.260230 [info ] [MainThread]: Found 7 models, 9 tests, 2 sources, 0 exposures, 0 metrics, 403 macros, 0 groups, 0 semantic models
[0m19:52:15.266067 [debug] [Thread-2 (]: Applying DROP to: "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_backup"
[0m19:52:15.271721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4be6a5be-379e-4915-a439-8702aaa12cc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6b91dfdd0>]}
[0m19:52:15.277692 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m19:52:15.287294 [info ] [MainThread]:
[0m19:52:15.287292 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */
drop table if exists "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_backup" cascade
[0m19:52:15.311930 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:52:15.329778 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse'
[0m19:52:15.362057 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:52:15.332781 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse'
[0m19:52:15.380700 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.mart_crypto_hourly_performance (execute): 19:52:12.580871 => 19:52:15.379864
[0m19:52:15.394280 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: Close
[0m19:52:15.406290 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6f4f78d-b436-4f62-b209-5111899124c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc49985d950>]}
[0m19:52:15.415203 [info ] [Thread-2 (]: 5 of 5 OK created sql table model public_marts.mart_crypto_hourly_performance .. [[32mSELECT 15[0m in 3.22s]
[0m19:52:15.419348 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse"
[0m19:52:15.426906 [debug] [Thread-2 (]: Finished running node model.crypto_analytics.mart_crypto_hourly_performance
[0m19:52:15.428601 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse"
[0m19:52:15.444683 [debug] [MainThread]: Using postgres connection "master"
[0m19:52:15.434256 [debug] [ThreadPool]: On list_crypto_warehouse: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse"} */

    select distinct nspname from pg_namespace

[0m19:52:15.455005 [debug] [MainThread]: On master: BEGIN
[0m19:52:15.450288 [debug] [ThreadPool]: On list_crypto_warehouse: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse"} */

    select distinct nspname from pg_namespace

[0m19:52:15.463027 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:52:15.461738 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:52:15.469903 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:52:15.479246 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:52:15.487479 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m19:52:15.489098 [debug] [MainThread]: On master: COMMIT
[0m19:52:15.497536 [debug] [MainThread]: Using postgres connection "master"
[0m19:52:15.500321 [debug] [ThreadPool]: On list_crypto_warehouse: Close
[0m19:52:15.506312 [debug] [MainThread]: On master: COMMIT
[0m19:52:15.503594 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m19:52:15.515558 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:52:15.521099 [debug] [ThreadPool]: On list_crypto_warehouse: Close
[0m19:52:15.524070 [debug] [MainThread]: On master: Close
[0m19:52:15.534802 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_warehouse, now list_crypto_warehouse_public_marts)
[0m19:52:15.541276 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:52:15.549964 [debug] [MainThread]: Connection 'model.crypto_analytics.mart_crypto_hourly_performance' was properly closed.
[0m19:52:15.559885 [debug] [MainThread]: Connection 'model.crypto_analytics.mart_crypto_latest_prices' was properly closed.
[0m19:52:15.537230 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_warehouse, now list_crypto_warehouse_public_staging)
[0m19:52:15.575172 [debug] [MainThread]: Connection 'model.crypto_analytics.int_crypto_hourly_aggs' was properly closed.
[0m19:52:15.539843 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse_public_dbt_test__audit'
[0m19:52:15.597560 [debug] [MainThread]: Connection 'model.crypto_analytics.mart_pipeline_monitoring' was properly closed.
[0m19:52:15.604913 [info ] [MainThread]:
[0m19:52:15.573944 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_marts"
[0m19:52:15.613240 [info ] [MainThread]: Finished running 1 view model, 4 table models in 0 hours 0 minutes and 6.30 seconds (6.30s).
[0m19:52:15.629255 [debug] [MainThread]: Command end result
[0m19:52:15.591067 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_staging"
[0m19:52:15.604322 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_dbt_test__audit"
[0m19:52:15.626315 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: BEGIN
[0m19:52:15.639155 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: BEGIN
[0m19:52:15.647280 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: BEGIN
[0m19:52:15.656169 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:52:15.663715 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:52:15.671719 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:52:15.688768 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:52:15.698924 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:52:15.712178 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_marts"
[0m19:52:15.714075 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:52:15.723562 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_staging"
[0m19:52:15.731807 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_marts"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'

[0m19:52:15.742780 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_dbt_test__audit"
[0m19:52:15.753536 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_staging"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'

[0m19:52:15.775561 [info ] [MainThread]:
[0m19:52:15.768289 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m19:52:15.784455 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:52:15.773185 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_dbt_test__audit"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'

[0m19:52:15.794002 [info ] [MainThread]:
[0m19:52:15.788472 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m19:52:15.805608 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m19:52:15.793096 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: ROLLBACK
[0m19:52:15.815459 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.900684, "process_user_time": 15.305207, "process_kernel_time": 0.972873, "process_mem_max_rss": "127580", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:52:15.808559 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m19:52:15.825842 [debug] [MainThread]: Command `dbt run` succeeded at 19:52:15.825458 after 16.91 seconds
[0m19:52:15.835536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc49bc29f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc49bc31e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc49c2a6090>]}
[0m19:52:15.812622 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: ROLLBACK
[0m19:52:15.825719 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: Close
[0m19:52:15.843965 [debug] [MainThread]: Flushing usage events
[0m19:52:15.836558 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: ROLLBACK
[0m19:52:15.844617 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: Close
[0m19:52:15.859276 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: Close
[0m19:52:15.903399 [debug] [MainThread]: Using postgres connection "master"
[0m19:52:15.911882 [debug] [MainThread]: On master: BEGIN
[0m19:52:15.925489 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:52:15.941487 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:52:15.949876 [debug] [MainThread]: Using postgres connection "master"
[0m19:52:15.957669 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:52:15.975907 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m19:52:15.989349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4be6a5be-379e-4915-a439-8702aaa12cc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6b947ed10>]}
[0m19:52:15.997367 [debug] [MainThread]: On master: ROLLBACK
[0m19:52:16.006605 [debug] [MainThread]: Using postgres connection "master"
[0m19:52:16.014407 [debug] [MainThread]: On master: BEGIN
[0m19:52:16.024712 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:52:16.032267 [debug] [MainThread]: On master: COMMIT
[0m19:52:16.040688 [debug] [MainThread]: Using postgres connection "master"
[0m19:52:16.048435 [debug] [MainThread]: On master: COMMIT
[0m19:52:16.057507 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:52:16.064653 [debug] [MainThread]: On master: Close
[0m19:52:16.076295 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:52:16.091387 [info ] [MainThread]:
[0m19:52:16.109762 [debug] [Thread-1 (]: Began running node model.crypto_analytics.stg_crypto_prices
[0m19:52:16.111170 [debug] [Thread-2 (]: Began running node model.crypto_analytics.stg_pipeline_runs
[0m19:52:16.121414 [info ] [Thread-1 (]: 1 of 5 START sql table model public_staging.stg_crypto_prices .................. [RUN]
[0m19:52:16.134166 [info ] [Thread-2 (]: 2 of 5 START sql view model public_staging.stg_pipeline_runs ................... [RUN]
[0m19:52:16.144876 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_dbt_test__audit, now model.crypto_analytics.stg_crypto_prices)
[0m19:52:16.158926 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_staging, now model.crypto_analytics.stg_pipeline_runs)
[0m19:52:16.176716 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics.stg_crypto_prices
[0m19:52:16.212868 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics.stg_pipeline_runs
[0m19:52:16.296199 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics.stg_crypto_prices"
[0m19:52:16.308062 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics.stg_pipeline_runs"
[0m19:52:16.356841 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.stg_pipeline_runs (compile): 19:52:16.299979 => 19:52:16.355895
[0m19:52:16.373947 [debug] [Thread-2 (]: Began executing node model.crypto_analytics.stg_pipeline_runs
[0m19:52:16.390652 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.stg_crypto_prices (compile): 19:52:16.233780 => 19:52:16.389682
[0m19:52:16.415522 [debug] [Thread-1 (]: Began executing node model.crypto_analytics.stg_crypto_prices
[0m19:52:16.622522 [debug] [Thread-2 (]: Writing runtime sql for node "model.crypto_analytics.stg_pipeline_runs"
[0m19:52:16.652220 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics.stg_crypto_prices"
[0m19:52:16.704289 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m19:52:16.709817 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m19:52:16.712990 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: BEGIN
[0m19:52:16.721446 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: BEGIN
[0m19:52:16.729644 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:52:16.747486 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m19:52:16.738114 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:52:16.753139 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:52:16.779861 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:52:16.790770 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m19:52:16.800794 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m19:52:16.812317 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */




  create  table "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_tmp"


    as

  (


WITH source_data AS (
    SELECT
        id as price_id,
        UPPER(TRIM(symbol)) as symbol,
        TRIM(name) as crypto_name,
        current_price as price_usd,
        market_cap,
        total_volume as volume_24h,
        price_change_24h,
        price_change_percentage_24h as price_change_pct_24h,
        market_cap_rank,
        extracted_at,
        created_at,

        CASE WHEN current_price <= 0 THEN TRUE ELSE FALSE END as is_invalid_price,
        CASE WHEN market_cap <= 0 THEN TRUE ELSE FALSE END as is_invalid_market_cap
    FROM "crypto_warehouse"."public"."crypto_prices_raw"
),

cleaned_data AS (
    SELECT
        *,
        DATE(extracted_at) as extraction_date,
        DATE_TRUNC('hour', extracted_at) as extraction_hour,
        CASE
            WHEN LAG(price_usd) OVER (
                PARTITION BY symbol ORDER BY extracted_at
            ) IS NOT NULL THEN
                ((price_usd - LAG(price_usd) OVER (
                    PARTITION BY symbol ORDER BY extracted_at
                )) / LAG(price_usd) OVER (
                    PARTITION BY symbol ORDER BY extracted_at
                )) * 100
        END as price_change_pct_from_previous
    FROM source_data
    WHERE NOT is_invalid_price
)

SELECT * FROM cleaned_data
  );

[0m19:52:16.841452 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */

  create view "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_tmp"


  as (
    SELECT
    id as run_id,
    run_id as run_identifier,
    stage,
    status,
    records_processed,
    error_message,
    started_at,
    completed_at,
    CASE
        WHEN completed_at IS NOT NULL
        THEN EXTRACT(EPOCH FROM (completed_at - started_at))
        ELSE NULL
    END as duration_seconds
FROM "crypto_warehouse"."public"."pipeline_runs"
  );
[0m19:52:16.868131 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:52:16.911551 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m19:52:16.923098 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */
alter table "crypto_warehouse"."public_staging"."stg_pipeline_runs" rename to "stg_pipeline_runs__dbt_backup"
[0m19:52:16.936434 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:52:16.966529 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m19:52:16.976342 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */
alter table "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_tmp" rename to "stg_pipeline_runs"
[0m19:52:16.988265 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:52:17.045425 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.0 seconds
[0m19:52:17.055661 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: COMMIT
[0m19:52:17.077485 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m19:52:17.094531 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m19:52:17.107331 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */
alter table "crypto_warehouse"."public_staging"."stg_crypto_prices" rename to "stg_crypto_prices__dbt_backup"
[0m19:52:17.119074 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: COMMIT
[0m19:52:17.128841 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:52:17.159736 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m19:52:17.173335 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */
alter table "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_tmp" rename to "stg_crypto_prices"
[0m19:52:17.185347 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:52:17.230680 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m19:52:17.243863 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */

        CREATE INDEX IF NOT EXISTS idx_stg_crypto_prices_symbol_time ON "crypto_warehouse"."public_staging"."stg_crypto_prices" (symbol, extracted_at)

[0m19:52:17.333122 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m19:52:17.367740 [debug] [Thread-2 (]: Applying DROP to: "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_backup"
[0m19:52:17.404041 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m19:52:17.413400 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */
drop view if exists "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_backup" cascade
[0m19:52:17.428415 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m19:52:17.441582 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: COMMIT
[0m19:52:17.451814 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m19:52:17.460810 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: COMMIT
[0m19:52:17.472362 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:52:17.485702 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.stg_pipeline_runs (execute): 19:52:16.382482 => 19:52:17.485138
[0m19:52:17.494667 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: Close
[0m19:52:17.506890 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4be6a5be-379e-4915-a439-8702aaa12cc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6b905fb50>]}
[0m19:52:17.521803 [info ] [Thread-2 (]: 2 of 5 OK created sql view model public_staging.stg_pipeline_runs .............. [[32mCREATE VIEW[0m in 1.35s]
[0m19:52:17.527385 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:52:17.537402 [debug] [Thread-2 (]: Finished running node model.crypto_analytics.stg_pipeline_runs
[0m19:52:17.565259 [debug] [Thread-1 (]: Applying DROP to: "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_backup"
[0m19:52:17.567883 [debug] [Thread-4 (]: Began running node model.crypto_analytics.mart_pipeline_monitoring
[0m19:52:17.592755 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m19:52:17.604113 [info ] [Thread-4 (]: 3 of 5 START sql table model public_marts.mart_pipeline_monitoring ............. [RUN]
[0m19:52:17.623555 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */
drop table if exists "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_backup" cascade
[0m19:52:17.638072 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.crypto_analytics.mart_pipeline_monitoring'
[0m19:52:17.661288 [debug] [Thread-4 (]: Began compiling node model.crypto_analytics.mart_pipeline_monitoring
[0m19:52:17.682590 [debug] [Thread-4 (]: Writing injected SQL for node "model.crypto_analytics.mart_pipeline_monitoring"
[0m19:52:17.706188 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:52:17.733156 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.stg_crypto_prices (execute): 19:52:16.444865 => 19:52:17.730694
[0m19:52:17.744727 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: Close
[0m19:52:17.756546 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4be6a5be-379e-4915-a439-8702aaa12cc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6bac2c9d0>]}
[0m19:52:17.791239 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public_staging.stg_crypto_prices ............. [[32mSELECT 15[0m in 1.61s]
[0m19:52:17.796175 [debug] [Thread-4 (]: Timing info for model.crypto_analytics.mart_pipeline_monitoring (compile): 19:52:17.672483 => 19:52:17.795115
[0m19:53:28.397024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28399fd690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28399f1c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28399f21d0>]}


============================== 19:53:28.481552 | bbb3eb14-ffde-49df-bb28-a8d2711114d6 ==============================
[0m19:53:28.481552 [info ] [MainThread]: Running with dbt=1.7.0
[0m19:53:28.515906 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /app/dbt', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:53:29.474625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bbb3eb14-ffde-49df-bb28-a8d2711114d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2839a75f90>]}
[0m19:53:30.046401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bbb3eb14-ffde-49df-bb28-a8d2711114d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28381c7290>]}
[0m19:53:30.143458 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m19:53:30.294901 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m19:53:34.162709 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:53:34.173219 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:53:34.224215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bbb3eb14-ffde-49df-bb28-a8d2711114d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f283812df90>]}
[0m19:53:34.406643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bbb3eb14-ffde-49df-bb28-a8d2711114d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28380bbd90>]}
[0m19:53:34.418604 [info ] [MainThread]: Found 7 models, 9 tests, 2 sources, 0 exposures, 0 metrics, 403 macros, 0 groups, 0 semantic models
[0m19:53:34.429975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bbb3eb14-ffde-49df-bb28-a8d2711114d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f283b4ac2d0>]}
[0m19:53:34.444553 [info ] [MainThread]:
[0m19:53:34.456717 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:53:34.471750 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse'
[0m19:53:34.474247 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse'
[0m19:53:34.516783 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse"
[0m19:53:34.524874 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse"
[0m19:53:34.530928 [debug] [ThreadPool]: On list_crypto_warehouse: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse"} */

    select distinct nspname from pg_namespace

[0m19:53:34.539210 [debug] [ThreadPool]: On list_crypto_warehouse: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse"} */

    select distinct nspname from pg_namespace

[0m19:53:34.549885 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:53:34.557576 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:53:34.577528 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m19:53:34.587620 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m19:53:34.591629 [debug] [ThreadPool]: On list_crypto_warehouse: Close
[0m19:53:34.601528 [debug] [ThreadPool]: On list_crypto_warehouse: Close
[0m19:53:34.628367 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_warehouse, now list_crypto_warehouse_public_marts)
[0m19:53:34.631033 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_warehouse, now list_crypto_warehouse_public_dbt_test__audit)
[0m19:53:34.633736 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse_public_staging'
[0m19:53:34.662161 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_marts"
[0m19:53:34.668084 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_dbt_test__audit"
[0m19:53:34.685223 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_staging"
[0m19:53:34.696070 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: BEGIN
[0m19:53:34.705652 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: BEGIN
[0m19:53:34.716295 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: BEGIN
[0m19:53:34.725198 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:53:34.733953 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:53:34.742897 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:53:34.761497 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:53:34.776089 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:53:34.801906 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:53:34.829681 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_marts"
[0m19:53:34.850301 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_dbt_test__audit"
[0m19:53:34.862918 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_staging"
[0m19:53:34.907834 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_marts"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'

[0m19:53:34.919909 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_dbt_test__audit"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'

[0m19:53:34.931338 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_staging"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'

[0m19:53:34.957778 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m19:53:34.974593 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m19:53:35.002296 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m19:53:35.031340 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: ROLLBACK
[0m19:53:35.051029 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: ROLLBACK
[0m19:53:35.064535 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: ROLLBACK
[0m19:53:35.074007 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: Close
[0m19:53:35.082635 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: Close
[0m19:53:35.090938 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: Close
[0m19:53:35.137628 [debug] [MainThread]: Using postgres connection "master"
[0m19:53:35.148818 [debug] [MainThread]: On master: BEGIN
[0m19:53:35.156657 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:53:35.177555 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:53:35.186975 [debug] [MainThread]: Using postgres connection "master"
[0m19:53:35.198046 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:53:35.220849 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m19:53:35.244951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bbb3eb14-ffde-49df-bb28-a8d2711114d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2839a75450>]}
[0m19:53:35.253422 [debug] [MainThread]: On master: ROLLBACK
[0m19:53:35.261905 [debug] [MainThread]: Using postgres connection "master"
[0m19:53:35.267790 [debug] [MainThread]: On master: BEGIN
[0m19:53:35.278389 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:53:35.287813 [debug] [MainThread]: On master: COMMIT
[0m19:53:35.298811 [debug] [MainThread]: Using postgres connection "master"
[0m19:53:35.312699 [debug] [MainThread]: On master: COMMIT
[0m19:53:35.321157 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:53:35.333249 [debug] [MainThread]: On master: Close
[0m19:53:35.349503 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:53:35.361925 [info ] [MainThread]:
[0m19:53:35.376974 [debug] [Thread-1 (]: Began running node model.crypto_analytics.stg_crypto_prices
[0m19:53:35.378269 [debug] [Thread-2 (]: Began running node model.crypto_analytics.stg_pipeline_runs
[0m19:53:35.386561 [info ] [Thread-1 (]: 1 of 5 START sql table model public_staging.stg_crypto_prices .................. [RUN]
[0m19:53:35.395701 [info ] [Thread-2 (]: 2 of 5 START sql view model public_staging.stg_pipeline_runs ................... [RUN]
[0m19:53:35.404951 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_staging, now model.crypto_analytics.stg_crypto_prices)
[0m19:53:35.415260 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_dbt_test__audit, now model.crypto_analytics.stg_pipeline_runs)
[0m19:53:35.423046 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics.stg_crypto_prices
[0m19:53:35.433877 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics.stg_pipeline_runs
[0m19:53:35.461375 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics.stg_crypto_prices"
[0m19:53:35.470062 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics.stg_pipeline_runs"
[0m19:53:35.515636 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.stg_pipeline_runs (compile): 19:53:35.462445 => 19:53:35.514713
[0m19:53:35.525848 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.stg_crypto_prices (compile): 19:53:35.440470 => 19:53:35.524998
[0m19:53:35.532689 [debug] [Thread-2 (]: Began executing node model.crypto_analytics.stg_pipeline_runs
[0m19:53:35.546081 [debug] [Thread-1 (]: Began executing node model.crypto_analytics.stg_crypto_prices
[0m19:53:35.744313 [debug] [Thread-2 (]: Writing runtime sql for node "model.crypto_analytics.stg_pipeline_runs"
[0m19:53:35.753778 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics.stg_crypto_prices"
[0m19:53:35.795528 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m19:53:35.802679 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m19:53:35.804097 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: BEGIN
[0m19:53:35.813669 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: BEGIN
[0m19:53:35.836150 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:53:35.847468 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:53:35.863689 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:53:35.876223 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:53:35.880853 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m19:53:35.889782 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m19:53:35.901610 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */

  create view "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_tmp"


  as (
    SELECT
    id as run_id,
    run_id as run_identifier,
    stage,
    status,
    records_processed,
    error_message,
    started_at,
    completed_at,
    CASE
        WHEN completed_at IS NOT NULL
        THEN EXTRACT(EPOCH FROM (completed_at - started_at))
        ELSE NULL
    END as duration_seconds
FROM "crypto_warehouse"."public"."pipeline_runs"
  );
[0m19:53:35.912362 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */




  create  table "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_tmp"


    as

  (


WITH source_data AS (
    SELECT
        id as price_id,
        UPPER(TRIM(symbol)) as symbol,
        TRIM(name) as crypto_name,
        current_price as price_usd,
        market_cap,
        total_volume as volume_24h,
        price_change_24h,
        price_change_percentage_24h as price_change_pct_24h,
        market_cap_rank,
        extracted_at,
        created_at,

        CASE WHEN current_price <= 0 THEN TRUE ELSE FALSE END as is_invalid_price,
        CASE WHEN market_cap <= 0 THEN TRUE ELSE FALSE END as is_invalid_market_cap
    FROM "crypto_warehouse"."public"."crypto_prices_raw"
),

cleaned_data AS (
    SELECT
        *,
        DATE(extracted_at) as extraction_date,
        DATE_TRUNC('hour', extracted_at) as extraction_hour,
        CASE
            WHEN LAG(price_usd) OVER (
                PARTITION BY symbol ORDER BY extracted_at
            ) IS NOT NULL THEN
                ((price_usd - LAG(price_usd) OVER (
                    PARTITION BY symbol ORDER BY extracted_at
                )) / LAG(price_usd) OVER (
                    PARTITION BY symbol ORDER BY extracted_at
                )) * 100
        END as price_change_pct_from_previous
    FROM source_data
    WHERE NOT is_invalid_price
)

SELECT * FROM cleaned_data
  );

[0m19:53:35.922892 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:53:35.950182 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m19:53:35.961646 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */
alter table "crypto_warehouse"."public_staging"."stg_pipeline_runs" rename to "stg_pipeline_runs__dbt_backup"
[0m19:53:35.970833 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:53:35.991247 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m19:53:35.999212 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */
alter table "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_tmp" rename to "stg_pipeline_runs"
[0m19:53:36.008197 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:53:36.057311 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: COMMIT
[0m19:53:36.067544 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m19:53:36.075727 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: COMMIT
[0m19:53:36.198229 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m19:53:36.199233 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.0 seconds
[0m19:53:36.231207 [debug] [Thread-2 (]: Applying DROP to: "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_backup"
[0m19:53:36.241179 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m19:53:36.266128 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m19:53:36.270394 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */
alter table "crypto_warehouse"."public_staging"."stg_crypto_prices" rename to "stg_crypto_prices__dbt_backup"
[0m19:53:36.277836 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */
drop view if exists "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_backup" cascade
[0m19:53:36.286962 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:53:36.308423 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m19:53:36.317005 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */
alter table "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_tmp" rename to "stg_crypto_prices"
[0m19:53:36.327871 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:53:36.352428 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:53:36.351263 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m19:53:36.363422 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.stg_pipeline_runs (execute): 19:53:35.554585 => 19:53:36.362882
[0m19:53:36.371411 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */

        CREATE INDEX IF NOT EXISTS idx_stg_crypto_prices_symbol_time ON "crypto_warehouse"."public_staging"."stg_crypto_prices" (symbol, extracted_at)

[0m19:53:36.381508 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: Close
[0m19:53:36.390012 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m19:53:36.401407 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbb3eb14-ffde-49df-bb28-a8d2711114d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2837eaeed0>]}
[0m19:53:36.412078 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: COMMIT
[0m19:53:36.420651 [info ] [Thread-2 (]: 2 of 5 OK created sql view model public_staging.stg_pipeline_runs .............. [[32mCREATE VIEW[0m in 0.99s]
[0m19:53:36.430028 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m19:53:36.438138 [debug] [Thread-2 (]: Finished running node model.crypto_analytics.stg_pipeline_runs
[0m19:53:36.447801 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: COMMIT
[0m19:53:36.457026 [debug] [Thread-4 (]: Began running node model.crypto_analytics.mart_pipeline_monitoring
[0m19:53:36.475920 [info ] [Thread-4 (]: 3 of 5 START sql table model public_marts.mart_pipeline_monitoring ............. [RUN]
[0m19:53:36.483915 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.crypto_analytics.mart_pipeline_monitoring'
[0m19:53:36.492167 [debug] [Thread-4 (]: Began compiling node model.crypto_analytics.mart_pipeline_monitoring
[0m19:53:36.511254 [debug] [Thread-4 (]: Writing injected SQL for node "model.crypto_analytics.mart_pipeline_monitoring"
[0m19:53:36.536362 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:53:36.550292 [debug] [Thread-1 (]: Applying DROP to: "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_backup"
[0m19:53:36.567408 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m19:53:36.571623 [debug] [Thread-4 (]: Timing info for model.crypto_analytics.mart_pipeline_monitoring (compile): 19:53:36.499729 => 19:53:36.570719
[0m19:53:36.577834 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */
drop table if exists "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_backup" cascade
[0m19:53:36.585462 [debug] [Thread-4 (]: Began executing node model.crypto_analytics.mart_pipeline_monitoring
[0m19:53:36.614528 [debug] [Thread-4 (]: Writing runtime sql for node "model.crypto_analytics.mart_pipeline_monitoring"
[0m19:53:36.647796 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:53:36.665016 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.stg_crypto_prices (execute): 19:53:35.584216 => 19:53:36.664200
[0m19:53:36.675442 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: Close
[0m19:53:36.681868 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m19:53:36.686219 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbb3eb14-ffde-49df-bb28-a8d2711114d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2838041d50>]}
[0m19:53:36.693515 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: BEGIN
[0m19:53:36.701753 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public_staging.stg_crypto_prices ............. [[32mSELECT 20[0m in 1.28s]
[0m19:53:36.713001 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:53:36.722464 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.stg_crypto_prices
[0m19:53:36.739061 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m19:53:36.747092 [debug] [Thread-2 (]: Began running node model.crypto_analytics.int_crypto_daily_aggs
[0m19:53:36.748256 [debug] [Thread-3 (]: Began running node model.crypto_analytics.int_crypto_hourly_aggs
[0m19:53:36.749388 [debug] [Thread-1 (]: Began running node model.crypto_analytics.mart_crypto_latest_prices
[0m19:53:36.757046 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m19:53:36.765647 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.stg_pipeline_runs, now model.crypto_analytics.int_crypto_daily_aggs)
[0m19:53:36.773707 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_marts, now model.crypto_analytics.int_crypto_hourly_aggs)
[0m19:53:36.783405 [info ] [Thread-1 (]: 4 of 5 START sql table model public_marts.mart_crypto_latest_prices ............ [RUN]
[0m19:53:36.793509 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */




  create  table "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_tmp"


    as

  (


WITH pipeline_metrics AS (
    SELECT
        run_id,
        stage,
        status,
        records_processed,
        error_message,
        started_at,
        completed_at,
        EXTRACT(EPOCH FROM completed_at - started_at) AS duration_seconds,

        -- Flag to compute success rate
        CASE WHEN status = 'success' THEN 1 ELSE 0 END AS is_success,

        -- Classify performance
        CASE
            WHEN completed_at IS NULL THEN 'Running'
            WHEN EXTRACT(EPOCH FROM completed_at - started_at) < 30 THEN 'Fast'
            WHEN EXTRACT(EPOCH FROM completed_at - started_at) < 120 THEN 'Normal'
            ELSE 'Slow'
        END AS performance_category

    FROM "crypto_warehouse"."public_staging"."stg_pipeline_runs"
),

latest_status_per_day_stage AS (
    SELECT
        DATE(started_at) AS run_date,
        stage,
        FIRST_VALUE(status) OVER (
            PARTITION BY DATE(started_at), stage
            ORDER BY started_at DESC
        ) AS latest_run_status
    FROM pipeline_metrics
),

daily_summary AS (
    SELECT
        DATE(started_at) AS run_date,
        stage,

        COUNT(*) AS total_runs,
        SUM(is_success) AS successful_runs,
        SUM(records_processed) AS total_records_processed,
        AVG(duration_seconds) AS avg_duration_seconds,
        MAX(duration_seconds) AS max_duration_seconds,
        ROUND(((SUM(is_success)::FLOAT / COUNT(*)) * 100)::NUMERIC, 2) AS success_rate_pct


    FROM pipeline_metrics
    WHERE started_at >= CURRENT_DATE - INTERVAL '30 days'
    GROUP BY DATE(started_at), stage
)

-- Final result combining metrics with latest run status
SELECT
    ds.*,
    ls.latest_run_status
FROM daily_summary ds
LEFT JOIN latest_status_per_day_stage ls
  ON ds.run_date = ls.run_date AND ds.stage = ls.stage
  );

[0m19:53:36.801263 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics.int_crypto_daily_aggs
[0m19:53:36.809692 [debug] [Thread-3 (]: Began compiling node model.crypto_analytics.int_crypto_hourly_aggs
[0m19:53:36.818363 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.stg_crypto_prices, now model.crypto_analytics.mart_crypto_latest_prices)
[0m19:53:36.844490 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics.int_crypto_daily_aggs"
[0m19:53:36.858993 [debug] [Thread-3 (]: Writing injected SQL for node "model.crypto_analytics.int_crypto_hourly_aggs"
[0m19:53:36.864274 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics.mart_crypto_latest_prices
[0m19:53:36.895774 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics.mart_crypto_latest_prices"
[0m19:53:36.919221 [debug] [Thread-3 (]: Timing info for model.crypto_analytics.int_crypto_hourly_aggs (compile): 19:53:36.848647 => 19:53:36.918116
[0m19:53:36.928006 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.int_crypto_daily_aggs (compile): 19:53:36.835200 => 19:53:36.927228
[0m19:53:36.932390 [debug] [Thread-3 (]: Finished running node model.crypto_analytics.int_crypto_hourly_aggs
[0m19:53:36.940676 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.mart_crypto_latest_prices (compile): 19:53:36.886465 => 19:53:36.939320
[0m19:53:36.943237 [debug] [Thread-2 (]: Finished running node model.crypto_analytics.int_crypto_daily_aggs
[0m19:53:36.952041 [debug] [Thread-3 (]: Began running node model.crypto_analytics.mart_crypto_hourly_performance
[0m19:53:36.957690 [debug] [Thread-1 (]: Began executing node model.crypto_analytics.mart_crypto_latest_prices
[0m19:53:36.975168 [info ] [Thread-3 (]: 5 of 5 START sql table model public_marts.mart_crypto_hourly_performance ....... [RUN]
[0m19:53:36.998885 [debug] [Thread-4 (]: SQL status: SELECT 8 in 0.0 seconds
[0m19:53:37.000174 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics.mart_crypto_latest_prices"
[0m19:53:37.003653 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.int_crypto_hourly_aggs, now model.crypto_analytics.mart_crypto_hourly_performance)
[0m19:53:37.030962 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m19:53:37.044728 [debug] [Thread-3 (]: Began compiling node model.crypto_analytics.mart_crypto_hourly_performance
[0m19:53:37.052921 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */
alter table "crypto_warehouse"."public_marts"."mart_pipeline_monitoring" rename to "mart_pipeline_monitoring__dbt_backup"
[0m19:53:37.226917 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m19:53:37.238781 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:53:37.261535 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: BEGIN
[0m19:53:37.262588 [debug] [Thread-3 (]: Writing injected SQL for node "model.crypto_analytics.mart_crypto_hourly_performance"
[0m19:53:37.285369 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m19:53:37.301118 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:53:37.322066 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */
alter table "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_tmp" rename to "mart_pipeline_monitoring"
[0m19:53:37.340076 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:53:37.355463 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:53:37.371715 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m19:53:37.442300 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m19:53:37.444772 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */




  create  table "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_tmp"


    as

  (


WITH latest_prices AS (
    SELECT
        symbol,
        crypto_name,
        price_usd,
        market_cap,
        volume_24h,
        price_change_24h,
        price_change_pct_24h,
        market_cap_rank,
        extracted_at,

        ROW_NUMBER() OVER (
            PARTITION BY symbol
            ORDER BY extracted_at DESC
        ) as rn

    FROM "crypto_warehouse"."public_staging"."stg_crypto_prices"
    WHERE extraction_date = CURRENT_DATE
),

price_changes AS (
    SELECT
        symbol,
        crypto_name,
        price_usd as current_price,
        market_cap,
        volume_24h,
        price_change_24h,
        price_change_pct_24h,
        market_cap_rank,
        extracted_at as last_updated,

        -- Calculate additional metrics
        CASE
            WHEN price_change_pct_24h > 10 THEN 'Strong Gain'
            WHEN price_change_pct_24h > 5 THEN 'Moderate Gain'
            WHEN price_change_pct_24h > 0 THEN 'Slight Gain'
            WHEN price_change_pct_24h > -5 THEN 'Slight Loss'
            WHEN price_change_pct_24h > -10 THEN 'Moderate Loss'
            ELSE 'Strong Loss'
        END as price_trend_category,

        -- Market cap category
        CASE
            WHEN market_cap_rank <= 10 THEN 'Large Cap'
            WHEN market_cap_rank <= 50 THEN 'Mid Cap'
            WHEN market_cap_rank <= 100 THEN 'Small Cap'
            ELSE 'Micro Cap'
        END as market_cap_category

    FROM latest_prices
    WHERE rn = 1
)

SELECT * FROM price_changes
  );

[0m19:53:37.454883 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */

    create  index if not exists
  "456cdea22b87eb6cb5818e6c4173fddd"
  on "crypto_warehouse"."public_marts"."mart_pipeline_monitoring" using btree
  (run_date);

[0m19:53:37.478716 [debug] [Thread-3 (]: Timing info for model.crypto_analytics.mart_crypto_hourly_performance (compile): 19:53:37.065015 => 19:53:37.478075
[0m19:53:37.486922 [debug] [Thread-3 (]: Began executing node model.crypto_analytics.mart_crypto_hourly_performance
[0m19:53:37.510511 [debug] [Thread-3 (]: Writing runtime sql for node "model.crypto_analytics.mart_crypto_hourly_performance"
[0m19:53:37.562299 [debug] [Thread-3 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m19:53:37.575778 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: BEGIN
[0m19:53:37.592278 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:53:37.607171 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m19:53:37.617996 [debug] [Thread-3 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m19:53:37.629542 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.0 seconds
[0m19:53:37.633914 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */




  create  table "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_tmp"


    as

  (


WITH  __dbt__cte__int_crypto_hourly_aggs as (


WITH base_data AS (
    SELECT
        symbol,
        crypto_name,
        DATE_TRUNC('hour', extracted_at) AS extraction_hour,
        price_usd,
        volume_24h,
        market_cap,
        CASE WHEN price_usd <= 0 THEN 1 ELSE 0 END AS is_invalid
    FROM "crypto_warehouse"."public_staging"."stg_crypto_prices"
)

SELECT
    symbol,
    crypto_name,
    extraction_hour,
    COUNT(*) AS total_records,
    SUM(is_invalid) AS invalid_price_records,
    AVG(price_usd) AS avg_price_usd,
    MIN(price_usd) AS min_price_usd,
    MAX(price_usd) AS max_price_usd,
    STDDEV(price_usd) AS price_volatility,
    AVG(volume_24h) AS avg_volume_24h,
    AVG(market_cap) AS avg_market_cap
FROM base_data
GROUP BY symbol, crypto_name, extraction_hour
), hourly_data AS (
    SELECT
        symbol,
        crypto_name,
        extraction_hour,
        avg_price_usd,
        min_price_usd,
        max_price_usd,
        price_volatility,
        avg_volume_24h,
        avg_market_cap,
        total_records,

        -- Calculate hourly change
        LAG(avg_price_usd) OVER (
            PARTITION BY symbol
            ORDER BY extraction_hour
        ) as previous_hour_price,

        -- Data quality score
        (1.0 - (invalid_price_records::FLOAT / GREATEST(total_records, 1))) * 100 as data_quality_score

    FROM __dbt__cte__int_crypto_hourly_aggs
),

performance_metrics AS (
    SELECT
        *,
        CASE
            WHEN previous_hour_price IS NOT NULL AND previous_hour_price > 0 THEN
                ((avg_price_usd - previous_hour_price) / previous_hour_price) * 100
            ELSE NULL
        END as hourly_change_pct,

        -- Volatility category
        CASE
            WHEN price_volatility IS NULL THEN 'Unknown'
            WHEN price_volatility < avg_price_usd * 0.01 THEN 'Low Volatility'
            WHEN price_volatility < avg_price_usd * 0.05 THEN 'Medium Volatility'
            ELSE 'High Volatility'
        END as volatility_category

    FROM hourly_data
)

SELECT * FROM performance_metrics
  );

[0m19:53:37.651073 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m19:53:37.668615 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_latest_prices" rename to "mart_crypto_latest_prices__dbt_backup"
[0m19:53:37.679422 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:53:37.697106 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m19:53:37.704231 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_tmp" rename to "mart_crypto_latest_prices"
[0m19:53:37.715382 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:53:37.729030 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m19:53:37.737649 [debug] [Thread-4 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m19:53:37.739076 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */

    create  index if not exists
  "14a6feeab28be64f05468920f88bef07"
  on "crypto_warehouse"."public_marts"."mart_crypto_latest_prices" using btree
  (symbol);

[0m19:53:37.755068 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m19:53:37.775816 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */

    create  index if not exists
  "b62c686907c8bc07cdaf595790f90604"
  on "crypto_warehouse"."public_marts"."mart_pipeline_monitoring" using btree
  (stage);

[0m19:53:37.872512 [debug] [Thread-3 (]: SQL status: SELECT 15 in 0.0 seconds
[0m19:53:37.888937 [debug] [Thread-3 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m19:53:37.898857 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance" rename to "mart_crypto_hourly_performance__dbt_backup"
[0m19:53:37.908549 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:53:37.922953 [debug] [Thread-3 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m19:53:37.933225 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_tmp" rename to "mart_crypto_hourly_performance"
[0m19:53:37.943436 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:53:37.953927 [debug] [Thread-3 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m19:53:37.959589 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m19:53:37.960586 [debug] [Thread-4 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m19:53:37.965135 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */

    create  index if not exists
  "f87c5c23dd8eafc2385291a50651d15e"
  on "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance" using btree
  (symbol, extraction_hour);

[0m19:53:37.977190 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m19:53:37.988292 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: COMMIT
[0m19:53:38.003194 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */

    create  index if not exists
  "e5f85bc5fe9aaf9d53fc53e451e6574a"
  on "crypto_warehouse"."public_marts"."mart_crypto_latest_prices" using btree
  (market_cap_rank);

[0m19:53:38.012214 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m19:53:38.030591 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: COMMIT
[0m19:53:38.136686 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m19:53:38.137787 [debug] [Thread-3 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m19:53:38.167626 [debug] [Thread-4 (]: Applying DROP to: "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_backup"
[0m19:53:38.203527 [debug] [Thread-3 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m19:53:38.234604 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m19:53:38.274556 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */
drop table if exists "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_backup" cascade
[0m19:53:38.247636 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */

    create  index if not exists
  "d63724bbad59f9a3c923bd06a1f91a3a"
  on "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance" using btree
  (extraction_hour);

[0m19:53:38.376060 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m19:53:38.382624 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:53:38.397228 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: COMMIT
[0m19:53:38.412775 [debug] [Thread-4 (]: Timing info for model.crypto_analytics.mart_pipeline_monitoring (execute): 19:53:36.602086 => 19:53:38.412224
[0m19:53:38.421837 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m19:53:38.429857 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: Close
[0m19:53:38.437619 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: COMMIT
[0m19:53:38.451982 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbb3eb14-ffde-49df-bb28-a8d2711114d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2837e7a950>]}
[0m19:53:38.459388 [debug] [Thread-3 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m19:53:38.475923 [info ] [Thread-4 (]: 3 of 5 OK created sql table model public_marts.mart_pipeline_monitoring ........ [[32mSELECT 8[0m in 1.97s]
[0m19:53:38.487619 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: COMMIT
[0m19:53:38.495686 [debug] [Thread-4 (]: Finished running node model.crypto_analytics.mart_pipeline_monitoring
[0m19:53:38.503655 [debug] [Thread-3 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m19:53:38.514967 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:53:38.519430 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: COMMIT
[0m19:53:38.536161 [debug] [Thread-1 (]: Applying DROP to: "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_backup"
[0m19:53:38.549565 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m19:53:38.557896 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */
drop table if exists "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_backup" cascade
[0m19:53:38.592439 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m19:53:38.613055 [debug] [Thread-3 (]: Applying DROP to: "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_backup"
[0m19:53:38.622452 [debug] [Thread-3 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m19:53:38.630765 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */
drop table if exists "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_backup" cascade
[0m19:53:38.634003 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:53:38.648988 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.mart_crypto_latest_prices (execute): 19:53:36.982491 => 19:53:38.648513
[0m19:53:38.659408 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: Close
[0m19:53:38.668443 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbb3eb14-ffde-49df-bb28-a8d2711114d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28381f1a10>]}
[0m19:53:38.678113 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public_marts.mart_crypto_latest_prices ....... [[32mSELECT 5[0m in 1.85s]
[0m19:53:38.686782 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.mart_crypto_latest_prices
[0m19:53:38.801924 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:53:38.814002 [debug] [Thread-3 (]: Timing info for model.crypto_analytics.mart_crypto_hourly_performance (execute): 19:53:37.496644 => 19:53:38.813349
[0m19:53:38.823344 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: Close
[0m19:53:38.837013 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbb3eb14-ffde-49df-bb28-a8d2711114d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2837edd610>]}
[0m19:53:38.851902 [info ] [Thread-3 (]: 5 of 5 OK created sql table model public_marts.mart_crypto_hourly_performance .. [[32mSELECT 15[0m in 1.83s]
[0m19:53:38.866943 [debug] [Thread-3 (]: Finished running node model.crypto_analytics.mart_crypto_hourly_performance
[0m19:53:38.878542 [debug] [MainThread]: Using postgres connection "master"
[0m19:53:38.886511 [debug] [MainThread]: On master: BEGIN
[0m19:53:38.893803 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:53:38.905715 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:53:38.914523 [debug] [MainThread]: On master: COMMIT
[0m19:53:38.922585 [debug] [MainThread]: Using postgres connection "master"
[0m19:53:38.930408 [debug] [MainThread]: On master: COMMIT
[0m19:53:38.938803 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:53:38.946294 [debug] [MainThread]: On master: Close
[0m19:53:38.955031 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:53:38.963323 [debug] [MainThread]: Connection 'model.crypto_analytics.int_crypto_daily_aggs' was properly closed.
[0m19:53:38.971425 [debug] [MainThread]: Connection 'model.crypto_analytics.mart_crypto_hourly_performance' was properly closed.
[0m19:53:38.980247 [debug] [MainThread]: Connection 'model.crypto_analytics.mart_crypto_latest_prices' was properly closed.
[0m19:53:38.990821 [debug] [MainThread]: Connection 'model.crypto_analytics.mart_pipeline_monitoring' was properly closed.
[0m19:53:38.998501 [info ] [MainThread]:
[0m19:53:39.008153 [info ] [MainThread]: Finished running 1 view model, 4 table models in 0 hours 0 minutes and 4.54 seconds (4.54s).
[0m19:53:39.018619 [debug] [MainThread]: Command end result
[0m19:53:39.134626 [info ] [MainThread]:
[0m19:53:39.142876 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:53:39.151787 [info ] [MainThread]:
[0m19:53:39.160250 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m19:53:39.168936 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.345625, "process_user_time": 16.172365, "process_kernel_time": 1.948603, "process_mem_max_rss": "120900", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:53:39.180787 [debug] [MainThread]: Command `dbt run` succeeded at 19:53:39.180218 after 11.36 seconds
[0m19:53:39.190729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2839a3f850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2839a3e950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f283aeb1f90>]}
[0m19:53:39.198077 [debug] [MainThread]: Flushing usage events
[0m19:47:30.998774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c78af8f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c78afa290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c78af9050>]}
[0m19:47:30.999653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d009bc810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d009b7b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d009bc550>]}
[0m19:47:30.999479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cc8819350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ccad7d090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cc9674b10>]}
[0m19:47:31.000312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddccbd1e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddccc16710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddccc16490>]}


============================== 19:47:31.522304 | 60cc7a69-5260-4106-82a5-b378e891acd4 ==============================
[0m19:47:31.522304 [info ] [MainThread]: Running with dbt=1.7.0


============================== 19:47:31.534881 | e20b8590-5df6-4e10-b94e-0e7d1b0e629e ==============================
[0m19:47:31.534881 [info ] [MainThread]: Running with dbt=1.7.0
[0m19:47:31.566628 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'version_check': 'True', 'debug': 'False', 'log_path': '/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug --project-dir /app/dbt', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:47:31.566915 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /app/dbt', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:47:31.581984 [info ] [MainThread]: dbt version: 1.7.0


============================== 19:47:31.559314 | 7bb51654-40ca-4af3-a99b-e873b71c1a83 ==============================
[0m19:47:31.559314 [info ] [MainThread]: Running with dbt=1.7.0
[0m19:47:31.588305 [info ] [MainThread]: python version: 3.11.13


============================== 19:47:31.557070 | 9a080281-d418-419a-8a8b-7fda2902d4d4 ==============================
[0m19:47:31.557070 [info ] [MainThread]: Running with dbt=1.7.0
[0m19:47:31.600252 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/app', 'log_path': '/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug --project-dir /app/dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:47:31.636537 [info ] [MainThread]: dbt version: 1.7.0
[0m19:47:31.621222 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'debug': 'False', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug --project-dir /app/dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:47:31.614097 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m19:47:31.648761 [info ] [MainThread]: python version: 3.11.13
[0m19:47:31.667615 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m19:47:31.675839 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m19:47:31.720419 [info ] [MainThread]: dbt version: 1.7.0
[0m19:47:31.765327 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m19:47:31.774014 [info ] [MainThread]: python version: 3.11.13
[0m19:47:31.835048 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m19:47:31.875189 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m19:47:40.621827 [info ] [MainThread]: Using profiles dir at /app
[0m19:47:40.649558 [info ] [MainThread]: Using profiles dir at /app
[0m19:47:40.649941 [info ] [MainThread]: Using profiles.yml file at /app/profiles.yml
[0m19:47:40.648991 [info ] [MainThread]: Using profiles dir at /app
[0m19:47:40.660868 [info ] [MainThread]: Using profiles.yml file at /app/profiles.yml
[0m19:47:40.660867 [info ] [MainThread]: Using dbt_project.yml file at /app/dbt/dbt_project.yml
[0m19:47:40.662052 [info ] [MainThread]: Using profiles.yml file at /app/profiles.yml
[0m19:47:40.670859 [info ] [MainThread]: Using dbt_project.yml file at /app/dbt/dbt_project.yml
[0m19:47:40.674523 [info ] [MainThread]: Using dbt_project.yml file at /app/dbt/dbt_project.yml
[0m19:47:41.184103 [info ] [MainThread]: adapter type: postgres
[0m19:47:41.184103 [info ] [MainThread]: adapter type: postgres
[0m19:47:41.184109 [info ] [MainThread]: adapter type: postgres
[0m19:47:41.195215 [info ] [MainThread]: adapter version: 1.7.0
[0m19:47:41.196548 [info ] [MainThread]: adapter version: 1.7.0
[0m19:47:41.199555 [info ] [MainThread]: adapter version: 1.7.0
[0m19:47:41.420101 [info ] [MainThread]: Configuration:
[0m19:47:41.419329 [info ] [MainThread]: Configuration:
[0m19:47:41.429790 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:47:41.428625 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:47:41.437877 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:47:41.439656 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:47:41.451026 [info ] [MainThread]: Required dependencies:
[0m19:47:41.453518 [info ] [MainThread]: Configuration:
[0m19:47:41.452160 [info ] [MainThread]: Required dependencies:
[0m19:47:41.458593 [debug] [MainThread]: Executing "git --help"
[0m19:47:41.462283 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:47:41.467846 [debug] [MainThread]: Executing "git --help"
[0m19:47:41.473513 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:47:41.480931 [info ] [MainThread]: Required dependencies:
[0m19:47:41.486621 [debug] [MainThread]: Executing "git --help"
[0m19:47:43.173162 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:47:43.173174 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:47:43.173131 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:47:43.207860 [debug] [MainThread]: STDERR: "b''"
[0m19:47:43.207859 [debug] [MainThread]: STDERR: "b''"
[0m19:47:43.216258 [debug] [MainThread]: STDERR: "b''"
[0m19:47:43.238320 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:47:43.244215 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:47:43.252538 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:47:43.294227 [info ] [MainThread]: Connection:
[0m19:47:43.301300 [info ] [MainThread]: Connection:
[0m19:47:43.319951 [info ] [MainThread]: Connection:
[0m19:47:43.344570 [info ] [MainThread]:   host: postgres
[0m19:47:43.383868 [info ] [MainThread]:   host: postgres
[0m19:47:43.389295 [info ] [MainThread]:   host: postgres
[0m19:47:43.403509 [info ] [MainThread]:   port: 5432
[0m19:47:43.404641 [info ] [MainThread]:   port: 5432
[0m19:47:43.519744 [info ] [MainThread]:   user: postgres
[0m19:47:43.519634 [info ] [MainThread]:   user: postgres
[0m19:47:43.428071 [info ] [MainThread]:   port: 5432
[0m19:47:43.529453 [info ] [MainThread]:   database: crypto_warehouse
[0m19:47:43.528208 [info ] [MainThread]:   database: crypto_warehouse
[0m19:47:43.533050 [info ] [MainThread]:   user: postgres
[0m19:47:43.541379 [info ] [MainThread]:   schema: public
[0m19:47:43.540622 [info ] [MainThread]:   schema: public
[0m19:47:43.564447 [info ] [MainThread]:   connect_timeout: 10
[0m19:47:43.574898 [info ] [MainThread]:   role: None
[0m19:47:43.561250 [info ] [MainThread]:   database: crypto_warehouse
[0m19:47:43.566120 [info ] [MainThread]:   connect_timeout: 10
[0m19:47:43.581876 [info ] [MainThread]:   search_path: None
[0m19:47:43.585398 [info ] [MainThread]:   schema: public
[0m19:47:43.589916 [info ] [MainThread]:   role: None
[0m19:47:43.589858 [info ] [MainThread]:   keepalives_idle: 0
[0m19:47:43.598409 [info ] [MainThread]:   search_path: None
[0m19:47:43.594827 [info ] [MainThread]:   connect_timeout: 10
[0m19:47:43.606873 [info ] [MainThread]:   keepalives_idle: 0
[0m19:47:43.615337 [info ] [MainThread]:   sslmode: None
[0m19:47:43.613630 [info ] [MainThread]:   role: None
[0m19:47:43.610824 [info ] [MainThread]:   sslmode: None
[0m19:47:43.623078 [info ] [MainThread]:   sslcert: None
[0m19:47:43.630257 [info ] [MainThread]:   sslkey: None
[0m19:47:43.625388 [info ] [MainThread]:   search_path: None
[0m19:47:43.628922 [info ] [MainThread]:   sslcert: None
[0m19:47:43.638096 [info ] [MainThread]:   sslrootcert: None
[0m19:47:43.644793 [info ] [MainThread]:   application_name: dbt
[0m19:47:43.643462 [info ] [MainThread]:   sslkey: None
[0m19:47:43.652708 [info ] [MainThread]:   retries: 1
[0m19:47:43.641093 [info ] [MainThread]:   keepalives_idle: 0
[0m19:47:43.659142 [info ] [MainThread]:   sslrootcert: None
[0m19:47:43.660921 [info ] [MainThread]:   sslmode: None
[0m19:47:43.666526 [info ] [MainThread]:   application_name: dbt
[0m19:47:43.669962 [info ] [MainThread]:   sslcert: None
[0m19:47:43.674457 [info ] [MainThread]:   retries: 1
[0m19:47:43.663008 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m19:47:43.677098 [info ] [MainThread]:   sslkey: None
[0m19:47:43.681860 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m19:47:43.684353 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m19:47:43.692835 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m19:47:43.688699 [info ] [MainThread]:   sslrootcert: None
[0m19:47:43.695757 [debug] [MainThread]: Using postgres connection "debug"
[0m19:47:43.702835 [info ] [MainThread]:   application_name: dbt
[0m19:47:43.699833 [debug] [MainThread]: Using postgres connection "debug"
[0m19:47:43.707313 [debug] [MainThread]: On debug: select 1 as id
[0m19:47:43.710166 [info ] [MainThread]:   retries: 1
[0m19:47:43.714750 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:47:43.717714 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m19:47:43.711485 [debug] [MainThread]: On debug: select 1 as id
[0m19:47:43.727569 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:47:43.726539 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m19:47:43.735487 [debug] [MainThread]: Using postgres connection "debug"
[0m19:47:43.741578 [debug] [MainThread]: On debug: select 1 as id
[0m19:47:43.747369 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:47:45.418075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e20b8590-5df6-4e10-b94e-0e7d1b0e629e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d008be850>]}
[0m19:47:45.463339 [debug] [MainThread]: SQL status: SELECT 1 in 2.0 seconds
[0m19:47:45.468473 [debug] [MainThread]: SQL status: SELECT 1 in 2.0 seconds
[0m19:47:45.473439 [debug] [MainThread]: SQL status: SELECT 1 in 2.0 seconds
[0m19:47:45.484678 [debug] [MainThread]: On debug: Close
[0m19:47:45.493762 [debug] [MainThread]: On debug: Close
[0m19:47:45.504985 [debug] [MainThread]: On debug: Close
[0m19:47:45.504361 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:47:45.517696 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:47:45.534206 [info ] [MainThread]: [32mAll checks passed![0m
[0m19:47:45.530461 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:47:45.546800 [info ] [MainThread]: [32mAll checks passed![0m
[0m19:47:45.550186 [info ] [MainThread]: [32mAll checks passed![0m
[0m19:47:45.725273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e20b8590-5df6-4e10-b94e-0e7d1b0e629e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d009e2810>]}
[0m19:47:45.733163 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m19:47:45.830801 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 16.019728, "process_user_time": 6.380068, "process_kernel_time": 0.540853, "process_mem_max_rss": "111204", "process_in_blocks": "5224", "process_out_blocks": "648"}
[0m19:47:45.830779 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 16.0197, "process_user_time": 7.366607, "process_kernel_time": 0.967124, "process_mem_max_rss": "111088", "process_in_blocks": "12352", "process_out_blocks": "712"}
[0m19:47:45.830776 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 16.02162, "process_user_time": 5.706524, "process_kernel_time": 0.764895, "process_mem_max_rss": "111444", "process_in_blocks": "4224", "process_out_blocks": "256"}
[0m19:47:45.853496 [debug] [MainThread]: Command `dbt debug` succeeded at 19:47:45.853151 after 16.04 seconds
[0m19:47:45.866934 [debug] [MainThread]: Command `dbt debug` succeeded at 19:47:45.866477 after 16.06 seconds
[0m19:47:45.871057 [debug] [MainThread]: Command `dbt debug` succeeded at 19:47:45.870722 after 16.06 seconds
[0m19:47:45.898055 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:47:45.907722 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:47:45.914315 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:47:45.927080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c7953f210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c7a0ecad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c77400ed0>]}
[0m19:47:45.938928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddccc18990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddccbe1090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddcb570050>]}
[0m19:47:45.953781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cc873fbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cc6f571d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cc875e8d0>]}
[0m19:47:45.968180 [debug] [MainThread]: Flushing usage events
[0m19:47:45.968177 [debug] [MainThread]: Flushing usage events
[0m19:47:45.972622 [debug] [MainThread]: Flushing usage events
[0m19:47:46.032332 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m19:48:05.818639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61837d3210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61837d2610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61837d3310>]}


============================== 19:48:05.829990 | 71585ec5-1961-4eab-a2a6-17caedccedec ==============================
[0m19:48:05.829990 [info ] [MainThread]: Running with dbt=1.7.0
[0m19:48:05.837071 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/app/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug --project-dir /app/dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:48:05.852406 [info ] [MainThread]: dbt version: 1.7.0
[0m19:48:05.863890 [info ] [MainThread]: python version: 3.11.13
[0m19:48:05.881010 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m19:48:05.887912 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m19:48:06.393875 [info ] [MainThread]: Using profiles dir at /app
[0m19:48:06.414246 [info ] [MainThread]: Using profiles.yml file at /app/profiles.yml
[0m19:48:06.459129 [info ] [MainThread]: Using dbt_project.yml file at /app/dbt/dbt_project.yml
[0m19:48:06.497822 [info ] [MainThread]: adapter type: postgres
[0m19:48:06.512258 [info ] [MainThread]: adapter version: 1.7.0
[0m19:48:07.129640 [info ] [MainThread]: Configuration:
[0m19:48:07.178478 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:48:07.209321 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:48:07.219151 [info ] [MainThread]: Required dependencies:
[0m19:48:07.325990 [debug] [MainThread]: Executing "git --help"
[0m19:48:07.383712 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:48:07.412609 [debug] [MainThread]: STDERR: "b''"
[0m19:48:07.465413 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:48:07.501935 [info ] [MainThread]: Connection:
[0m19:48:07.525432 [info ] [MainThread]:   host: postgres
[0m19:48:07.532039 [info ] [MainThread]:   port: 5432
[0m19:48:07.542711 [info ] [MainThread]:   user: postgres
[0m19:48:07.550844 [info ] [MainThread]:   database: crypto_warehouse
[0m19:48:07.560387 [info ] [MainThread]:   schema: public
[0m19:48:07.582759 [info ] [MainThread]:   connect_timeout: 10
[0m19:48:07.594441 [info ] [MainThread]:   role: None
[0m19:48:07.608667 [info ] [MainThread]:   search_path: None
[0m19:48:07.616189 [info ] [MainThread]:   keepalives_idle: 0
[0m19:48:07.627737 [info ] [MainThread]:   sslmode: None
[0m19:48:07.639600 [info ] [MainThread]:   sslcert: None
[0m19:48:07.647718 [info ] [MainThread]:   sslkey: None
[0m19:48:07.656051 [info ] [MainThread]:   sslrootcert: None
[0m19:48:07.662872 [info ] [MainThread]:   application_name: dbt
[0m19:48:07.670003 [info ] [MainThread]:   retries: 1
[0m19:48:07.681385 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m19:48:07.690134 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m19:48:07.696796 [debug] [MainThread]: Using postgres connection "debug"
[0m19:48:07.705414 [debug] [MainThread]: On debug: select 1 as id
[0m19:48:07.713276 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:48:07.726544 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m19:48:07.734743 [debug] [MainThread]: On debug: Close
[0m19:48:07.743050 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:48:07.750352 [info ] [MainThread]: [32mAll checks passed![0m
[0m19:48:07.759739 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.1182206, "process_user_time": 7.148529, "process_kernel_time": 0.717886, "process_mem_max_rss": "111044", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:48:07.767072 [debug] [MainThread]: Command `dbt debug` succeeded at 19:48:07.766693 after 2.13 seconds
[0m19:48:07.775047 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:48:07.782021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6181f9e650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f618509ebd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6185c52450>]}
[0m19:48:07.790445 [debug] [MainThread]: Flushing usage events
[0m19:48:23.912539 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m19:48:23.923115 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/staging/schema.yml
[0m19:48:23.932086 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/staging/stg_crypto_prices.sql
[0m19:48:27.860497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e20b8590-5df6-4e10-b94e-0e7d1b0e629e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cfe5c86d0>]}
[0m19:48:28.327954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e20b8590-5df6-4e10-b94e-0e7d1b0e629e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cff1eea50>]}
[0m19:48:28.334576 [info ] [MainThread]: Found 7 models, 14 tests, 2 sources, 0 exposures, 0 metrics, 403 macros, 0 groups, 0 semantic models
[0m19:48:28.343222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e20b8590-5df6-4e10-b94e-0e7d1b0e629e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d043a3c90>]}
[0m19:48:28.354890 [info ] [MainThread]:
[0m19:48:28.362748 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:48:28.372640 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse'
[0m19:48:28.374818 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse'
[0m19:48:28.436744 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse"
[0m19:48:28.463842 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse"
[0m19:48:28.464568 [debug] [ThreadPool]: On list_crypto_warehouse: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse"} */

    select distinct nspname from pg_namespace

[0m19:48:28.471650 [debug] [ThreadPool]: On list_crypto_warehouse: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse"} */

    select distinct nspname from pg_namespace

[0m19:48:28.478395 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:48:28.485422 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:48:28.499503 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m19:48:28.508691 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m19:48:28.512149 [debug] [ThreadPool]: On list_crypto_warehouse: Close
[0m19:48:28.522977 [debug] [ThreadPool]: On list_crypto_warehouse: Close
[0m19:48:28.552566 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_warehouse, now create_crypto_warehouse_public_staging)
[0m19:48:28.554065 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_warehouse, now create_crypto_warehouse_public_marts)
[0m19:48:28.562521 [debug] [ThreadPool]: Creating schema "database: "crypto_warehouse"
schema: "public_staging"
"
[0m19:48:28.571440 [debug] [ThreadPool]: Creating schema "database: "crypto_warehouse"
schema: "public_marts"
"
[0m19:48:28.602955 [debug] [ThreadPool]: Using postgres connection "create_crypto_warehouse_public_staging"
[0m19:48:28.610357 [debug] [ThreadPool]: Using postgres connection "create_crypto_warehouse_public_marts"
[0m19:48:28.618501 [debug] [ThreadPool]: On create_crypto_warehouse_public_staging: BEGIN
[0m19:48:28.625864 [debug] [ThreadPool]: On create_crypto_warehouse_public_marts: BEGIN
[0m19:48:28.634323 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:48:28.641750 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:48:28.656799 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:48:28.670753 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:48:28.679905 [debug] [ThreadPool]: Using postgres connection "create_crypto_warehouse_public_staging"
[0m19:48:28.686978 [debug] [ThreadPool]: Using postgres connection "create_crypto_warehouse_public_marts"
[0m19:48:28.694933 [debug] [ThreadPool]: On create_crypto_warehouse_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "create_crypto_warehouse_public_staging"} */
create schema if not exists "public_staging"
[0m19:48:28.702064 [debug] [ThreadPool]: On create_crypto_warehouse_public_marts: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "create_crypto_warehouse_public_marts"} */
create schema if not exists "public_marts"
[0m19:48:28.710128 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m19:48:28.716521 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m19:48:28.723147 [debug] [ThreadPool]: On create_crypto_warehouse_public_staging: COMMIT
[0m19:48:28.733636 [debug] [ThreadPool]: On create_crypto_warehouse_public_marts: COMMIT
[0m19:48:28.742649 [debug] [ThreadPool]: Using postgres connection "create_crypto_warehouse_public_staging"
[0m19:48:28.750227 [debug] [ThreadPool]: Using postgres connection "create_crypto_warehouse_public_marts"
[0m19:48:28.757382 [debug] [ThreadPool]: On create_crypto_warehouse_public_staging: COMMIT
[0m19:48:28.764728 [debug] [ThreadPool]: On create_crypto_warehouse_public_marts: COMMIT
[0m19:48:29.529289 [debug] [ThreadPool]: SQL status: COMMIT in 1.0 seconds
[0m19:48:29.536783 [debug] [ThreadPool]: On create_crypto_warehouse_public_staging: Close
[0m19:48:31.183519 [debug] [ThreadPool]: SQL status: COMMIT in 2.0 seconds
[0m19:48:31.190754 [debug] [ThreadPool]: On create_crypto_warehouse_public_marts: Close
[0m19:48:31.203180 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_warehouse_public_marts, now list_crypto_warehouse_public_staging)
[0m19:48:31.205282 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_warehouse_public_staging, now list_crypto_warehouse_public_marts)
[0m19:48:31.207433 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse_public_dbt_test__audit'
[0m19:48:31.223020 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_staging"
[0m19:48:31.229351 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_marts"
[0m19:48:31.238355 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_dbt_test__audit"
[0m19:48:31.246451 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: BEGIN
[0m19:48:31.253341 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: BEGIN
[0m19:48:31.260268 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: BEGIN
[0m19:48:31.265229 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:48:31.270875 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:48:31.277423 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:48:31.288088 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:48:31.294746 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:48:31.302729 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:48:31.304730 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_staging"
[0m19:48:31.311680 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_marts"
[0m19:48:31.318675 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_dbt_test__audit"
[0m19:48:31.324935 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_staging"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'

[0m19:48:31.332068 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_marts"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'

[0m19:48:31.339135 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_dbt_test__audit"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'

[0m19:48:31.350319 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m19:48:31.355610 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m19:48:31.363316 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m19:48:31.368677 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: ROLLBACK
[0m19:48:31.375649 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: ROLLBACK
[0m19:48:31.382385 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: ROLLBACK
[0m19:48:31.388020 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: Close
[0m19:48:31.393977 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: Close
[0m19:48:31.401273 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: Close
[0m19:48:31.446014 [debug] [MainThread]: Using postgres connection "master"
[0m19:48:31.452002 [debug] [MainThread]: On master: BEGIN
[0m19:48:31.457106 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:48:31.467972 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:48:31.473665 [debug] [MainThread]: Using postgres connection "master"
[0m19:48:31.478951 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:48:31.492197 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m19:48:31.500267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e20b8590-5df6-4e10-b94e-0e7d1b0e629e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d00858050>]}
[0m19:48:31.507048 [debug] [MainThread]: On master: ROLLBACK
[0m19:48:31.514056 [debug] [MainThread]: Using postgres connection "master"
[0m19:48:31.520689 [debug] [MainThread]: On master: BEGIN
[0m19:48:31.527808 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:48:31.535182 [debug] [MainThread]: On master: COMMIT
[0m19:48:31.542447 [debug] [MainThread]: Using postgres connection "master"
[0m19:48:31.548875 [debug] [MainThread]: On master: COMMIT
[0m19:48:31.557207 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:48:31.569490 [debug] [MainThread]: On master: Close
[0m19:48:31.580889 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:48:31.589717 [info ] [MainThread]:
[0m19:48:32.259962 [debug] [Thread-1 (]: Began running node model.crypto_analytics.stg_crypto_prices
[0m19:48:32.260859 [debug] [Thread-2 (]: Began running node model.crypto_analytics.stg_pipeline_runs
[0m19:48:32.268363 [info ] [Thread-1 (]: 1 of 5 START sql table model public_staging.stg_crypto_prices .................. [RUN]
[0m19:48:32.275751 [info ] [Thread-2 (]: 2 of 5 START sql view model public_staging.stg_pipeline_runs ................... [RUN]
[0m19:48:32.282314 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_dbt_test__audit, now model.crypto_analytics.stg_crypto_prices)
[0m19:48:32.289654 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_marts, now model.crypto_analytics.stg_pipeline_runs)
[0m19:48:32.296453 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics.stg_crypto_prices
[0m19:48:32.302991 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics.stg_pipeline_runs
[0m19:48:32.328485 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics.stg_crypto_prices"
[0m19:48:32.334995 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics.stg_pipeline_runs"
[0m19:48:32.572780 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.stg_pipeline_runs (compile): 19:48:32.329438 => 19:48:32.572130
[0m19:48:32.580451 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.stg_crypto_prices (compile): 19:48:32.310300 => 19:48:32.579712
[0m19:48:32.581785 [debug] [Thread-2 (]: Began executing node model.crypto_analytics.stg_pipeline_runs
[0m19:48:32.588707 [debug] [Thread-1 (]: Began executing node model.crypto_analytics.stg_crypto_prices
[0m19:48:32.727342 [debug] [Thread-2 (]: Writing runtime sql for node "model.crypto_analytics.stg_pipeline_runs"
[0m19:48:32.741570 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics.stg_crypto_prices"
[0m19:48:33.380076 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m19:48:33.387378 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: BEGIN
[0m19:48:33.393944 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:48:33.405458 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:48:33.412791 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m19:48:33.420005 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */

  create view "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_tmp"


  as (
    SELECT
    id as run_id,
    run_id as run_identifier,
    stage,
    status,
    records_processed,
    error_message,
    started_at,
    completed_at,
    CASE
        WHEN completed_at IS NOT NULL
        THEN EXTRACT(EPOCH FROM (completed_at - started_at))
        ELSE NULL
    END as duration_seconds
FROM "crypto_warehouse"."public"."pipeline_runs"
  );
[0m19:48:33.429571 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:48:33.457667 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m19:48:33.464621 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */
alter table "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_tmp" rename to "stg_pipeline_runs"
[0m19:48:33.472640 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:48:33.515574 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: COMMIT
[0m19:48:33.522317 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m19:48:33.529453 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: COMMIT
[0m19:48:33.787307 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m19:48:33.794203 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: BEGIN
[0m19:48:33.801227 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:48:33.812220 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:48:33.818995 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m19:48:33.826344 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */




  create  table "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_tmp"


    as

  (


WITH source_data AS (
    SELECT
        id as price_id,
        UPPER(TRIM(symbol)) as symbol,
        TRIM(name) as crypto_name,
        current_price as price_usd,
        market_cap,
        total_volume as volume_24h,
        price_change_24h,
        price_change_percentage_24h as price_change_pct_24h,
        market_cap_rank,
        extracted_at,
        created_at,

        CASE WHEN current_price <= 0 THEN TRUE ELSE FALSE END as is_invalid_price,
        CASE WHEN market_cap <= 0 THEN TRUE ELSE FALSE END as is_invalid_market_cap,
        CASE WHEN total_volume < 0 THEN TRUE ELSE FALSE END as is_invalid_volume
    FROM "crypto_warehouse"."public"."crypto_prices_raw"
),

cleaned_data AS (
    SELECT
        *,
        DATE(extracted_at) as extraction_date,
        DATE_TRUNC('hour', extracted_at) as extraction_hour,
        CASE
            WHEN LAG(price_usd) OVER (
                PARTITION BY symbol ORDER BY extracted_at
            ) IS NOT NULL THEN
                ((price_usd - LAG(price_usd) OVER (
                    PARTITION BY symbol ORDER BY extracted_at
                )) / LAG(price_usd) OVER (
                    PARTITION BY symbol ORDER BY extracted_at
                )) * 100
        END as price_change_pct_from_previous
    FROM source_data
    WHERE NOT is_invalid_price AND NOT is_invalid_volume
)

SELECT * FROM cleaned_data
  );

[0m19:48:35.854621 [debug] [Thread-2 (]: SQL status: COMMIT in 2.0 seconds
[0m19:48:35.889583 [debug] [Thread-2 (]: Applying DROP to: "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_backup"
[0m19:48:36.254499 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m19:48:36.262627 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */
drop view if exists "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_backup" cascade
[0m19:48:36.271004 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:48:36.281784 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.stg_pipeline_runs (execute): 19:48:32.595389 => 19:48:36.281269
[0m19:48:36.288802 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: Close
[0m19:48:36.297186 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e20b8590-5df6-4e10-b94e-0e7d1b0e629e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cfeea6c10>]}
[0m19:48:36.305505 [info ] [Thread-2 (]: 2 of 5 OK created sql view model public_staging.stg_pipeline_runs .............. [[32mCREATE VIEW[0m in 4.01s]
[0m19:48:36.313323 [debug] [Thread-2 (]: Finished running node model.crypto_analytics.stg_pipeline_runs
[0m19:48:36.321240 [debug] [Thread-4 (]: Began running node model.crypto_analytics.mart_pipeline_monitoring
[0m19:48:36.329152 [info ] [Thread-4 (]: 3 of 5 START sql table model public_marts.mart_pipeline_monitoring ............. [RUN]
[0m19:48:36.337731 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.crypto_analytics.mart_pipeline_monitoring'
[0m19:48:36.345713 [debug] [Thread-4 (]: Began compiling node model.crypto_analytics.mart_pipeline_monitoring
[0m19:48:36.361596 [debug] [Thread-4 (]: Writing injected SQL for node "model.crypto_analytics.mart_pipeline_monitoring"
[0m19:48:36.413555 [debug] [Thread-4 (]: Timing info for model.crypto_analytics.mart_pipeline_monitoring (compile): 19:48:36.353055 => 19:48:36.412962
[0m19:48:36.420792 [debug] [Thread-4 (]: Began executing node model.crypto_analytics.mart_pipeline_monitoring
[0m19:48:36.444507 [debug] [Thread-4 (]: Writing runtime sql for node "model.crypto_analytics.mart_pipeline_monitoring"
[0m19:48:36.500025 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m19:48:36.505365 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: BEGIN
[0m19:48:36.511917 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:48:36.524036 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m19:48:36.531122 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m19:48:36.539054 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */




  create  table "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_tmp"


    as

  (


WITH pipeline_metrics AS (
    SELECT
        run_id,
        stage,
        status,
        records_processed,
        error_message,
        started_at,
        completed_at,
        EXTRACT(EPOCH FROM completed_at - started_at) AS duration_seconds,

        -- Flag to compute success rate
        CASE WHEN status = 'success' THEN 1 ELSE 0 END AS is_success,

        -- Classify performance
        CASE
            WHEN completed_at IS NULL THEN 'Running'
            WHEN EXTRACT(EPOCH FROM completed_at - started_at) < 30 THEN 'Fast'
            WHEN EXTRACT(EPOCH FROM completed_at - started_at) < 120 THEN 'Normal'
            ELSE 'Slow'
        END AS performance_category

    FROM "crypto_warehouse"."public_staging"."stg_pipeline_runs"
),

latest_status_per_day_stage AS (
    SELECT
        DATE(started_at) AS run_date,
        stage,
        FIRST_VALUE(status) OVER (
            PARTITION BY DATE(started_at), stage
            ORDER BY started_at DESC
        ) AS latest_run_status
    FROM pipeline_metrics
),

daily_summary AS (
    SELECT
        DATE(started_at) AS run_date,
        stage,

        COUNT(*) AS total_runs,
        SUM(is_success) AS successful_runs,
        SUM(records_processed) AS total_records_processed,
        AVG(duration_seconds) AS avg_duration_seconds,
        MAX(duration_seconds) AS max_duration_seconds,
        ROUND(((SUM(is_success)::FLOAT / COUNT(*)) * 100)::NUMERIC, 2) AS success_rate_pct


    FROM pipeline_metrics
    WHERE started_at >= CURRENT_DATE - INTERVAL '30 days'
    GROUP BY DATE(started_at), stage
)

-- Final result combining metrics with latest run status
SELECT
    ds.*,
    ls.latest_run_status
FROM daily_summary ds
LEFT JOIN latest_status_per_day_stage ls
  ON ds.run_date = ls.run_date AND ds.stage = ls.stage
  );

[0m19:48:38.228776 [debug] [Thread-1 (]: SQL status: SELECT 5 in 4.0 seconds
[0m19:48:38.244759 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m19:48:38.252945 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */
alter table "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_tmp" rename to "stg_crypto_prices"
[0m19:48:38.261575 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:48:38.282071 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m19:48:38.287591 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */

        CREATE INDEX IF NOT EXISTS idx_stg_crypto_prices_symbol_time ON "crypto_warehouse"."public_staging"."stg_crypto_prices" (symbol, extracted_at)

[0m19:48:40.458871 [debug] [Thread-4 (]: SQL status: SELECT 2 in 4.0 seconds
[0m19:48:40.523859 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m19:48:40.556825 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */
alter table "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_tmp" rename to "mart_pipeline_monitoring"
[0m19:48:40.619149 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:48:40.713697 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m19:48:40.748485 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */

    create  index if not exists
  "da626ed8865b1186ee15cdfc5e0eee58"
  on "crypto_warehouse"."public_marts"."mart_pipeline_monitoring" using btree
  (run_date);

[0m19:48:42.085865 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 4.0 seconds
[0m19:48:42.096089 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: COMMIT
[0m19:48:42.103086 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m19:48:42.113299 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: COMMIT
[0m19:48:42.886380 [debug] [Thread-1 (]: SQL status: COMMIT in 1.0 seconds
[0m19:48:42.926098 [debug] [Thread-1 (]: Applying DROP to: "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_backup"
[0m19:48:42.944955 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m19:48:42.956034 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */
drop table if exists "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_backup" cascade
[0m19:48:42.967027 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:48:42.977266 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.stg_crypto_prices (execute): 19:48:32.622825 => 19:48:42.976796
[0m19:48:42.984538 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: Close
[0m19:48:42.993403 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e20b8590-5df6-4e10-b94e-0e7d1b0e629e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cfef0ab50>]}
[0m19:48:43.004252 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public_staging.stg_crypto_prices ............. [[32mSELECT 5[0m in 10.71s]
[0m19:48:43.013665 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.stg_crypto_prices
[0m19:48:43.021586 [debug] [Thread-2 (]: Began running node model.crypto_analytics.int_crypto_daily_aggs
[0m19:48:43.022500 [debug] [Thread-3 (]: Began running node model.crypto_analytics.int_crypto_hourly_aggs
[0m19:48:43.023347 [debug] [Thread-1 (]: Began running node model.crypto_analytics.mart_crypto_latest_prices
[0m19:48:43.030854 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.stg_pipeline_runs, now model.crypto_analytics.int_crypto_daily_aggs)
[0m19:48:43.040077 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_staging, now model.crypto_analytics.int_crypto_hourly_aggs)
[0m19:48:43.049464 [info ] [Thread-1 (]: 4 of 5 START sql table model public_marts.mart_crypto_latest_prices ............ [RUN]
[0m19:48:43.057375 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics.int_crypto_daily_aggs
[0m19:48:43.066418 [debug] [Thread-3 (]: Began compiling node model.crypto_analytics.int_crypto_hourly_aggs
[0m19:48:43.074472 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.stg_crypto_prices, now model.crypto_analytics.mart_crypto_latest_prices)
[0m19:48:43.099264 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics.int_crypto_daily_aggs"
[0m19:48:43.109933 [debug] [Thread-3 (]: Writing injected SQL for node "model.crypto_analytics.int_crypto_hourly_aggs"
[0m19:48:43.147769 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics.mart_crypto_latest_prices
[0m19:48:43.267916 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics.mart_crypto_latest_prices"
[0m19:48:43.685610 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.mart_crypto_latest_prices (compile): 19:48:43.220252 => 19:48:43.684979
[0m19:48:43.690200 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.int_crypto_daily_aggs (compile): 19:48:43.082033 => 19:48:43.689517
[0m19:48:43.694509 [debug] [Thread-1 (]: Began executing node model.crypto_analytics.mart_crypto_latest_prices
[0m19:48:43.702966 [debug] [Thread-2 (]: Finished running node model.crypto_analytics.int_crypto_daily_aggs
[0m19:48:43.732950 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics.mart_crypto_latest_prices"
[0m19:48:43.782602 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m19:48:43.792344 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: BEGIN
[0m19:48:43.799909 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:48:43.812986 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:48:43.820865 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m19:48:43.828510 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */




  create  table "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_tmp"


    as

  (


WITH latest_prices AS (
    SELECT
        symbol,
        crypto_name,
        price_usd,
        market_cap,
        volume_24h,
        price_change_24h,
        price_change_pct_24h,
        market_cap_rank,
        extracted_at,

        ROW_NUMBER() OVER (
            PARTITION BY symbol
            ORDER BY extracted_at DESC
        ) as rn

    FROM "crypto_warehouse"."public_staging"."stg_crypto_prices"
    WHERE extraction_date = CURRENT_DATE
),

price_changes AS (
    SELECT
        symbol,
        crypto_name,
        price_usd as current_price,
        market_cap,
        volume_24h,
        price_change_24h,
        price_change_pct_24h,
        market_cap_rank,
        extracted_at as last_updated,

        -- Calculate additional metrics
        CASE
            WHEN price_change_pct_24h > 10 THEN 'Strong Gain'
            WHEN price_change_pct_24h > 5 THEN 'Moderate Gain'
            WHEN price_change_pct_24h > 0 THEN 'Slight Gain'
            WHEN price_change_pct_24h > -5 THEN 'Slight Loss'
            WHEN price_change_pct_24h > -10 THEN 'Moderate Loss'
            ELSE 'Strong Loss'
        END as price_trend_category,

        -- Market cap category
        CASE
            WHEN market_cap_rank <= 10 THEN 'Large Cap'
            WHEN market_cap_rank <= 50 THEN 'Mid Cap'
            WHEN market_cap_rank <= 100 THEN 'Small Cap'
            ELSE 'Micro Cap'
        END as market_cap_category

    FROM latest_prices
    WHERE rn = 1
)

SELECT * FROM price_changes
  );

[0m19:48:44.160040 [debug] [Thread-4 (]: SQL status: CREATE INDEX in 3.0 seconds
[0m19:48:44.173377 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m19:48:44.181064 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */

    create  index if not exists
  "8f75f1d1e2a8dd66054f83d56367b1cb"
  on "crypto_warehouse"."public_marts"."mart_pipeline_monitoring" using btree
  (stage);

[0m19:48:44.747258 [debug] [Thread-3 (]: Timing info for model.crypto_analytics.int_crypto_hourly_aggs (compile): 19:48:43.103747 => 19:48:44.746580
[0m19:48:44.755289 [debug] [Thread-3 (]: Finished running node model.crypto_analytics.int_crypto_hourly_aggs
[0m19:48:44.764886 [debug] [Thread-2 (]: Began running node model.crypto_analytics.mart_crypto_hourly_performance
[0m19:48:44.777092 [info ] [Thread-2 (]: 5 of 5 START sql table model public_marts.mart_crypto_hourly_performance ....... [RUN]
[0m19:48:44.790909 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.int_crypto_daily_aggs, now model.crypto_analytics.mart_crypto_hourly_performance)
[0m19:48:44.805484 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics.mart_crypto_hourly_performance
[0m19:48:44.902903 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics.mart_crypto_hourly_performance"
[0m19:48:45.093676 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.mart_crypto_hourly_performance (compile): 19:48:44.817070 => 19:48:45.092924
[0m19:48:45.100327 [debug] [Thread-2 (]: Began executing node model.crypto_analytics.mart_crypto_hourly_performance
[0m19:48:45.135829 [debug] [Thread-2 (]: Writing runtime sql for node "model.crypto_analytics.mart_crypto_hourly_performance"
[0m19:48:45.739863 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m19:48:45.751187 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: BEGIN
[0m19:48:45.785208 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:48:45.832001 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:48:45.866268 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m19:48:45.890749 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */




  create  table "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_tmp"


    as

  (


WITH  __dbt__cte__int_crypto_hourly_aggs as (


WITH base_data AS (
    SELECT
        symbol,
        crypto_name,
        DATE_TRUNC('hour', extracted_at) AS extraction_hour,
        price_usd,
        volume_24h,
        market_cap,
        CASE WHEN price_usd <= 0 THEN 1 ELSE 0 END AS is_invalid
    FROM "crypto_warehouse"."public_staging"."stg_crypto_prices"
)

SELECT
    symbol,
    crypto_name,
    extraction_hour,
    COUNT(*) AS total_records,
    SUM(is_invalid) AS invalid_price_records,
    AVG(price_usd) AS avg_price_usd,
    MIN(price_usd) AS min_price_usd,
    MAX(price_usd) AS max_price_usd,
    STDDEV(price_usd) AS price_volatility,
    AVG(volume_24h) AS avg_volume_24h,
    AVG(market_cap) AS avg_market_cap
FROM base_data
GROUP BY symbol, crypto_name, extraction_hour
), hourly_data AS (
    SELECT
        symbol,
        crypto_name,
        extraction_hour,
        avg_price_usd,
        min_price_usd,
        max_price_usd,
        price_volatility,
        avg_volume_24h,
        avg_market_cap,
        total_records,

        -- Calculate hourly change
        LAG(avg_price_usd) OVER (
            PARTITION BY symbol
            ORDER BY extraction_hour
        ) as previous_hour_price,

        -- Data quality score
        (1.0 - (invalid_price_records::FLOAT / GREATEST(total_records, 1))) * 100 as data_quality_score

    FROM __dbt__cte__int_crypto_hourly_aggs
),

performance_metrics AS (
    SELECT
        *,
        CASE
            WHEN previous_hour_price IS NOT NULL AND previous_hour_price > 0 THEN
                ((avg_price_usd - previous_hour_price) / previous_hour_price) * 100
            ELSE NULL
        END as hourly_change_pct,

        -- Volatility category
        CASE
            WHEN price_volatility IS NULL THEN 'Unknown'
            WHEN price_volatility < avg_price_usd * 0.01 THEN 'Low Volatility'
            WHEN price_volatility < avg_price_usd * 0.05 THEN 'Medium Volatility'
            ELSE 'High Volatility'
        END as volatility_category

    FROM hourly_data
)

SELECT * FROM performance_metrics
  );

[0m19:48:46.991690 [debug] [Thread-4 (]: SQL status: CREATE INDEX in 3.0 seconds
[0m19:48:47.129603 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: COMMIT
[0m19:48:47.265196 [debug] [Thread-1 (]: SQL status: SELECT 5 in 3.0 seconds
[0m19:48:47.275585 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m19:48:47.407714 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m19:48:47.429082 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: COMMIT
[0m19:48:47.473839 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_tmp" rename to "mart_crypto_latest_prices"
[0m19:48:47.562801 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:48:47.615123 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m19:48:47.629685 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */

    create  index if not exists
  "98dda0926c41a7a30e4c9242d05630c0"
  on "crypto_warehouse"."public_marts"."mart_crypto_latest_prices" using btree
  (symbol);

[0m19:48:48.887900 [debug] [Thread-2 (]: SQL status: SELECT 5 in 3.0 seconds
[0m19:48:48.918102 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m19:48:48.932312 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_tmp" rename to "mart_crypto_hourly_performance"
[0m19:48:48.960075 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:48:48.983322 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m19:48:49.043984 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */

    create  index if not exists
  "9b5f276806da61e25d50f44192974e37"
  on "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance" using btree
  (symbol, extraction_hour);

[0m19:48:49.506161 [debug] [Thread-4 (]: SQL status: COMMIT in 2.0 seconds
[0m19:48:49.532123 [debug] [Thread-4 (]: Applying DROP to: "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_backup"
[0m19:48:49.565296 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m19:48:49.580260 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */
drop table if exists "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_backup" cascade
[0m19:48:49.598722 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:48:49.629614 [debug] [Thread-4 (]: Timing info for model.crypto_analytics.mart_pipeline_monitoring (execute): 19:48:36.432725 => 19:48:49.629172
[0m19:48:49.642462 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: Close
[0m19:48:49.659871 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e20b8590-5df6-4e10-b94e-0e7d1b0e629e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cfe5ca450>]}
[0m19:48:49.677567 [info ] [Thread-4 (]: 3 of 5 OK created sql table model public_marts.mart_pipeline_monitoring ........ [[32mSELECT 2[0m in 13.32s]
[0m19:48:49.697413 [debug] [Thread-4 (]: Finished running node model.crypto_analytics.mart_pipeline_monitoring
[0m19:48:50.560200 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 3.0 seconds
[0m19:48:50.608119 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m19:48:50.621562 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */

    create  index if not exists
  "c6907e975a23e73a9d8f28107c457e26"
  on "crypto_warehouse"."public_marts"."mart_crypto_latest_prices" using btree
  (market_cap_rank);

[0m19:48:50.644089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e79874cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e798ad850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e798b6750>]}


============================== 19:48:50.660016 | 0f70c551-8b51-46dd-94b6-1f1b6718e28c ==============================
[0m19:48:50.660016 [info ] [MainThread]: Running with dbt=1.7.0
[0m19:48:50.673587 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'debug': 'False', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug --project-dir /app/dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:48:50.695793 [info ] [MainThread]: dbt version: 1.7.0
[0m19:48:50.718131 [info ] [MainThread]: python version: 3.11.13
[0m19:48:50.735489 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m19:48:50.749356 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m19:48:51.375667 [info ] [MainThread]: Using profiles dir at /app
[0m19:48:51.385465 [info ] [MainThread]: Using profiles.yml file at /app/profiles.yml
[0m19:48:51.395118 [info ] [MainThread]: Using dbt_project.yml file at /app/dbt/dbt_project.yml
[0m19:48:51.408162 [info ] [MainThread]: adapter type: postgres
[0m19:48:51.421016 [info ] [MainThread]: adapter version: 1.7.0
[0m19:48:51.807585 [debug] [Thread-2 (]: SQL status: CREATE INDEX in 3.0 seconds
[0m19:48:51.844812 [info ] [MainThread]: Configuration:
[0m19:48:51.906741 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m19:48:51.981429 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:48:51.993203 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */

    create  index if not exists
  "acefdab8c435a526a73d63bee0052158"
  on "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance" using btree
  (extraction_hour);

[0m19:48:52.039547 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:48:52.170031 [info ] [MainThread]: Required dependencies:
[0m19:48:52.296424 [debug] [MainThread]: Executing "git --help"
[0m19:48:52.332563 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:48:52.395618 [debug] [MainThread]: STDERR: "b''"
[0m19:48:52.420591 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:48:52.540891 [info ] [MainThread]: Connection:
[0m19:48:52.613099 [info ] [MainThread]:   host: postgres
[0m19:48:52.655387 [info ] [MainThread]:   port: 5432
[0m19:48:52.692367 [info ] [MainThread]:   user: postgres
[0m19:48:52.736921 [info ] [MainThread]:   database: crypto_warehouse
[0m19:48:52.758343 [info ] [MainThread]:   schema: public
[0m19:48:52.783550 [info ] [MainThread]:   connect_timeout: 10
[0m19:48:52.792891 [info ] [MainThread]:   role: None
[0m19:48:52.804733 [info ] [MainThread]:   search_path: None
[0m19:48:52.816487 [info ] [MainThread]:   keepalives_idle: 0
[0m19:48:52.837008 [info ] [MainThread]:   sslmode: None
[0m19:48:52.851845 [info ] [MainThread]:   sslcert: None
[0m19:48:52.864568 [info ] [MainThread]:   sslkey: None
[0m19:48:52.874748 [info ] [MainThread]:   sslrootcert: None
[0m19:48:52.885675 [info ] [MainThread]:   application_name: dbt
[0m19:48:52.896632 [info ] [MainThread]:   retries: 1
[0m19:48:52.904120 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m19:48:52.916843 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m19:48:52.926341 [debug] [MainThread]: Using postgres connection "debug"
[0m19:48:52.936194 [debug] [MainThread]: On debug: select 1 as id
[0m19:48:52.943152 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:48:52.960772 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m19:48:52.953932 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 2.0 seconds
[0m19:48:52.974909 [debug] [MainThread]: On debug: Close
[0m19:48:52.984805 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: COMMIT
[0m19:48:52.994802 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:48:53.001465 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m19:48:53.009644 [info ] [MainThread]: [32mAll checks passed![0m
[0m19:48:53.013706 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: COMMIT
[0m19:48:53.023728 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.8841448, "process_user_time": 11.74193, "process_kernel_time": 0.536022, "process_mem_max_rss": "111344", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:48:53.099558 [debug] [MainThread]: Command `dbt debug` succeeded at 19:48:53.099192 after 2.96 seconds
[0m19:48:53.111287 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:48:53.135373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e78147210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e77fced50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e79e82fd0>]}
[0m19:48:53.150223 [debug] [MainThread]: Flushing usage events
[0m19:48:53.707683 [debug] [Thread-1 (]: SQL status: COMMIT in 1.0 seconds
[0m19:48:53.724351 [debug] [Thread-1 (]: Applying DROP to: "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_backup"
[0m19:48:53.733532 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m19:48:53.742506 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */
drop table if exists "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_backup" cascade
[0m19:48:53.753020 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:48:53.764898 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.mart_crypto_latest_prices (execute): 19:48:43.713172 => 19:48:53.764457
[0m19:48:53.772097 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: Close
[0m19:48:53.784310 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e20b8590-5df6-4e10-b94e-0e7d1b0e629e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cff0aedd0>]}
[0m19:48:53.792253 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public_marts.mart_crypto_latest_prices ....... [[32mSELECT 5[0m in 10.71s]
[0m19:48:53.803821 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.mart_crypto_latest_prices
[0m19:48:53.918272 [debug] [Thread-2 (]: SQL status: CREATE INDEX in 2.0 seconds
[0m19:48:53.930015 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: COMMIT
[0m19:48:53.937400 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m19:48:53.947986 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: COMMIT
[0m19:48:54.405562 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m19:48:54.421636 [debug] [Thread-2 (]: Applying DROP to: "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_backup"
[0m19:48:54.453038 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m19:48:54.481837 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */
drop table if exists "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_backup" cascade
[0m19:48:54.550143 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:48:54.637760 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.mart_crypto_hourly_performance (execute): 19:48:45.127591 => 19:48:54.637253
[0m19:48:54.657882 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: Close
[0m19:48:54.670729 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e20b8590-5df6-4e10-b94e-0e7d1b0e629e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cfe2f5e50>]}
[0m19:48:54.681029 [info ] [Thread-2 (]: 5 of 5 OK created sql table model public_marts.mart_crypto_hourly_performance .. [[32mSELECT 5[0m in 9.88s]
[0m19:48:54.689279 [debug] [Thread-2 (]: Finished running node model.crypto_analytics.mart_crypto_hourly_performance
[0m19:48:54.704389 [debug] [MainThread]: Using postgres connection "master"
[0m19:48:54.716839 [debug] [MainThread]: On master: BEGIN
[0m19:48:54.723621 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:48:54.739456 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:48:54.748984 [debug] [MainThread]: On master: COMMIT
[0m19:48:54.755860 [debug] [MainThread]: Using postgres connection "master"
[0m19:48:54.768152 [debug] [MainThread]: On master: COMMIT
[0m19:48:54.778959 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:48:54.786065 [debug] [MainThread]: On master: Close
[0m19:48:54.798404 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:48:54.810241 [debug] [MainThread]: Connection 'model.crypto_analytics.mart_crypto_hourly_performance' was properly closed.
[0m19:48:54.819878 [debug] [MainThread]: Connection 'model.crypto_analytics.int_crypto_hourly_aggs' was properly closed.
[0m19:48:54.834353 [debug] [MainThread]: Connection 'model.crypto_analytics.mart_crypto_latest_prices' was properly closed.
[0m19:48:54.842604 [debug] [MainThread]: Connection 'model.crypto_analytics.mart_pipeline_monitoring' was properly closed.
[0m19:48:54.853902 [info ] [MainThread]:
[0m19:48:54.863977 [info ] [MainThread]: Finished running 1 view model, 4 table models in 0 hours 0 minutes and 26.49 seconds (26.49s).
[0m19:48:54.872984 [debug] [MainThread]: Command end result
[0m19:48:55.069865 [info ] [MainThread]:
[0m19:48:55.079556 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:48:55.087343 [info ] [MainThread]:
[0m19:48:55.104738 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m19:48:55.118343 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 85.31299, "process_user_time": 10.687047, "process_kernel_time": 1.187449, "process_mem_max_rss": "126572", "process_in_blocks": "59288", "process_out_blocks": "1968"}
[0m19:48:55.126063 [debug] [MainThread]: Command `dbt run` succeeded at 19:48:55.125749 after 85.32 seconds
[0m19:48:55.133562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d00a04950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d00e92390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d05369690>]}
[0m19:48:55.143259 [debug] [MainThread]: Flushing usage events
[0m20:04:13.633712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59eb801a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59eb64fb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59eb61cb50>]}


============================== 20:04:13.682617 | 6bcc5c30-dbe4-4a7c-af32-3f20a5a3349f ==============================
[0m20:04:13.682617 [info ] [MainThread]: Running with dbt=1.7.0
[0m20:04:13.690009 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/app', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /app/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:04:14.116114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6bcc5c30-dbe4-4a7c-af32-3f20a5a3349f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59e9f60050>]}
[0m20:04:14.315872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6bcc5c30-dbe4-4a7c-af32-3f20a5a3349f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59eb67f810>]}
[0m20:04:14.324489 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m20:04:14.360219 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m20:04:16.519141 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:04:16.526075 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:04:16.557391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6bcc5c30-dbe4-4a7c-af32-3f20a5a3349f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59e9e65b90>]}
[0m20:04:16.756135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6bcc5c30-dbe4-4a7c-af32-3f20a5a3349f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59e9e81690>]}
[0m20:04:16.763257 [info ] [MainThread]: Found 7 models, 14 tests, 2 sources, 0 exposures, 0 metrics, 403 macros, 0 groups, 0 semantic models
[0m20:04:16.770231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bcc5c30-dbe4-4a7c-af32-3f20a5a3349f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59e9fb49d0>]}
[0m20:04:16.780741 [info ] [MainThread]:
[0m20:04:16.788775 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:04:16.797201 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse'
[0m20:04:16.799180 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse'
[0m20:04:16.846820 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse"
[0m20:04:16.864650 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse"
[0m20:04:16.879182 [debug] [ThreadPool]: On list_crypto_warehouse: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse"} */

    select distinct nspname from pg_namespace

[0m20:04:16.886353 [debug] [ThreadPool]: On list_crypto_warehouse: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse"} */

    select distinct nspname from pg_namespace

[0m20:04:16.893711 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:04:16.900887 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:04:16.956722 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m20:04:16.960362 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m20:04:16.969656 [debug] [ThreadPool]: On list_crypto_warehouse: Close
[0m20:04:16.980189 [debug] [ThreadPool]: On list_crypto_warehouse: Close
[0m20:04:16.999178 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_warehouse, now list_crypto_warehouse_public_marts)
[0m20:04:17.001081 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_warehouse, now list_crypto_warehouse_public_staging)
[0m20:04:17.003093 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse_public_dbt_test__audit'
[0m20:04:17.024414 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_marts"
[0m20:04:17.029912 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_staging"
[0m20:04:17.041363 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_dbt_test__audit"
[0m20:04:17.048349 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: BEGIN
[0m20:04:17.055635 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: BEGIN
[0m20:04:17.063124 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: BEGIN
[0m20:04:17.069724 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:04:17.076240 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:04:17.083380 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:04:17.096149 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:04:17.103997 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:04:17.163812 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:04:17.173063 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_marts"
[0m20:04:17.180169 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_staging"
[0m20:04:17.187194 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_dbt_test__audit"
[0m20:04:17.193737 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_marts"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'

[0m20:04:17.200635 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_staging"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'

[0m20:04:17.207765 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_dbt_test__audit"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'

[0m20:04:17.219736 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m20:04:17.225940 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m20:04:17.236333 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: ROLLBACK
[0m20:04:17.237111 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m20:04:17.245929 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: ROLLBACK
[0m20:04:17.256436 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: Close
[0m20:04:17.264185 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: ROLLBACK
[0m20:04:17.271513 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: Close
[0m20:04:17.286680 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: Close
[0m20:04:17.314458 [debug] [MainThread]: Using postgres connection "master"
[0m20:04:17.334181 [debug] [MainThread]: On master: BEGIN
[0m20:04:17.342083 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:04:17.355722 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:04:17.363020 [debug] [MainThread]: Using postgres connection "master"
[0m20:04:17.370758 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:04:17.395741 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m20:04:17.415046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bcc5c30-dbe4-4a7c-af32-3f20a5a3349f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59e9d786d0>]}
[0m20:04:17.428387 [debug] [MainThread]: On master: ROLLBACK
[0m20:04:17.435911 [debug] [MainThread]: Using postgres connection "master"
[0m20:04:17.443024 [debug] [MainThread]: On master: BEGIN
[0m20:04:17.451681 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:04:17.459036 [debug] [MainThread]: On master: COMMIT
[0m20:04:17.465801 [debug] [MainThread]: Using postgres connection "master"
[0m20:04:17.472586 [debug] [MainThread]: On master: COMMIT
[0m20:04:17.479674 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:04:17.486130 [debug] [MainThread]: On master: Close
[0m20:04:17.493331 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:04:17.500757 [info ] [MainThread]:
[0m20:04:17.512992 [debug] [Thread-1 (]: Began running node model.crypto_analytics.stg_crypto_prices
[0m20:04:17.514215 [debug] [Thread-2 (]: Began running node model.crypto_analytics.stg_pipeline_runs
[0m20:04:17.523260 [info ] [Thread-1 (]: 1 of 5 START sql table model public_staging.stg_crypto_prices .................. [RUN]
[0m20:04:17.530389 [info ] [Thread-2 (]: 2 of 5 START sql view model public_staging.stg_pipeline_runs ................... [RUN]
[0m20:04:17.537396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_dbt_test__audit, now model.crypto_analytics.stg_crypto_prices)
[0m20:04:17.545153 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_staging, now model.crypto_analytics.stg_pipeline_runs)
[0m20:04:17.553787 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics.stg_crypto_prices
[0m20:04:17.561568 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics.stg_pipeline_runs
[0m20:04:17.594608 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics.stg_crypto_prices"
[0m20:04:17.602228 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics.stg_pipeline_runs"
[0m20:04:17.766408 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.stg_crypto_prices (compile): 20:04:17.569697 => 20:04:17.765779
[0m20:04:17.789683 [debug] [Thread-1 (]: Began executing node model.crypto_analytics.stg_crypto_prices
[0m20:04:17.790839 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.stg_pipeline_runs (compile): 20:04:17.595729 => 20:04:17.790287
[0m20:04:17.882461 [debug] [Thread-2 (]: Began executing node model.crypto_analytics.stg_pipeline_runs
[0m20:04:17.970239 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics.stg_crypto_prices"
[0m20:04:18.049348 [debug] [Thread-2 (]: Writing runtime sql for node "model.crypto_analytics.stg_pipeline_runs"
[0m20:04:18.069022 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m20:04:18.080151 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: BEGIN
[0m20:04:18.087142 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:04:18.099275 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:04:18.106693 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m20:04:18.114684 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */




  create  table "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_tmp"


    as

  (


WITH source_data AS (
    SELECT
        id as price_id,
        UPPER(TRIM(symbol)) as symbol,
        TRIM(name) as crypto_name,
        current_price as price_usd,
        market_cap,
        total_volume as volume_24h,
        price_change_24h,
        price_change_percentage_24h as price_change_pct_24h,
        market_cap_rank,
        extracted_at,
        created_at,

        CASE WHEN current_price <= 0 THEN TRUE ELSE FALSE END as is_invalid_price,
        CASE WHEN market_cap <= 0 THEN TRUE ELSE FALSE END as is_invalid_market_cap,
        CASE WHEN total_volume < 0 THEN TRUE ELSE FALSE END as is_invalid_volume
    FROM "crypto_warehouse"."public"."crypto_prices_raw"
),

cleaned_data AS (
    SELECT
        *,
        DATE(extracted_at) as extraction_date,
        DATE_TRUNC('hour', extracted_at) as extraction_hour,
        CASE
            WHEN LAG(price_usd) OVER (
                PARTITION BY symbol ORDER BY extracted_at
            ) IS NOT NULL THEN
                ((price_usd - LAG(price_usd) OVER (
                    PARTITION BY symbol ORDER BY extracted_at
                )) / LAG(price_usd) OVER (
                    PARTITION BY symbol ORDER BY extracted_at
                )) * 100
        END as price_change_pct_from_previous
    FROM source_data
    WHERE NOT is_invalid_price AND NOT is_invalid_volume
)

SELECT * FROM cleaned_data
  );

[0m20:04:18.155184 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m20:04:18.162383 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: BEGIN
[0m20:04:18.185188 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:04:18.200746 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m20:04:18.229527 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m20:04:18.239183 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */

  create view "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_tmp"


  as (
    SELECT
    id as run_id,
    run_id as run_identifier,
    stage,
    status,
    records_processed,
    error_message,
    started_at,
    completed_at,
    CASE
        WHEN completed_at IS NOT NULL
        THEN EXTRACT(EPOCH FROM (completed_at - started_at))
        ELSE NULL
    END as duration_seconds
FROM "crypto_warehouse"."public"."pipeline_runs"
  );
[0m20:04:18.269448 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:04:18.302750 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m20:04:18.309751 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */
alter table "crypto_warehouse"."public_staging"."stg_pipeline_runs" rename to "stg_pipeline_runs__dbt_backup"
[0m20:04:18.317407 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:04:18.336591 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m20:04:18.343668 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */
alter table "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_tmp" rename to "stg_pipeline_runs"
[0m20:04:18.351590 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:04:18.410975 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: COMMIT
[0m20:04:18.421495 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m20:04:18.428656 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: COMMIT
[0m20:04:19.292942 [debug] [Thread-2 (]: SQL status: COMMIT in 1.0 seconds
[0m20:04:19.316797 [debug] [Thread-2 (]: Applying DROP to: "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_backup"
[0m20:04:19.334713 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m20:04:19.344627 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */
drop view if exists "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_backup" cascade
[0m20:04:19.361291 [debug] [Thread-1 (]: SQL status: SELECT 5 in 1.0 seconds
[0m20:04:19.378246 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m20:04:19.385066 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */
alter table "crypto_warehouse"."public_staging"."stg_crypto_prices" rename to "stg_crypto_prices__dbt_backup"
[0m20:04:19.395333 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:04:19.409655 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m20:04:19.418541 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */
alter table "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_tmp" rename to "stg_crypto_prices"
[0m20:04:19.428608 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:04:19.450653 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m20:04:19.467249 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:04:19.478648 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */

        CREATE INDEX IF NOT EXISTS idx_stg_crypto_prices_symbol_time ON "crypto_warehouse"."public_staging"."stg_crypto_prices" (symbol, extracted_at)

[0m20:04:19.488636 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.stg_pipeline_runs (execute): 20:04:17.934254 => 20:04:19.488062
[0m20:04:19.498020 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m20:04:19.504895 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: Close
[0m20:04:19.515692 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: COMMIT
[0m20:04:19.527142 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bcc5c30-dbe4-4a7c-af32-3f20a5a3349f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59e9d88910>]}
[0m20:04:19.533035 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m20:04:19.542536 [info ] [Thread-2 (]: 2 of 5 OK created sql view model public_staging.stg_pipeline_runs .............. [[32mCREATE VIEW[0m in 1.98s]
[0m20:04:19.551808 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: COMMIT
[0m20:04:19.561318 [debug] [Thread-2 (]: Finished running node model.crypto_analytics.stg_pipeline_runs
[0m20:04:19.585314 [debug] [Thread-4 (]: Began running node model.crypto_analytics.mart_pipeline_monitoring
[0m20:04:19.596192 [info ] [Thread-4 (]: 3 of 5 START sql table model public_marts.mart_pipeline_monitoring ............. [RUN]
[0m20:04:19.605373 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.crypto_analytics.mart_pipeline_monitoring'
[0m20:04:19.614772 [debug] [Thread-4 (]: Began compiling node model.crypto_analytics.mart_pipeline_monitoring
[0m20:04:19.644571 [debug] [Thread-4 (]: Writing injected SQL for node "model.crypto_analytics.mart_pipeline_monitoring"
[0m20:04:19.695059 [debug] [Thread-4 (]: Timing info for model.crypto_analytics.mart_pipeline_monitoring (compile): 20:04:19.627600 => 20:04:19.694369
[0m20:04:19.701449 [debug] [Thread-4 (]: Began executing node model.crypto_analytics.mart_pipeline_monitoring
[0m20:04:19.721303 [debug] [Thread-4 (]: Writing runtime sql for node "model.crypto_analytics.mart_pipeline_monitoring"
[0m20:04:19.764603 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m20:04:19.771395 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: BEGIN
[0m20:04:19.778018 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:04:19.789489 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m20:04:19.795365 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m20:04:19.801091 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */




  create  table "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_tmp"


    as

  (


WITH pipeline_metrics AS (
    SELECT
        run_id,
        stage,
        status,
        records_processed,
        error_message,
        started_at,
        completed_at,
        EXTRACT(EPOCH FROM completed_at - started_at) AS duration_seconds,

        -- Flag to compute success rate
        CASE WHEN status = 'success' THEN 1 ELSE 0 END AS is_success,

        -- Classify performance
        CASE
            WHEN completed_at IS NULL THEN 'Running'
            WHEN EXTRACT(EPOCH FROM completed_at - started_at) < 30 THEN 'Fast'
            WHEN EXTRACT(EPOCH FROM completed_at - started_at) < 120 THEN 'Normal'
            ELSE 'Slow'
        END AS performance_category

    FROM "crypto_warehouse"."public_staging"."stg_pipeline_runs"
),

latest_status_per_day_stage AS (
    SELECT
        DATE(started_at) AS run_date,
        stage,
        FIRST_VALUE(status) OVER (
            PARTITION BY DATE(started_at), stage
            ORDER BY started_at DESC
        ) AS latest_run_status
    FROM pipeline_metrics
),

daily_summary AS (
    SELECT
        DATE(started_at) AS run_date,
        stage,

        COUNT(*) AS total_runs,
        SUM(is_success) AS successful_runs,
        SUM(records_processed) AS total_records_processed,
        AVG(duration_seconds) AS avg_duration_seconds,
        MAX(duration_seconds) AS max_duration_seconds,
        ROUND(((SUM(is_success)::FLOAT / COUNT(*)) * 100)::NUMERIC, 2) AS success_rate_pct


    FROM pipeline_metrics
    WHERE started_at >= CURRENT_DATE - INTERVAL '30 days'
    GROUP BY DATE(started_at), stage
)

-- Final result combining metrics with latest run status
SELECT
    ds.*,
    ls.latest_run_status
FROM daily_summary ds
LEFT JOIN latest_status_per_day_stage ls
  ON ds.run_date = ls.run_date AND ds.stage = ls.stage
  );

[0m20:04:20.137306 [debug] [Thread-1 (]: SQL status: COMMIT in 1.0 seconds
[0m20:04:20.151586 [debug] [Thread-1 (]: Applying DROP to: "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_backup"
[0m20:04:20.186093 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m20:04:20.210937 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */
drop table if exists "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_backup" cascade
[0m20:04:20.719129 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:04:20.729187 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.stg_crypto_prices (execute): 20:04:17.814544 => 20:04:20.728677
[0m20:04:20.736824 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: Close
[0m20:04:20.744666 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bcc5c30-dbe4-4a7c-af32-3f20a5a3349f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59e9e30250>]}
[0m20:04:20.752838 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public_staging.stg_crypto_prices ............. [[32mSELECT 5[0m in 3.21s]
[0m20:04:20.760971 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.stg_crypto_prices
[0m20:04:20.777530 [debug] [Thread-2 (]: Began running node model.crypto_analytics.int_crypto_daily_aggs
[0m20:04:20.778423 [debug] [Thread-3 (]: Began running node model.crypto_analytics.int_crypto_hourly_aggs
[0m20:04:20.779396 [debug] [Thread-1 (]: Began running node model.crypto_analytics.mart_crypto_latest_prices
[0m20:04:20.813655 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.stg_pipeline_runs, now model.crypto_analytics.int_crypto_daily_aggs)
[0m20:04:20.830356 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_marts, now model.crypto_analytics.int_crypto_hourly_aggs)
[0m20:04:20.838929 [info ] [Thread-1 (]: 4 of 5 START sql table model public_marts.mart_crypto_latest_prices ............ [RUN]
[0m20:04:20.847957 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics.int_crypto_daily_aggs
[0m20:04:20.850135 [debug] [Thread-4 (]: SQL status: SELECT 2 in 1.0 seconds
[0m20:04:20.856318 [debug] [Thread-3 (]: Began compiling node model.crypto_analytics.int_crypto_hourly_aggs
[0m20:04:20.863819 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.stg_crypto_prices, now model.crypto_analytics.mart_crypto_latest_prices)
[0m20:04:20.887841 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics.int_crypto_daily_aggs"
[0m20:04:20.900869 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m20:04:20.925643 [debug] [Thread-3 (]: Writing injected SQL for node "model.crypto_analytics.int_crypto_hourly_aggs"
[0m20:04:20.930294 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics.mart_crypto_latest_prices
[0m20:04:20.945859 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */
alter table "crypto_warehouse"."public_marts"."mart_pipeline_monitoring" rename to "mart_pipeline_monitoring__dbt_backup"
[0m20:04:20.973081 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics.mart_crypto_latest_prices"
[0m20:04:20.982499 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:04:20.994454 [debug] [Thread-3 (]: Timing info for model.crypto_analytics.int_crypto_hourly_aggs (compile): 20:04:20.907979 => 20:04:20.993812
[0m20:04:21.001312 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.int_crypto_daily_aggs (compile): 20:04:20.871046 => 20:04:21.000638
[0m20:04:21.149636 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.mart_crypto_latest_prices (compile): 20:04:20.963945 => 20:04:21.148997
[0m20:04:21.151149 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m20:04:21.153745 [debug] [Thread-3 (]: Finished running node model.crypto_analytics.int_crypto_hourly_aggs
[0m20:04:21.161697 [debug] [Thread-2 (]: Finished running node model.crypto_analytics.int_crypto_daily_aggs
[0m20:04:21.169047 [debug] [Thread-1 (]: Began executing node model.crypto_analytics.mart_crypto_latest_prices
[0m20:04:21.176482 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */
alter table "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_tmp" rename to "mart_pipeline_monitoring"
[0m20:04:21.182213 [debug] [Thread-3 (]: Began running node model.crypto_analytics.mart_crypto_hourly_performance
[0m20:04:21.210462 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics.mart_crypto_latest_prices"
[0m20:04:21.212380 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:04:21.224263 [info ] [Thread-3 (]: 5 of 5 START sql table model public_marts.mart_crypto_hourly_performance ....... [RUN]
[0m20:04:21.272927 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m20:04:21.274428 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.int_crypto_hourly_aggs, now model.crypto_analytics.mart_crypto_hourly_performance)
[0m20:04:21.284469 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */

    create  index if not exists
  "7d015b7167e5786109eeef78760e41e8"
  on "crypto_warehouse"."public_marts"."mart_pipeline_monitoring" using btree
  (run_date);

[0m20:04:21.294034 [debug] [Thread-3 (]: Began compiling node model.crypto_analytics.mart_crypto_hourly_performance
[0m20:04:21.314592 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m20:04:21.352210 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: BEGIN
[0m20:04:21.365751 [debug] [Thread-3 (]: Writing injected SQL for node "model.crypto_analytics.mart_crypto_hourly_performance"
[0m20:04:21.367267 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:04:21.389413 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:04:21.397220 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m20:04:21.406091 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */




  create  table "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_tmp"


    as

  (


WITH latest_prices AS (
    SELECT
        symbol,
        crypto_name,
        price_usd,
        market_cap,
        volume_24h,
        price_change_24h,
        price_change_pct_24h,
        market_cap_rank,
        extracted_at,

        ROW_NUMBER() OVER (
            PARTITION BY symbol
            ORDER BY extracted_at DESC
        ) as rn

    FROM "crypto_warehouse"."public_staging"."stg_crypto_prices"
    WHERE extraction_date = CURRENT_DATE
),

price_changes AS (
    SELECT
        symbol,
        crypto_name,
        price_usd as current_price,
        market_cap,
        volume_24h,
        price_change_24h,
        price_change_pct_24h,
        market_cap_rank,
        extracted_at as last_updated,

        -- Calculate additional metrics
        CASE
            WHEN price_change_pct_24h > 10 THEN 'Strong Gain'
            WHEN price_change_pct_24h > 5 THEN 'Moderate Gain'
            WHEN price_change_pct_24h > 0 THEN 'Slight Gain'
            WHEN price_change_pct_24h > -5 THEN 'Slight Loss'
            WHEN price_change_pct_24h > -10 THEN 'Moderate Loss'
            ELSE 'Strong Loss'
        END as price_trend_category,

        -- Market cap category
        CASE
            WHEN market_cap_rank <= 10 THEN 'Large Cap'
            WHEN market_cap_rank <= 50 THEN 'Mid Cap'
            WHEN market_cap_rank <= 100 THEN 'Small Cap'
            ELSE 'Micro Cap'
        END as market_cap_category

    FROM latest_prices
    WHERE rn = 1
)

SELECT * FROM price_changes
  );

[0m20:04:21.433676 [debug] [Thread-3 (]: Timing info for model.crypto_analytics.mart_crypto_hourly_performance (compile): 20:04:21.316399 => 20:04:21.433172
[0m20:04:21.442644 [debug] [Thread-3 (]: Began executing node model.crypto_analytics.mart_crypto_hourly_performance
[0m20:04:21.461704 [debug] [Thread-3 (]: Writing runtime sql for node "model.crypto_analytics.mart_crypto_hourly_performance"
[0m20:04:21.505717 [debug] [Thread-3 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m20:04:21.512984 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: BEGIN
[0m20:04:21.519744 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:04:21.532357 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m20:04:21.540699 [debug] [Thread-3 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m20:04:21.547776 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */




  create  table "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_tmp"


    as

  (


WITH  __dbt__cte__int_crypto_hourly_aggs as (


WITH base_data AS (
    SELECT
        symbol,
        crypto_name,
        DATE_TRUNC('hour', extracted_at) AS extraction_hour,
        price_usd,
        volume_24h,
        market_cap,
        CASE WHEN price_usd <= 0 THEN 1 ELSE 0 END AS is_invalid
    FROM "crypto_warehouse"."public_staging"."stg_crypto_prices"
)

SELECT
    symbol,
    crypto_name,
    extraction_hour,
    COUNT(*) AS total_records,
    SUM(is_invalid) AS invalid_price_records,
    AVG(price_usd) AS avg_price_usd,
    MIN(price_usd) AS min_price_usd,
    MAX(price_usd) AS max_price_usd,
    STDDEV(price_usd) AS price_volatility,
    AVG(volume_24h) AS avg_volume_24h,
    AVG(market_cap) AS avg_market_cap
FROM base_data
GROUP BY symbol, crypto_name, extraction_hour
), hourly_data AS (
    SELECT
        symbol,
        crypto_name,
        extraction_hour,
        avg_price_usd,
        min_price_usd,
        max_price_usd,
        price_volatility,
        avg_volume_24h,
        avg_market_cap,
        total_records,

        -- Calculate hourly change
        LAG(avg_price_usd) OVER (
            PARTITION BY symbol
            ORDER BY extraction_hour
        ) as previous_hour_price,

        -- Data quality score
        (1.0 - (invalid_price_records::FLOAT / GREATEST(total_records, 1))) * 100 as data_quality_score

    FROM __dbt__cte__int_crypto_hourly_aggs
),

performance_metrics AS (
    SELECT
        *,
        CASE
            WHEN previous_hour_price IS NOT NULL AND previous_hour_price > 0 THEN
                ((avg_price_usd - previous_hour_price) / previous_hour_price) * 100
            ELSE NULL
        END as hourly_change_pct,

        -- Volatility category
        CASE
            WHEN price_volatility IS NULL THEN 'Unknown'
            WHEN price_volatility < avg_price_usd * 0.01 THEN 'Low Volatility'
            WHEN price_volatility < avg_price_usd * 0.05 THEN 'Medium Volatility'
            ELSE 'High Volatility'
        END as volatility_category

    FROM hourly_data
)

SELECT * FROM performance_metrics
  );

[0m20:04:22.002570 [debug] [Thread-4 (]: SQL status: CREATE INDEX in 1.0 seconds
[0m20:04:22.011369 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m20:04:22.018106 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */

    create  index if not exists
  "ae0e34345c99d153f1c4cbb54d6d989e"
  on "crypto_warehouse"."public_marts"."mart_pipeline_monitoring" using btree
  (stage);

[0m20:04:22.559668 [debug] [Thread-1 (]: SQL status: SELECT 5 in 1.0 seconds
[0m20:04:22.560991 [debug] [Thread-3 (]: SQL status: SELECT 5 in 1.0 seconds
[0m20:04:22.573637 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m20:04:22.587165 [debug] [Thread-3 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m20:04:22.594125 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_latest_prices" rename to "mart_crypto_latest_prices__dbt_backup"
[0m20:04:22.601575 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance" rename to "mart_crypto_hourly_performance__dbt_backup"
[0m20:04:22.610869 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:04:22.617436 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:04:22.630183 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m20:04:22.640727 [debug] [Thread-3 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m20:04:22.646430 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_tmp" rename to "mart_crypto_latest_prices"
[0m20:04:22.654239 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_tmp" rename to "mart_crypto_hourly_performance"
[0m20:04:22.662238 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:04:22.669230 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:04:22.677868 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m20:04:22.689403 [debug] [Thread-3 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m20:04:22.697814 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */

    create  index if not exists
  "2837afd2c3f17305e10c45b38f0b17fe"
  on "crypto_warehouse"."public_marts"."mart_crypto_latest_prices" using btree
  (symbol);

[0m20:04:22.705334 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */

    create  index if not exists
  "fa7c6515adb0441680df9a7c4a78bd18"
  on "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance" using btree
  (symbol, extraction_hour);

[0m20:04:23.003201 [debug] [Thread-4 (]: SQL status: CREATE INDEX in 1.0 seconds
[0m20:04:23.036531 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: COMMIT
[0m20:04:23.080020 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m20:04:23.103814 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: COMMIT
[0m20:04:23.549564 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 1.0 seconds
[0m20:04:23.550560 [debug] [Thread-3 (]: SQL status: CREATE INDEX in 1.0 seconds
[0m20:04:23.561169 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m20:04:23.572963 [debug] [Thread-3 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m20:04:23.580283 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */

    create  index if not exists
  "bd4f10c7e2528cf0ff52899586ed8c52"
  on "crypto_warehouse"."public_marts"."mart_crypto_latest_prices" using btree
  (market_cap_rank);

[0m20:04:23.591202 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */

    create  index if not exists
  "6d7d5398fe81e608d07db2eac7cc52d2"
  on "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance" using btree
  (extraction_hour);

[0m20:04:23.727591 [debug] [Thread-4 (]: SQL status: COMMIT in 1.0 seconds
[0m20:04:23.747337 [debug] [Thread-4 (]: Applying DROP to: "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_backup"
[0m20:04:23.769935 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m20:04:23.785927 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */
drop table if exists "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_backup" cascade
[0m20:04:24.268051 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:04:24.278771 [debug] [Thread-4 (]: Timing info for model.crypto_analytics.mart_pipeline_monitoring (execute): 20:04:19.711957 => 20:04:24.278337
[0m20:04:24.289508 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: Close
[0m20:04:24.301506 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bcc5c30-dbe4-4a7c-af32-3f20a5a3349f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59ec200310>]}
[0m20:04:24.313347 [info ] [Thread-4 (]: 3 of 5 OK created sql table model public_marts.mart_pipeline_monitoring ........ [[32mSELECT 2[0m in 4.70s]
[0m20:04:24.323726 [debug] [Thread-4 (]: Finished running node model.crypto_analytics.mart_pipeline_monitoring
[0m20:04:24.442574 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 1.0 seconds
[0m20:04:24.443843 [debug] [Thread-3 (]: SQL status: CREATE INDEX in 1.0 seconds
[0m20:04:24.455037 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: COMMIT
[0m20:04:24.464597 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: COMMIT
[0m20:04:24.474186 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m20:04:24.481175 [debug] [Thread-3 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m20:04:24.491094 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: COMMIT
[0m20:04:24.499542 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: COMMIT
[0m20:04:24.682967 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:04:24.699140 [debug] [Thread-1 (]: Applying DROP to: "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_backup"
[0m20:04:24.710208 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m20:04:24.723545 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */
drop table if exists "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_backup" cascade
[0m20:04:24.794368 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m20:04:24.812543 [debug] [Thread-3 (]: Applying DROP to: "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_backup"
[0m20:04:24.829784 [debug] [Thread-3 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m20:04:24.840983 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */
drop table if exists "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_backup" cascade
[0m20:04:24.917199 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:04:24.928211 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.mart_crypto_latest_prices (execute): 20:04:21.191729 => 20:04:24.927714
[0m20:04:24.939363 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: Close
[0m20:04:24.947069 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bcc5c30-dbe4-4a7c-af32-3f20a5a3349f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59ec07de10>]}
[0m20:04:25.022093 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public_marts.mart_crypto_latest_prices ....... [[32mSELECT 5[0m in 4.08s]
[0m20:04:25.093221 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.mart_crypto_latest_prices
[0m20:04:25.157014 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:04:25.262651 [debug] [Thread-3 (]: Timing info for model.crypto_analytics.mart_crypto_hourly_performance (execute): 20:04:21.448854 => 20:04:25.262249
[0m20:04:25.327697 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: Close
[0m20:04:25.362076 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bcc5c30-dbe4-4a7c-af32-3f20a5a3349f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59e9c812d0>]}
[0m20:04:25.403458 [info ] [Thread-3 (]: 5 of 5 OK created sql table model public_marts.mart_crypto_hourly_performance .. [[32mSELECT 5[0m in 4.09s]
[0m20:04:25.475007 [debug] [Thread-3 (]: Finished running node model.crypto_analytics.mart_crypto_hourly_performance
[0m20:04:25.514040 [debug] [MainThread]: Using postgres connection "master"
[0m20:04:25.689757 [debug] [MainThread]: On master: BEGIN
[0m20:04:25.779368 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:04:25.883814 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:04:26.001364 [debug] [MainThread]: On master: COMMIT
[0m20:04:26.044789 [debug] [MainThread]: Using postgres connection "master"
[0m20:04:26.113508 [debug] [MainThread]: On master: COMMIT
[0m20:04:26.190780 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:04:26.259835 [debug] [MainThread]: On master: Close
[0m20:04:26.294544 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:04:26.315692 [debug] [MainThread]: Connection 'model.crypto_analytics.int_crypto_daily_aggs' was properly closed.
[0m20:04:26.329948 [debug] [MainThread]: Connection 'model.crypto_analytics.mart_crypto_hourly_performance' was properly closed.
[0m20:04:26.339095 [debug] [MainThread]: Connection 'model.crypto_analytics.mart_crypto_latest_prices' was properly closed.
[0m20:04:26.345503 [debug] [MainThread]: Connection 'model.crypto_analytics.mart_pipeline_monitoring' was properly closed.
[0m20:04:26.355900 [info ] [MainThread]:
[0m20:04:26.362687 [info ] [MainThread]: Finished running 1 view model, 4 table models in 0 hours 0 minutes and 9.57 seconds (9.57s).
[0m20:04:26.431677 [debug] [MainThread]: Command end result
[0m20:04:26.999745 [info ] [MainThread]:
[0m20:04:27.008599 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:04:27.021352 [info ] [MainThread]:
[0m20:04:27.035628 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m20:04:27.066096 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.682125, "process_user_time": 8.104286, "process_kernel_time": 0.688004, "process_mem_max_rss": "121892", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:04:27.077961 [debug] [MainThread]: Command `dbt run` succeeded at 20:04:27.077659 after 13.69 seconds
[0m20:04:27.090085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59ed1808d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59ebcca050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59ebcc9e10>]}
[0m20:04:27.099342 [debug] [MainThread]: Flushing usage events
[0m20:06:30.437895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc8611ac90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc8630a550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc86118e90>]}


============================== 20:06:30.449377 | fbc0c49d-ac35-4aab-bb7e-0c25d887edbc ==============================
[0m20:06:30.449377 [info ] [MainThread]: Running with dbt=1.7.0
[0m20:06:30.458003 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/app/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /app/dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:06:30.862131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fbc0c49d-ac35-4aab-bb7e-0c25d887edbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc84aad010>]}
[0m20:06:31.048965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fbc0c49d-ac35-4aab-bb7e-0c25d887edbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc84acdcd0>]}
[0m20:06:31.056032 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m20:06:31.094175 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m20:06:32.422667 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:06:32.429757 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:06:32.465345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fbc0c49d-ac35-4aab-bb7e-0c25d887edbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc848abed0>]}
[0m20:06:32.654719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fbc0c49d-ac35-4aab-bb7e-0c25d887edbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc8496c3d0>]}
[0m20:06:32.661449 [info ] [MainThread]: Found 7 models, 14 tests, 2 sources, 0 exposures, 0 metrics, 403 macros, 0 groups, 0 semantic models
[0m20:06:32.668532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbc0c49d-ac35-4aab-bb7e-0c25d887edbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc84a86c90>]}
[0m20:06:32.679720 [info ] [MainThread]:
[0m20:06:32.687895 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:06:32.697079 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse'
[0m20:06:32.699313 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse'
[0m20:06:32.745517 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse"
[0m20:06:32.758103 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse"
[0m20:06:32.774056 [debug] [ThreadPool]: On list_crypto_warehouse: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse"} */

    select distinct nspname from pg_namespace

[0m20:06:32.780749 [debug] [ThreadPool]: On list_crypto_warehouse: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse"} */

    select distinct nspname from pg_namespace

[0m20:06:32.788033 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:06:32.797397 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:06:32.816213 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m20:06:32.828309 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m20:06:32.833166 [debug] [ThreadPool]: On list_crypto_warehouse: Close
[0m20:06:32.842834 [debug] [ThreadPool]: On list_crypto_warehouse: Close
[0m20:06:32.877010 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_warehouse, now list_crypto_warehouse_public_dbt_test__audit)
[0m20:06:32.878928 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_warehouse, now list_crypto_warehouse_public_staging)
[0m20:06:32.881047 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse_public_marts'
[0m20:06:32.902497 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_dbt_test__audit"
[0m20:06:32.908145 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_staging"
[0m20:06:32.922136 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_marts"
[0m20:06:32.929230 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: BEGIN
[0m20:06:32.940119 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: BEGIN
[0m20:06:32.947106 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: BEGIN
[0m20:06:32.954314 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:06:32.961878 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:06:32.969363 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:06:32.981856 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:06:32.993076 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:06:33.004584 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:06:33.008495 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_dbt_test__audit"
[0m20:06:33.017379 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_staging"
[0m20:06:33.024769 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_marts"
[0m20:06:33.032741 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_dbt_test__audit"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'

[0m20:06:33.040974 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_staging"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'

[0m20:06:33.048254 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_marts"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'

[0m20:06:33.060635 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m20:06:33.069793 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m20:06:33.079008 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m20:06:33.084180 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: ROLLBACK
[0m20:06:33.093151 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: ROLLBACK
[0m20:06:33.107610 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: ROLLBACK
[0m20:06:33.143037 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: Close
[0m20:06:33.149210 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: Close
[0m20:06:33.155247 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: Close
[0m20:06:33.191475 [debug] [MainThread]: Using postgres connection "master"
[0m20:06:33.202543 [debug] [MainThread]: On master: BEGIN
[0m20:06:33.212835 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:06:33.225709 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:06:33.236882 [debug] [MainThread]: Using postgres connection "master"
[0m20:06:33.245763 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:06:33.263944 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m20:06:33.276719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbc0c49d-ac35-4aab-bb7e-0c25d887edbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc84a24f50>]}
[0m20:06:33.283858 [debug] [MainThread]: On master: ROLLBACK
[0m20:06:33.291565 [debug] [MainThread]: Using postgres connection "master"
[0m20:06:33.298877 [debug] [MainThread]: On master: BEGIN
[0m20:06:33.306860 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:06:33.314059 [debug] [MainThread]: On master: COMMIT
[0m20:06:33.323054 [debug] [MainThread]: Using postgres connection "master"
[0m20:06:33.329990 [debug] [MainThread]: On master: COMMIT
[0m20:06:33.337419 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:06:33.344222 [debug] [MainThread]: On master: Close
[0m20:06:33.352357 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:06:33.360282 [info ] [MainThread]:
[0m20:06:33.373535 [debug] [Thread-1 (]: Began running node model.crypto_analytics.stg_crypto_prices
[0m20:06:33.374646 [debug] [Thread-2 (]: Began running node model.crypto_analytics.stg_pipeline_runs
[0m20:06:33.381253 [info ] [Thread-1 (]: 1 of 5 START sql table model public_staging.stg_crypto_prices .................. [RUN]
[0m20:06:33.389173 [info ] [Thread-2 (]: 2 of 5 START sql view model public_staging.stg_pipeline_runs ................... [RUN]
[0m20:06:33.396831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_marts, now model.crypto_analytics.stg_crypto_prices)
[0m20:06:33.404569 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_staging, now model.crypto_analytics.stg_pipeline_runs)
[0m20:06:33.411517 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics.stg_crypto_prices
[0m20:06:33.420406 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics.stg_pipeline_runs
[0m20:06:33.449498 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics.stg_crypto_prices"
[0m20:06:33.458797 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics.stg_pipeline_runs"
[0m20:06:33.497221 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.stg_pipeline_runs (compile): 20:06:33.450610 => 20:06:33.496600
[0m20:06:33.505173 [debug] [Thread-2 (]: Began executing node model.crypto_analytics.stg_pipeline_runs
[0m20:06:33.506525 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.stg_crypto_prices (compile): 20:06:33.428026 => 20:06:33.505944
[0m20:06:33.539026 [debug] [Thread-1 (]: Began executing node model.crypto_analytics.stg_crypto_prices
[0m20:06:33.636668 [debug] [Thread-2 (]: Writing runtime sql for node "model.crypto_analytics.stg_pipeline_runs"
[0m20:06:33.669022 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics.stg_crypto_prices"
[0m20:06:33.713846 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m20:06:33.715160 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m20:06:33.722806 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: BEGIN
[0m20:06:33.757441 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: BEGIN
[0m20:06:33.808032 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:06:33.829620 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:33.850551 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m20:06:33.876014 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:06:33.902767 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m20:06:33.920978 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m20:06:33.945396 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */

  create view "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_tmp"


  as (
    SELECT
    id as run_id,
    run_id as run_identifier,
    stage,
    status,
    records_processed,
    error_message,
    started_at,
    completed_at,
    CASE
        WHEN completed_at IS NOT NULL
        THEN EXTRACT(EPOCH FROM (completed_at - started_at))
        ELSE NULL
    END as duration_seconds
FROM "crypto_warehouse"."public"."pipeline_runs"
  );
[0m20:06:33.963155 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */




  create  table "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_tmp"


    as

  (


WITH source_data AS (
    SELECT
        id as price_id,
        UPPER(TRIM(symbol)) as symbol,
        TRIM(name) as crypto_name,
        current_price as price_usd,
        market_cap,
        total_volume as volume_24h,
        price_change_24h,
        price_change_percentage_24h as price_change_pct_24h,
        market_cap_rank,
        extracted_at,
        created_at,

        CASE WHEN current_price <= 0 THEN TRUE ELSE FALSE END as is_invalid_price,
        CASE WHEN market_cap <= 0 THEN TRUE ELSE FALSE END as is_invalid_market_cap,
        CASE WHEN total_volume < 0 THEN TRUE ELSE FALSE END as is_invalid_volume
    FROM "crypto_warehouse"."public"."crypto_prices_raw"
),

cleaned_data AS (
    SELECT
        *,
        DATE(extracted_at) as extraction_date,
        DATE_TRUNC('hour', extracted_at) as extraction_hour,
        CASE
            WHEN LAG(price_usd) OVER (
                PARTITION BY symbol ORDER BY extracted_at
            ) IS NOT NULL THEN
                ((price_usd - LAG(price_usd) OVER (
                    PARTITION BY symbol ORDER BY extracted_at
                )) / LAG(price_usd) OVER (
                    PARTITION BY symbol ORDER BY extracted_at
                )) * 100
        END as price_change_pct_from_previous
    FROM source_data
    WHERE NOT is_invalid_price AND NOT is_invalid_volume
)

SELECT * FROM cleaned_data
  );

[0m20:06:33.977077 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:06:34.022397 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m20:06:34.037077 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */
alter table "crypto_warehouse"."public_staging"."stg_pipeline_runs" rename to "stg_pipeline_runs__dbt_backup"
[0m20:06:34.048573 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:06:34.064064 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m20:06:34.074579 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */
alter table "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_tmp" rename to "stg_pipeline_runs"
[0m20:06:34.082217 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:06:34.138635 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: COMMIT
[0m20:06:34.146138 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m20:06:34.154534 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: COMMIT
[0m20:06:34.192780 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.0 seconds
[0m20:06:34.206574 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m20:06:34.213900 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */
alter table "crypto_warehouse"."public_staging"."stg_crypto_prices" rename to "stg_crypto_prices__dbt_backup"
[0m20:06:34.221241 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:06:34.233650 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m20:06:34.241054 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */
alter table "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_tmp" rename to "stg_crypto_prices"
[0m20:06:34.250311 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:06:34.252430 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m20:06:34.269486 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m20:06:34.290669 [debug] [Thread-2 (]: Applying DROP to: "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_backup"
[0m20:06:34.293046 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */

        CREATE INDEX IF NOT EXISTS idx_stg_crypto_prices_symbol_time ON "crypto_warehouse"."public_staging"."stg_crypto_prices" (symbol, extracted_at)

[0m20:06:34.316779 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m20:06:34.326869 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */
drop view if exists "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_backup" cascade
[0m20:06:34.434229 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:06:34.443420 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.stg_pipeline_runs (execute): 20:06:33.511564 => 20:06:34.443003
[0m20:06:34.450885 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: Close
[0m20:06:34.458989 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fbc0c49d-ac35-4aab-bb7e-0c25d887edbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc848c2010>]}
[0m20:06:34.470610 [info ] [Thread-2 (]: 2 of 5 OK created sql view model public_staging.stg_pipeline_runs .............. [[32mCREATE VIEW[0m in 1.05s]
[0m20:06:34.477778 [debug] [Thread-2 (]: Finished running node model.crypto_analytics.stg_pipeline_runs
[0m20:06:34.485244 [debug] [Thread-4 (]: Began running node model.crypto_analytics.mart_pipeline_monitoring
[0m20:06:34.498850 [info ] [Thread-4 (]: 3 of 5 START sql table model public_marts.mart_pipeline_monitoring ............. [RUN]
[0m20:06:34.512933 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.crypto_analytics.mart_pipeline_monitoring'
[0m20:06:34.520546 [debug] [Thread-4 (]: Began compiling node model.crypto_analytics.mart_pipeline_monitoring
[0m20:06:34.536968 [debug] [Thread-4 (]: Writing injected SQL for node "model.crypto_analytics.mart_pipeline_monitoring"
[0m20:06:34.584794 [debug] [Thread-4 (]: Timing info for model.crypto_analytics.mart_pipeline_monitoring (compile): 20:06:34.527416 => 20:06:34.584347
[0m20:06:34.591844 [debug] [Thread-4 (]: Began executing node model.crypto_analytics.mart_pipeline_monitoring
[0m20:06:34.600459 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m20:06:34.609247 [debug] [Thread-4 (]: Writing runtime sql for node "model.crypto_analytics.mart_pipeline_monitoring"
[0m20:06:34.616419 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: COMMIT
[0m20:06:34.631640 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m20:06:34.638962 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: COMMIT
[0m20:06:34.674104 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m20:06:34.682850 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: BEGIN
[0m20:06:34.690617 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:06:34.703610 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m20:06:34.710002 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m20:06:34.718164 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */




  create  table "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_tmp"


    as

  (


WITH pipeline_metrics AS (
    SELECT
        run_id,
        stage,
        status,
        records_processed,
        error_message,
        started_at,
        completed_at,
        EXTRACT(EPOCH FROM completed_at - started_at) AS duration_seconds,

        -- Flag to compute success rate
        CASE WHEN status = 'success' THEN 1 ELSE 0 END AS is_success,

        -- Classify performance
        CASE
            WHEN completed_at IS NULL THEN 'Running'
            WHEN EXTRACT(EPOCH FROM completed_at - started_at) < 30 THEN 'Fast'
            WHEN EXTRACT(EPOCH FROM completed_at - started_at) < 120 THEN 'Normal'
            ELSE 'Slow'
        END AS performance_category

    FROM "crypto_warehouse"."public_staging"."stg_pipeline_runs"
),

latest_status_per_day_stage AS (
    SELECT
        DATE(started_at) AS run_date,
        stage,
        FIRST_VALUE(status) OVER (
            PARTITION BY DATE(started_at), stage
            ORDER BY started_at DESC
        ) AS latest_run_status
    FROM pipeline_metrics
),

daily_summary AS (
    SELECT
        DATE(started_at) AS run_date,
        stage,

        COUNT(*) AS total_runs,
        SUM(is_success) AS successful_runs,
        SUM(records_processed) AS total_records_processed,
        AVG(duration_seconds) AS avg_duration_seconds,
        MAX(duration_seconds) AS max_duration_seconds,
        ROUND(((SUM(is_success)::FLOAT / COUNT(*)) * 100)::NUMERIC, 2) AS success_rate_pct


    FROM pipeline_metrics
    WHERE started_at >= CURRENT_DATE - INTERVAL '30 days'
    GROUP BY DATE(started_at), stage
)

-- Final result combining metrics with latest run status
SELECT
    ds.*,
    ls.latest_run_status
FROM daily_summary ds
LEFT JOIN latest_status_per_day_stage ls
  ON ds.run_date = ls.run_date AND ds.stage = ls.stage
  );

[0m20:06:34.720292 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:06:34.737286 [debug] [Thread-1 (]: Applying DROP to: "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_backup"
[0m20:06:34.755051 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m20:06:34.761404 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */
drop table if exists "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_backup" cascade
[0m20:06:34.964888 [debug] [Thread-4 (]: SQL status: SELECT 2 in 0.0 seconds
[0m20:06:34.978369 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m20:06:34.986264 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */
alter table "crypto_warehouse"."public_marts"."mart_pipeline_monitoring" rename to "mart_pipeline_monitoring__dbt_backup"
[0m20:06:34.994192 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:06:35.006479 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m20:06:35.013409 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */
alter table "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_tmp" rename to "mart_pipeline_monitoring"
[0m20:06:35.020982 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:06:35.025861 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:06:35.062432 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m20:06:35.082222 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.stg_crypto_prices (execute): 20:06:33.561756 => 20:06:35.081791
[0m20:06:35.118721 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */

    create  index if not exists
  "0e058ace4172777da4e7e97dfb8d1a2a"
  on "crypto_warehouse"."public_marts"."mart_pipeline_monitoring" using btree
  (run_date);

[0m20:06:35.140137 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: Close
[0m20:06:35.186328 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fbc0c49d-ac35-4aab-bb7e-0c25d887edbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc861a2050>]}
[0m20:06:35.200197 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public_staging.stg_crypto_prices ............. [[32mSELECT 5[0m in 1.79s]
[0m20:06:35.211613 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.stg_crypto_prices
[0m20:06:35.221748 [debug] [Thread-2 (]: Began running node model.crypto_analytics.int_crypto_daily_aggs
[0m20:06:35.222647 [debug] [Thread-3 (]: Began running node model.crypto_analytics.int_crypto_hourly_aggs
[0m20:06:35.223548 [debug] [Thread-1 (]: Began running node model.crypto_analytics.mart_crypto_latest_prices
[0m20:06:35.230619 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.stg_pipeline_runs, now model.crypto_analytics.int_crypto_daily_aggs)
[0m20:06:35.241253 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_dbt_test__audit, now model.crypto_analytics.int_crypto_hourly_aggs)
[0m20:06:35.251484 [info ] [Thread-1 (]: 4 of 5 START sql table model public_marts.mart_crypto_latest_prices ............ [RUN]
[0m20:06:35.262300 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics.int_crypto_daily_aggs
[0m20:06:35.273029 [debug] [Thread-3 (]: Began compiling node model.crypto_analytics.int_crypto_hourly_aggs
[0m20:06:35.284305 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.stg_crypto_prices, now model.crypto_analytics.mart_crypto_latest_prices)
[0m20:06:35.414826 [debug] [Thread-4 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m20:06:35.490448 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m20:06:35.441308 [debug] [Thread-3 (]: Writing injected SQL for node "model.crypto_analytics.int_crypto_hourly_aggs"
[0m20:06:35.462317 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics.mart_crypto_latest_prices
[0m20:06:35.415747 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics.int_crypto_daily_aggs"
[0m20:06:35.500718 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */

    create  index if not exists
  "92e39bd1b6127e7dae4a84d7382010de"
  on "crypto_warehouse"."public_marts"."mart_pipeline_monitoring" using btree
  (stage);

[0m20:06:35.555310 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics.mart_crypto_latest_prices"
[0m20:06:35.625072 [debug] [Thread-3 (]: Timing info for model.crypto_analytics.int_crypto_hourly_aggs (compile): 20:06:35.434561 => 20:06:35.624334
[0m20:06:35.637424 [debug] [Thread-3 (]: Finished running node model.crypto_analytics.int_crypto_hourly_aggs
[0m20:06:35.627161 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.int_crypto_daily_aggs (compile): 20:06:35.296418 => 20:06:35.626612
[0m20:06:35.668496 [debug] [Thread-2 (]: Finished running node model.crypto_analytics.int_crypto_daily_aggs
[0m20:06:35.649166 [debug] [Thread-3 (]: Began running node model.crypto_analytics.mart_crypto_hourly_performance
[0m20:06:35.647764 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.mart_crypto_latest_prices (compile): 20:06:35.536795 => 20:06:35.646924
[0m20:06:35.691574 [info ] [Thread-3 (]: 5 of 5 START sql table model public_marts.mart_crypto_hourly_performance ....... [RUN]
[0m20:06:35.713389 [debug] [Thread-1 (]: Began executing node model.crypto_analytics.mart_crypto_latest_prices
[0m20:06:35.721900 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.int_crypto_hourly_aggs, now model.crypto_analytics.mart_crypto_hourly_performance)
[0m20:06:35.742992 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics.mart_crypto_latest_prices"
[0m20:06:35.747203 [debug] [Thread-3 (]: Began compiling node model.crypto_analytics.mart_crypto_hourly_performance
[0m20:06:35.783224 [debug] [Thread-4 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m20:06:35.806323 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: COMMIT
[0m20:06:35.816869 [debug] [Thread-3 (]: Writing injected SQL for node "model.crypto_analytics.mart_crypto_hourly_performance"
[0m20:06:35.819347 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m20:06:35.823175 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m20:06:35.836094 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: BEGIN
[0m20:06:35.854118 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: COMMIT
[0m20:06:35.861040 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:35.931555 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:06:35.994322 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m20:06:36.071003 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */




  create  table "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_tmp"


    as

  (


WITH latest_prices AS (
    SELECT
        symbol,
        crypto_name,
        price_usd,
        market_cap,
        volume_24h,
        price_change_24h,
        price_change_pct_24h,
        market_cap_rank,
        extracted_at,

        ROW_NUMBER() OVER (
            PARTITION BY symbol
            ORDER BY extracted_at DESC
        ) as rn

    FROM "crypto_warehouse"."public_staging"."stg_crypto_prices"
    WHERE extraction_date = CURRENT_DATE
),

price_changes AS (
    SELECT
        symbol,
        crypto_name,
        price_usd as current_price,
        market_cap,
        volume_24h,
        price_change_24h,
        price_change_pct_24h,
        market_cap_rank,
        extracted_at as last_updated,

        -- Calculate additional metrics
        CASE
            WHEN price_change_pct_24h > 10 THEN 'Strong Gain'
            WHEN price_change_pct_24h > 5 THEN 'Moderate Gain'
            WHEN price_change_pct_24h > 0 THEN 'Slight Gain'
            WHEN price_change_pct_24h > -5 THEN 'Slight Loss'
            WHEN price_change_pct_24h > -10 THEN 'Moderate Loss'
            ELSE 'Strong Loss'
        END as price_trend_category,

        -- Market cap category
        CASE
            WHEN market_cap_rank <= 10 THEN 'Large Cap'
            WHEN market_cap_rank <= 50 THEN 'Mid Cap'
            WHEN market_cap_rank <= 100 THEN 'Small Cap'
            ELSE 'Micro Cap'
        END as market_cap_category

    FROM latest_prices
    WHERE rn = 1
)

SELECT * FROM price_changes
  );

[0m20:06:36.110081 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m20:06:36.192828 [debug] [Thread-4 (]: Applying DROP to: "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_backup"
[0m20:06:36.248906 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m20:06:36.263857 [debug] [Thread-3 (]: Timing info for model.crypto_analytics.mart_crypto_hourly_performance (compile): 20:06:35.760361 => 20:06:36.263226
[0m20:06:36.282398 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */
drop table if exists "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_backup" cascade
[0m20:06:36.330139 [debug] [Thread-3 (]: Began executing node model.crypto_analytics.mart_crypto_hourly_performance
[0m20:06:36.401761 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.0 seconds
[0m20:06:36.486561 [debug] [Thread-3 (]: Writing runtime sql for node "model.crypto_analytics.mart_crypto_hourly_performance"
[0m20:06:36.502553 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m20:06:36.558646 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_latest_prices" rename to "mart_crypto_latest_prices__dbt_backup"
[0m20:06:36.574494 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:06:36.631275 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m20:06:36.687163 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_tmp" rename to "mart_crypto_latest_prices"
[0m20:06:36.751459 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:06:36.778962 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m20:06:36.794192 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */

    create  index if not exists
  "446768f6d7da36e5d00ecc0f3641a4ca"
  on "crypto_warehouse"."public_marts"."mart_crypto_latest_prices" using btree
  (symbol);

[0m20:06:36.818171 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:06:36.835914 [debug] [Thread-4 (]: Timing info for model.crypto_analytics.mart_pipeline_monitoring (execute): 20:06:34.602228 => 20:06:36.835231
[0m20:06:36.836991 [debug] [Thread-3 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m20:06:36.845709 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: Close
[0m20:06:36.854857 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: BEGIN
[0m20:06:36.865395 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fbc0c49d-ac35-4aab-bb7e-0c25d887edbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc8463cb90>]}
[0m20:06:36.874797 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:06:36.882560 [info ] [Thread-4 (]: 3 of 5 OK created sql table model public_marts.mart_pipeline_monitoring ........ [[32mSELECT 2[0m in 2.35s]
[0m20:06:36.894807 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m20:06:36.902749 [debug] [Thread-4 (]: Finished running node model.crypto_analytics.mart_pipeline_monitoring
[0m20:06:36.910054 [debug] [Thread-3 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m20:06:36.929893 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */




  create  table "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_tmp"


    as

  (


WITH  __dbt__cte__int_crypto_hourly_aggs as (


WITH base_data AS (
    SELECT
        symbol,
        crypto_name,
        DATE_TRUNC('hour', extracted_at) AS extraction_hour,
        price_usd,
        volume_24h,
        market_cap,
        CASE WHEN price_usd <= 0 THEN 1 ELSE 0 END AS is_invalid
    FROM "crypto_warehouse"."public_staging"."stg_crypto_prices"
)

SELECT
    symbol,
    crypto_name,
    extraction_hour,
    COUNT(*) AS total_records,
    SUM(is_invalid) AS invalid_price_records,
    AVG(price_usd) AS avg_price_usd,
    MIN(price_usd) AS min_price_usd,
    MAX(price_usd) AS max_price_usd,
    STDDEV(price_usd) AS price_volatility,
    AVG(volume_24h) AS avg_volume_24h,
    AVG(market_cap) AS avg_market_cap
FROM base_data
GROUP BY symbol, crypto_name, extraction_hour
), hourly_data AS (
    SELECT
        symbol,
        crypto_name,
        extraction_hour,
        avg_price_usd,
        min_price_usd,
        max_price_usd,
        price_volatility,
        avg_volume_24h,
        avg_market_cap,
        total_records,

        -- Calculate hourly change
        LAG(avg_price_usd) OVER (
            PARTITION BY symbol
            ORDER BY extraction_hour
        ) as previous_hour_price,

        -- Data quality score
        (1.0 - (invalid_price_records::FLOAT / GREATEST(total_records, 1))) * 100 as data_quality_score

    FROM __dbt__cte__int_crypto_hourly_aggs
),

performance_metrics AS (
    SELECT
        *,
        CASE
            WHEN previous_hour_price IS NOT NULL AND previous_hour_price > 0 THEN
                ((avg_price_usd - previous_hour_price) / previous_hour_price) * 100
            ELSE NULL
        END as hourly_change_pct,

        -- Volatility category
        CASE
            WHEN price_volatility IS NULL THEN 'Unknown'
            WHEN price_volatility < avg_price_usd * 0.01 THEN 'Low Volatility'
            WHEN price_volatility < avg_price_usd * 0.05 THEN 'Medium Volatility'
            ELSE 'High Volatility'
        END as volatility_category

    FROM hourly_data
)

SELECT * FROM performance_metrics
  );

[0m20:06:37.307700 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m20:06:37.318597 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m20:06:37.327893 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */

    create  index if not exists
  "16a6c88fbf9ceedfad77b181d3407b0f"
  on "crypto_warehouse"."public_marts"."mart_crypto_latest_prices" using btree
  (market_cap_rank);

[0m20:06:37.743917 [debug] [Thread-3 (]: SQL status: SELECT 5 in 1.0 seconds
[0m20:06:37.757703 [debug] [Thread-3 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m20:06:37.769193 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance" rename to "mart_crypto_hourly_performance__dbt_backup"
[0m20:06:37.776318 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:06:37.788796 [debug] [Thread-3 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m20:06:37.795889 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_tmp" rename to "mart_crypto_hourly_performance"
[0m20:06:37.803222 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:06:37.815133 [debug] [Thread-3 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m20:06:37.820586 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */

    create  index if not exists
  "344462d2596165f6c56ccb0424c1a04b"
  on "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance" using btree
  (symbol, extraction_hour);

[0m20:06:38.131164 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 1.0 seconds
[0m20:06:38.143782 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: COMMIT
[0m20:06:38.151715 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m20:06:38.160038 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: COMMIT
[0m20:06:38.437123 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:06:38.449888 [debug] [Thread-1 (]: Applying DROP to: "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_backup"
[0m20:06:38.459156 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m20:06:38.460164 [debug] [Thread-3 (]: SQL status: CREATE INDEX in 1.0 seconds
[0m20:06:38.468509 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */
drop table if exists "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_backup" cascade
[0m20:06:38.483707 [debug] [Thread-3 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m20:06:38.503654 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */

    create  index if not exists
  "44de64e7a26fb1ba20f12b13ee84c72c"
  on "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance" using btree
  (extraction_hour);

[0m20:06:38.571762 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:06:38.603019 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.mart_crypto_latest_prices (execute): 20:06:35.730120 => 20:06:38.602570
[0m20:06:38.617827 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: Close
[0m20:06:38.643123 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fbc0c49d-ac35-4aab-bb7e-0c25d887edbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc847befd0>]}
[0m20:06:38.662195 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public_marts.mart_crypto_latest_prices ....... [[32mSELECT 5[0m in 3.36s]
[0m20:06:38.688275 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.mart_crypto_latest_prices
[0m20:06:38.738699 [debug] [Thread-3 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m20:06:38.783186 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: COMMIT
[0m20:06:38.801793 [debug] [Thread-3 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m20:06:38.841048 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: COMMIT
[0m20:06:38.921612 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m20:06:38.937001 [debug] [Thread-3 (]: Applying DROP to: "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_backup"
[0m20:06:38.948382 [debug] [Thread-3 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m20:06:38.955236 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */
drop table if exists "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_backup" cascade
[0m20:06:39.044257 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:06:39.051102 [debug] [Thread-3 (]: Timing info for model.crypto_analytics.mart_crypto_hourly_performance (execute): 20:06:36.465103 => 20:06:39.050798
[0m20:06:39.057720 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: Close
[0m20:06:39.065958 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fbc0c49d-ac35-4aab-bb7e-0c25d887edbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc848a9550>]}
[0m20:06:39.074069 [info ] [Thread-3 (]: 5 of 5 OK created sql table model public_marts.mart_crypto_hourly_performance .. [[32mSELECT 5[0m in 3.34s]
[0m20:06:39.082216 [debug] [Thread-3 (]: Finished running node model.crypto_analytics.mart_crypto_hourly_performance
[0m20:06:39.091946 [debug] [MainThread]: Using postgres connection "master"
[0m20:06:39.097816 [debug] [MainThread]: On master: BEGIN
[0m20:06:39.103995 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:06:39.118082 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:06:39.127069 [debug] [MainThread]: On master: COMMIT
[0m20:06:39.133981 [debug] [MainThread]: Using postgres connection "master"
[0m20:06:39.140467 [debug] [MainThread]: On master: COMMIT
[0m20:06:39.148059 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:06:39.154458 [debug] [MainThread]: On master: Close
[0m20:06:39.161590 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:06:39.168489 [debug] [MainThread]: Connection 'model.crypto_analytics.int_crypto_daily_aggs' was properly closed.
[0m20:06:39.175026 [debug] [MainThread]: Connection 'model.crypto_analytics.mart_crypto_hourly_performance' was properly closed.
[0m20:06:39.182043 [debug] [MainThread]: Connection 'model.crypto_analytics.mart_crypto_latest_prices' was properly closed.
[0m20:06:39.189248 [debug] [MainThread]: Connection 'model.crypto_analytics.mart_pipeline_monitoring' was properly closed.
[0m20:06:39.196541 [info ] [MainThread]:
[0m20:06:39.203510 [info ] [MainThread]: Finished running 1 view model, 4 table models in 0 hours 0 minutes and 6.51 seconds (6.51s).
[0m20:06:39.212613 [debug] [MainThread]: Command end result
[0m20:06:39.336647 [info ] [MainThread]:
[0m20:06:39.345694 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:06:39.352482 [info ] [MainThread]:
[0m20:06:39.359216 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m20:06:39.368569 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.057372, "process_user_time": 8.500686, "process_kernel_time": 0.672147, "process_mem_max_rss": "121336", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:06:39.376105 [debug] [MainThread]: Command `dbt run` succeeded at 20:06:39.375601 after 9.06 seconds
[0m20:06:39.383458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc86155f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc8ab4d510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc8ab4cad0>]}
[0m20:06:39.390471 [debug] [MainThread]: Flushing usage events
[0m20:45:39.111699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94be161b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94be15b810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94be1a3c50>]}
[0m20:45:39.111613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96a07c6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96a07d4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96a0c6590>]}
[0m20:45:39.111624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae1f247b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae1f228fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae20d1cb90>]}


============================== 20:45:39.513095 | 75e00dd1-9ab6-4225-85e7-9224fe7d786d ==============================
[0m20:45:39.513095 [info ] [MainThread]: Running with dbt=1.7.0


============================== 20:45:39.524649 | ac9d474c-c6e4-4dce-b9f2-264f4eefa7ec ==============================
[0m20:45:39.524649 [info ] [MainThread]: Running with dbt=1.7.0


============================== 20:45:39.513094 | 6429f48a-3f70-4c67-b504-566543b3b0f3 ==============================
[0m20:45:39.513094 [info ] [MainThread]: Running with dbt=1.7.0
[0m20:45:39.534745 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'debug': 'False', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /app/dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:45:39.542144 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'profiles_dir': '/app', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug --project-dir /app/dbt', 'send_anonymous_usage_stats': 'True'}
[0m20:45:39.544562 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/app/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug --project-dir /app/dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:45:39.575328 [info ] [MainThread]: dbt version: 1.7.0
[0m20:45:39.576209 [info ] [MainThread]: dbt version: 1.7.0
[0m20:45:39.589279 [info ] [MainThread]: python version: 3.11.13
[0m20:45:39.591151 [info ] [MainThread]: python version: 3.11.13
[0m20:45:39.602517 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m20:45:39.605784 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m20:45:39.612056 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m20:45:39.620534 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m20:45:45.043754 [info ] [MainThread]: Using profiles dir at /app
[0m20:45:45.065648 [info ] [MainThread]: Using profiles.yml file at /app/profiles.yml
[0m20:45:45.086488 [info ] [MainThread]: Using dbt_project.yml file at /app/dbt/dbt_project.yml
[0m20:45:45.094843 [info ] [MainThread]: Using profiles dir at /app
[0m20:45:45.104873 [info ] [MainThread]: Using profiles.yml file at /app/profiles.yml
[0m20:45:45.117870 [info ] [MainThread]: Using dbt_project.yml file at /app/dbt/dbt_project.yml
[0m20:45:45.139324 [info ] [MainThread]: adapter type: postgres
[0m20:45:45.152115 [info ] [MainThread]: adapter type: postgres
[0m20:45:45.157222 [info ] [MainThread]: adapter version: 1.7.0
[0m20:45:45.179144 [info ] [MainThread]: adapter version: 1.7.0
[0m20:45:46.006378 [info ] [MainThread]: Configuration:
[0m20:45:46.048926 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:45:46.119733 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:45:46.221126 [info ] [MainThread]: Configuration:
[0m20:45:46.300736 [info ] [MainThread]: Required dependencies:
[0m20:45:46.318337 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:45:46.362606 [debug] [MainThread]: Executing "git --help"
[0m20:45:46.367731 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:45:46.389747 [info ] [MainThread]: Required dependencies:
[0m20:45:46.404384 [debug] [MainThread]: Executing "git --help"
[0m20:45:47.972156 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:45:47.972736 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:45:48.382240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75e00dd1-9ab6-4225-85e7-9224fe7d786d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94be098f10>]}
[0m20:45:48.539928 [debug] [MainThread]: STDERR: "b''"
[0m20:45:48.526431 [debug] [MainThread]: STDERR: "b''"
[0m20:45:48.690827 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:45:48.702893 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:45:49.005645 [info ] [MainThread]: Connection:
[0m20:45:49.006712 [info ] [MainThread]: Connection:
[0m20:45:49.045621 [info ] [MainThread]:   host: postgres
[0m20:45:49.059257 [info ] [MainThread]:   host: postgres
[0m20:45:49.087747 [info ] [MainThread]:   port: 5432
[0m20:45:49.104884 [info ] [MainThread]:   port: 5432
[0m20:45:49.128544 [info ] [MainThread]:   user: postgres
[0m20:45:49.301951 [info ] [MainThread]:   user: postgres
[0m20:45:49.388717 [info ] [MainThread]:   database: crypto_warehouse
[0m20:45:49.399692 [info ] [MainThread]:   database: crypto_warehouse
[0m20:45:49.407326 [info ] [MainThread]:   schema: public
[0m20:45:49.409320 [info ] [MainThread]:   schema: public
[0m20:45:49.427056 [info ] [MainThread]:   connect_timeout: 10
[0m20:45:49.441351 [info ] [MainThread]:   role: None
[0m20:45:49.459292 [info ] [MainThread]:   search_path: None
[0m20:45:49.437475 [info ] [MainThread]:   connect_timeout: 10
[0m20:45:49.508351 [info ] [MainThread]:   keepalives_idle: 0
[0m20:45:49.510519 [info ] [MainThread]:   role: None
[0m20:45:49.594106 [info ] [MainThread]:   search_path: None
[0m20:45:49.574080 [info ] [MainThread]:   sslmode: None
[0m20:45:49.633589 [info ] [MainThread]:   sslcert: None
[0m20:45:49.633536 [info ] [MainThread]:   keepalives_idle: 0
[0m20:45:49.642746 [info ] [MainThread]:   sslkey: None
[0m20:45:49.642744 [info ] [MainThread]:   sslmode: None
[0m20:45:49.656811 [info ] [MainThread]:   sslcert: None
[0m20:45:49.655764 [info ] [MainThread]:   sslrootcert: None
[0m20:45:49.670572 [info ] [MainThread]:   application_name: dbt
[0m20:45:49.669129 [info ] [MainThread]:   sslkey: None
[0m20:45:49.681696 [info ] [MainThread]:   retries: 1
[0m20:45:49.683649 [info ] [MainThread]:   sslrootcert: None
[0m20:45:49.690142 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m20:45:49.691884 [info ] [MainThread]:   application_name: dbt
[0m20:45:49.704870 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m20:45:49.706900 [info ] [MainThread]:   retries: 1
[0m20:45:49.717786 [debug] [MainThread]: Using postgres connection "debug"
[0m20:45:49.720226 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m20:45:49.734516 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m20:45:49.733828 [debug] [MainThread]: On debug: select 1 as id
[0m20:45:49.752308 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:45:49.750652 [debug] [MainThread]: Using postgres connection "debug"
[0m20:45:49.784178 [debug] [MainThread]: On debug: select 1 as id
[0m20:45:49.821946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '75e00dd1-9ab6-4225-85e7-9224fe7d786d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94be636990>]}
[0m20:45:49.826937 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:45:49.872083 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m20:45:50.138951 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m20:45:50.353558 [debug] [MainThread]: SQL status: SELECT 1 in 1.0 seconds
[0m20:45:50.354208 [debug] [MainThread]: SQL status: SELECT 1 in 1.0 seconds
[0m20:45:50.368064 [debug] [MainThread]: On debug: Close
[0m20:45:50.371049 [debug] [MainThread]: On debug: Close
[0m20:45:50.382382 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:45:50.386440 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:45:50.393300 [info ] [MainThread]: [32mAll checks passed![0m
[0m20:45:50.399510 [info ] [MainThread]: [32mAll checks passed![0m
[0m20:45:50.594882 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 13.20923, "process_user_time": 6.903705, "process_kernel_time": 0.88509, "process_mem_max_rss": "111200", "process_in_blocks": "23648", "process_out_blocks": "1056"}
[0m20:45:50.596281 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 13.204251, "process_user_time": 5.641847, "process_kernel_time": 0.628015, "process_mem_max_rss": "110960", "process_in_blocks": "4784", "process_out_blocks": "256"}
[0m20:45:50.621211 [debug] [MainThread]: Command `dbt debug` succeeded at 20:45:50.620747 after 13.23 seconds
[0m20:45:50.619929 [debug] [MainThread]: Command `dbt debug` succeeded at 20:45:50.619456 after 13.23 seconds
[0m20:45:50.649019 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:45:50.650172 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:45:50.680343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96a0d02d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96a0c7b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96a555810>]}
[0m20:45:50.681552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae20721510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae1f7c0550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae1f223dd0>]}
[0m20:45:50.725994 [debug] [MainThread]: Flushing usage events
[0m20:45:50.741739 [debug] [MainThread]: Flushing usage events
[0m20:45:56.780744 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m20:45:56.793058 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m20:46:14.504235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0ee967dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0eee1dd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0eee1dad0>]}


============================== 20:46:14.522470 | 820a628d-e001-48a7-ada7-85a3e61761e0 ==============================
[0m20:46:14.522470 [info ] [MainThread]: Running with dbt=1.7.0
[0m20:46:14.532650 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'debug': 'False', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug --project-dir /app/dbt', 'send_anonymous_usage_stats': 'True'}
[0m20:46:14.554650 [info ] [MainThread]: dbt version: 1.7.0
[0m20:46:14.562811 [info ] [MainThread]: python version: 3.11.13
[0m20:46:14.573688 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m20:46:14.583275 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m20:46:14.816727 [info ] [MainThread]: Using profiles dir at /app
[0m20:46:14.823029 [info ] [MainThread]: Using profiles.yml file at /app/profiles.yml
[0m20:46:14.829244 [info ] [MainThread]: Using dbt_project.yml file at /app/dbt/dbt_project.yml
[0m20:46:14.835833 [info ] [MainThread]: adapter type: postgres
[0m20:46:14.841818 [info ] [MainThread]: adapter version: 1.7.0
[0m20:46:15.039305 [info ] [MainThread]: Configuration:
[0m20:46:15.048322 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:46:15.058040 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:46:15.074463 [info ] [MainThread]: Required dependencies:
[0m20:46:15.087631 [debug] [MainThread]: Executing "git --help"
[0m20:46:15.112755 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:46:15.122303 [debug] [MainThread]: STDERR: "b''"
[0m20:46:15.129873 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:46:15.136080 [info ] [MainThread]: Connection:
[0m20:46:15.142041 [info ] [MainThread]:   host: postgres
[0m20:46:15.148663 [info ] [MainThread]:   port: 5432
[0m20:46:15.157092 [info ] [MainThread]:   user: postgres
[0m20:46:15.165520 [info ] [MainThread]:   database: crypto_warehouse
[0m20:46:15.174026 [info ] [MainThread]:   schema: public
[0m20:46:15.181761 [info ] [MainThread]:   connect_timeout: 10
[0m20:46:15.188684 [info ] [MainThread]:   role: None
[0m20:46:15.194649 [info ] [MainThread]:   search_path: None
[0m20:46:15.201493 [info ] [MainThread]:   keepalives_idle: 0
[0m20:46:15.208255 [info ] [MainThread]:   sslmode: None
[0m20:46:15.214400 [info ] [MainThread]:   sslcert: None
[0m20:46:15.220606 [info ] [MainThread]:   sslkey: None
[0m20:46:15.226727 [info ] [MainThread]:   sslrootcert: None
[0m20:46:15.233979 [info ] [MainThread]:   application_name: dbt
[0m20:46:15.239935 [info ] [MainThread]:   retries: 1
[0m20:46:15.246482 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m20:46:15.253696 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m20:46:15.260541 [debug] [MainThread]: Using postgres connection "debug"
[0m20:46:15.267091 [debug] [MainThread]: On debug: select 1 as id
[0m20:46:15.273119 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:46:15.285079 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m20:46:15.294640 [debug] [MainThread]: On debug: Close
[0m20:46:15.301663 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:46:15.309184 [info ] [MainThread]: [32mAll checks passed![0m
[0m20:46:15.316669 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.0928159, "process_user_time": 7.949171, "process_kernel_time": 0.465218, "process_mem_max_rss": "110928", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:46:15.323203 [debug] [MainThread]: Command `dbt debug` succeeded at 20:46:15.322928 after 1.10 seconds
[0m20:46:15.331080 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:46:15.339183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0ee9e0bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0ee9cbbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0ee9cb9d0>]}
[0m20:46:15.346276 [debug] [MainThread]: Flushing usage events
[0m20:46:27.638133 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:46:27.644444 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:46:27.667826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75e00dd1-9ab6-4225-85e7-9224fe7d786d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94bc6b7d10>]}
[0m20:46:27.989840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75e00dd1-9ab6-4225-85e7-9224fe7d786d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94bc7ba390>]}
[0m20:46:27.996911 [info ] [MainThread]: Found 7 models, 14 tests, 2 sources, 0 exposures, 0 metrics, 403 macros, 0 groups, 0 semantic models
[0m20:46:28.006110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75e00dd1-9ab6-4225-85e7-9224fe7d786d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94bc93f690>]}
[0m20:46:28.020375 [info ] [MainThread]:
[0m20:46:28.029396 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:46:28.040485 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse'
[0m20:46:28.043094 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse'
[0m20:46:28.076345 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse"
[0m20:46:28.081026 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse"
[0m20:46:28.087140 [debug] [ThreadPool]: On list_crypto_warehouse: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse"} */

    select distinct nspname from pg_namespace

[0m20:46:28.094413 [debug] [ThreadPool]: On list_crypto_warehouse: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse"} */

    select distinct nspname from pg_namespace

[0m20:46:28.100266 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:46:28.106564 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:46:28.119262 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m20:46:28.128526 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m20:46:28.131329 [debug] [ThreadPool]: On list_crypto_warehouse: Close
[0m20:46:28.139970 [debug] [ThreadPool]: On list_crypto_warehouse: Close
[0m20:46:28.157031 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_warehouse, now list_crypto_warehouse_public_staging)
[0m20:46:28.159019 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_warehouse, now list_crypto_warehouse_public_dbt_test__audit)
[0m20:46:28.161428 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse_public_marts'
[0m20:46:28.176861 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_staging"
[0m20:46:28.185027 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_dbt_test__audit"
[0m20:46:28.193611 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_marts"
[0m20:46:28.199994 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: BEGIN
[0m20:46:28.205861 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: BEGIN
[0m20:46:28.212582 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: BEGIN
[0m20:46:28.218672 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:46:28.224649 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:46:28.230399 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:46:28.242113 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:46:28.249968 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:46:28.258815 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:46:28.260297 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_staging"
[0m20:46:28.267655 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_dbt_test__audit"
[0m20:46:28.273658 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_marts"
[0m20:46:28.279946 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_staging"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'

[0m20:46:28.287838 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_dbt_test__audit"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'

[0m20:46:28.294542 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_marts"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'

[0m20:46:31.262722 [debug] [ThreadPool]: SQL status: SELECT 0 in 3.0 seconds
[0m20:46:31.264636 [debug] [ThreadPool]: SQL status: SELECT 2 in 3.0 seconds
[0m20:46:31.263595 [debug] [ThreadPool]: SQL status: SELECT 3 in 3.0 seconds
[0m20:46:31.275117 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: ROLLBACK
[0m20:46:31.285836 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: ROLLBACK
[0m20:46:31.300636 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: ROLLBACK
[0m20:46:31.310741 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: Close
[0m20:46:31.324447 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: Close
[0m20:46:31.339877 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: Close
[0m20:46:31.432294 [debug] [MainThread]: Using postgres connection "master"
[0m20:46:31.446233 [debug] [MainThread]: On master: BEGIN
[0m20:46:31.457866 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:46:31.474222 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:46:31.485638 [debug] [MainThread]: Using postgres connection "master"
[0m20:46:31.495029 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:46:33.556166 [debug] [MainThread]: SQL status: SELECT 1 in 2.0 seconds
[0m20:46:33.564308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75e00dd1-9ab6-4225-85e7-9224fe7d786d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94bc81e010>]}
[0m20:46:33.573928 [debug] [MainThread]: On master: ROLLBACK
[0m20:46:33.582092 [debug] [MainThread]: Using postgres connection "master"
[0m20:46:33.589613 [debug] [MainThread]: On master: BEGIN
[0m20:46:33.597986 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:46:33.604826 [debug] [MainThread]: On master: COMMIT
[0m20:46:33.611334 [debug] [MainThread]: Using postgres connection "master"
[0m20:46:33.618625 [debug] [MainThread]: On master: COMMIT
[0m20:46:33.626595 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:46:33.633666 [debug] [MainThread]: On master: Close
[0m20:46:33.641780 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:46:33.650043 [info ] [MainThread]:
[0m20:46:33.858103 [debug] [Thread-1 (]: Began running node model.crypto_analytics.stg_crypto_prices
[0m20:46:33.859095 [debug] [Thread-2 (]: Began running node model.crypto_analytics.stg_pipeline_runs
[0m20:46:33.865542 [info ] [Thread-1 (]: 1 of 5 START sql table model public_staging.stg_crypto_prices .................. [RUN]
[0m20:46:33.872234 [info ] [Thread-2 (]: 2 of 5 START sql view model public_staging.stg_pipeline_runs ................... [RUN]
[0m20:46:33.881270 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_marts, now model.crypto_analytics.stg_crypto_prices)
[0m20:46:33.887991 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_staging, now model.crypto_analytics.stg_pipeline_runs)
[0m20:46:33.895499 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics.stg_crypto_prices
[0m20:46:33.905931 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics.stg_pipeline_runs
[0m20:46:33.938041 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics.stg_crypto_prices"
[0m20:46:33.946526 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics.stg_pipeline_runs"
[0m20:46:34.028833 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.stg_pipeline_runs (compile): 20:46:33.939291 => 20:46:34.027995
[0m20:46:34.036873 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.stg_crypto_prices (compile): 20:46:33.912939 => 20:46:34.035963
[0m20:46:34.038407 [debug] [Thread-2 (]: Began executing node model.crypto_analytics.stg_pipeline_runs
[0m20:46:34.046230 [debug] [Thread-1 (]: Began executing node model.crypto_analytics.stg_crypto_prices
[0m20:46:34.133627 [debug] [Thread-2 (]: Writing runtime sql for node "model.crypto_analytics.stg_pipeline_runs"
[0m20:46:34.366209 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics.stg_crypto_prices"
[0m20:46:34.678061 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m20:46:34.686076 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: BEGIN
[0m20:46:34.694233 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:46:34.707845 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m20:46:34.716311 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m20:46:34.724591 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */

  create view "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_tmp"


  as (
    SELECT
    id as run_id,
    run_id as run_identifier,
    stage,
    status,
    records_processed,
    error_message,
    started_at,
    completed_at,
    CASE
        WHEN completed_at IS NOT NULL
        THEN EXTRACT(EPOCH FROM (completed_at - started_at))
        ELSE NULL
    END as duration_seconds
FROM "crypto_warehouse"."public"."pipeline_runs"
  );
[0m20:46:34.905868 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m20:46:34.915185 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: BEGIN
[0m20:46:34.923964 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:46:34.937774 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:46:34.946168 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m20:46:34.955187 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */




  create  table "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_tmp"


    as

  (


WITH source_data AS (
    SELECT
        id as price_id,
        UPPER(TRIM(symbol)) as symbol,
        TRIM(name) as crypto_name,
        current_price as price_usd,
        market_cap,
        total_volume as volume_24h,
        price_change_24h,
        price_change_percentage_24h as price_change_pct_24h,
        market_cap_rank,
        extracted_at,
        created_at,

        CASE WHEN current_price <= 0 THEN TRUE ELSE FALSE END as is_invalid_price,
        CASE WHEN market_cap <= 0 THEN TRUE ELSE FALSE END as is_invalid_market_cap,
        CASE WHEN total_volume < 0 THEN TRUE ELSE FALSE END as is_invalid_volume
    FROM "crypto_warehouse"."public"."crypto_prices_raw"
),

cleaned_data AS (
    SELECT
        *,
        DATE(extracted_at) as extraction_date,
        DATE_TRUNC('hour', extracted_at) as extraction_hour,
        CASE
            WHEN LAG(price_usd) OVER (
                PARTITION BY symbol ORDER BY extracted_at
            ) IS NOT NULL THEN
                ((price_usd - LAG(price_usd) OVER (
                    PARTITION BY symbol ORDER BY extracted_at
                )) / LAG(price_usd) OVER (
                    PARTITION BY symbol ORDER BY extracted_at
                )) * 100
        END as price_change_pct_from_previous
    FROM source_data
    WHERE NOT is_invalid_price AND NOT is_invalid_volume
)

SELECT * FROM cleaned_data
  );

[0m20:46:38.855529 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 4.0 seconds
[0m20:46:38.896557 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m20:46:38.940937 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */
alter table "crypto_warehouse"."public_staging"."stg_pipeline_runs" rename to "stg_pipeline_runs__dbt_backup"
[0m20:46:39.095448 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:46:39.115543 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m20:46:39.122354 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */
alter table "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_tmp" rename to "stg_pipeline_runs"
[0m20:46:39.129545 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:46:39.178780 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: COMMIT
[0m20:46:39.186402 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m20:46:39.192831 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: COMMIT
[0m20:46:39.374765 [debug] [Thread-1 (]: SQL status: SELECT 10 in 4.0 seconds
[0m20:46:39.399634 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m20:46:39.408376 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */
alter table "crypto_warehouse"."public_staging"."stg_crypto_prices" rename to "stg_crypto_prices__dbt_backup"
[0m20:46:39.418008 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:46:39.433584 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m20:46:39.443664 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */
alter table "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_tmp" rename to "stg_crypto_prices"
[0m20:46:39.454053 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:46:39.482983 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m20:46:39.491095 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */

        CREATE INDEX IF NOT EXISTS idx_stg_crypto_prices_symbol_time ON "crypto_warehouse"."public_staging"."stg_crypto_prices" (symbol, extracted_at)

[0m20:46:39.499305 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m20:46:39.511764 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: COMMIT
[0m20:46:39.521039 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m20:46:39.529363 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: COMMIT
[0m20:46:39.984173 [debug] [Thread-2 (]: SQL status: COMMIT in 1.0 seconds
[0m20:46:39.985028 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:46:40.004972 [debug] [Thread-2 (]: Applying DROP to: "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_backup"
[0m20:46:40.013615 [debug] [Thread-1 (]: Applying DROP to: "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_backup"
[0m20:46:40.029814 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m20:46:40.041186 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m20:46:40.044987 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */
drop view if exists "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_backup" cascade
[0m20:46:40.051337 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */
drop table if exists "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_backup" cascade
[0m20:46:42.874150 [debug] [Thread-2 (]: SQL status: DROP VIEW in 3.0 seconds
[0m20:46:42.882698 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.stg_pipeline_runs (execute): 20:46:34.057871 => 20:46:42.882094
[0m20:46:42.892909 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: Close
[0m20:46:42.911310 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75e00dd1-9ab6-4225-85e7-9224fe7d786d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94bc5b2890>]}
[0m20:46:42.927758 [info ] [Thread-2 (]: 2 of 5 OK created sql view model public_staging.stg_pipeline_runs .............. [[32mCREATE VIEW[0m in 9.02s]
[0m20:46:42.942748 [debug] [Thread-2 (]: Finished running node model.crypto_analytics.stg_pipeline_runs
[0m20:46:42.955233 [debug] [Thread-4 (]: Began running node model.crypto_analytics.mart_pipeline_monitoring
[0m20:46:42.963511 [info ] [Thread-4 (]: 3 of 5 START sql table model public_marts.mart_pipeline_monitoring ............. [RUN]
[0m20:46:42.976406 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.crypto_analytics.mart_pipeline_monitoring'
[0m20:46:42.990290 [debug] [Thread-4 (]: Began compiling node model.crypto_analytics.mart_pipeline_monitoring
[0m20:46:43.012212 [debug] [Thread-4 (]: Writing injected SQL for node "model.crypto_analytics.mart_pipeline_monitoring"
[0m20:46:43.070831 [debug] [Thread-4 (]: Timing info for model.crypto_analytics.mart_pipeline_monitoring (compile): 20:46:42.997868 => 20:46:43.070325
[0m20:46:43.076863 [debug] [Thread-4 (]: Began executing node model.crypto_analytics.mart_pipeline_monitoring
[0m20:46:43.098562 [debug] [Thread-4 (]: Writing runtime sql for node "model.crypto_analytics.mart_pipeline_monitoring"
[0m20:46:43.161063 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m20:46:43.163809 [debug] [Thread-1 (]: SQL status: DROP TABLE in 3.0 seconds
[0m20:46:43.173435 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: BEGIN
[0m20:46:43.188688 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.stg_crypto_prices (execute): 20:46:34.278497 => 20:46:43.188115
[0m20:46:43.196465 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:46:43.213275 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: Close
[0m20:46:43.237690 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m20:46:43.246180 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75e00dd1-9ab6-4225-85e7-9224fe7d786d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94bc6b6c50>]}
[0m20:46:43.258334 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m20:46:43.281836 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public_staging.stg_crypto_prices ............. [[32mSELECT 10[0m in 9.37s]
[0m20:46:43.305230 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */




  create  table "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_tmp"


    as

  (


WITH pipeline_metrics AS (
    SELECT
        run_id,
        stage,
        status,
        records_processed,
        error_message,
        started_at,
        completed_at,
        EXTRACT(EPOCH FROM completed_at - started_at) AS duration_seconds,

        -- Flag to compute success rate
        CASE WHEN status = 'success' THEN 1 ELSE 0 END AS is_success,

        -- Classify performance
        CASE
            WHEN completed_at IS NULL THEN 'Running'
            WHEN EXTRACT(EPOCH FROM completed_at - started_at) < 30 THEN 'Fast'
            WHEN EXTRACT(EPOCH FROM completed_at - started_at) < 120 THEN 'Normal'
            ELSE 'Slow'
        END AS performance_category

    FROM "crypto_warehouse"."public_staging"."stg_pipeline_runs"
),

latest_status_per_day_stage AS (
    SELECT
        DATE(started_at) AS run_date,
        stage,
        FIRST_VALUE(status) OVER (
            PARTITION BY DATE(started_at), stage
            ORDER BY started_at DESC
        ) AS latest_run_status
    FROM pipeline_metrics
),

daily_summary AS (
    SELECT
        DATE(started_at) AS run_date,
        stage,

        COUNT(*) AS total_runs,
        SUM(is_success) AS successful_runs,
        SUM(records_processed) AS total_records_processed,
        AVG(duration_seconds) AS avg_duration_seconds,
        MAX(duration_seconds) AS max_duration_seconds,
        ROUND(((SUM(is_success)::FLOAT / COUNT(*)) * 100)::NUMERIC, 2) AS success_rate_pct


    FROM pipeline_metrics
    WHERE started_at >= CURRENT_DATE - INTERVAL '30 days'
    GROUP BY DATE(started_at), stage
)

-- Final result combining metrics with latest run status
SELECT
    ds.*,
    ls.latest_run_status
FROM daily_summary ds
LEFT JOIN latest_status_per_day_stage ls
  ON ds.run_date = ls.run_date AND ds.stage = ls.stage
  );

[0m20:46:43.313947 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.stg_crypto_prices
[0m20:46:43.363467 [debug] [Thread-2 (]: Began running node model.crypto_analytics.int_crypto_daily_aggs
[0m20:46:43.364683 [debug] [Thread-3 (]: Began running node model.crypto_analytics.int_crypto_hourly_aggs
[0m20:46:43.366705 [debug] [Thread-1 (]: Began running node model.crypto_analytics.mart_crypto_latest_prices
[0m20:46:43.379646 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.stg_pipeline_runs, now model.crypto_analytics.int_crypto_daily_aggs)
[0m20:46:43.397537 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_dbt_test__audit, now model.crypto_analytics.int_crypto_hourly_aggs)
[0m20:46:43.413771 [info ] [Thread-1 (]: 4 of 5 START sql table model public_marts.mart_crypto_latest_prices ............ [RUN]
[0m20:46:43.445030 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics.int_crypto_daily_aggs
[0m20:46:43.479315 [debug] [Thread-3 (]: Began compiling node model.crypto_analytics.int_crypto_hourly_aggs
[0m20:46:43.494994 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.stg_crypto_prices, now model.crypto_analytics.mart_crypto_latest_prices)
[0m20:46:43.522535 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics.int_crypto_daily_aggs"
[0m20:46:43.679303 [debug] [Thread-3 (]: Writing injected SQL for node "model.crypto_analytics.int_crypto_hourly_aggs"
[0m20:46:43.692603 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics.mart_crypto_latest_prices
[0m20:46:43.945162 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics.mart_crypto_latest_prices"
[0m20:46:44.211160 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.int_crypto_daily_aggs (compile): 20:46:43.509051 => 20:46:44.210472
[0m20:46:44.212418 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.mart_crypto_latest_prices (compile): 20:46:43.753984 => 20:46:44.211694
[0m20:46:44.223193 [debug] [Thread-2 (]: Finished running node model.crypto_analytics.int_crypto_daily_aggs
[0m20:46:44.231265 [debug] [Thread-1 (]: Began executing node model.crypto_analytics.mart_crypto_latest_prices
[0m20:46:44.262625 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics.mart_crypto_latest_prices"
[0m20:46:44.358422 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m20:46:44.369790 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: BEGIN
[0m20:46:44.378632 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:46:44.400526 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:46:44.412783 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m20:46:44.424739 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */




  create  table "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_tmp"


    as

  (


WITH latest_prices AS (
    SELECT
        symbol,
        crypto_name,
        price_usd,
        market_cap,
        volume_24h,
        price_change_24h,
        price_change_pct_24h,
        market_cap_rank,
        extracted_at,

        ROW_NUMBER() OVER (
            PARTITION BY symbol
            ORDER BY extracted_at DESC
        ) as rn

    FROM "crypto_warehouse"."public_staging"."stg_crypto_prices"
    WHERE extraction_date = CURRENT_DATE
),

price_changes AS (
    SELECT
        symbol,
        crypto_name,
        price_usd as current_price,
        market_cap,
        volume_24h,
        price_change_24h,
        price_change_pct_24h,
        market_cap_rank,
        extracted_at as last_updated,

        -- Calculate additional metrics
        CASE
            WHEN price_change_pct_24h > 10 THEN 'Strong Gain'
            WHEN price_change_pct_24h > 5 THEN 'Moderate Gain'
            WHEN price_change_pct_24h > 0 THEN 'Slight Gain'
            WHEN price_change_pct_24h > -5 THEN 'Slight Loss'
            WHEN price_change_pct_24h > -10 THEN 'Moderate Loss'
            ELSE 'Strong Loss'
        END as price_trend_category,

        -- Market cap category
        CASE
            WHEN market_cap_rank <= 10 THEN 'Large Cap'
            WHEN market_cap_rank <= 50 THEN 'Mid Cap'
            WHEN market_cap_rank <= 100 THEN 'Small Cap'
            ELSE 'Micro Cap'
        END as market_cap_category

    FROM latest_prices
    WHERE rn = 1
)

SELECT * FROM price_changes
  );

[0m20:46:44.664016 [debug] [Thread-3 (]: Timing info for model.crypto_analytics.int_crypto_hourly_aggs (compile): 20:46:43.654059 => 20:46:44.663217
[0m20:46:44.678150 [debug] [Thread-3 (]: Finished running node model.crypto_analytics.int_crypto_hourly_aggs
[0m20:46:44.694585 [debug] [Thread-2 (]: Began running node model.crypto_analytics.mart_crypto_hourly_performance
[0m20:46:44.710805 [info ] [Thread-2 (]: 5 of 5 START sql table model public_marts.mart_crypto_hourly_performance ....... [RUN]
[0m20:46:44.726332 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.int_crypto_daily_aggs, now model.crypto_analytics.mart_crypto_hourly_performance)
[0m20:46:44.741346 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics.mart_crypto_hourly_performance
[0m20:46:44.809526 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics.mart_crypto_hourly_performance"
[0m20:46:45.074708 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.mart_crypto_hourly_performance (compile): 20:46:44.756714 => 20:46:45.073808
[0m20:46:45.088918 [debug] [Thread-2 (]: Began executing node model.crypto_analytics.mart_crypto_hourly_performance
[0m20:46:45.110353 [debug] [Thread-2 (]: Writing runtime sql for node "model.crypto_analytics.mart_crypto_hourly_performance"
[0m20:46:45.160321 [debug] [Thread-1 (]: SQL status: SELECT 5 in 1.0 seconds
[0m20:46:45.203355 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m20:46:45.212433 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_latest_prices" rename to "mart_crypto_latest_prices__dbt_backup"
[0m20:46:45.574082 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m20:46:45.588262 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:46:45.628107 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: BEGIN
[0m20:46:45.729610 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m20:46:45.783738 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:46:45.794150 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_tmp" rename to "mart_crypto_latest_prices"
[0m20:46:45.812301 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m20:46:45.821821 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:46:45.832858 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m20:46:45.908078 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */




  create  table "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_tmp"


    as

  (


WITH  __dbt__cte__int_crypto_hourly_aggs as (


WITH base_data AS (
    SELECT
        symbol,
        crypto_name,
        DATE_TRUNC('hour', extracted_at) AS extraction_hour,
        price_usd,
        volume_24h,
        market_cap,
        CASE WHEN price_usd <= 0 THEN 1 ELSE 0 END AS is_invalid
    FROM "crypto_warehouse"."public_staging"."stg_crypto_prices"
)

SELECT
    symbol,
    crypto_name,
    extraction_hour,
    COUNT(*) AS total_records,
    SUM(is_invalid) AS invalid_price_records,
    AVG(price_usd) AS avg_price_usd,
    MIN(price_usd) AS min_price_usd,
    MAX(price_usd) AS max_price_usd,
    STDDEV(price_usd) AS price_volatility,
    AVG(volume_24h) AS avg_volume_24h,
    AVG(market_cap) AS avg_market_cap
FROM base_data
GROUP BY symbol, crypto_name, extraction_hour
), hourly_data AS (
    SELECT
        symbol,
        crypto_name,
        extraction_hour,
        avg_price_usd,
        min_price_usd,
        max_price_usd,
        price_volatility,
        avg_volume_24h,
        avg_market_cap,
        total_records,

        -- Calculate hourly change
        LAG(avg_price_usd) OVER (
            PARTITION BY symbol
            ORDER BY extraction_hour
        ) as previous_hour_price,

        -- Data quality score
        (1.0 - (invalid_price_records::FLOAT / GREATEST(total_records, 1))) * 100 as data_quality_score

    FROM __dbt__cte__int_crypto_hourly_aggs
),

performance_metrics AS (
    SELECT
        *,
        CASE
            WHEN previous_hour_price IS NOT NULL AND previous_hour_price > 0 THEN
                ((avg_price_usd - previous_hour_price) / previous_hour_price) * 100
            ELSE NULL
        END as hourly_change_pct,

        -- Volatility category
        CASE
            WHEN price_volatility IS NULL THEN 'Unknown'
            WHEN price_volatility < avg_price_usd * 0.01 THEN 'Low Volatility'
            WHEN price_volatility < avg_price_usd * 0.05 THEN 'Medium Volatility'
            ELSE 'High Volatility'
        END as volatility_category

    FROM hourly_data
)

SELECT * FROM performance_metrics
  );

[0m20:46:45.923118 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m20:46:46.056757 [debug] [Thread-4 (]: SQL status: SELECT 4 in 3.0 seconds
[0m20:46:46.109175 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */

    create  index if not exists
  "da36fd03e0a31c2cbe2a4e76a250ca3a"
  on "crypto_warehouse"."public_marts"."mart_crypto_latest_prices" using btree
  (symbol);

[0m20:46:46.198031 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m20:46:47.573331 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */
alter table "crypto_warehouse"."public_marts"."mart_pipeline_monitoring" rename to "mart_pipeline_monitoring__dbt_backup"
[0m20:46:47.669181 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:46:47.693791 [debug] [Thread-2 (]: SQL status: SELECT 10 in 2.0 seconds
[0m20:46:47.748267 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m20:46:47.789842 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m20:46:47.824785 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */
alter table "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_tmp" rename to "mart_pipeline_monitoring"
[0m20:46:47.941443 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance" rename to "mart_crypto_hourly_performance__dbt_backup"
[0m20:46:48.084538 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:46:48.327132 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m20:46:48.400098 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */

    create  index if not exists
  "bebd49dd117143865b74ee9a7023dbf8"
  on "crypto_warehouse"."public_marts"."mart_pipeline_monitoring" using btree
  (run_date);

[0m20:46:48.612510 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:46:48.724210 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 2.0 seconds
[0m20:46:48.846020 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m20:46:48.914449 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m20:46:48.925323 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_tmp" rename to "mart_crypto_hourly_performance"
[0m20:46:48.942546 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */

    create  index if not exists
  "db19628d96e751b977815e943f355cab"
  on "crypto_warehouse"."public_marts"."mart_crypto_latest_prices" using btree
  (market_cap_rank);

[0m20:46:48.959474 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:46:49.047999 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m20:46:49.074952 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */

    create  index if not exists
  "0faa0724ebd7567efa85d636ed04ee25"
  on "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance" using btree
  (symbol, extraction_hour);

[0m20:46:50.171527 [debug] [Thread-4 (]: SQL status: CREATE INDEX in 2.0 seconds
[0m20:46:50.191553 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m20:46:50.203777 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */

    create  index if not exists
  "1ff5b49380855e02b0b49f97ae280386"
  on "crypto_warehouse"."public_marts"."mart_pipeline_monitoring" using btree
  (stage);

[0m20:46:50.961451 [debug] [Thread-2 (]: SQL status: CREATE INDEX in 2.0 seconds
[0m20:46:50.962400 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 2.0 seconds
[0m20:46:50.977890 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m20:46:50.994877 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: COMMIT
[0m20:46:51.011467 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */

    create  index if not exists
  "e3ce9f3123ebff53cf5feadd418376f8"
  on "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance" using btree
  (extraction_hour);

[0m20:46:51.029756 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m20:46:51.051626 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: COMMIT
[0m20:46:51.610802 [debug] [Thread-1 (]: SQL status: COMMIT in 1.0 seconds
[0m20:46:51.645327 [debug] [Thread-1 (]: Applying DROP to: "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_backup"
[0m20:46:51.660399 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m20:46:51.672632 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */
drop table if exists "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_backup" cascade
[0m20:46:51.913432 [debug] [Thread-4 (]: SQL status: CREATE INDEX in 2.0 seconds
[0m20:46:51.930397 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: COMMIT
[0m20:46:51.941441 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m20:46:51.953376 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: COMMIT
[0m20:46:52.173753 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:46:52.191200 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.mart_crypto_latest_prices (execute): 20:46:44.253597 => 20:46:52.190532
[0m20:46:52.201942 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: Close
[0m20:46:52.216905 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75e00dd1-9ab6-4225-85e7-9224fe7d786d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94beabdd90>]}
[0m20:46:52.234434 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public_marts.mart_crypto_latest_prices ....... [[32mSELECT 5[0m in 8.72s]
[0m20:46:52.250344 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.mart_crypto_latest_prices
[0m20:46:52.928943 [debug] [Thread-4 (]: SQL status: COMMIT in 1.0 seconds
[0m20:46:52.961502 [debug] [Thread-4 (]: Applying DROP to: "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_backup"
[0m20:46:53.012047 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m20:46:53.056700 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */
drop table if exists "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_backup" cascade
[0m20:46:53.148344 [debug] [Thread-2 (]: SQL status: CREATE INDEX in 2.0 seconds
[0m20:46:53.170603 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: COMMIT
[0m20:46:53.185957 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m20:46:53.199046 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: COMMIT
[0m20:46:53.392800 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:46:53.424566 [debug] [Thread-4 (]: Timing info for model.crypto_analytics.mart_pipeline_monitoring (execute): 20:46:43.088078 => 20:46:53.424008
[0m20:46:53.441864 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: Close
[0m20:46:53.459513 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75e00dd1-9ab6-4225-85e7-9224fe7d786d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94bc6c6a50>]}
[0m20:46:53.479040 [info ] [Thread-4 (]: 3 of 5 OK created sql table model public_marts.mart_pipeline_monitoring ........ [[32mSELECT 4[0m in 10.48s]
[0m20:46:53.542843 [debug] [Thread-4 (]: Finished running node model.crypto_analytics.mart_pipeline_monitoring
[0m20:46:53.846599 [debug] [Thread-2 (]: SQL status: COMMIT in 1.0 seconds
[0m20:46:53.942838 [debug] [Thread-2 (]: Applying DROP to: "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_backup"
[0m20:46:54.084259 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m20:46:54.122342 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */
drop table if exists "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_backup" cascade
[0m20:46:54.915535 [debug] [Thread-2 (]: SQL status: DROP TABLE in 1.0 seconds
[0m20:46:54.995480 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.mart_crypto_hourly_performance (execute): 20:46:45.095012 => 20:46:54.993945
[0m20:46:55.020261 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: Close
[0m20:46:55.040820 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75e00dd1-9ab6-4225-85e7-9224fe7d786d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94be2cf250>]}
[0m20:46:55.060801 [info ] [Thread-2 (]: 5 of 5 OK created sql table model public_marts.mart_crypto_hourly_performance .. [[32mSELECT 10[0m in 10.32s]
[0m20:46:55.093677 [debug] [Thread-2 (]: Finished running node model.crypto_analytics.mart_crypto_hourly_performance
[0m20:46:55.124021 [debug] [MainThread]: Using postgres connection "master"
[0m20:46:55.154170 [debug] [MainThread]: On master: BEGIN
[0m20:46:55.173612 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:46:55.201407 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:46:55.221026 [debug] [MainThread]: On master: COMMIT
[0m20:46:55.241583 [debug] [MainThread]: Using postgres connection "master"
[0m20:46:55.255223 [debug] [MainThread]: On master: COMMIT
[0m20:46:55.283442 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:46:55.299240 [debug] [MainThread]: On master: Close
[0m20:46:55.321231 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:46:55.349063 [debug] [MainThread]: Connection 'model.crypto_analytics.int_crypto_hourly_aggs' was properly closed.
[0m20:46:55.368416 [debug] [MainThread]: Connection 'model.crypto_analytics.mart_crypto_hourly_performance' was properly closed.
[0m20:46:55.386916 [debug] [MainThread]: Connection 'model.crypto_analytics.mart_crypto_latest_prices' was properly closed.
[0m20:46:55.399434 [debug] [MainThread]: Connection 'model.crypto_analytics.mart_pipeline_monitoring' was properly closed.
[0m20:46:55.409611 [info ] [MainThread]:
[0m20:46:55.422286 [info ] [MainThread]: Finished running 1 view model, 4 table models in 0 hours 0 minutes and 27.38 seconds (27.38s).
[0m20:46:55.436332 [debug] [MainThread]: Command end result
[0m20:46:55.519635 [error] [MainThread]: Encountered an error:
[Errno 22] Invalid argument: '/app/dbt/target/manifest.json'
[0m20:46:58.932401 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 90, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 75, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 197, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 244, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 284, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/main.py", line 625, in run
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 489, in run
    write_manifest(self.manifest, self.config.project_target_path)
  File "/usr/local/lib/python3.11/site-packages/dbt/parser/manifest.py", line 1770, in write_manifest
    manifest.write(path)
  File "/usr/local/lib/python3.11/site-packages/dbt/contracts/graph/manifest.py", line 1030, in write
    self.writable_manifest().write(path)
  File "/usr/local/lib/python3.11/site-packages/dbt/contracts/util.py", line 66, in write
    write_json(path, self.to_dict(omit_none=False))  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/system.py", line 200, in write_json
    return write_file(path, json.dumps(data, cls=dbt.utils.JSONEncoder))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/system.py", line 169, in write_file
    with open(path, "w", encoding="utf-8") as f:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
OSError: [Errno 22] Invalid argument: '/app/dbt/target/manifest.json'

[0m20:46:58.948024 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 81.56672, "process_user_time": 9.583983, "process_kernel_time": 1.212368, "process_mem_max_rss": "121532", "process_in_blocks": "61416", "process_out_blocks": "1968", "command_success": false}
[0m20:46:58.963094 [debug] [MainThread]: Command `dbt run` failed at 20:46:58.962606 after 81.58 seconds
[0m20:46:58.979565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94be1a3750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94bc624f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94bc674810>]}
[0m20:46:58.991991 [debug] [MainThread]: Flushing usage events
[0m20:47:01.399725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad66d71790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad6742dd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad66f665d0>]}


============================== 20:47:01.428587 | a9adf0f0-9405-48ac-af86-76a03bfc30e4 ==============================
[0m20:47:01.428587 [info ] [MainThread]: Running with dbt=1.7.0
[0m20:47:01.441306 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/app/dbt/logs', 'profiles_dir': '/app', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug --project-dir /app/dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:47:01.466512 [info ] [MainThread]: dbt version: 1.7.0
[0m20:47:01.479039 [info ] [MainThread]: python version: 3.11.13
[0m20:47:01.492710 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m20:47:01.501084 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m20:55:34.458424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f332adf47d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f332adefc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f332b37ff90>]}


============================== 20:55:34.482170 | c62d96f0-01cb-4120-908c-05860297cc28 ==============================
[0m20:55:34.482170 [info ] [MainThread]: Running with dbt=1.7.0
[0m20:55:34.491008 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /app/dbt', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:55:35.014214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c62d96f0-01cb-4120-908c-05860297cc28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3329581950>]}
[0m20:55:35.198445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c62d96f0-01cb-4120-908c-05860297cc28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f332acf7850>]}
[0m20:55:35.206520 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m20:55:35.250365 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m20:55:38.417330 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:55:38.431424 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:55:38.461427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c62d96f0-01cb-4120-908c-05860297cc28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f332ae3ccd0>]}
[0m20:55:38.660040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c62d96f0-01cb-4120-908c-05860297cc28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3329598190>]}
[0m20:55:38.668288 [info ] [MainThread]: Found 7 models, 14 tests, 2 sources, 0 exposures, 0 metrics, 403 macros, 0 groups, 0 semantic models
[0m20:55:38.680708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c62d96f0-01cb-4120-908c-05860297cc28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f332acee610>]}
[0m20:55:38.699205 [info ] [MainThread]:
[0m20:55:38.713399 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:55:38.727759 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse'
[0m20:55:38.729979 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse'
[0m20:55:38.767779 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse"
[0m20:55:38.775657 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse"
[0m20:55:38.782012 [debug] [ThreadPool]: On list_crypto_warehouse: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse"} */

    select distinct nspname from pg_namespace

[0m20:55:38.794421 [debug] [ThreadPool]: On list_crypto_warehouse: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse"} */

    select distinct nspname from pg_namespace

[0m20:55:38.801471 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:55:38.812924 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:55:38.841881 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m20:55:38.843393 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m20:55:38.850829 [debug] [ThreadPool]: On list_crypto_warehouse: Close
[0m20:55:38.862998 [debug] [ThreadPool]: On list_crypto_warehouse: Close
[0m20:55:38.894798 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_warehouse, now create_crypto_warehouse_public_marts)
[0m20:55:38.896675 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_warehouse, now create_crypto_warehouse_public_staging)
[0m20:55:38.903666 [debug] [ThreadPool]: Creating schema "database: "crypto_warehouse"
schema: "public_marts"
"
[0m20:55:38.912857 [debug] [ThreadPool]: Creating schema "database: "crypto_warehouse"
schema: "public_staging"
"
[0m20:55:38.944455 [debug] [ThreadPool]: Using postgres connection "create_crypto_warehouse_public_marts"
[0m20:55:38.950278 [debug] [ThreadPool]: Using postgres connection "create_crypto_warehouse_public_staging"
[0m20:55:38.965372 [debug] [ThreadPool]: On create_crypto_warehouse_public_marts: BEGIN
[0m20:55:38.978913 [debug] [ThreadPool]: On create_crypto_warehouse_public_staging: BEGIN
[0m20:55:38.987791 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:55:38.996355 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:55:39.011883 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:55:39.031546 [debug] [ThreadPool]: Using postgres connection "create_crypto_warehouse_public_marts"
[0m20:55:39.033321 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:55:39.044293 [debug] [ThreadPool]: On create_crypto_warehouse_public_marts: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "create_crypto_warehouse_public_marts"} */
create schema if not exists "public_marts"
[0m20:55:39.051578 [debug] [ThreadPool]: Using postgres connection "create_crypto_warehouse_public_staging"
[0m20:55:39.063011 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m20:55:39.071798 [debug] [ThreadPool]: On create_crypto_warehouse_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "create_crypto_warehouse_public_staging"} */
create schema if not exists "public_staging"
[0m20:55:39.079938 [debug] [ThreadPool]: On create_crypto_warehouse_public_marts: COMMIT
[0m20:55:39.091670 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m20:55:39.096785 [debug] [ThreadPool]: Using postgres connection "create_crypto_warehouse_public_marts"
[0m20:55:39.110898 [debug] [ThreadPool]: On create_crypto_warehouse_public_staging: COMMIT
[0m20:55:39.130531 [debug] [ThreadPool]: On create_crypto_warehouse_public_marts: COMMIT
[0m20:55:39.146552 [debug] [ThreadPool]: Using postgres connection "create_crypto_warehouse_public_staging"
[0m20:55:39.176042 [debug] [ThreadPool]: On create_crypto_warehouse_public_staging: COMMIT
[0m20:55:39.266973 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m20:55:39.280856 [debug] [ThreadPool]: On create_crypto_warehouse_public_marts: Close
[0m20:55:39.356784 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m20:55:39.366025 [debug] [ThreadPool]: On create_crypto_warehouse_public_staging: Close
[0m20:55:39.387265 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_warehouse_public_staging, now list_crypto_warehouse_public_dbt_test__audit)
[0m20:55:39.391546 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_warehouse_public_marts, now list_crypto_warehouse_public_marts)
[0m20:55:39.394999 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse_public_staging'
[0m20:55:39.430255 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_dbt_test__audit"
[0m20:55:39.445589 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_marts"
[0m20:55:39.458009 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_staging"
[0m20:55:39.464912 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: BEGIN
[0m20:55:39.479116 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: BEGIN
[0m20:55:39.490559 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: BEGIN
[0m20:55:39.498067 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:55:39.514291 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:55:39.528518 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:55:39.547086 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:55:39.558378 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:55:39.569650 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:55:39.576314 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_dbt_test__audit"
[0m20:55:39.583958 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_marts"
[0m20:55:39.594999 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_staging"
[0m20:55:39.607700 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_dbt_test__audit"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'

[0m20:55:39.615772 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_marts"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'

[0m20:55:39.628707 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_staging"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'

[0m20:55:39.645256 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m20:55:39.658144 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m20:55:39.667086 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m20:55:39.677315 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: ROLLBACK
[0m20:55:39.699998 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: ROLLBACK
[0m20:55:39.763341 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: ROLLBACK
[0m20:55:39.778868 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: Close
[0m20:55:39.791261 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: Close
[0m20:55:39.799332 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: Close
[0m20:55:39.864926 [debug] [MainThread]: Using postgres connection "master"
[0m20:55:39.878674 [debug] [MainThread]: On master: BEGIN
[0m20:55:39.892982 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:55:39.930335 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:55:39.962719 [debug] [MainThread]: Using postgres connection "master"
[0m20:55:39.976950 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:55:40.032061 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m20:55:40.063855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c62d96f0-01cb-4120-908c-05860297cc28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33295d3750>]}
[0m20:55:40.084295 [debug] [MainThread]: On master: ROLLBACK
[0m20:55:40.109959 [debug] [MainThread]: Using postgres connection "master"
[0m20:55:40.128668 [debug] [MainThread]: On master: BEGIN
[0m20:55:40.152068 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:55:40.174798 [debug] [MainThread]: On master: COMMIT
[0m20:55:40.184013 [debug] [MainThread]: Using postgres connection "master"
[0m20:55:40.196504 [debug] [MainThread]: On master: COMMIT
[0m20:55:40.210780 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:55:40.225155 [debug] [MainThread]: On master: Close
[0m20:55:40.234731 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:55:40.248086 [info ] [MainThread]:
[0m20:55:40.297213 [debug] [Thread-1 (]: Began running node model.crypto_analytics.stg_crypto_prices
[0m20:55:40.298979 [debug] [Thread-2 (]: Began running node model.crypto_analytics.stg_pipeline_runs
[0m20:55:40.324494 [info ] [Thread-1 (]: 1 of 5 START sql table model public_staging.stg_crypto_prices .................. [RUN]
[0m20:55:40.342058 [info ] [Thread-2 (]: 2 of 5 START sql view model public_staging.stg_pipeline_runs ................... [RUN]
[0m20:55:40.360212 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_staging, now model.crypto_analytics.stg_crypto_prices)
[0m20:55:40.375260 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_marts, now model.crypto_analytics.stg_pipeline_runs)
[0m20:55:40.389896 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics.stg_crypto_prices
[0m20:55:40.398149 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics.stg_pipeline_runs
[0m20:55:40.476189 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics.stg_crypto_prices"
[0m20:55:40.496720 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics.stg_pipeline_runs"
[0m20:55:40.595090 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.stg_pipeline_runs (compile): 20:55:40.466454 => 20:55:40.594277
[0m20:55:40.611458 [debug] [Thread-2 (]: Began executing node model.crypto_analytics.stg_pipeline_runs
[0m20:55:40.616724 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.stg_crypto_prices (compile): 20:55:40.412409 => 20:55:40.615219
[0m20:55:40.677501 [debug] [Thread-1 (]: Began executing node model.crypto_analytics.stg_crypto_prices
[0m20:55:41.091935 [debug] [Thread-2 (]: Writing runtime sql for node "model.crypto_analytics.stg_pipeline_runs"
[0m20:55:41.207325 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics.stg_crypto_prices"
[0m20:55:41.491884 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m20:55:41.559161 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: BEGIN
[0m20:55:41.577168 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m20:55:41.581949 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:55:41.595810 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: BEGIN
[0m20:55:41.618302 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m20:55:41.628936 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:55:41.643433 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m20:55:41.667190 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:55:41.677288 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */

  create view "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_tmp"


  as (
    SELECT
    id as run_id,
    run_id as run_identifier,
    stage,
    status,
    records_processed,
    error_message,
    started_at,
    completed_at,
    CASE
        WHEN completed_at IS NOT NULL
        THEN EXTRACT(EPOCH FROM (completed_at - started_at))
        ELSE NULL
    END as duration_seconds
FROM "crypto_warehouse"."public"."pipeline_runs"
  );
[0m20:55:41.691650 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m20:55:41.706845 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "public.pipeline_runs" does not exist
LINE 21: FROM "crypto_warehouse"."public"."pipeline_runs"
              ^

[0m20:55:41.713772 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */




  create  table "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_tmp"


    as

  (


WITH source_data AS (
    SELECT
        id as price_id,
        UPPER(TRIM(symbol)) as symbol,
        TRIM(name) as crypto_name,
        current_price as price_usd,
        market_cap,
        total_volume as volume_24h,
        price_change_24h,
        price_change_percentage_24h as price_change_pct_24h,
        market_cap_rank,
        extracted_at,
        created_at,

        CASE WHEN current_price <= 0 THEN TRUE ELSE FALSE END as is_invalid_price,
        CASE WHEN market_cap <= 0 THEN TRUE ELSE FALSE END as is_invalid_market_cap,
        CASE WHEN total_volume < 0 THEN TRUE ELSE FALSE END as is_invalid_volume
    FROM "crypto_warehouse"."public"."crypto_prices_raw"
),

cleaned_data AS (
    SELECT
        *,
        DATE(extracted_at) as extraction_date,
        DATE_TRUNC('hour', extracted_at) as extraction_hour,
        CASE
            WHEN LAG(price_usd) OVER (
                PARTITION BY symbol ORDER BY extracted_at
            ) IS NOT NULL THEN
                ((price_usd - LAG(price_usd) OVER (
                    PARTITION BY symbol ORDER BY extracted_at
                )) / LAG(price_usd) OVER (
                    PARTITION BY symbol ORDER BY extracted_at
                )) * 100
        END as price_change_pct_from_previous
    FROM source_data
    WHERE NOT is_invalid_price AND NOT is_invalid_volume
)

SELECT * FROM cleaned_data
  );

[0m20:55:41.727153 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: ROLLBACK
[0m20:55:41.741864 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.crypto_prices_raw" does not exist
LINE 31:     FROM "crypto_warehouse"."public"."crypto_prices_raw"
                  ^

[0m20:55:41.753390 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.stg_pipeline_runs (execute): 20:55:40.626298 => 20:55:41.751224
[0m20:55:41.760605 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: ROLLBACK
[0m20:55:41.774434 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: Close
[0m20:55:41.789435 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.stg_crypto_prices (execute): 20:55:40.714791 => 20:55:41.788727
[0m20:55:41.811993 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: Close
[0m20:55:42.059004 [debug] [Thread-1 (]: Database Error in model stg_crypto_prices (models/staging/stg_crypto_prices.sql)
  relation "public.crypto_prices_raw" does not exist
  LINE 31:     FROM "crypto_warehouse"."public"."crypto_prices_raw"
                    ^
  compiled Code at target/run/crypto_analytics/models/staging/stg_crypto_prices.sql
[0m20:55:42.246744 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c62d96f0-01cb-4120-908c-05860297cc28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3329265010>]}
[0m20:55:42.274200 [error] [Thread-1 (]: 1 of 5 ERROR creating sql table model public_staging.stg_crypto_prices ......... [[31mERROR[0m in 1.89s]
[0m20:55:42.156777 [debug] [Thread-2 (]: Database Error in model stg_pipeline_runs (models/staging/stg_pipeline_runs.sql)
  relation "public.pipeline_runs" does not exist
  LINE 21: FROM "crypto_warehouse"."public"."pipeline_runs"
                ^
  compiled Code at target/run/crypto_analytics/models/staging/stg_pipeline_runs.sql
[0m20:55:42.327281 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.stg_crypto_prices
[0m20:55:42.367523 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c62d96f0-01cb-4120-908c-05860297cc28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33295c3dd0>]}
[0m20:55:42.405164 [debug] [Thread-4 (]: Began running node model.crypto_analytics.int_crypto_daily_aggs
[0m20:55:42.443334 [debug] [Thread-4 (]: Finished running node model.crypto_analytics.int_crypto_daily_aggs
[0m20:55:42.408652 [debug] [Thread-1 (]: Began running node model.crypto_analytics.mart_crypto_latest_prices
[0m20:55:42.548543 [info ] [Thread-1 (]: 3 of 5 SKIP relation public_marts.mart_crypto_latest_prices .................... [[33mSKIP[0m]
[0m20:55:42.406889 [debug] [Thread-3 (]: Began running node model.crypto_analytics.int_crypto_hourly_aggs
[0m20:55:42.421897 [error] [Thread-2 (]: 2 of 5 ERROR creating sql view model public_staging.stg_pipeline_runs .......... [[31mERROR[0m in 1.99s]
[0m20:55:42.595588 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.mart_crypto_latest_prices
[0m20:55:42.638157 [debug] [Thread-3 (]: Finished running node model.crypto_analytics.int_crypto_hourly_aggs
[0m20:55:42.653173 [debug] [Thread-2 (]: Finished running node model.crypto_analytics.stg_pipeline_runs
[0m20:55:42.674327 [debug] [Thread-4 (]: Began running node model.crypto_analytics.mart_crypto_hourly_performance
[0m20:55:42.682565 [debug] [Thread-3 (]: Began running node model.crypto_analytics.mart_pipeline_monitoring
[0m20:55:42.692288 [info ] [Thread-4 (]: 4 of 5 SKIP relation public_marts.mart_crypto_hourly_performance ............... [[33mSKIP[0m]
[0m20:55:42.705364 [info ] [Thread-3 (]: 5 of 5 SKIP relation public_marts.mart_pipeline_monitoring ..................... [[33mSKIP[0m]
[0m20:55:42.714519 [debug] [Thread-4 (]: Finished running node model.crypto_analytics.mart_crypto_hourly_performance
[0m20:55:42.725415 [debug] [Thread-3 (]: Finished running node model.crypto_analytics.mart_pipeline_monitoring
[0m20:55:42.746582 [debug] [MainThread]: Using postgres connection "master"
[0m20:55:42.755886 [debug] [MainThread]: On master: BEGIN
[0m20:55:42.765237 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:55:42.780994 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:55:42.793862 [debug] [MainThread]: On master: COMMIT
[0m20:55:42.804167 [debug] [MainThread]: Using postgres connection "master"
[0m20:55:42.812330 [debug] [MainThread]: On master: COMMIT
[0m20:55:42.824396 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:55:42.835966 [debug] [MainThread]: On master: Close
[0m20:55:42.857461 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:55:42.874057 [debug] [MainThread]: Connection 'list_crypto_warehouse_public_dbt_test__audit' was properly closed.
[0m20:55:42.886569 [debug] [MainThread]: Connection 'model.crypto_analytics.stg_pipeline_runs' was properly closed.
[0m20:55:42.900752 [debug] [MainThread]: Connection 'model.crypto_analytics.stg_crypto_prices' was properly closed.
[0m20:55:42.909286 [info ] [MainThread]:
[0m20:55:42.918150 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 4.20 seconds (4.20s).
[0m20:55:42.930985 [debug] [MainThread]: Command end result
[0m20:55:43.084447 [info ] [MainThread]:
[0m20:55:43.094972 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m20:55:43.105221 [info ] [MainThread]:
[0m20:55:43.113949 [error] [MainThread]:   Database Error in model stg_crypto_prices (models/staging/stg_crypto_prices.sql)
  relation "public.crypto_prices_raw" does not exist
  LINE 31:     FROM "crypto_warehouse"."public"."crypto_prices_raw"
                    ^
  compiled Code at target/run/crypto_analytics/models/staging/stg_crypto_prices.sql
[0m20:55:43.123442 [info ] [MainThread]:
[0m20:55:43.132726 [error] [MainThread]:   Database Error in model stg_pipeline_runs (models/staging/stg_pipeline_runs.sql)
  relation "public.pipeline_runs" does not exist
  LINE 21: FROM "crypto_warehouse"."public"."pipeline_runs"
                ^
  compiled Code at target/run/crypto_analytics/models/staging/stg_pipeline_runs.sql
[0m20:55:43.141645 [info ] [MainThread]:
[0m20:55:43.150913 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=3 TOTAL=5
[0m20:55:43.160504 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 8.886856, "process_user_time": 13.645094, "process_kernel_time": 3.144927, "process_mem_max_rss": "121772", "process_in_blocks": "440", "process_out_blocks": "1976", "command_success": false}
[0m20:55:43.171042 [debug] [MainThread]: Command `dbt run` failed at 20:55:43.170520 after 8.90 seconds
[0m20:55:43.179641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f332f7a1690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33292a5fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33292a6f90>]}
[0m20:55:43.189710 [debug] [MainThread]: Flushing usage events
[0m20:58:11.821912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f934cfb2810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f934cfab950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f934d53bed0>]}


============================== 20:58:11.859559 | 88f01c7f-76e3-4199-bab4-fba3489b40b8 ==============================
[0m20:58:11.859559 [info ] [MainThread]: Running with dbt=1.7.0
[0m20:58:11.893580 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/app', 'log_path': '/app/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /app/dbt', 'send_anonymous_usage_stats': 'True'}
[0m20:58:12.783088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '88f01c7f-76e3-4199-bab4-fba3489b40b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f934cedf390>]}
[0m20:58:13.049427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '88f01c7f-76e3-4199-bab4-fba3489b40b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f934cede2d0>]}
[0m20:58:13.061351 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m20:58:13.132950 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m20:58:14.740151 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:58:14.745956 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:58:14.775093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '88f01c7f-76e3-4199-bab4-fba3489b40b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f934b517790>]}
[0m20:58:14.995929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '88f01c7f-76e3-4199-bab4-fba3489b40b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f934b667a50>]}
[0m20:58:15.007128 [info ] [MainThread]: Found 7 models, 14 tests, 2 sources, 0 exposures, 0 metrics, 403 macros, 0 groups, 0 semantic models
[0m20:58:15.015015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88f01c7f-76e3-4199-bab4-fba3489b40b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f934cfd53d0>]}
[0m20:58:15.031197 [info ] [MainThread]:
[0m20:58:15.044252 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:58:15.058338 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse'
[0m20:58:15.060650 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse'
[0m20:58:15.136296 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse"
[0m20:58:15.146531 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse"
[0m20:58:15.155321 [debug] [ThreadPool]: On list_crypto_warehouse: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse"} */

    select distinct nspname from pg_namespace

[0m20:58:15.164117 [debug] [ThreadPool]: On list_crypto_warehouse: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse"} */

    select distinct nspname from pg_namespace

[0m20:58:15.178185 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:58:15.192049 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:58:15.213262 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m20:58:15.222260 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m20:58:15.230591 [debug] [ThreadPool]: On list_crypto_warehouse: Close
[0m20:58:15.248215 [debug] [ThreadPool]: On list_crypto_warehouse: Close
[0m20:58:15.278256 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_warehouse, now create_crypto_warehouse_public_staging)
[0m20:58:15.280053 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_warehouse, now create_crypto_warehouse_public_marts)
[0m20:58:15.296277 [debug] [ThreadPool]: Creating schema "database: "crypto_warehouse"
schema: "public_staging"
"
[0m20:58:15.309119 [debug] [ThreadPool]: Creating schema "database: "crypto_warehouse"
schema: "public_marts"
"
[0m20:58:15.339682 [debug] [ThreadPool]: Using postgres connection "create_crypto_warehouse_public_staging"
[0m20:58:15.348431 [debug] [ThreadPool]: Using postgres connection "create_crypto_warehouse_public_marts"
[0m20:58:15.360773 [debug] [ThreadPool]: On create_crypto_warehouse_public_staging: BEGIN
[0m20:58:15.382038 [debug] [ThreadPool]: On create_crypto_warehouse_public_marts: BEGIN
[0m20:58:15.396595 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:58:15.408526 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:58:15.426338 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:58:15.441205 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:58:15.444158 [debug] [ThreadPool]: Using postgres connection "create_crypto_warehouse_public_staging"
[0m20:58:15.459195 [debug] [ThreadPool]: Using postgres connection "create_crypto_warehouse_public_marts"
[0m20:58:15.474179 [debug] [ThreadPool]: On create_crypto_warehouse_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "create_crypto_warehouse_public_staging"} */
create schema if not exists "public_staging"
[0m20:58:15.488010 [debug] [ThreadPool]: On create_crypto_warehouse_public_marts: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "create_crypto_warehouse_public_marts"} */
create schema if not exists "public_marts"
[0m20:58:15.496183 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m20:58:15.508206 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m20:58:15.516817 [debug] [ThreadPool]: On create_crypto_warehouse_public_staging: COMMIT
[0m20:58:15.528692 [debug] [ThreadPool]: On create_crypto_warehouse_public_marts: COMMIT
[0m20:58:15.540014 [debug] [ThreadPool]: Using postgres connection "create_crypto_warehouse_public_staging"
[0m20:58:15.547593 [debug] [ThreadPool]: Using postgres connection "create_crypto_warehouse_public_marts"
[0m20:58:15.559240 [debug] [ThreadPool]: On create_crypto_warehouse_public_staging: COMMIT
[0m20:58:15.570919 [debug] [ThreadPool]: On create_crypto_warehouse_public_marts: COMMIT
[0m20:58:15.790726 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m20:58:15.803337 [debug] [ThreadPool]: On create_crypto_warehouse_public_staging: Close
[0m20:58:15.869269 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m20:58:15.876109 [debug] [ThreadPool]: On create_crypto_warehouse_public_marts: Close
[0m20:58:15.894245 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_warehouse_public_marts, now list_crypto_warehouse_public_staging)
[0m20:58:15.896076 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_warehouse_public_staging, now list_crypto_warehouse_public_marts)
[0m20:58:15.898615 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse_public_dbt_test__audit'
[0m20:58:15.928040 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_staging"
[0m20:58:15.934235 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_marts"
[0m20:58:15.946004 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_dbt_test__audit"
[0m20:58:15.957231 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: BEGIN
[0m20:58:15.963387 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: BEGIN
[0m20:58:15.975156 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: BEGIN
[0m20:58:15.986509 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:58:15.993729 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:58:16.004896 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:58:16.023640 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:58:16.031217 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:58:16.047660 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:58:16.057365 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_staging"
[0m20:58:16.065464 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_marts"
[0m20:58:16.075523 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_dbt_test__audit"
[0m20:58:16.087662 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_staging"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'

[0m20:58:16.095349 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_marts"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'

[0m20:58:16.107380 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_dbt_test__audit"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'

[0m20:58:16.125082 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m20:58:16.138903 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m20:58:16.144041 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m20:58:16.151436 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: ROLLBACK
[0m20:58:16.160324 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: ROLLBACK
[0m20:58:16.174152 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: ROLLBACK
[0m20:58:16.184935 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: Close
[0m20:58:16.192775 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: Close
[0m20:58:16.203421 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: Close
[0m20:58:16.248932 [debug] [MainThread]: Using postgres connection "master"
[0m20:58:16.257875 [debug] [MainThread]: On master: BEGIN
[0m20:58:16.269050 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:58:16.282050 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:58:16.293374 [debug] [MainThread]: Using postgres connection "master"
[0m20:58:16.304777 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:58:16.320899 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m20:58:16.329713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88f01c7f-76e3-4199-bab4-fba3489b40b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f934b5222d0>]}
[0m20:58:16.344509 [debug] [MainThread]: On master: ROLLBACK
[0m20:58:16.358309 [debug] [MainThread]: Using postgres connection "master"
[0m20:58:16.370580 [debug] [MainThread]: On master: BEGIN
[0m20:58:16.378610 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:58:16.390170 [debug] [MainThread]: On master: COMMIT
[0m20:58:16.403645 [debug] [MainThread]: Using postgres connection "master"
[0m20:58:16.412577 [debug] [MainThread]: On master: COMMIT
[0m20:58:16.424031 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:58:16.430220 [debug] [MainThread]: On master: Close
[0m20:58:16.441345 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:58:16.453933 [info ] [MainThread]:
[0m20:58:16.485781 [debug] [Thread-1 (]: Began running node model.crypto_analytics.stg_crypto_prices
[0m20:58:16.487675 [debug] [Thread-2 (]: Began running node model.crypto_analytics.stg_pipeline_runs
[0m20:58:16.494241 [info ] [Thread-1 (]: 1 of 5 START sql table model public_staging.stg_crypto_prices .................. [RUN]
[0m20:58:16.507446 [info ] [Thread-2 (]: 2 of 5 START sql view model public_staging.stg_pipeline_runs ................... [RUN]
[0m20:58:16.521847 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_dbt_test__audit, now model.crypto_analytics.stg_crypto_prices)
[0m20:58:16.529701 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_marts, now model.crypto_analytics.stg_pipeline_runs)
[0m20:58:16.540897 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics.stg_crypto_prices
[0m20:58:16.552159 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics.stg_pipeline_runs
[0m20:58:16.580358 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics.stg_crypto_prices"
[0m20:58:16.591074 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics.stg_pipeline_runs"
[0m20:58:16.648154 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.stg_crypto_prices (compile): 20:58:16.559238 => 20:58:16.646733
[0m20:58:16.658706 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.stg_pipeline_runs (compile): 20:58:16.583571 => 20:58:16.658016
[0m20:58:16.660943 [debug] [Thread-1 (]: Began executing node model.crypto_analytics.stg_crypto_prices
[0m20:58:16.672759 [debug] [Thread-2 (]: Began executing node model.crypto_analytics.stg_pipeline_runs
[0m20:58:16.873604 [debug] [Thread-2 (]: Writing runtime sql for node "model.crypto_analytics.stg_pipeline_runs"
[0m20:58:16.889532 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics.stg_crypto_prices"
[0m20:58:16.942697 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m20:58:16.954850 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: BEGIN
[0m20:58:16.962443 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:58:16.963805 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m20:58:16.981950 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:58:16.991580 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: BEGIN
[0m20:58:17.004340 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m20:58:17.019898 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:58:17.028700 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */




  create  table "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_tmp"


    as

  (


WITH source_data AS (
    SELECT
        id as price_id,
        UPPER(TRIM(symbol)) as symbol,
        TRIM(name) as crypto_name,
        current_price as price_usd,
        market_cap,
        total_volume as volume_24h,
        price_change_24h,
        price_change_percentage_24h as price_change_pct_24h,
        market_cap_rank,
        extracted_at,
        created_at,

        CASE WHEN current_price <= 0 THEN TRUE ELSE FALSE END as is_invalid_price,
        CASE WHEN market_cap <= 0 THEN TRUE ELSE FALSE END as is_invalid_market_cap,
        CASE WHEN total_volume < 0 THEN TRUE ELSE FALSE END as is_invalid_volume
    FROM "crypto_warehouse"."public"."crypto_prices_raw"
),

cleaned_data AS (
    SELECT
        *,
        DATE(extracted_at) as extraction_date,
        DATE_TRUNC('hour', extracted_at) as extraction_hour,
        CASE
            WHEN LAG(price_usd) OVER (
                PARTITION BY symbol ORDER BY extracted_at
            ) IS NOT NULL THEN
                ((price_usd - LAG(price_usd) OVER (
                    PARTITION BY symbol ORDER BY extracted_at
                )) / LAG(price_usd) OVER (
                    PARTITION BY symbol ORDER BY extracted_at
                )) * 100
        END as price_change_pct_from_previous
    FROM source_data
    WHERE NOT is_invalid_price AND NOT is_invalid_volume
)

SELECT * FROM cleaned_data
  );

[0m20:58:17.045980 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m20:58:17.053359 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.crypto_prices_raw" does not exist
LINE 31:     FROM "crypto_warehouse"."public"."crypto_prices_raw"
                  ^

[0m20:58:17.059560 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m20:58:17.070955 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: ROLLBACK
[0m20:58:17.078779 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */

  create view "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_tmp"


  as (
    SELECT
    id as run_id,
    run_id as run_identifier,
    stage,
    status,
    records_processed,
    error_message,
    started_at,
    completed_at,
    CASE
        WHEN completed_at IS NOT NULL
        THEN EXTRACT(EPOCH FROM (completed_at - started_at))
        ELSE NULL
    END as duration_seconds
FROM "crypto_warehouse"."public"."pipeline_runs"
  );
[0m20:58:17.090727 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.stg_crypto_prices (execute): 20:58:16.682271 => 20:58:17.090003
[0m20:58:17.096374 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "public.pipeline_runs" does not exist
LINE 21: FROM "crypto_warehouse"."public"."pipeline_runs"
              ^

[0m20:58:17.107366 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: Close
[0m20:58:17.119084 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: ROLLBACK
[0m20:58:17.143154 [debug] [Thread-1 (]: Database Error in model stg_crypto_prices (models/staging/stg_crypto_prices.sql)
  relation "public.crypto_prices_raw" does not exist
  LINE 31:     FROM "crypto_warehouse"."public"."crypto_prices_raw"
                    ^
  compiled Code at target/run/crypto_analytics/models/staging/stg_crypto_prices.sql
[0m20:58:17.145185 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.stg_pipeline_runs (execute): 20:58:16.717243 => 20:58:17.144492
[0m20:58:17.156299 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88f01c7f-76e3-4199-bab4-fba3489b40b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f934b433650>]}
[0m20:58:17.165897 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: Close
[0m20:58:17.175421 [error] [Thread-1 (]: 1 of 5 ERROR creating sql table model public_staging.stg_crypto_prices ......... [[31mERROR[0m in 0.64s]
[0m20:58:17.194808 [debug] [Thread-2 (]: Database Error in model stg_pipeline_runs (models/staging/stg_pipeline_runs.sql)
  relation "public.pipeline_runs" does not exist
  LINE 21: FROM "crypto_warehouse"."public"."pipeline_runs"
                ^
  compiled Code at target/run/crypto_analytics/models/staging/stg_pipeline_runs.sql
[0m20:58:17.197642 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.stg_crypto_prices
[0m20:58:17.207529 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88f01c7f-76e3-4199-bab4-fba3489b40b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f934b42ce50>]}
[0m20:58:17.219918 [debug] [Thread-4 (]: Began running node model.crypto_analytics.int_crypto_daily_aggs
[0m20:58:17.220956 [debug] [Thread-3 (]: Began running node model.crypto_analytics.int_crypto_hourly_aggs
[0m20:58:17.222239 [debug] [Thread-1 (]: Began running node model.crypto_analytics.mart_crypto_latest_prices
[0m20:58:17.226669 [error] [Thread-2 (]: 2 of 5 ERROR creating sql view model public_staging.stg_pipeline_runs .......... [[31mERROR[0m in 0.68s]
[0m20:58:17.238720 [debug] [Thread-4 (]: Finished running node model.crypto_analytics.int_crypto_daily_aggs
[0m20:58:17.253228 [debug] [Thread-3 (]: Finished running node model.crypto_analytics.int_crypto_hourly_aggs
[0m20:58:17.260939 [info ] [Thread-1 (]: 3 of 5 SKIP relation public_marts.mart_crypto_latest_prices .................... [[33mSKIP[0m]
[0m20:58:17.273543 [debug] [Thread-2 (]: Finished running node model.crypto_analytics.stg_pipeline_runs
[0m20:58:17.290556 [debug] [Thread-4 (]: Began running node model.crypto_analytics.mart_crypto_hourly_performance
[0m20:58:17.295876 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.mart_crypto_latest_prices
[0m20:58:17.309081 [debug] [Thread-3 (]: Began running node model.crypto_analytics.mart_pipeline_monitoring
[0m20:58:17.323241 [info ] [Thread-4 (]: 4 of 5 SKIP relation public_marts.mart_crypto_hourly_performance ............... [[33mSKIP[0m]
[0m20:58:17.348891 [info ] [Thread-3 (]: 5 of 5 SKIP relation public_marts.mart_pipeline_monitoring ..................... [[33mSKIP[0m]
[0m20:58:17.368931 [debug] [Thread-4 (]: Finished running node model.crypto_analytics.mart_crypto_hourly_performance
[0m20:58:17.377697 [debug] [Thread-3 (]: Finished running node model.crypto_analytics.mart_pipeline_monitoring
[0m20:58:17.404641 [debug] [MainThread]: Using postgres connection "master"
[0m20:58:17.417699 [debug] [MainThread]: On master: BEGIN
[0m20:58:17.426725 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:58:17.453673 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:58:17.461858 [debug] [MainThread]: On master: COMMIT
[0m20:58:17.479029 [debug] [MainThread]: Using postgres connection "master"
[0m20:58:17.492897 [debug] [MainThread]: On master: COMMIT
[0m20:58:17.520756 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:58:17.543035 [debug] [MainThread]: On master: Close
[0m20:58:17.563239 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:58:17.575852 [debug] [MainThread]: Connection 'model.crypto_analytics.stg_pipeline_runs' was properly closed.
[0m20:58:17.587971 [debug] [MainThread]: Connection 'list_crypto_warehouse_public_staging' was properly closed.
[0m20:58:17.595152 [debug] [MainThread]: Connection 'model.crypto_analytics.stg_crypto_prices' was properly closed.
[0m20:58:17.608275 [info ] [MainThread]:
[0m20:58:17.620565 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 2.56 seconds (2.56s).
[0m20:58:17.635311 [debug] [MainThread]: Command end result
[0m20:58:17.820215 [info ] [MainThread]:
[0m20:58:17.828145 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m20:58:17.840219 [info ] [MainThread]:
[0m20:58:17.848005 [error] [MainThread]:   Database Error in model stg_crypto_prices (models/staging/stg_crypto_prices.sql)
  relation "public.crypto_prices_raw" does not exist
  LINE 31:     FROM "crypto_warehouse"."public"."crypto_prices_raw"
                    ^
  compiled Code at target/run/crypto_analytics/models/staging/stg_crypto_prices.sql
[0m20:58:17.857741 [info ] [MainThread]:
[0m20:58:17.870526 [error] [MainThread]:   Database Error in model stg_pipeline_runs (models/staging/stg_pipeline_runs.sql)
  relation "public.pipeline_runs" does not exist
  LINE 21: FROM "crypto_warehouse"."public"."pipeline_runs"
                ^
  compiled Code at target/run/crypto_analytics/models/staging/stg_pipeline_runs.sql
[0m20:58:17.878168 [info ] [MainThread]:
[0m20:58:17.888814 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=3 TOTAL=5
[0m20:58:17.904129 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.2691855, "process_user_time": 10.133746, "process_kernel_time": 0.852086, "process_mem_max_rss": "122140", "process_out_blocks": "1976", "command_success": false, "process_in_blocks": "0"}
[0m20:58:17.912077 [debug] [MainThread]: Command `dbt run` failed at 20:58:17.911601 after 6.28 seconds
[0m20:58:17.923635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f934ddf3090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f935194d310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f934cfc2210>]}
[0m20:58:17.935035 [debug] [MainThread]: Flushing usage events
[0m20:59:26.798142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab0b94dc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab0b97a090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab0b97a3d0>]}


============================== 20:59:26.813627 | d37dff9a-bca4-4818-806f-dd8658840cdc ==============================
[0m20:59:26.813627 [info ] [MainThread]: Running with dbt=1.7.0
[0m20:59:26.826632 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'debug': 'False', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /app/dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:59:27.530124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd37dff9a-bca4-4818-806f-dd8658840cdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab0a0acd10>]}
[0m20:59:27.844284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd37dff9a-bca4-4818-806f-dd8658840cdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab0b973590>]}
[0m20:59:27.858283 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m20:59:27.921878 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m20:59:29.376075 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:59:29.385865 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:59:29.407783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd37dff9a-bca4-4818-806f-dd8658840cdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab09eee310>]}
[0m20:59:29.585537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd37dff9a-bca4-4818-806f-dd8658840cdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab09fb2fd0>]}
[0m20:59:29.592780 [info ] [MainThread]: Found 7 models, 14 tests, 2 sources, 0 exposures, 0 metrics, 403 macros, 0 groups, 0 semantic models
[0m20:59:29.603700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd37dff9a-bca4-4818-806f-dd8658840cdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab0a235d90>]}
[0m20:59:29.619802 [info ] [MainThread]:
[0m20:59:29.630597 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:59:29.646622 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse'
[0m20:59:29.651557 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse'
[0m20:59:29.720080 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse"
[0m20:59:29.736360 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse"
[0m20:59:29.739674 [debug] [ThreadPool]: On list_crypto_warehouse: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse"} */

    select distinct nspname from pg_namespace

[0m20:59:29.752345 [debug] [ThreadPool]: On list_crypto_warehouse: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse"} */

    select distinct nspname from pg_namespace

[0m20:59:29.760215 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:59:29.771692 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:59:29.793139 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m20:59:29.824775 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m20:59:29.828623 [debug] [ThreadPool]: On list_crypto_warehouse: Close
[0m20:59:29.853193 [debug] [ThreadPool]: On list_crypto_warehouse: Close
[0m20:59:29.903639 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_warehouse, now list_crypto_warehouse_public_staging)
[0m20:59:29.906189 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_warehouse, now list_crypto_warehouse_public_dbt_test__audit)
[0m20:59:29.908466 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse_public_marts'
[0m20:59:29.947727 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_staging"
[0m20:59:29.957081 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_dbt_test__audit"
[0m20:59:29.972596 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_marts"
[0m20:59:29.986151 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: BEGIN
[0m20:59:30.003342 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: BEGIN
[0m20:59:30.021376 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: BEGIN
[0m20:59:30.040710 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:59:30.058580 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:59:30.071436 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:59:30.091180 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:59:30.102279 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:59:30.118972 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:59:30.120730 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_staging"
[0m20:59:30.129126 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_dbt_test__audit"
[0m20:59:30.139149 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_marts"
[0m20:59:30.150654 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_staging"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'

[0m20:59:30.157591 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_dbt_test__audit"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'

[0m20:59:30.168707 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_marts"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'

[0m20:59:30.185352 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m20:59:30.194712 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m20:59:30.209901 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: ROLLBACK
[0m20:59:30.210656 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m20:59:30.223447 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: ROLLBACK
[0m20:59:30.235467 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: Close
[0m20:59:30.242812 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: ROLLBACK
[0m20:59:30.254059 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: Close
[0m20:59:30.273422 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: Close
[0m20:59:30.307938 [debug] [MainThread]: Using postgres connection "master"
[0m20:59:30.320685 [debug] [MainThread]: On master: BEGIN
[0m20:59:30.333467 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:59:30.349793 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:59:30.358188 [debug] [MainThread]: Using postgres connection "master"
[0m20:59:30.370464 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:59:30.386520 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m20:59:30.397600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd37dff9a-bca4-4818-806f-dd8658840cdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab0a02b190>]}
[0m20:59:30.405884 [debug] [MainThread]: On master: ROLLBACK
[0m20:59:30.418604 [debug] [MainThread]: Using postgres connection "master"
[0m20:59:30.424564 [debug] [MainThread]: On master: BEGIN
[0m20:59:30.436532 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:59:30.443680 [debug] [MainThread]: On master: COMMIT
[0m20:59:30.454020 [debug] [MainThread]: Using postgres connection "master"
[0m20:59:30.463256 [debug] [MainThread]: On master: COMMIT
[0m20:59:30.473125 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:59:30.486327 [debug] [MainThread]: On master: Close
[0m20:59:30.495477 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:59:30.508746 [info ] [MainThread]:
[0m20:59:30.535035 [debug] [Thread-1 (]: Began running node model.crypto_analytics.stg_crypto_prices
[0m20:59:30.536695 [debug] [Thread-2 (]: Began running node model.crypto_analytics.stg_pipeline_runs
[0m20:59:30.553792 [info ] [Thread-1 (]: 1 of 5 START sql table model public_staging.stg_crypto_prices .................. [RUN]
[0m20:59:30.568765 [info ] [Thread-2 (]: 2 of 5 START sql view model public_staging.stg_pipeline_runs ................... [RUN]
[0m20:59:30.584304 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_marts, now model.crypto_analytics.stg_crypto_prices)
[0m20:59:30.605544 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_dbt_test__audit, now model.crypto_analytics.stg_pipeline_runs)
[0m20:59:30.620440 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics.stg_crypto_prices
[0m20:59:30.634386 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics.stg_pipeline_runs
[0m20:59:30.699941 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics.stg_crypto_prices"
[0m20:59:30.703324 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics.stg_pipeline_runs"
[0m20:59:30.774947 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.stg_crypto_prices (compile): 20:59:30.642971 => 20:59:30.773994
[0m20:59:30.777458 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.stg_pipeline_runs (compile): 20:59:30.691741 => 20:59:30.776518
[0m20:59:30.789095 [debug] [Thread-1 (]: Began executing node model.crypto_analytics.stg_crypto_prices
[0m20:59:30.803084 [debug] [Thread-2 (]: Began executing node model.crypto_analytics.stg_pipeline_runs
[0m20:59:31.132052 [debug] [Thread-2 (]: Writing runtime sql for node "model.crypto_analytics.stg_pipeline_runs"
[0m20:59:31.152042 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics.stg_crypto_prices"
[0m20:59:31.206713 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m20:59:31.219687 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m20:59:31.220864 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: BEGIN
[0m20:59:31.234109 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: BEGIN
[0m20:59:31.242114 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:59:31.254201 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:59:31.273280 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m20:59:31.287282 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:59:31.293418 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m20:59:31.305993 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m20:59:31.317878 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */

  create view "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_tmp"


  as (
    SELECT
    id as run_id,
    run_id as run_identifier,
    stage,
    status,
    records_processed,
    error_message,
    started_at,
    completed_at,
    CASE
        WHEN completed_at IS NOT NULL
        THEN EXTRACT(EPOCH FROM (completed_at - started_at))
        ELSE NULL
    END as duration_seconds
FROM "crypto_warehouse"."public"."pipeline_runs"
  );
[0m20:59:31.326369 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */




  create  table "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_tmp"


    as

  (


WITH source_data AS (
    SELECT
        id as price_id,
        UPPER(TRIM(symbol)) as symbol,
        TRIM(name) as crypto_name,
        current_price as price_usd,
        market_cap,
        total_volume as volume_24h,
        price_change_24h,
        price_change_percentage_24h as price_change_pct_24h,
        market_cap_rank,
        extracted_at,
        created_at,

        CASE WHEN current_price <= 0 THEN TRUE ELSE FALSE END as is_invalid_price,
        CASE WHEN market_cap <= 0 THEN TRUE ELSE FALSE END as is_invalid_market_cap,
        CASE WHEN total_volume < 0 THEN TRUE ELSE FALSE END as is_invalid_volume
    FROM "crypto_warehouse"."public"."crypto_prices_raw"
),

cleaned_data AS (
    SELECT
        *,
        DATE(extracted_at) as extraction_date,
        DATE_TRUNC('hour', extracted_at) as extraction_hour,
        CASE
            WHEN LAG(price_usd) OVER (
                PARTITION BY symbol ORDER BY extracted_at
            ) IS NOT NULL THEN
                ((price_usd - LAG(price_usd) OVER (
                    PARTITION BY symbol ORDER BY extracted_at
                )) / LAG(price_usd) OVER (
                    PARTITION BY symbol ORDER BY extracted_at
                )) * 100
        END as price_change_pct_from_previous
    FROM source_data
    WHERE NOT is_invalid_price AND NOT is_invalid_volume
)

SELECT * FROM cleaned_data
  );

[0m20:59:31.340942 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:59:31.384494 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m20:59:31.399585 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */
alter table "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_tmp" rename to "stg_pipeline_runs"
[0m20:59:31.409593 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:59:31.484082 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: COMMIT
[0m20:59:31.503129 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m20:59:31.517510 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: COMMIT
[0m20:59:31.734456 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m20:59:31.769808 [debug] [Thread-2 (]: Applying DROP to: "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_backup"
[0m20:59:31.791121 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.0 seconds
[0m20:59:31.806359 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m20:59:31.827514 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m20:59:31.833937 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */
drop view if exists "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_backup" cascade
[0m20:59:31.842867 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */
alter table "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_tmp" rename to "stg_crypto_prices"
[0m20:59:31.856399 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:59:31.869642 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:59:31.882481 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.stg_pipeline_runs (execute): 20:59:30.868545 => 20:59:31.881865
[0m20:59:31.931520 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: Close
[0m20:59:31.924428 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m20:59:31.941209 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd37dff9a-bca4-4818-806f-dd8658840cdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab09ff6cd0>]}
[0m20:59:31.955529 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */

        CREATE INDEX IF NOT EXISTS idx_stg_crypto_prices_symbol_time ON "crypto_warehouse"."public_staging"."stg_crypto_prices" (symbol, extracted_at)

[0m20:59:31.969924 [info ] [Thread-2 (]: 2 of 5 OK created sql view model public_staging.stg_pipeline_runs .............. [[32mCREATE VIEW[0m in 1.34s]
[0m20:59:31.991238 [debug] [Thread-2 (]: Finished running node model.crypto_analytics.stg_pipeline_runs
[0m20:59:32.005123 [debug] [Thread-4 (]: Began running node model.crypto_analytics.mart_pipeline_monitoring
[0m20:59:32.025554 [info ] [Thread-4 (]: 3 of 5 START sql table model public_marts.mart_pipeline_monitoring ............. [RUN]
[0m20:59:32.043665 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.crypto_analytics.mart_pipeline_monitoring'
[0m20:59:32.065691 [debug] [Thread-4 (]: Began compiling node model.crypto_analytics.mart_pipeline_monitoring
[0m20:59:32.094605 [debug] [Thread-4 (]: Writing injected SQL for node "model.crypto_analytics.mart_pipeline_monitoring"
[0m20:59:32.164629 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m20:59:32.187241 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: COMMIT
[0m20:59:32.240204 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m20:59:32.274882 [debug] [Thread-4 (]: Timing info for model.crypto_analytics.mart_pipeline_monitoring (compile): 20:59:32.081381 => 20:59:32.273852
[0m20:59:32.282201 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: COMMIT
[0m20:59:32.299856 [debug] [Thread-4 (]: Began executing node model.crypto_analytics.mart_pipeline_monitoring
[0m20:59:32.398341 [debug] [Thread-4 (]: Writing runtime sql for node "model.crypto_analytics.mart_pipeline_monitoring"
[0m20:59:32.430720 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:59:32.458385 [debug] [Thread-1 (]: Applying DROP to: "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_backup"
[0m20:59:32.505555 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m20:59:32.522082 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */
drop table if exists "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_backup" cascade
[0m20:59:32.537770 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:59:32.556445 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.stg_crypto_prices (execute): 20:59:30.817156 => 20:59:32.555627
[0m20:59:32.570043 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: Close
[0m20:59:32.571303 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m20:59:32.588327 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd37dff9a-bca4-4818-806f-dd8658840cdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab0b97af10>]}
[0m20:59:32.603245 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: BEGIN
[0m20:59:32.617042 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public_staging.stg_crypto_prices ............. [[32mSELECT 5[0m in 2.01s]
[0m20:59:32.634137 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:59:32.652120 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.stg_crypto_prices
[0m20:59:32.673833 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m20:59:32.685309 [debug] [Thread-2 (]: Began running node model.crypto_analytics.int_crypto_daily_aggs
[0m20:59:32.686694 [debug] [Thread-3 (]: Began running node model.crypto_analytics.int_crypto_hourly_aggs
[0m20:59:32.687816 [debug] [Thread-1 (]: Began running node model.crypto_analytics.mart_crypto_latest_prices
[0m20:59:32.701248 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m20:59:32.722146 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.stg_pipeline_runs, now model.crypto_analytics.int_crypto_daily_aggs)
[0m20:59:32.736504 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_staging, now model.crypto_analytics.int_crypto_hourly_aggs)
[0m20:59:32.751551 [info ] [Thread-1 (]: 4 of 5 START sql table model public_marts.mart_crypto_latest_prices ............ [RUN]
[0m20:59:32.768302 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */




  create  table "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_tmp"


    as

  (


WITH pipeline_metrics AS (
    SELECT
        run_id,
        stage,
        status,
        records_processed,
        error_message,
        started_at,
        completed_at,
        EXTRACT(EPOCH FROM completed_at - started_at) AS duration_seconds,

        -- Flag to compute success rate
        CASE WHEN status = 'success' THEN 1 ELSE 0 END AS is_success,

        -- Classify performance
        CASE
            WHEN completed_at IS NULL THEN 'Running'
            WHEN EXTRACT(EPOCH FROM completed_at - started_at) < 30 THEN 'Fast'
            WHEN EXTRACT(EPOCH FROM completed_at - started_at) < 120 THEN 'Normal'
            ELSE 'Slow'
        END AS performance_category

    FROM "crypto_warehouse"."public_staging"."stg_pipeline_runs"
),

latest_status_per_day_stage AS (
    SELECT
        DATE(started_at) AS run_date,
        stage,
        FIRST_VALUE(status) OVER (
            PARTITION BY DATE(started_at), stage
            ORDER BY started_at DESC
        ) AS latest_run_status
    FROM pipeline_metrics
),

daily_summary AS (
    SELECT
        DATE(started_at) AS run_date,
        stage,

        COUNT(*) AS total_runs,
        SUM(is_success) AS successful_runs,
        SUM(records_processed) AS total_records_processed,
        AVG(duration_seconds) AS avg_duration_seconds,
        MAX(duration_seconds) AS max_duration_seconds,
        ROUND(((SUM(is_success)::FLOAT / COUNT(*)) * 100)::NUMERIC, 2) AS success_rate_pct


    FROM pipeline_metrics
    WHERE started_at >= CURRENT_DATE - INTERVAL '30 days'
    GROUP BY DATE(started_at), stage
)

-- Final result combining metrics with latest run status
SELECT
    ds.*,
    ls.latest_run_status
FROM daily_summary ds
LEFT JOIN latest_status_per_day_stage ls
  ON ds.run_date = ls.run_date AND ds.stage = ls.stage
  );

[0m20:59:32.782802 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics.int_crypto_daily_aggs
[0m20:59:32.796539 [debug] [Thread-3 (]: Began compiling node model.crypto_analytics.int_crypto_hourly_aggs
[0m20:59:32.806184 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.stg_crypto_prices, now model.crypto_analytics.mart_crypto_latest_prices)
[0m20:59:32.850284 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics.int_crypto_daily_aggs"
[0m20:59:32.874792 [debug] [Thread-3 (]: Writing injected SQL for node "model.crypto_analytics.int_crypto_hourly_aggs"
[0m20:59:32.882286 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics.mart_crypto_latest_prices
[0m20:59:32.932914 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics.mart_crypto_latest_prices"
[0m20:59:32.950876 [debug] [Thread-3 (]: Timing info for model.crypto_analytics.int_crypto_hourly_aggs (compile): 20:59:32.855053 => 20:59:32.950023
[0m20:59:32.965682 [debug] [Thread-3 (]: Finished running node model.crypto_analytics.int_crypto_hourly_aggs
[0m20:59:32.967180 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.int_crypto_daily_aggs (compile): 20:59:32.836048 => 20:59:32.966488
[0m20:59:32.975065 [debug] [Thread-3 (]: Began running node model.crypto_analytics.mart_crypto_hourly_performance
[0m20:59:32.991921 [debug] [Thread-2 (]: Finished running node model.crypto_analytics.int_crypto_daily_aggs
[0m20:59:32.999271 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.mart_crypto_latest_prices (compile): 20:59:32.920098 => 20:59:32.998474
[0m20:59:33.004492 [info ] [Thread-3 (]: 5 of 5 START sql table model public_marts.mart_crypto_hourly_performance ....... [RUN]
[0m20:59:33.008104 [debug] [Thread-4 (]: SQL status: SELECT 2 in 0.0 seconds
[0m20:59:33.032684 [debug] [Thread-1 (]: Began executing node model.crypto_analytics.mart_crypto_latest_prices
[0m20:59:33.049178 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.int_crypto_hourly_aggs, now model.crypto_analytics.mart_crypto_hourly_performance)
[0m20:59:33.080677 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m20:59:33.203388 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics.mart_crypto_latest_prices"
[0m20:59:33.212213 [debug] [Thread-3 (]: Began compiling node model.crypto_analytics.mart_crypto_hourly_performance
[0m20:59:33.220347 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */
alter table "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_tmp" rename to "mart_pipeline_monitoring"
[0m20:59:33.289426 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:59:33.349626 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m20:59:33.362912 [debug] [Thread-3 (]: Writing injected SQL for node "model.crypto_analytics.mart_crypto_hourly_performance"
[0m20:59:33.376101 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: BEGIN
[0m20:59:33.374872 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m20:59:33.398483 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:59:33.407887 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */

    create  index if not exists
  "0bcbea197f5859da18bb8772d2dec079"
  on "crypto_warehouse"."public_marts"."mart_pipeline_monitoring" using btree
  (run_date);

[0m20:59:33.426201 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:59:33.444998 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m20:59:33.453216 [debug] [Thread-3 (]: Timing info for model.crypto_analytics.mart_crypto_hourly_performance (compile): 20:59:33.239642 => 20:59:33.452663
[0m20:59:33.454407 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */




  create  table "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_tmp"


    as

  (


WITH latest_prices AS (
    SELECT
        symbol,
        crypto_name,
        price_usd,
        market_cap,
        volume_24h,
        price_change_24h,
        price_change_pct_24h,
        market_cap_rank,
        extracted_at,

        ROW_NUMBER() OVER (
            PARTITION BY symbol
            ORDER BY extracted_at DESC
        ) as rn

    FROM "crypto_warehouse"."public_staging"."stg_crypto_prices"
    WHERE extraction_date = CURRENT_DATE
),

price_changes AS (
    SELECT
        symbol,
        crypto_name,
        price_usd as current_price,
        market_cap,
        volume_24h,
        price_change_24h,
        price_change_pct_24h,
        market_cap_rank,
        extracted_at as last_updated,

        -- Calculate additional metrics
        CASE
            WHEN price_change_pct_24h > 10 THEN 'Strong Gain'
            WHEN price_change_pct_24h > 5 THEN 'Moderate Gain'
            WHEN price_change_pct_24h > 0 THEN 'Slight Gain'
            WHEN price_change_pct_24h > -5 THEN 'Slight Loss'
            WHEN price_change_pct_24h > -10 THEN 'Moderate Loss'
            ELSE 'Strong Loss'
        END as price_trend_category,

        -- Market cap category
        CASE
            WHEN market_cap_rank <= 10 THEN 'Large Cap'
            WHEN market_cap_rank <= 50 THEN 'Mid Cap'
            WHEN market_cap_rank <= 100 THEN 'Small Cap'
            ELSE 'Micro Cap'
        END as market_cap_category

    FROM latest_prices
    WHERE rn = 1
)

SELECT * FROM price_changes
  );

[0m20:59:33.469029 [debug] [Thread-3 (]: Began executing node model.crypto_analytics.mart_crypto_hourly_performance
[0m20:59:33.498315 [debug] [Thread-3 (]: Writing runtime sql for node "model.crypto_analytics.mart_crypto_hourly_performance"
[0m20:59:33.552040 [debug] [Thread-3 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m20:59:33.565202 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: BEGIN
[0m20:59:33.573040 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:59:33.596327 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m20:59:33.602707 [debug] [Thread-3 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m20:59:33.614552 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */




  create  table "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_tmp"


    as

  (


WITH  __dbt__cte__int_crypto_hourly_aggs as (


WITH base_data AS (
    SELECT
        symbol,
        crypto_name,
        DATE_TRUNC('hour', extracted_at) AS extraction_hour,
        price_usd,
        volume_24h,
        market_cap,
        CASE WHEN price_usd <= 0 THEN 1 ELSE 0 END AS is_invalid
    FROM "crypto_warehouse"."public_staging"."stg_crypto_prices"
)

SELECT
    symbol,
    crypto_name,
    extraction_hour,
    COUNT(*) AS total_records,
    SUM(is_invalid) AS invalid_price_records,
    AVG(price_usd) AS avg_price_usd,
    MIN(price_usd) AS min_price_usd,
    MAX(price_usd) AS max_price_usd,
    STDDEV(price_usd) AS price_volatility,
    AVG(volume_24h) AS avg_volume_24h,
    AVG(market_cap) AS avg_market_cap
FROM base_data
GROUP BY symbol, crypto_name, extraction_hour
), hourly_data AS (
    SELECT
        symbol,
        crypto_name,
        extraction_hour,
        avg_price_usd,
        min_price_usd,
        max_price_usd,
        price_volatility,
        avg_volume_24h,
        avg_market_cap,
        total_records,

        -- Calculate hourly change
        LAG(avg_price_usd) OVER (
            PARTITION BY symbol
            ORDER BY extraction_hour
        ) as previous_hour_price,

        -- Data quality score
        (1.0 - (invalid_price_records::FLOAT / GREATEST(total_records, 1))) * 100 as data_quality_score

    FROM __dbt__cte__int_crypto_hourly_aggs
),

performance_metrics AS (
    SELECT
        *,
        CASE
            WHEN previous_hour_price IS NOT NULL AND previous_hour_price > 0 THEN
                ((avg_price_usd - previous_hour_price) / previous_hour_price) * 100
            ELSE NULL
        END as hourly_change_pct,

        -- Volatility category
        CASE
            WHEN price_volatility IS NULL THEN 'Unknown'
            WHEN price_volatility < avg_price_usd * 0.01 THEN 'Low Volatility'
            WHEN price_volatility < avg_price_usd * 0.05 THEN 'Medium Volatility'
            ELSE 'High Volatility'
        END as volatility_category

    FROM hourly_data
)

SELECT * FROM performance_metrics
  );

[0m20:59:33.652032 [debug] [Thread-4 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m20:59:33.666603 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m20:59:33.673151 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */

    create  index if not exists
  "e733786e0f8197b9141221d2e4d85f95"
  on "crypto_warehouse"."public_marts"."mart_pipeline_monitoring" using btree
  (stage);

[0m20:59:34.022262 [debug] [Thread-1 (]: SQL status: SELECT 5 in 1.0 seconds
[0m20:59:34.058156 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m20:59:34.069873 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_tmp" rename to "mart_crypto_latest_prices"
[0m20:59:34.082698 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:59:34.099008 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m20:59:34.111453 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */

    create  index if not exists
  "85f60fb6265865288d99ba160dc34eab"
  on "crypto_warehouse"."public_marts"."mart_crypto_latest_prices" using btree
  (symbol);

[0m20:59:34.194867 [debug] [Thread-4 (]: SQL status: CREATE INDEX in 1.0 seconds
[0m20:59:34.203674 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: COMMIT
[0m20:59:34.214103 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m20:59:34.221870 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: COMMIT
[0m20:59:34.241117 [debug] [Thread-3 (]: SQL status: SELECT 5 in 1.0 seconds
[0m20:59:34.255818 [debug] [Thread-3 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m20:59:34.267865 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_tmp" rename to "mart_crypto_hourly_performance"
[0m20:59:34.280278 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:59:34.291300 [debug] [Thread-3 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m20:59:34.301018 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */

    create  index if not exists
  "0892ef01aa27914e78b1b159e8dcbd32"
  on "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance" using btree
  (symbol, extraction_hour);

[0m20:59:34.430418 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m20:59:34.448130 [debug] [Thread-4 (]: Applying DROP to: "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_backup"
[0m20:59:34.458629 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m20:59:34.467575 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */
drop table if exists "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_backup" cascade
[0m20:59:34.480959 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:59:34.485746 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m20:59:34.491185 [debug] [Thread-4 (]: Timing info for model.crypto_analytics.mart_pipeline_monitoring (execute): 20:59:32.371229 => 20:59:34.490475
[0m20:59:34.503407 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m20:59:34.517217 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: Close
[0m20:59:34.529650 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */

    create  index if not exists
  "d634921979abec52cba2c5cf4368bb44"
  on "crypto_warehouse"."public_marts"."mart_crypto_latest_prices" using btree
  (market_cap_rank);

[0m20:59:34.539293 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd37dff9a-bca4-4818-806f-dd8658840cdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab0a01c550>]}
[0m20:59:34.567940 [info ] [Thread-4 (]: 3 of 5 OK created sql table model public_marts.mart_pipeline_monitoring ........ [[32mSELECT 2[0m in 2.50s]
[0m20:59:34.581746 [debug] [Thread-4 (]: Finished running node model.crypto_analytics.mart_pipeline_monitoring
[0m20:59:34.652478 [debug] [Thread-3 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m20:59:34.668138 [debug] [Thread-3 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m20:59:34.681425 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */

    create  index if not exists
  "530df09e0081e634c87bf76a8670ebfd"
  on "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance" using btree
  (extraction_hour);

[0m20:59:34.863915 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m20:59:34.878086 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: COMMIT
[0m20:59:34.886222 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m20:59:34.897848 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: COMMIT
[0m20:59:35.077259 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:59:35.078493 [debug] [Thread-3 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m20:59:35.095148 [debug] [Thread-1 (]: Applying DROP to: "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_backup"
[0m20:59:35.105494 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: COMMIT
[0m20:59:35.118324 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m20:59:35.129635 [debug] [Thread-3 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m20:59:35.137182 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */
drop table if exists "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_backup" cascade
[0m20:59:35.148998 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: COMMIT
[0m20:59:35.156822 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:59:35.180273 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.mart_crypto_latest_prices (execute): 20:59:33.082765 => 20:59:35.179755
[0m20:59:35.187800 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: Close
[0m20:59:35.199884 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd37dff9a-bca4-4818-806f-dd8658840cdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab09edfa50>]}
[0m20:59:35.214152 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public_marts.mart_crypto_latest_prices ....... [[32mSELECT 5[0m in 2.39s]
[0m20:59:35.228879 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.mart_crypto_latest_prices
[0m20:59:35.400078 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m20:59:35.419424 [debug] [Thread-3 (]: Applying DROP to: "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_backup"
[0m20:59:35.433484 [debug] [Thread-3 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m20:59:35.444717 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */
drop table if exists "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_backup" cascade
[0m20:59:35.453596 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:59:35.469483 [debug] [Thread-3 (]: Timing info for model.crypto_analytics.mart_crypto_hourly_performance (execute): 20:59:33.485530 => 20:59:35.468867
[0m20:59:35.482316 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: Close
[0m20:59:35.495171 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd37dff9a-bca4-4818-806f-dd8658840cdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab0b9b19d0>]}
[0m20:59:35.504295 [info ] [Thread-3 (]: 5 of 5 OK created sql table model public_marts.mart_crypto_hourly_performance .. [[32mSELECT 5[0m in 2.45s]
[0m20:59:35.516835 [debug] [Thread-3 (]: Finished running node model.crypto_analytics.mart_crypto_hourly_performance
[0m20:59:35.531466 [debug] [MainThread]: Using postgres connection "master"
[0m20:59:35.543939 [debug] [MainThread]: On master: BEGIN
[0m20:59:35.550050 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:59:35.567860 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:59:35.581780 [debug] [MainThread]: On master: COMMIT
[0m20:59:35.592906 [debug] [MainThread]: Using postgres connection "master"
[0m20:59:35.601047 [debug] [MainThread]: On master: COMMIT
[0m20:59:35.612758 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:59:35.620279 [debug] [MainThread]: On master: Close
[0m20:59:35.632815 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:59:35.644958 [debug] [MainThread]: Connection 'model.crypto_analytics.int_crypto_daily_aggs' was properly closed.
[0m20:59:35.651500 [debug] [MainThread]: Connection 'model.crypto_analytics.mart_crypto_hourly_performance' was properly closed.
[0m20:59:35.663320 [debug] [MainThread]: Connection 'model.crypto_analytics.mart_crypto_latest_prices' was properly closed.
[0m20:59:35.671211 [debug] [MainThread]: Connection 'model.crypto_analytics.mart_pipeline_monitoring' was properly closed.
[0m20:59:35.682354 [info ] [MainThread]:
[0m20:59:35.718966 [info ] [MainThread]: Finished running 1 view model, 4 table models in 0 hours 0 minutes and 6.05 seconds (6.05s).
[0m20:59:35.739359 [debug] [MainThread]: Command end result
[0m20:59:35.979600 [info ] [MainThread]:
[0m20:59:35.993953 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:59:36.010126 [info ] [MainThread]:
[0m20:59:36.020727 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m20:59:36.035231 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.402576, "process_user_time": 13.514649, "process_kernel_time": 1.042733, "process_mem_max_rss": "122232", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:59:36.049549 [debug] [MainThread]: Command `dbt run` succeeded at 20:59:36.048691 after 9.42 seconds
[0m20:59:36.099318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab0a0aebd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab0b982390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab101c2e10>]}
[0m20:59:36.118005 [debug] [MainThread]: Flushing usage events
[0m22:10:03.369093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1333e40050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1333e76490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1333e235d0>]}
[0m22:10:03.370507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05b96c0b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05b969bbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05b96dfbd0>]}


============================== 22:10:03.466655 | 89d3b78d-0704-4247-b977-cf9bd866aeae ==============================
[0m22:10:03.466655 [info ] [MainThread]: Running with dbt=1.7.0


============================== 22:10:03.475517 | 4f455d5d-bff1-4dc3-a9b2-fe47522d62f6 ==============================
[0m22:10:03.475517 [info ] [MainThread]: Running with dbt=1.7.0
[0m22:10:03.475884 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug --project-dir /app/dbt', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:10:03.484373 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'version_check': 'True', 'debug': 'False', 'log_path': '/app/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug --project-dir /app/dbt', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:10:03.494493 [info ] [MainThread]: dbt version: 1.7.0
[0m22:10:03.493706 [info ] [MainThread]: dbt version: 1.7.0
[0m22:10:03.501882 [info ] [MainThread]: python version: 3.11.13
[0m22:10:03.501910 [info ] [MainThread]: python version: 3.11.13
[0m22:10:03.508422 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m22:10:03.509008 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m22:10:03.516747 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m22:10:03.519330 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m22:10:03.369086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff447d9a290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff447d7f790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff447d7f950>]}
[0m22:10:03.370195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c0289b650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c02e97f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c02d07410>]}


============================== 22:10:03.572447 | 0d075c6f-d538-4637-be95-f2fd1ae6ceac ==============================
[0m22:10:03.572447 [info ] [MainThread]: Running with dbt=1.7.0


============================== 22:10:03.569023 | 6e3af6b2-b640-4763-9628-488814251c04 ==============================
[0m22:10:03.569023 [info ] [MainThread]: Running with dbt=1.7.0
[0m22:10:03.369120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc82cab8850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc82d914c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc82cab8490>]}
[0m22:10:03.600335 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/app/dbt/logs', 'profiles_dir': '/app', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug --project-dir /app/dbt', 'send_anonymous_usage_stats': 'True'}
[0m22:10:03.370448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6303ae7ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6303ae7fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6303ae6950>]}
[0m22:10:03.598902 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/app/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /app/dbt', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}


============================== 22:10:03.615076 | fd137f1a-cbed-4b28-b4e6-2ddfb7b8f02b ==============================
[0m22:10:03.615076 [info ] [MainThread]: Running with dbt=1.7.0


============================== 22:10:03.618820 | ba4f9ae0-a776-43bd-aa05-5fdf4257e75a ==============================
[0m22:10:03.618820 [info ] [MainThread]: Running with dbt=1.7.0
[0m22:10:03.369077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76eccfbe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76ecce4d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76edb54210>]}
[0m22:10:03.625400 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/app', 'log_path': '/app/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug --project-dir /app/dbt', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:10:03.628564 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'version_check': 'True', 'debug': 'False', 'log_path': '/app/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug --project-dir /app/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}


============================== 22:10:03.630212 | 707c2f0e-e164-4977-97c0-43eb25a009de ==============================
[0m22:10:03.630212 [info ] [MainThread]: Running with dbt=1.7.0
[0m22:10:03.641212 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/app/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /app/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:10:03.647212 [info ] [MainThread]: dbt version: 1.7.0
[0m22:10:03.642690 [info ] [MainThread]: dbt version: 1.7.0
[0m22:10:03.662860 [info ] [MainThread]: python version: 3.11.13
[0m22:10:03.657240 [info ] [MainThread]: python version: 3.11.13
[0m22:10:03.659349 [info ] [MainThread]: dbt version: 1.7.0
[0m22:10:03.686993 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m22:10:03.690046 [info ] [MainThread]: python version: 3.11.13
[0m22:10:03.707875 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m22:10:03.710891 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m22:10:03.726179 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m22:10:03.686577 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m22:10:03.757824 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m22:10:11.272240 [info ] [MainThread]: Using profiles dir at /app
[0m22:10:11.287834 [info ] [MainThread]: Using profiles.yml file at /app/profiles.yml
[0m22:10:11.328565 [info ] [MainThread]: Using dbt_project.yml file at /app/dbt/dbt_project.yml
[0m22:10:11.399509 [info ] [MainThread]: adapter type: postgres
[0m22:10:11.414267 [info ] [MainThread]: adapter version: 1.7.0
[0m22:10:11.436404 [info ] [MainThread]: Using profiles dir at /app
[0m22:10:11.492830 [info ] [MainThread]: Using profiles.yml file at /app/profiles.yml
[0m22:10:11.682065 [info ] [MainThread]: Using dbt_project.yml file at /app/dbt/dbt_project.yml
[0m22:10:11.710645 [info ] [MainThread]: Using profiles dir at /app
[0m22:10:11.715936 [info ] [MainThread]: Using profiles dir at /app
[0m22:10:11.805234 [info ] [MainThread]: adapter type: postgres
[0m22:10:11.788780 [info ] [MainThread]: Using profiles.yml file at /app/profiles.yml
[0m22:10:11.744048 [info ] [MainThread]: Using profiles dir at /app
[0m22:10:11.836215 [info ] [MainThread]: Using profiles.yml file at /app/profiles.yml
[0m22:10:11.861567 [info ] [MainThread]: Using profiles.yml file at /app/profiles.yml
[0m22:10:11.873714 [info ] [MainThread]: Using dbt_project.yml file at /app/dbt/dbt_project.yml
[0m22:10:11.877343 [info ] [MainThread]: Using dbt_project.yml file at /app/dbt/dbt_project.yml
[0m22:10:11.866748 [info ] [MainThread]: adapter version: 1.7.0
[0m22:10:11.929649 [info ] [MainThread]: adapter type: postgres
[0m22:10:11.930445 [info ] [MainThread]: adapter type: postgres
[0m22:10:11.926120 [info ] [MainThread]: Using dbt_project.yml file at /app/dbt/dbt_project.yml
[0m22:10:12.027669 [info ] [MainThread]: adapter version: 1.7.0
[0m22:10:12.077585 [info ] [MainThread]: adapter version: 1.7.0
[0m22:10:12.078844 [info ] [MainThread]: adapter type: postgres
[0m22:10:12.233567 [info ] [MainThread]: adapter version: 1.7.0
[0m22:10:12.584856 [info ] [MainThread]: Configuration:
[0m22:10:12.606366 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:10:12.616954 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:10:12.631940 [info ] [MainThread]: Required dependencies:
[0m22:10:12.653745 [debug] [MainThread]: Executing "git --help"
[0m22:10:12.940018 [info ] [MainThread]: Configuration:
[0m22:10:12.987664 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:10:13.017925 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:10:13.096360 [info ] [MainThread]: Configuration:
[0m22:10:13.076273 [info ] [MainThread]: Required dependencies:
[0m22:10:13.129250 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:10:13.133533 [debug] [MainThread]: Executing "git --help"
[0m22:10:13.168578 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:10:13.187522 [info ] [MainThread]: Required dependencies:
[0m22:10:13.224889 [debug] [MainThread]: Executing "git --help"
[0m22:10:13.222613 [info ] [MainThread]: Configuration:
[0m22:10:13.248838 [info ] [MainThread]: Configuration:
[0m22:10:13.261334 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:10:13.297554 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:10:13.288970 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:10:13.327286 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:10:13.346108 [info ] [MainThread]: Required dependencies:
[0m22:10:13.324439 [info ] [MainThread]: Required dependencies:
[0m22:10:13.361703 [debug] [MainThread]: Executing "git --help"
[0m22:10:13.369939 [debug] [MainThread]: Executing "git --help"
[0m22:10:14.960219 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:10:14.960218 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:10:14.960398 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:10:14.962043 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:10:14.962257 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:10:15.008912 [debug] [MainThread]: STDERR: "b''"
[0m22:10:15.009796 [debug] [MainThread]: STDERR: "b''"
[0m22:10:14.995870 [debug] [MainThread]: STDERR: "b''"
[0m22:10:14.993500 [debug] [MainThread]: STDERR: "b''"
[0m22:10:15.007215 [debug] [MainThread]: STDERR: "b''"
[0m22:10:15.028779 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:10:15.044056 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:10:15.045358 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:10:15.060127 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:10:15.060464 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:10:15.084858 [info ] [MainThread]: Connection:
[0m22:10:15.076429 [info ] [MainThread]: Connection:
[0m22:10:15.062287 [info ] [MainThread]: Connection:
[0m22:10:15.077007 [info ] [MainThread]: Connection:
[0m22:10:15.096230 [info ] [MainThread]:   host: postgres
[0m22:10:15.096230 [info ] [MainThread]:   host: postgres
[0m22:10:15.080075 [info ] [MainThread]: Connection:
[0m22:10:15.122063 [info ] [MainThread]:   host: postgres
[0m22:10:15.124987 [info ] [MainThread]:   port: 5432
[0m22:10:15.127704 [info ] [MainThread]:   port: 5432
[0m22:10:15.112499 [info ] [MainThread]:   host: postgres
[0m22:10:15.140084 [info ] [MainThread]:   port: 5432
[0m22:10:15.142907 [info ] [MainThread]:   user: postgres
[0m22:10:15.145905 [info ] [MainThread]:   port: 5432
[0m22:10:15.161386 [info ] [MainThread]:   database: crypto_warehouse
[0m22:10:15.128818 [info ] [MainThread]:   host: postgres
[0m22:10:15.162158 [info ] [MainThread]:   user: postgres
[0m22:10:15.176395 [info ] [MainThread]:   schema: public
[0m22:10:15.161353 [info ] [MainThread]:   user: postgres
[0m22:10:15.177664 [info ] [MainThread]:   port: 5432
[0m22:10:15.187538 [info ] [MainThread]:   database: crypto_warehouse
[0m22:10:15.194520 [info ] [MainThread]:   database: crypto_warehouse
[0m22:10:15.143042 [info ] [MainThread]:   user: postgres
[0m22:10:15.202422 [info ] [MainThread]:   schema: public
[0m22:10:15.209646 [info ] [MainThread]:   database: crypto_warehouse
[0m22:10:15.212887 [info ] [MainThread]:   connect_timeout: 10
[0m22:10:15.192309 [info ] [MainThread]:   connect_timeout: 10
[0m22:10:15.195651 [info ] [MainThread]:   user: postgres
[0m22:10:15.222437 [info ] [MainThread]:   schema: public
[0m22:10:15.226959 [info ] [MainThread]:   role: None
[0m22:10:15.225702 [info ] [MainThread]:   role: None
[0m22:10:15.232872 [info ] [MainThread]:   database: crypto_warehouse
[0m22:10:15.238051 [info ] [MainThread]:   connect_timeout: 10
[0m22:10:15.242068 [info ] [MainThread]:   search_path: None
[0m22:10:15.246186 [info ] [MainThread]:   schema: public
[0m22:10:15.241956 [info ] [MainThread]:   search_path: None
[0m22:10:15.253598 [info ] [MainThread]:   role: None
[0m22:10:15.261476 [info ] [MainThread]:   connect_timeout: 10
[0m22:10:15.271357 [info ] [MainThread]:   keepalives_idle: 0
[0m22:10:15.276597 [info ] [MainThread]:   search_path: None
[0m22:10:15.285977 [info ] [MainThread]:   sslmode: None
[0m22:10:15.295192 [info ] [MainThread]:   keepalives_idle: 0
[0m22:10:15.209241 [info ] [MainThread]:   schema: public
[0m22:10:15.279526 [info ] [MainThread]:   role: None
[0m22:10:15.298292 [info ] [MainThread]:   sslcert: None
[0m22:10:15.308370 [info ] [MainThread]:   sslmode: None
[0m22:10:15.320545 [info ] [MainThread]:   search_path: None
[0m22:10:15.257047 [info ] [MainThread]:   keepalives_idle: 0
[0m22:10:15.328396 [info ] [MainThread]:   sslcert: None
[0m22:10:15.320543 [info ] [MainThread]:   connect_timeout: 10
[0m22:10:15.349661 [info ] [MainThread]:   role: None
[0m22:10:15.346692 [info ] [MainThread]:   keepalives_idle: 0
[0m22:10:15.358372 [info ] [MainThread]:   sslmode: None
[0m22:10:15.321362 [info ] [MainThread]:   sslkey: None
[0m22:10:15.359338 [info ] [MainThread]:   sslkey: None
[0m22:10:15.410770 [info ] [MainThread]:   sslmode: None
[0m22:10:15.412018 [info ] [MainThread]:   sslcert: None
[0m22:10:15.422260 [info ] [MainThread]:   sslrootcert: None
[0m22:10:15.434955 [info ] [MainThread]:   sslkey: None
[0m22:10:15.436838 [info ] [MainThread]:   application_name: dbt
[0m22:10:15.444368 [info ] [MainThread]:   sslrootcert: None
[0m22:10:15.386894 [info ] [MainThread]:   search_path: None
[0m22:10:15.412071 [info ] [MainThread]:   sslrootcert: None
[0m22:10:15.445711 [info ] [MainThread]:   retries: 1
[0m22:10:15.457031 [info ] [MainThread]:   application_name: dbt
[0m22:10:15.460517 [info ] [MainThread]:   sslcert: None
[0m22:10:15.603238 [info ] [MainThread]:   keepalives_idle: 0
[0m22:10:15.651017 [info ] [MainThread]:   application_name: dbt
[0m22:10:15.754291 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m22:10:15.760853 [info ] [MainThread]:   retries: 1
[0m22:10:15.767575 [info ] [MainThread]:   sslkey: None
[0m22:10:15.774131 [info ] [MainThread]:   retries: 1
[0m22:10:15.769067 [info ] [MainThread]:   sslmode: None
[0m22:10:15.795210 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m22:10:15.808113 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m22:10:15.817517 [info ] [MainThread]:   sslcert: None
[0m22:10:15.792544 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m22:10:15.824786 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m22:10:15.816363 [info ] [MainThread]:   sslrootcert: None
[0m22:10:15.831678 [info ] [MainThread]:   sslkey: None
[0m22:10:15.831724 [debug] [MainThread]: Using postgres connection "debug"
[0m22:10:15.864321 [debug] [MainThread]: On debug: select 1 as id
[0m22:10:15.833642 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m22:10:15.880871 [debug] [MainThread]: Using postgres connection "debug"
[0m22:10:15.853567 [debug] [MainThread]: Using postgres connection "debug"
[0m22:10:15.883907 [info ] [MainThread]:   sslrootcert: None
[0m22:10:15.879131 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:10:15.892533 [debug] [MainThread]: On debug: select 1 as id
[0m22:10:15.861571 [info ] [MainThread]:   application_name: dbt
[0m22:10:15.902576 [debug] [MainThread]: On debug: select 1 as id
[0m22:10:15.927135 [info ] [MainThread]:   application_name: dbt
[0m22:10:15.952208 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:10:15.951287 [info ] [MainThread]:   retries: 1
[0m22:10:15.964432 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:10:15.964497 [info ] [MainThread]:   retries: 1
[0m22:10:15.974727 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m22:10:15.982485 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m22:10:15.984191 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m22:10:15.995677 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m22:10:15.998096 [debug] [MainThread]: Using postgres connection "debug"
[0m22:10:16.005358 [debug] [MainThread]: Using postgres connection "debug"
[0m22:10:16.011135 [debug] [MainThread]: On debug: select 1 as id
[0m22:10:16.023777 [debug] [MainThread]: On debug: select 1 as id
[0m22:10:16.030747 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:10:16.034515 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:10:16.517791 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m22:10:16.521511 [debug] [MainThread]: SQL status: SELECT 1 in 1.0 seconds
[0m22:10:16.519545 [debug] [MainThread]: SQL status: SELECT 1 in 1.0 seconds
[0m22:10:16.520683 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m22:10:16.519367 [debug] [MainThread]: SQL status: SELECT 1 in 1.0 seconds
[0m22:10:16.525450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d075c6f-d538-4637-be95-f2fd1ae6ceac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c036dea90>]}
[0m22:10:16.541949 [debug] [MainThread]: On debug: Close
[0m22:10:16.550372 [debug] [MainThread]: On debug: Close
[0m22:10:16.554101 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m22:10:16.539318 [debug] [MainThread]: On debug: Close
[0m22:10:16.559044 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m22:10:16.565139 [info ] [MainThread]: [32mAll checks passed![0m
[0m22:10:16.525451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '707c2f0e-e164-4977-97c0-43eb25a009de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76eb47e050>]}
[0m22:10:16.544659 [debug] [MainThread]: On debug: Close
[0m22:10:16.541847 [debug] [MainThread]: On debug: Close
[0m22:10:16.580167 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m22:10:16.578591 [info ] [MainThread]: [32mAll checks passed![0m
[0m22:10:16.575604 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m22:10:16.587796 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m22:10:16.612974 [info ] [MainThread]: [32mAll checks passed![0m
[0m22:10:16.626409 [info ] [MainThread]: [32mAll checks passed![0m
[0m22:10:16.624580 [info ] [MainThread]: [32mAll checks passed![0m
[0m22:10:16.665139 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 15.457794, "process_user_time": 11.458352, "process_kernel_time": 2.904633, "process_mem_max_rss": "111204", "process_in_blocks": "6568", "process_out_blocks": "712"}
[0m22:10:16.672039 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 15.467351, "process_user_time": 10.637813, "process_kernel_time": 3.997239, "process_mem_max_rss": "111052", "process_in_blocks": "10472", "process_out_blocks": "632"}
[0m22:10:16.670556 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 15.463474, "process_user_time": 11.170536, "process_kernel_time": 2.779272, "process_mem_max_rss": "111072", "process_in_blocks": "8840", "process_out_blocks": "560"}
[0m22:10:16.666194 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 15.461339, "process_user_time": 8.613861, "process_kernel_time": 1.638282, "process_mem_max_rss": "111260", "process_in_blocks": "3824", "process_out_blocks": "720"}
[0m22:10:16.664862 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 15.45784, "process_user_time": 5.608867, "process_kernel_time": 0.508971, "process_mem_max_rss": "111320", "process_in_blocks": "2016", "process_out_blocks": "648"}
[0m22:10:16.686219 [debug] [MainThread]: Command `dbt debug` succeeded at 22:10:16.685849 after 15.48 seconds
[0m22:10:16.696262 [debug] [MainThread]: Command `dbt debug` succeeded at 22:10:16.695869 after 15.49 seconds
[0m22:10:16.716727 [debug] [MainThread]: Command `dbt debug` succeeded at 22:10:16.716251 after 15.51 seconds
[0m22:10:16.708364 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m22:10:16.717867 [debug] [MainThread]: Command `dbt debug` succeeded at 22:10:16.717489 after 15.51 seconds
[0m22:10:16.697511 [debug] [MainThread]: Command `dbt debug` succeeded at 22:10:16.697049 after 15.49 seconds
[0m22:10:16.744302 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m22:10:16.761225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05b8032890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05b8033850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05bb146b90>]}
[0m22:10:16.760909 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m22:10:16.777847 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m22:10:16.777607 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m22:10:16.841816 [debug] [MainThread]: Flushing usage events
[0m22:10:16.841731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc82c9ccb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc82b1faf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc82b1f9510>]}
[0m22:10:16.876133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1333e40550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13352d9110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1333e23410>]}
[0m22:10:16.809154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6303f825d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6303c15550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6303b59550>]}
[0m22:10:16.906684 [debug] [MainThread]: Flushing usage events
[0m22:10:16.921752 [debug] [MainThread]: Flushing usage events
[0m22:10:16.922660 [debug] [MainThread]: Flushing usage events
[0m22:10:16.894436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff447dbb210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff446532810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff448bf8a90>]}
[0m22:10:16.975523 [debug] [MainThread]: Flushing usage events
[0m22:10:17.323061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d075c6f-d538-4637-be95-f2fd1ae6ceac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c036dea90>]}
[0m22:10:17.352118 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m22:10:17.451420 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m22:10:17.473663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '707c2f0e-e164-4977-97c0-43eb25a009de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76ee191510>]}
[0m22:10:17.493291 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m22:10:17.618426 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m22:10:18.073855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc58fbe0790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc58fbe1950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc58fbcc1d0>]}


============================== 22:10:18.093061 | c077658a-8a27-4f28-8700-e6da6f69b69a ==============================
[0m22:10:18.093061 [info ] [MainThread]: Running with dbt=1.7.0
[0m22:10:18.104821 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/app/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug --project-dir /app/dbt', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:10:18.130551 [info ] [MainThread]: dbt version: 1.7.0
[0m22:10:18.138743 [info ] [MainThread]: python version: 3.11.13
[0m22:10:18.150382 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m22:10:18.158557 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m22:10:18.603794 [info ] [MainThread]: Using profiles dir at /app
[0m22:10:18.615995 [info ] [MainThread]: Using profiles.yml file at /app/profiles.yml
[0m22:10:18.624486 [info ] [MainThread]: Using dbt_project.yml file at /app/dbt/dbt_project.yml
[0m22:10:18.635300 [info ] [MainThread]: adapter type: postgres
[0m22:10:18.644597 [info ] [MainThread]: adapter version: 1.7.0
[0m22:10:19.105591 [info ] [MainThread]: Configuration:
[0m22:10:19.120623 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:10:19.137466 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:10:19.151254 [info ] [MainThread]: Required dependencies:
[0m22:10:19.167555 [debug] [MainThread]: Executing "git --help"
[0m22:10:19.186314 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:10:19.203508 [debug] [MainThread]: STDERR: "b''"
[0m22:10:19.218637 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:10:19.233301 [info ] [MainThread]: Connection:
[0m22:10:19.248199 [info ] [MainThread]:   host: postgres
[0m22:10:19.257271 [info ] [MainThread]:   port: 5432
[0m22:10:19.271177 [info ] [MainThread]:   user: postgres
[0m22:10:19.285799 [info ] [MainThread]:   database: crypto_warehouse
[0m22:10:19.299460 [info ] [MainThread]:   schema: public
[0m22:10:19.307480 [info ] [MainThread]:   connect_timeout: 10
[0m22:10:19.447239 [info ] [MainThread]:   role: None
[0m22:10:19.566293 [info ] [MainThread]:   search_path: None
[0m22:10:19.829086 [info ] [MainThread]:   keepalives_idle: 0
[0m22:10:20.017526 [info ] [MainThread]:   sslmode: None
[0m22:10:20.072902 [info ] [MainThread]:   sslcert: None
[0m22:10:20.245056 [info ] [MainThread]:   sslkey: None
[0m22:10:20.266003 [info ] [MainThread]:   sslrootcert: None
[0m22:10:20.285180 [info ] [MainThread]:   application_name: dbt
[0m22:10:20.300826 [info ] [MainThread]:   retries: 1
[0m22:10:20.314281 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m22:10:20.331746 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m22:10:20.342863 [debug] [MainThread]: Using postgres connection "debug"
[0m22:10:20.350759 [debug] [MainThread]: On debug: select 1 as id
[0m22:10:20.359221 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:10:20.370354 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m22:10:20.377784 [debug] [MainThread]: On debug: Close
[0m22:10:20.385533 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m22:10:20.394767 [info ] [MainThread]: [32mAll checks passed![0m
[0m22:10:20.403438 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.525018, "process_user_time": 7.568569, "process_kernel_time": 0.863528, "process_mem_max_rss": "111024", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:10:20.410804 [debug] [MainThread]: Command `dbt debug` succeeded at 22:10:20.410498 after 2.53 seconds
[0m22:10:20.417741 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m22:10:20.424930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc58e4a5990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc58e382f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc58fc44550>]}
[0m22:10:20.432253 [debug] [MainThread]: Flushing usage events
[0m22:10:26.804657 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:10:26.804619 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:10:26.812714 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:10:26.812992 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:10:26.836247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d075c6f-d538-4637-be95-f2fd1ae6ceac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c00dffc10>]}
[0m22:10:26.837030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '707c2f0e-e164-4977-97c0-43eb25a009de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76ecc129d0>]}
[0m22:10:27.375428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '707c2f0e-e164-4977-97c0-43eb25a009de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76eb350d90>]}
[0m22:10:27.394340 [info ] [MainThread]: Found 7 models, 14 tests, 2 sources, 0 exposures, 0 metrics, 403 macros, 0 groups, 0 semantic models
[0m22:10:27.375572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d075c6f-d538-4637-be95-f2fd1ae6ceac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c01081b90>]}
[0m22:10:27.410324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '707c2f0e-e164-4977-97c0-43eb25a009de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76ecc1ac90>]}
[0m22:10:27.418121 [info ] [MainThread]: Found 7 models, 14 tests, 2 sources, 0 exposures, 0 metrics, 403 macros, 0 groups, 0 semantic models
[0m22:10:27.432583 [info ] [MainThread]:
[0m22:10:27.462742 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:10:27.486481 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse'
[0m22:10:27.442710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d075c6f-d538-4637-be95-f2fd1ae6ceac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c028f6d10>]}
[0m22:10:27.527195 [info ] [MainThread]:
[0m22:10:27.489419 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse'
[0m22:10:27.539676 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:10:27.566127 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse'
[0m22:10:27.576060 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse"
[0m22:10:27.569245 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse'
[0m22:10:27.602775 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse"
[0m22:10:27.633035 [debug] [ThreadPool]: On list_crypto_warehouse: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse"} */

    select distinct nspname from pg_namespace

[0m22:10:27.652615 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse"
[0m22:10:27.658544 [debug] [ThreadPool]: On list_crypto_warehouse: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse"} */

    select distinct nspname from pg_namespace

[0m22:10:27.658053 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse"
[0m22:10:27.669597 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:10:27.680942 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:10:27.696158 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m22:10:27.675016 [debug] [ThreadPool]: On list_crypto_warehouse: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse"} */

    select distinct nspname from pg_namespace

[0m22:10:27.703536 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m22:10:27.705643 [debug] [ThreadPool]: On list_crypto_warehouse: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse"} */

    select distinct nspname from pg_namespace

[0m22:10:27.707593 [debug] [ThreadPool]: On list_crypto_warehouse: Close
[0m22:10:27.721002 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:10:27.735994 [debug] [ThreadPool]: On list_crypto_warehouse: Close
[0m22:10:27.737215 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:10:27.756852 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m22:10:27.772189 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_warehouse, now list_crypto_warehouse_public_marts)
[0m22:10:27.773269 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m22:10:27.774201 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_warehouse, now list_crypto_warehouse_public_staging)
[0m22:10:27.788928 [debug] [ThreadPool]: On list_crypto_warehouse: Close
[0m22:10:27.776491 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse_public_dbt_test__audit'
[0m22:10:27.809839 [debug] [ThreadPool]: On list_crypto_warehouse: Close
[0m22:10:27.817652 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_marts"
[0m22:10:27.859650 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_warehouse, now list_crypto_warehouse_public_dbt_test__audit)
[0m22:10:27.833678 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_staging"
[0m22:10:27.854841 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_dbt_test__audit"
[0m22:10:27.861558 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_warehouse, now list_crypto_warehouse_public_staging)
[0m22:10:27.885091 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: BEGIN
[0m22:10:27.863638 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse_public_marts'
[0m22:10:27.905980 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: BEGIN
[0m22:10:27.915367 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: BEGIN
[0m22:10:27.916888 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_dbt_test__audit"
[0m22:10:27.923115 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:10:27.922354 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_staging"
[0m22:10:27.930465 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:10:27.934817 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_marts"
[0m22:10:27.939526 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:10:27.961517 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: BEGIN
[0m22:10:27.952512 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:10:27.952421 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: BEGIN
[0m22:10:27.977256 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_marts"
[0m22:10:27.942652 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: BEGIN
[0m22:10:27.971066 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:10:27.974103 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:10:27.963903 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:10:27.983083 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:10:27.989730 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_marts"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'

[0m22:10:27.994225 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:10:27.998190 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_dbt_test__audit"
[0m22:10:28.012910 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:10:28.011676 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_staging"
[0m22:10:28.027089 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:10:28.039915 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_dbt_test__audit"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'

[0m22:10:28.038307 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:10:28.049381 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_staging"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'

[0m22:10:28.043377 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_marts"
[0m22:10:28.055670 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_staging"
[0m22:10:28.065046 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_dbt_test__audit"
[0m22:10:28.079474 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_marts"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'

[0m22:10:28.089427 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_staging"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'

[0m22:10:28.103572 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_dbt_test__audit"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'

[0m22:10:28.684303 [debug] [ThreadPool]: SQL status: SELECT 3 in 1.0 seconds
[0m22:10:28.683429 [debug] [ThreadPool]: SQL status: SELECT 3 in 1.0 seconds
[0m22:10:28.684272 [debug] [ThreadPool]: SQL status: SELECT 2 in 1.0 seconds
[0m22:10:28.685265 [debug] [ThreadPool]: SQL status: SELECT 0 in 1.0 seconds
[0m22:10:28.686135 [debug] [ThreadPool]: SQL status: SELECT 2 in 1.0 seconds
[0m22:10:28.685534 [debug] [ThreadPool]: SQL status: SELECT 0 in 1.0 seconds
[0m22:10:28.694097 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: ROLLBACK
[0m22:10:28.694776 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: ROLLBACK
[0m22:10:28.704974 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: ROLLBACK
[0m22:10:28.705439 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: ROLLBACK
[0m22:10:28.717690 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: ROLLBACK
[0m22:10:28.715592 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: ROLLBACK
[0m22:10:28.729722 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: Close
[0m22:10:28.729245 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: Close
[0m22:10:28.742931 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: Close
[0m22:10:28.744350 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: Close
[0m22:10:28.757029 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: Close
[0m22:10:28.759465 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: Close
[0m22:10:28.803736 [debug] [MainThread]: Using postgres connection "master"
[0m22:10:28.811464 [debug] [MainThread]: Using postgres connection "master"
[0m22:10:28.811494 [debug] [MainThread]: On master: BEGIN
[0m22:10:28.820449 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:10:28.819391 [debug] [MainThread]: On master: BEGIN
[0m22:10:28.829334 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:10:28.834303 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:10:28.843070 [debug] [MainThread]: Using postgres connection "master"
[0m22:10:28.843642 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:10:28.850825 [debug] [MainThread]: Using postgres connection "master"
[0m22:10:28.851142 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:10:28.869681 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:10:29.320804 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m22:10:29.320802 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m22:10:29.331288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d075c6f-d538-4637-be95-f2fd1ae6ceac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c00e58550>]}
[0m22:10:29.331704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '707c2f0e-e164-4977-97c0-43eb25a009de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76eccf7310>]}
[0m22:10:29.340437 [debug] [MainThread]: On master: ROLLBACK
[0m22:10:29.339711 [debug] [MainThread]: On master: ROLLBACK
[0m22:10:29.349847 [debug] [MainThread]: Using postgres connection "master"
[0m22:10:29.349577 [debug] [MainThread]: Using postgres connection "master"
[0m22:10:29.358417 [debug] [MainThread]: On master: BEGIN
[0m22:10:29.358487 [debug] [MainThread]: On master: BEGIN
[0m22:10:29.368029 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:10:29.368072 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:10:29.376683 [debug] [MainThread]: On master: COMMIT
[0m22:10:29.376769 [debug] [MainThread]: On master: COMMIT
[0m22:10:29.384811 [debug] [MainThread]: Using postgres connection "master"
[0m22:10:29.384818 [debug] [MainThread]: Using postgres connection "master"
[0m22:10:29.393002 [debug] [MainThread]: On master: COMMIT
[0m22:10:29.393008 [debug] [MainThread]: On master: COMMIT
[0m22:10:29.401070 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:10:29.401036 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:10:29.409699 [debug] [MainThread]: On master: Close
[0m22:10:29.409697 [debug] [MainThread]: On master: Close
[0m22:10:29.419262 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:10:29.419258 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:10:29.430645 [info ] [MainThread]:
[0m22:10:29.430530 [info ] [MainThread]:
[0m22:10:29.588455 [debug] [Thread-1 (]: Began running node model.crypto_analytics.stg_crypto_prices
[0m22:10:29.587982 [debug] [Thread-1 (]: Began running node model.crypto_analytics.stg_crypto_prices
[0m22:10:29.593625 [debug] [Thread-2 (]: Began running node model.crypto_analytics.stg_pipeline_runs
[0m22:10:29.589685 [debug] [Thread-2 (]: Began running node model.crypto_analytics.stg_pipeline_runs
[0m22:10:29.599283 [info ] [Thread-1 (]: 1 of 5 START sql table model public_staging.stg_crypto_prices .................. [RUN]
[0m22:10:29.599363 [info ] [Thread-1 (]: 1 of 5 START sql table model public_staging.stg_crypto_prices .................. [RUN]
[0m22:10:29.608953 [info ] [Thread-2 (]: 2 of 5 START sql view model public_staging.stg_pipeline_runs ................... [RUN]
[0m22:10:29.609096 [info ] [Thread-2 (]: 2 of 5 START sql view model public_staging.stg_pipeline_runs ................... [RUN]
[0m22:10:29.622341 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_staging, now model.crypto_analytics.stg_crypto_prices)
[0m22:10:29.622348 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_dbt_test__audit, now model.crypto_analytics.stg_crypto_prices)
[0m22:10:29.640512 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_staging, now model.crypto_analytics.stg_pipeline_runs)
[0m22:10:29.633715 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_dbt_test__audit, now model.crypto_analytics.stg_pipeline_runs)
[0m22:10:29.661696 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics.stg_crypto_prices
[0m22:10:29.644723 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics.stg_crypto_prices
[0m22:10:29.677295 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics.stg_pipeline_runs
[0m22:10:29.683033 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics.stg_pipeline_runs
[0m22:10:29.742467 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics.stg_crypto_prices"
[0m22:10:29.731193 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics.stg_crypto_prices"
[0m22:10:29.749634 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics.stg_pipeline_runs"
[0m22:10:29.750918 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics.stg_pipeline_runs"
[0m22:10:29.815697 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.stg_crypto_prices (compile): 22:10:29.692026 => 22:10:29.814891
[0m22:10:29.817372 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.stg_pipeline_runs (compile): 22:10:29.742294 => 22:10:29.816615
[0m22:10:29.825259 [debug] [Thread-1 (]: Began executing node model.crypto_analytics.stg_crypto_prices
[0m22:10:29.820204 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.stg_crypto_prices (compile): 22:10:29.689653 => 22:10:29.819447
[0m22:10:29.828814 [debug] [Thread-2 (]: Began executing node model.crypto_analytics.stg_pipeline_runs
[0m22:10:29.838798 [debug] [Thread-1 (]: Began executing node model.crypto_analytics.stg_crypto_prices
[0m22:10:30.020989 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.stg_pipeline_runs (compile): 22:10:29.743304 => 22:10:30.020383
[0m22:10:30.078452 [debug] [Thread-2 (]: Began executing node model.crypto_analytics.stg_pipeline_runs
[0m22:10:30.079912 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics.stg_crypto_prices"
[0m22:10:30.148716 [debug] [Thread-2 (]: Writing runtime sql for node "model.crypto_analytics.stg_pipeline_runs"
[0m22:10:30.175847 [debug] [Thread-2 (]: Writing runtime sql for node "model.crypto_analytics.stg_pipeline_runs"
[0m22:10:30.195881 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics.stg_crypto_prices"
[0m22:10:30.215557 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:10:30.221231 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m22:10:30.235120 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m22:10:30.229893 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: BEGIN
[0m22:10:30.243177 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: BEGIN
[0m22:10:30.251136 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:10:30.237755 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: BEGIN
[0m22:10:30.263990 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:10:30.245776 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:10:30.276335 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m22:10:30.274123 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:10:30.295550 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:10:30.291604 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:10:30.309181 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:10:30.297207 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */

  create view "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_tmp"


  as (
    SELECT
    id as run_id,
    run_id as run_identifier,
    stage,
    status,
    records_processed,
    error_message,
    started_at,
    completed_at,
    CASE
        WHEN completed_at IS NOT NULL
        THEN EXTRACT(EPOCH FROM (completed_at - started_at))
        ELSE NULL
    END as duration_seconds
FROM "crypto_warehouse"."public"."pipeline_runs"
  );
[0m22:10:30.314742 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:10:30.324329 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: BEGIN
[0m22:10:30.329687 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m22:10:30.340929 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:10:30.337991 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */




  create  table "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_tmp"


    as

  (


WITH source_data AS (
    SELECT
        id as price_id,
        UPPER(TRIM(symbol)) as symbol,
        TRIM(name) as crypto_name,
        current_price as price_usd,
        market_cap,
        total_volume as volume_24h,
        price_change_24h,
        price_change_percentage_24h as price_change_pct_24h,
        market_cap_rank,
        extracted_at,
        created_at,

        CASE WHEN current_price <= 0 THEN TRUE ELSE FALSE END as is_invalid_price,
        CASE WHEN market_cap <= 0 THEN TRUE ELSE FALSE END as is_invalid_market_cap,
        CASE WHEN total_volume < 0 THEN TRUE ELSE FALSE END as is_invalid_volume
    FROM "crypto_warehouse"."public"."crypto_prices_raw"
),

cleaned_data AS (
    SELECT
        *,
        DATE(extracted_at) as extraction_date,
        DATE_TRUNC('hour', extracted_at) as extraction_hour,
        CASE
            WHEN LAG(price_usd) OVER (
                PARTITION BY symbol ORDER BY extracted_at
            ) IS NOT NULL THEN
                ((price_usd - LAG(price_usd) OVER (
                    PARTITION BY symbol ORDER BY extracted_at
                )) / LAG(price_usd) OVER (
                    PARTITION BY symbol ORDER BY extracted_at
                )) * 100
        END as price_change_pct_from_previous
    FROM source_data
    WHERE NOT is_invalid_price AND NOT is_invalid_volume
)

SELECT * FROM cleaned_data
  );

[0m22:10:30.354220 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:10:30.346661 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */

  create view "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_tmp"


  as (
    SELECT
    id as run_id,
    run_id as run_identifier,
    stage,
    status,
    records_processed,
    error_message,
    started_at,
    completed_at,
    CASE
        WHEN completed_at IS NOT NULL
        THEN EXTRACT(EPOCH FROM (completed_at - started_at))
        ELSE NULL
    END as duration_seconds
FROM "crypto_warehouse"."public"."pipeline_runs"
  );
[0m22:10:30.364472 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:10:30.385254 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */




  create  table "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_tmp"


    as

  (


WITH source_data AS (
    SELECT
        id as price_id,
        UPPER(TRIM(symbol)) as symbol,
        TRIM(name) as crypto_name,
        current_price as price_usd,
        market_cap,
        total_volume as volume_24h,
        price_change_24h,
        price_change_percentage_24h as price_change_pct_24h,
        market_cap_rank,
        extracted_at,
        created_at,

        CASE WHEN current_price <= 0 THEN TRUE ELSE FALSE END as is_invalid_price,
        CASE WHEN market_cap <= 0 THEN TRUE ELSE FALSE END as is_invalid_market_cap,
        CASE WHEN total_volume < 0 THEN TRUE ELSE FALSE END as is_invalid_volume
    FROM "crypto_warehouse"."public"."crypto_prices_raw"
),

cleaned_data AS (
    SELECT
        *,
        DATE(extracted_at) as extraction_date,
        DATE_TRUNC('hour', extracted_at) as extraction_hour,
        CASE
            WHEN LAG(price_usd) OVER (
                PARTITION BY symbol ORDER BY extracted_at
            ) IS NOT NULL THEN
                ((price_usd - LAG(price_usd) OVER (
                    PARTITION BY symbol ORDER BY extracted_at
                )) / LAG(price_usd) OVER (
                    PARTITION BY symbol ORDER BY extracted_at
                )) * 100
        END as price_change_pct_from_previous
    FROM source_data
    WHERE NOT is_invalid_price AND NOT is_invalid_volume
)

SELECT * FROM cleaned_data
  );

[0m22:10:31.662395 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 1.0 seconds
[0m22:10:31.679937 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m22:10:31.687431 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */
alter table "crypto_warehouse"."public_staging"."stg_pipeline_runs" rename to "stg_pipeline_runs__dbt_backup"
[0m22:10:31.694869 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:10:31.706491 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m22:10:31.713951 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */
alter table "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_tmp" rename to "stg_pipeline_runs"
[0m22:10:31.721824 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:10:31.773546 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: COMMIT
[0m22:10:31.781020 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m22:10:31.788752 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: COMMIT
[0m22:10:31.889107 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m22:10:31.890846 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 2.0 seconds
[0m22:10:31.911403 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m22:10:31.916270 [debug] [Thread-2 (]: Applying DROP to: "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_backup"
[0m22:10:31.919770 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */
alter table "crypto_warehouse"."public_staging"."stg_pipeline_runs" rename to "stg_pipeline_runs__dbt_backup"
[0m22:10:31.933669 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m22:10:31.939318 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */
drop view if exists "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_backup" cascade
[0m22:10:31.978049 [debug] [Thread-1 (]: SQL status: SELECT 10 in 2.0 seconds
[0m22:10:31.992238 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:10:31.999146 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */
alter table "crypto_warehouse"."public_staging"."stg_crypto_prices" rename to "stg_crypto_prices__dbt_backup"
[0m22:10:32.027783 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "stg_pipeline_runs__dbt_backup" already exists

[0m22:10:32.035813 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: ROLLBACK
[0m22:10:32.043801 [debug] [Thread-2 (]: Postgres adapter: Error running SQL: macro rename_relation
[0m22:10:32.052445 [debug] [Thread-2 (]: Postgres adapter: Rolling back transaction.
[0m22:10:32.061010 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.stg_pipeline_runs (execute): 22:10:29.916785 => 22:10:32.060300
[0m22:10:32.069682 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: Close
[0m22:10:32.104424 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:10:32.118826 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:10:32.138801 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */
alter table "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_tmp" rename to "stg_crypto_prices"
[0m22:10:32.153626 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:10:32.191283 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:10:32.200257 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */

        CREATE INDEX IF NOT EXISTS idx_stg_crypto_prices_symbol_time ON "crypto_warehouse"."public_staging"."stg_crypto_prices" (symbol, extracted_at)

[0m22:10:32.209978 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:10:32.266045 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: COMMIT
[0m22:10:32.276163 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:10:32.285656 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: COMMIT
[0m22:10:32.628547 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:10:32.645219 [debug] [Thread-1 (]: Applying DROP to: "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_backup"
[0m22:10:32.663022 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:10:32.670116 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */
drop table if exists "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_backup" cascade
[0m22:10:32.801358 [debug] [Thread-2 (]: SQL status: DROP VIEW in 1.0 seconds
[0m22:10:32.810048 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.stg_pipeline_runs (execute): 22:10:30.087653 => 22:10:32.809700
[0m22:10:32.816971 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: Close
[0m22:10:32.824939 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d075c6f-d538-4637-be95-f2fd1ae6ceac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c00dff5d0>]}
[0m22:10:32.833900 [info ] [Thread-2 (]: 2 of 5 OK created sql view model public_staging.stg_pipeline_runs .............. [[32mCREATE VIEW[0m in 3.19s]
[0m22:10:32.841217 [debug] [Thread-2 (]: Finished running node model.crypto_analytics.stg_pipeline_runs
[0m22:10:32.849341 [debug] [Thread-4 (]: Began running node model.crypto_analytics.mart_pipeline_monitoring
[0m22:10:32.862728 [info ] [Thread-4 (]: 3 of 5 START sql table model public_marts.mart_pipeline_monitoring ............. [RUN]
[0m22:10:32.898658 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:10:32.899229 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.crypto_analytics.mart_pipeline_monitoring'
[0m22:10:32.917736 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.stg_crypto_prices (execute): 22:10:29.987444 => 22:10:32.917271
[0m22:10:32.934526 [debug] [Thread-4 (]: Began compiling node model.crypto_analytics.mart_pipeline_monitoring
[0m22:10:32.941860 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: Close
[0m22:10:32.966221 [debug] [Thread-4 (]: Writing injected SQL for node "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:10:32.965510 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '707c2f0e-e164-4977-97c0-43eb25a009de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76eb3afbd0>]}
[0m22:10:32.986406 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public_staging.stg_crypto_prices ............. [[32mSELECT 10[0m in 3.34s]
[0m22:10:33.006191 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.stg_crypto_prices
[0m22:10:33.055765 [debug] [Thread-4 (]: Began running node model.crypto_analytics.int_crypto_daily_aggs
[0m22:10:33.057205 [debug] [Thread-3 (]: Began running node model.crypto_analytics.int_crypto_hourly_aggs
[0m22:10:33.060349 [debug] [Thread-1 (]: Began running node model.crypto_analytics.mart_crypto_latest_prices
[0m22:10:33.069256 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.crypto_analytics.int_crypto_daily_aggs'
[0m22:10:33.146600 [debug] [Thread-4 (]: Timing info for model.crypto_analytics.mart_pipeline_monitoring (compile): 22:10:32.955655 => 22:10:33.142046
[0m22:10:33.095886 [debug] [Thread-2 (]: Database Error in model stg_pipeline_runs (models/staging/stg_pipeline_runs.sql)
  relation "stg_pipeline_runs__dbt_backup" already exists
  compiled Code at target/run/crypto_analytics/models/staging/stg_pipeline_runs.sql
[0m22:10:33.196175 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '707c2f0e-e164-4977-97c0-43eb25a009de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76ecc5ddd0>]}
[0m22:10:33.190748 [debug] [Thread-1 (]: SQL status: SELECT 10 in 3.0 seconds
[0m22:10:33.221771 [error] [Thread-2 (]: 2 of 5 ERROR creating sql view model public_staging.stg_pipeline_runs .......... [[31mERROR[0m in 3.56s]
[0m22:10:33.198734 [debug] [Thread-4 (]: Began executing node model.crypto_analytics.mart_pipeline_monitoring
[0m22:10:33.150655 [debug] [Thread-4 (]: Began compiling node model.crypto_analytics.int_crypto_daily_aggs
[0m22:10:33.101415 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_marts, now model.crypto_analytics.int_crypto_hourly_aggs)
[0m22:10:33.283064 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:10:33.119271 [info ] [Thread-1 (]: 3 of 5 START sql table model public_marts.mart_crypto_latest_prices ............ [RUN]
[0m22:10:33.342878 [debug] [Thread-4 (]: Writing runtime sql for node "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:10:33.293105 [debug] [Thread-2 (]: Finished running node model.crypto_analytics.stg_pipeline_runs
[0m22:10:33.351014 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */
alter table "crypto_warehouse"."public_staging"."stg_crypto_prices" rename to "stg_crypto_prices__dbt_backup"
[0m22:10:33.382743 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:10:33.334154 [debug] [Thread-4 (]: Writing injected SQL for node "model.crypto_analytics.int_crypto_daily_aggs"
[0m22:10:33.348841 [debug] [Thread-3 (]: Began compiling node model.crypto_analytics.int_crypto_hourly_aggs
[0m22:10:33.412387 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:10:33.359587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.stg_crypto_prices, now model.crypto_analytics.mart_crypto_latest_prices)
[0m22:10:33.424428 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */
alter table "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_tmp" rename to "stg_crypto_prices"
[0m22:10:33.380713 [debug] [Thread-2 (]: Began running node model.crypto_analytics.mart_pipeline_monitoring
[0m22:10:33.439629 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:10:33.428635 [debug] [Thread-3 (]: Writing injected SQL for node "model.crypto_analytics.int_crypto_hourly_aggs"
[0m22:10:33.434021 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics.mart_crypto_latest_prices
[0m22:10:33.491321 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:10:33.446925 [info ] [Thread-2 (]: 4 of 5 SKIP relation public_marts.mart_pipeline_monitoring ..................... [[33mSKIP[0m]
[0m22:10:33.514941 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */

        CREATE INDEX IF NOT EXISTS idx_stg_crypto_prices_symbol_time ON "crypto_warehouse"."public_staging"."stg_crypto_prices" (symbol, extracted_at)

[0m22:10:33.495617 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:10:33.522418 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:10:33.524145 [debug] [Thread-4 (]: Timing info for model.crypto_analytics.int_crypto_daily_aggs (compile): 22:10:33.326655 => 22:10:33.523366
[0m22:10:33.547299 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: BEGIN
[0m22:10:33.530204 [debug] [Thread-2 (]: Finished running node model.crypto_analytics.mart_pipeline_monitoring
[0m22:10:33.557422 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:10:33.537297 [debug] [Thread-3 (]: Timing info for model.crypto_analytics.int_crypto_hourly_aggs (compile): 22:10:33.411655 => 22:10:33.536432
[0m22:10:33.572490 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m22:10:33.581422 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:10:33.557550 [debug] [Thread-4 (]: Finished running node model.crypto_analytics.int_crypto_daily_aggs
[0m22:10:33.580159 [debug] [Thread-3 (]: Finished running node model.crypto_analytics.int_crypto_hourly_aggs
[0m22:10:33.590717 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */




  create  table "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_tmp"


    as

  (


WITH pipeline_metrics AS (
    SELECT
        run_id,
        stage,
        status,
        records_processed,
        error_message,
        started_at,
        completed_at,
        EXTRACT(EPOCH FROM completed_at - started_at) AS duration_seconds,

        -- Flag to compute success rate
        CASE WHEN status = 'success' THEN 1 ELSE 0 END AS is_success,

        -- Classify performance
        CASE
            WHEN completed_at IS NULL THEN 'Running'
            WHEN EXTRACT(EPOCH FROM completed_at - started_at) < 30 THEN 'Fast'
            WHEN EXTRACT(EPOCH FROM completed_at - started_at) < 120 THEN 'Normal'
            ELSE 'Slow'
        END AS performance_category

    FROM "crypto_warehouse"."public_staging"."stg_pipeline_runs"
),

latest_status_per_day_stage AS (
    SELECT
        DATE(started_at) AS run_date,
        stage,
        FIRST_VALUE(status) OVER (
            PARTITION BY DATE(started_at), stage
            ORDER BY started_at DESC
        ) AS latest_run_status
    FROM pipeline_metrics
),

daily_summary AS (
    SELECT
        DATE(started_at) AS run_date,
        stage,

        COUNT(*) AS total_runs,
        SUM(is_success) AS successful_runs,
        SUM(records_processed) AS total_records_processed,
        AVG(duration_seconds) AS avg_duration_seconds,
        MAX(duration_seconds) AS max_duration_seconds,
        ROUND(((SUM(is_success)::FLOAT / COUNT(*)) * 100)::NUMERIC, 2) AS success_rate_pct


    FROM pipeline_metrics
    WHERE started_at >= CURRENT_DATE - INTERVAL '30 days'
    GROUP BY DATE(started_at), stage
)

-- Final result combining metrics with latest run status
SELECT
    ds.*,
    ls.latest_run_status
FROM daily_summary ds
LEFT JOIN latest_status_per_day_stage ls
  ON ds.run_date = ls.run_date AND ds.stage = ls.stage
  );

[0m22:10:33.600116 [debug] [Thread-2 (]: Began running node model.crypto_analytics.mart_crypto_hourly_performance
[0m22:10:33.603251 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.mart_crypto_latest_prices (compile): 22:10:33.475279 => 22:10:33.602544
[0m22:10:33.608723 [info ] [Thread-2 (]: 5 of 5 START sql table model public_marts.mart_crypto_hourly_performance ....... [RUN]
[0m22:10:33.618555 [debug] [Thread-1 (]: Began executing node model.crypto_analytics.mart_crypto_latest_prices
[0m22:10:33.627173 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.stg_pipeline_runs, now model.crypto_analytics.mart_crypto_hourly_performance)
[0m22:10:33.659795 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:10:33.661465 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics.mart_crypto_hourly_performance
[0m22:10:33.856397 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:10:33.865203 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:10:33.875099 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: BEGIN
[0m22:10:33.890878 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:10:33.905122 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:10:33.913658 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:10:33.922691 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */




  create  table "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_tmp"


    as

  (


WITH latest_prices AS (
    SELECT
        symbol,
        crypto_name,
        price_usd,
        market_cap,
        volume_24h,
        price_change_24h,
        price_change_pct_24h,
        market_cap_rank,
        extracted_at,

        ROW_NUMBER() OVER (
            PARTITION BY symbol
            ORDER BY extracted_at DESC
        ) as rn

    FROM "crypto_warehouse"."public_staging"."stg_crypto_prices"
    WHERE extraction_date = CURRENT_DATE
),

price_changes AS (
    SELECT
        symbol,
        crypto_name,
        price_usd as current_price,
        market_cap,
        volume_24h,
        price_change_24h,
        price_change_pct_24h,
        market_cap_rank,
        extracted_at as last_updated,

        -- Calculate additional metrics
        CASE
            WHEN price_change_pct_24h > 10 THEN 'Strong Gain'
            WHEN price_change_pct_24h > 5 THEN 'Moderate Gain'
            WHEN price_change_pct_24h > 0 THEN 'Slight Gain'
            WHEN price_change_pct_24h > -5 THEN 'Slight Loss'
            WHEN price_change_pct_24h > -10 THEN 'Moderate Loss'
            ELSE 'Strong Loss'
        END as price_trend_category,

        -- Market cap category
        CASE
            WHEN market_cap_rank <= 10 THEN 'Large Cap'
            WHEN market_cap_rank <= 50 THEN 'Mid Cap'
            WHEN market_cap_rank <= 100 THEN 'Small Cap'
            ELSE 'Micro Cap'
        END as market_cap_category

    FROM latest_prices
    WHERE rn = 1
)

SELECT * FROM price_changes
  );

[0m22:10:33.935037 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.mart_crypto_hourly_performance (compile): 22:10:33.675185 => 22:10:33.934307
[0m22:10:33.943450 [debug] [Thread-2 (]: Began executing node model.crypto_analytics.mart_crypto_hourly_performance
[0m22:10:33.964495 [debug] [Thread-2 (]: Writing runtime sql for node "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:10:33.991135 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:10:34.003481 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: COMMIT
[0m22:10:34.012554 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:10:34.020891 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:10:34.021844 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: COMMIT
[0m22:10:34.029321 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: BEGIN
[0m22:10:34.037626 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:10:34.050476 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:10:34.058970 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:10:34.067883 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */




  create  table "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_tmp"


    as

  (


WITH  __dbt__cte__int_crypto_hourly_aggs as (


WITH base_data AS (
    SELECT
        symbol,
        crypto_name,
        DATE_TRUNC('hour', extracted_at) AS extraction_hour,
        price_usd,
        volume_24h,
        market_cap,
        CASE WHEN price_usd <= 0 THEN 1 ELSE 0 END AS is_invalid
    FROM "crypto_warehouse"."public_staging"."stg_crypto_prices"
)

SELECT
    symbol,
    crypto_name,
    extraction_hour,
    COUNT(*) AS total_records,
    SUM(is_invalid) AS invalid_price_records,
    AVG(price_usd) AS avg_price_usd,
    MIN(price_usd) AS min_price_usd,
    MAX(price_usd) AS max_price_usd,
    STDDEV(price_usd) AS price_volatility,
    AVG(volume_24h) AS avg_volume_24h,
    AVG(market_cap) AS avg_market_cap
FROM base_data
GROUP BY symbol, crypto_name, extraction_hour
), hourly_data AS (
    SELECT
        symbol,
        crypto_name,
        extraction_hour,
        avg_price_usd,
        min_price_usd,
        max_price_usd,
        price_volatility,
        avg_volume_24h,
        avg_market_cap,
        total_records,

        -- Calculate hourly change
        LAG(avg_price_usd) OVER (
            PARTITION BY symbol
            ORDER BY extraction_hour
        ) as previous_hour_price,

        -- Data quality score
        (1.0 - (invalid_price_records::FLOAT / GREATEST(total_records, 1))) * 100 as data_quality_score

    FROM __dbt__cte__int_crypto_hourly_aggs
),

performance_metrics AS (
    SELECT
        *,
        CASE
            WHEN previous_hour_price IS NOT NULL AND previous_hour_price > 0 THEN
                ((avg_price_usd - previous_hour_price) / previous_hour_price) * 100
            ELSE NULL
        END as hourly_change_pct,

        -- Volatility category
        CASE
            WHEN price_volatility IS NULL THEN 'Unknown'
            WHEN price_volatility < avg_price_usd * 0.01 THEN 'Low Volatility'
            WHEN price_volatility < avg_price_usd * 0.05 THEN 'Medium Volatility'
            ELSE 'High Volatility'
        END as volatility_category

    FROM hourly_data
)

SELECT * FROM performance_metrics
  );

[0m22:10:34.235604 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:10:34.276097 [debug] [Thread-1 (]: Applying DROP to: "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_backup"
[0m22:10:34.292919 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:10:34.302880 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */
drop table if exists "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_backup" cascade
[0m22:10:34.484842 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:10:34.495367 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.stg_crypto_prices (execute): 22:10:29.834330 => 22:10:34.494805
[0m22:10:34.504166 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: Close
[0m22:10:34.518833 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d075c6f-d538-4637-be95-f2fd1ae6ceac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c028f7650>]}
[0m22:10:34.536394 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public_staging.stg_crypto_prices ............. [[32mSELECT 10[0m in 4.90s]
[0m22:10:34.556291 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.stg_crypto_prices
[0m22:10:34.576897 [debug] [Thread-2 (]: Began running node model.crypto_analytics.int_crypto_daily_aggs
[0m22:10:34.577938 [debug] [Thread-3 (]: Began running node model.crypto_analytics.int_crypto_hourly_aggs
[0m22:10:34.578963 [debug] [Thread-1 (]: Began running node model.crypto_analytics.mart_crypto_latest_prices
[0m22:10:34.583153 [debug] [Thread-4 (]: SQL status: SELECT 4 in 1.0 seconds
[0m22:10:34.592427 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.stg_pipeline_runs, now model.crypto_analytics.int_crypto_daily_aggs)
[0m22:10:34.607082 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_marts, now model.crypto_analytics.int_crypto_hourly_aggs)
[0m22:10:34.615322 [info ] [Thread-1 (]: 4 of 5 START sql table model public_marts.mart_crypto_latest_prices ............ [RUN]
[0m22:10:34.630041 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:10:34.635458 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics.int_crypto_daily_aggs
[0m22:10:34.643245 [debug] [Thread-3 (]: Began compiling node model.crypto_analytics.int_crypto_hourly_aggs
[0m22:10:34.771973 [debug] [Thread-1 (]: SQL status: SELECT 5 in 1.0 seconds
[0m22:10:34.772886 [debug] [Thread-2 (]: SQL status: SELECT 10 in 1.0 seconds
[0m22:10:34.788861 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:10:34.803394 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:10:34.811820 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_latest_prices" rename to "mart_crypto_latest_prices__dbt_backup"
[0m22:10:34.651654 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.stg_crypto_prices, now model.crypto_analytics.mart_crypto_latest_prices)
[0m22:10:34.824605 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance" rename to "mart_crypto_hourly_performance__dbt_backup"
[0m22:10:34.659719 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */
alter table "crypto_warehouse"."public_marts"."mart_pipeline_monitoring" rename to "mart_pipeline_monitoring__dbt_backup"
[0m22:10:34.837063 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:10:34.685362 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics.int_crypto_daily_aggs"
[0m22:10:34.845246 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:10:34.836057 [debug] [Thread-3 (]: Writing injected SQL for node "model.crypto_analytics.int_crypto_hourly_aggs"
[0m22:10:34.842149 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics.mart_crypto_latest_prices
[0m22:10:34.862670 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:10:34.852753 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:10:34.884322 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:10:34.902619 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:10:34.922224 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_tmp" rename to "mart_crypto_latest_prices"
[0m22:10:34.947038 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:10:34.952469 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_tmp" rename to "mart_crypto_hourly_performance"
[0m22:10:34.963440 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:10:34.960130 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.int_crypto_daily_aggs (compile): 22:10:34.667035 => 22:10:34.958836
[0m22:10:34.966227 [debug] [Thread-3 (]: Timing info for model.crypto_analytics.int_crypto_hourly_aggs (compile): 22:10:34.695934 => 22:10:34.964780
[0m22:10:34.972635 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */
alter table "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_tmp" rename to "mart_pipeline_monitoring"
[0m22:10:34.982270 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:10:34.995857 [debug] [Thread-2 (]: Finished running node model.crypto_analytics.int_crypto_daily_aggs
[0m22:10:35.004031 [debug] [Thread-3 (]: Finished running node model.crypto_analytics.int_crypto_hourly_aggs
[0m22:10:35.015786 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:10:35.033722 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:10:35.045921 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:10:35.049014 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */

    create  index if not exists
  "95931705a3a7c18785bae298246eb19f"
  on "crypto_warehouse"."public_marts"."mart_crypto_latest_prices" using btree
  (symbol);

[0m22:10:35.026906 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.mart_crypto_latest_prices (compile): 22:10:34.893737 => 22:10:35.026090
[0m22:10:35.059065 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */

    create  index if not exists
  "2dc1e279371726ff745971b313107481"
  on "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance" using btree
  (symbol, extraction_hour);

[0m22:10:35.032697 [debug] [Thread-2 (]: Began running node model.crypto_analytics.mart_crypto_hourly_performance
[0m22:10:35.071290 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:10:35.073042 [debug] [Thread-1 (]: Began executing node model.crypto_analytics.mart_crypto_latest_prices
[0m22:10:35.080657 [info ] [Thread-2 (]: 5 of 5 START sql table model public_marts.mart_crypto_hourly_performance ....... [RUN]
[0m22:10:35.088182 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */

    create  index if not exists
  "14f396d78dc02463fbff1f0faef48353"
  on "crypto_warehouse"."public_marts"."mart_pipeline_monitoring" using btree
  (run_date);

[0m22:10:35.111373 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:10:35.113868 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.int_crypto_daily_aggs, now model.crypto_analytics.mart_crypto_hourly_performance)
[0m22:10:35.135738 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics.mart_crypto_hourly_performance
[0m22:10:35.208287 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:10:35.209476 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:10:35.227526 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: BEGIN
[0m22:10:35.239182 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:10:35.254953 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:10:35.264175 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:10:35.292870 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */




  create  table "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_tmp"


    as

  (


WITH latest_prices AS (
    SELECT
        symbol,
        crypto_name,
        price_usd,
        market_cap,
        volume_24h,
        price_change_24h,
        price_change_pct_24h,
        market_cap_rank,
        extracted_at,

        ROW_NUMBER() OVER (
            PARTITION BY symbol
            ORDER BY extracted_at DESC
        ) as rn

    FROM "crypto_warehouse"."public_staging"."stg_crypto_prices"
    WHERE extraction_date = CURRENT_DATE
),

price_changes AS (
    SELECT
        symbol,
        crypto_name,
        price_usd as current_price,
        market_cap,
        volume_24h,
        price_change_24h,
        price_change_pct_24h,
        market_cap_rank,
        extracted_at as last_updated,

        -- Calculate additional metrics
        CASE
            WHEN price_change_pct_24h > 10 THEN 'Strong Gain'
            WHEN price_change_pct_24h > 5 THEN 'Moderate Gain'
            WHEN price_change_pct_24h > 0 THEN 'Slight Gain'
            WHEN price_change_pct_24h > -5 THEN 'Slight Loss'
            WHEN price_change_pct_24h > -10 THEN 'Moderate Loss'
            ELSE 'Strong Loss'
        END as price_trend_category,

        -- Market cap category
        CASE
            WHEN market_cap_rank <= 10 THEN 'Large Cap'
            WHEN market_cap_rank <= 50 THEN 'Mid Cap'
            WHEN market_cap_rank <= 100 THEN 'Small Cap'
            ELSE 'Micro Cap'
        END as market_cap_category

    FROM latest_prices
    WHERE rn = 1
)

SELECT * FROM price_changes
  );

[0m22:10:35.308478 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.mart_crypto_hourly_performance (compile): 22:10:35.145130 => 22:10:35.307713
[0m22:10:35.317920 [debug] [Thread-2 (]: Began executing node model.crypto_analytics.mart_crypto_hourly_performance
[0m22:10:35.334075 [debug] [Thread-2 (]: Writing runtime sql for node "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:10:35.386757 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:10:35.393306 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: BEGIN
[0m22:10:35.399420 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:10:35.412268 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:10:35.418814 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:10:35.426597 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */




  create  table "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_tmp"


    as

  (


WITH  __dbt__cte__int_crypto_hourly_aggs as (


WITH base_data AS (
    SELECT
        symbol,
        crypto_name,
        DATE_TRUNC('hour', extracted_at) AS extraction_hour,
        price_usd,
        volume_24h,
        market_cap,
        CASE WHEN price_usd <= 0 THEN 1 ELSE 0 END AS is_invalid
    FROM "crypto_warehouse"."public_staging"."stg_crypto_prices"
)

SELECT
    symbol,
    crypto_name,
    extraction_hour,
    COUNT(*) AS total_records,
    SUM(is_invalid) AS invalid_price_records,
    AVG(price_usd) AS avg_price_usd,
    MIN(price_usd) AS min_price_usd,
    MAX(price_usd) AS max_price_usd,
    STDDEV(price_usd) AS price_volatility,
    AVG(volume_24h) AS avg_volume_24h,
    AVG(market_cap) AS avg_market_cap
FROM base_data
GROUP BY symbol, crypto_name, extraction_hour
), hourly_data AS (
    SELECT
        symbol,
        crypto_name,
        extraction_hour,
        avg_price_usd,
        min_price_usd,
        max_price_usd,
        price_volatility,
        avg_volume_24h,
        avg_market_cap,
        total_records,

        -- Calculate hourly change
        LAG(avg_price_usd) OVER (
            PARTITION BY symbol
            ORDER BY extraction_hour
        ) as previous_hour_price,

        -- Data quality score
        (1.0 - (invalid_price_records::FLOAT / GREATEST(total_records, 1))) * 100 as data_quality_score

    FROM __dbt__cte__int_crypto_hourly_aggs
),

performance_metrics AS (
    SELECT
        *,
        CASE
            WHEN previous_hour_price IS NOT NULL AND previous_hour_price > 0 THEN
                ((avg_price_usd - previous_hour_price) / previous_hour_price) * 100
            ELSE NULL
        END as hourly_change_pct,

        -- Volatility category
        CASE
            WHEN price_volatility IS NULL THEN 'Unknown'
            WHEN price_volatility < avg_price_usd * 0.01 THEN 'Low Volatility'
            WHEN price_volatility < avg_price_usd * 0.05 THEN 'Medium Volatility'
            ELSE 'High Volatility'
        END as volatility_category

    FROM hourly_data
)

SELECT * FROM performance_metrics
  );

[0m22:10:35.448533 [debug] [Thread-2 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:10:35.448530 [debug] [Thread-4 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:10:35.449319 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:10:35.459801 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:10:35.466857 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */

    create  index if not exists
  "1b57590c576e7b373ca5201fda55ccaf"
  on "crypto_warehouse"."public_marts"."mart_pipeline_monitoring" using btree
  (stage);

[0m22:10:35.458707 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:10:35.469769 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:10:35.478240 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */

    create  index if not exists
  "45abcf30f71a03e3dd6bf12536aebbdc"
  on "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance" using btree
  (extraction_hour);

[0m22:10:35.485666 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */

    create  index if not exists
  "71a30e45d17e517107e7ac752d90e0b7"
  on "crypto_warehouse"."public_marts"."mart_crypto_latest_prices" using btree
  (market_cap_rank);

[0m22:10:35.840237 [debug] [Thread-4 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:10:35.840243 [debug] [Thread-2 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:10:35.852038 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: COMMIT
[0m22:10:35.841448 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:10:35.859229 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:10:35.853163 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: COMMIT
[0m22:10:35.869384 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: COMMIT
[0m22:10:35.865750 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: COMMIT
[0m22:10:35.874675 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:10:35.882466 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:10:35.889689 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: COMMIT
[0m22:10:35.902894 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: COMMIT
[0m22:10:36.051239 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m22:10:36.064329 [debug] [Thread-4 (]: Applying DROP to: "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_backup"
[0m22:10:36.071968 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:10:36.079163 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */
drop table if exists "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_backup" cascade
[0m22:10:36.140351 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m22:10:36.141258 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:10:36.154447 [debug] [Thread-2 (]: Applying DROP to: "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_backup"
[0m22:10:36.169461 [debug] [Thread-1 (]: Applying DROP to: "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_backup"
[0m22:10:36.181438 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:10:36.189185 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:10:36.197176 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */
drop table if exists "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_backup" cascade
[0m22:10:36.205049 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */
drop table if exists "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_backup" cascade
[0m22:10:36.348806 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:10:36.358439 [debug] [Thread-4 (]: Timing info for model.crypto_analytics.mart_pipeline_monitoring (execute): 22:10:33.313891 => 22:10:36.357887
[0m22:10:36.365911 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: Close
[0m22:10:36.375192 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d075c6f-d538-4637-be95-f2fd1ae6ceac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c00faf590>]}
[0m22:10:36.384636 [info ] [Thread-4 (]: 3 of 5 OK created sql table model public_marts.mart_pipeline_monitoring ........ [[32mSELECT 4[0m in 3.48s]
[0m22:10:36.392598 [debug] [Thread-4 (]: Finished running node model.crypto_analytics.mart_pipeline_monitoring
[0m22:10:36.473999 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:10:36.474824 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:10:36.483610 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.mart_crypto_hourly_performance (execute): 22:10:33.953038 => 22:10:36.483172
[0m22:10:36.493050 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.mart_crypto_latest_prices (execute): 22:10:33.634710 => 22:10:36.492573
[0m22:10:36.500566 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: Close
[0m22:10:36.510229 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: Close
[0m22:10:36.517985 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '707c2f0e-e164-4977-97c0-43eb25a009de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76eb441490>]}
[0m22:10:36.528318 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '707c2f0e-e164-4977-97c0-43eb25a009de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76e804b6d0>]}
[0m22:10:36.534512 [info ] [Thread-2 (]: 5 of 5 OK created sql table model public_marts.mart_crypto_hourly_performance .. [[32mSELECT 10[0m in 2.89s]
[0m22:10:36.545053 [info ] [Thread-1 (]: 3 of 5 OK created sql table model public_marts.mart_crypto_latest_prices ....... [[32mSELECT 5[0m in 3.17s]
[0m22:10:36.553946 [debug] [Thread-2 (]: Finished running node model.crypto_analytics.mart_crypto_hourly_performance
[0m22:10:36.571851 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.mart_crypto_latest_prices
[0m22:10:36.590314 [debug] [Thread-2 (]: SQL status: SELECT 10 in 1.0 seconds
[0m22:10:36.607319 [debug] [MainThread]: Using postgres connection "master"
[0m22:10:36.591686 [debug] [Thread-1 (]: SQL status: SELECT 5 in 1.0 seconds
[0m22:10:36.619962 [debug] [MainThread]: On master: BEGIN
[0m22:10:36.635958 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:10:36.620472 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:10:36.645595 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:10:36.659701 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:10:36.650281 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance" rename to "mart_crypto_hourly_performance__dbt_backup"
[0m22:10:36.674658 [debug] [MainThread]: On master: COMMIT
[0m22:10:36.665835 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_latest_prices" rename to "mart_crypto_latest_prices__dbt_backup"
[0m22:10:36.686577 [debug] [MainThread]: Using postgres connection "master"
[0m22:10:36.696323 [debug] [MainThread]: On master: COMMIT
[0m22:10:36.682765 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:10:36.709648 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:10:36.725070 [debug] [MainThread]: On master: Close
[0m22:10:36.697244 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:10:36.736593 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:10:36.754321 [debug] [MainThread]: Connection 'model.crypto_analytics.int_crypto_hourly_aggs' was properly closed.
[0m22:10:36.728187 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:10:36.765152 [debug] [MainThread]: Connection 'model.crypto_analytics.mart_crypto_hourly_performance' was properly closed.
[0m22:10:36.768093 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:10:36.778340 [debug] [MainThread]: Connection 'model.crypto_analytics.mart_crypto_latest_prices' was properly closed.
[0m22:10:36.786959 [debug] [MainThread]: Connection 'model.crypto_analytics.int_crypto_daily_aggs' was properly closed.
[0m22:10:36.773517 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_tmp" rename to "mart_crypto_hourly_performance"
[0m22:10:36.786786 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_tmp" rename to "mart_crypto_latest_prices"
[0m22:10:36.806285 [info ] [MainThread]:
[0m22:10:36.799906 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:10:36.831821 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 9.34 seconds (9.34s).
[0m22:10:36.825432 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:10:36.844706 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:10:36.847005 [debug] [MainThread]: Command end result
[0m22:10:36.860920 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:10:36.868678 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */

    create  index if not exists
  "642c7308e2e6c848f90ed28323af0377"
  on "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance" using btree
  (symbol, extraction_hour);

[0m22:10:36.899757 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */

    create  index if not exists
  "4d576d3aaf851da805b21031b1371fa7"
  on "crypto_warehouse"."public_marts"."mart_crypto_latest_prices" using btree
  (symbol);

[0m22:10:37.087435 [info ] [MainThread]:
[0m22:10:37.096622 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:10:37.111360 [info ] [MainThread]:
[0m22:10:37.131885 [error] [MainThread]:   Database Error in model stg_pipeline_runs (models/staging/stg_pipeline_runs.sql)
  relation "stg_pipeline_runs__dbt_backup" already exists
  compiled Code at target/run/crypto_analytics/models/staging/stg_pipeline_runs.sql
[0m22:10:37.165142 [info ] [MainThread]:
[0m22:10:37.199976 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
[0m22:10:37.219706 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 36.01097, "process_user_time": 13.595821, "process_kernel_time": 3.275843, "process_mem_max_rss": "121912", "process_in_blocks": "10464", "process_out_blocks": "928", "command_success": false}
[0m22:10:37.243303 [debug] [MainThread]: Command `dbt run` failed at 22:10:37.242622 after 36.03 seconds
[0m22:10:37.252611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76ed1b96d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76f16a9450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76f16a88d0>]}
[0m22:10:37.267168 [debug] [MainThread]: Flushing usage events
[0m22:10:37.340766 [debug] [Thread-2 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:10:37.352751 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:10:37.361105 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */

    create  index if not exists
  "adf2fc110d2be5cec765be3b8143af8f"
  on "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance" using btree
  (extraction_hour);

[0m22:10:37.568947 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 1.0 seconds
[0m22:10:37.578194 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:10:37.586217 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */

    create  index if not exists
  "b943f2d1de4ccd1fae3bf8d5e6f83435"
  on "crypto_warehouse"."public_marts"."mart_crypto_latest_prices" using btree
  (market_cap_rank);

[0m22:10:37.724867 [debug] [Thread-2 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:10:37.734671 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: COMMIT
[0m22:10:37.742044 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:10:37.749198 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: COMMIT
[0m22:10:37.918964 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m22:10:37.931506 [debug] [Thread-2 (]: Applying DROP to: "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_backup"
[0m22:10:37.939865 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:10:37.947190 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */
drop table if exists "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_backup" cascade
[0m22:10:38.007518 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:10:38.016288 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: COMMIT
[0m22:10:38.024761 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:10:38.033468 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: COMMIT
[0m22:10:38.119928 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:10:38.133357 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.mart_crypto_hourly_performance (execute): 22:10:35.324580 => 22:10:38.132639
[0m22:10:38.142309 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: Close
[0m22:10:38.152387 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d075c6f-d538-4637-be95-f2fd1ae6ceac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c00d2d590>]}
[0m22:10:38.163366 [info ] [Thread-2 (]: 5 of 5 OK created sql table model public_marts.mart_crypto_hourly_performance .. [[32mSELECT 10[0m in 3.04s]
[0m22:10:38.172738 [debug] [Thread-2 (]: Finished running node model.crypto_analytics.mart_crypto_hourly_performance
[0m22:10:38.292737 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:10:38.313887 [debug] [Thread-1 (]: Applying DROP to: "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_backup"
[0m22:10:38.327555 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:10:38.336910 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */
drop table if exists "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_backup" cascade
[0m22:10:38.437006 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:10:38.451335 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.mart_crypto_latest_prices (execute): 22:10:35.095025 => 22:10:38.450817
[0m22:10:38.463583 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: Close
[0m22:10:38.476929 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d075c6f-d538-4637-be95-f2fd1ae6ceac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c00d80d90>]}
[0m22:10:38.489518 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public_marts.mart_crypto_latest_prices ....... [[32mSELECT 5[0m in 3.83s]
[0m22:10:38.500675 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.mart_crypto_latest_prices
[0m22:10:38.511393 [debug] [MainThread]: Using postgres connection "master"
[0m22:10:38.519668 [debug] [MainThread]: On master: BEGIN
[0m22:10:38.529527 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:10:38.545960 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:10:38.558769 [debug] [MainThread]: On master: COMMIT
[0m22:10:38.572214 [debug] [MainThread]: Using postgres connection "master"
[0m22:10:38.581730 [debug] [MainThread]: On master: COMMIT
[0m22:10:38.592255 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:10:38.601570 [debug] [MainThread]: On master: Close
[0m22:10:38.612835 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:10:38.622082 [debug] [MainThread]: Connection 'model.crypto_analytics.mart_crypto_latest_prices' was properly closed.
[0m22:10:38.632988 [debug] [MainThread]: Connection 'model.crypto_analytics.mart_crypto_hourly_performance' was properly closed.
[0m22:10:38.642926 [debug] [MainThread]: Connection 'model.crypto_analytics.int_crypto_hourly_aggs' was properly closed.
[0m22:10:38.653052 [debug] [MainThread]: Connection 'model.crypto_analytics.mart_pipeline_monitoring' was properly closed.
[0m22:10:38.663291 [info ] [MainThread]:
[0m22:10:38.676224 [info ] [MainThread]: Finished running 1 view model, 4 table models in 0 hours 0 minutes and 11.12 seconds (11.12s).
[0m22:10:38.687124 [debug] [MainThread]: Command end result
[0m22:10:38.783331 [info ] [MainThread]:
[0m22:10:38.792298 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:10:38.800103 [info ] [MainThread]:
[0m22:10:38.808416 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m22:10:38.816099 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 37.60852, "process_user_time": 13.135644, "process_kernel_time": 4.28039, "process_mem_max_rss": "122224", "process_in_blocks": "39800", "process_out_blocks": "1872"}
[0m22:10:38.824643 [debug] [MainThread]: Command `dbt run` succeeded at 22:10:38.824363 after 37.62 seconds
[0m22:10:38.831884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c07239590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c07238790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c07239790>]}
[0m22:10:38.840214 [debug] [MainThread]: Flushing usage events
[0m22:21:51.061069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb0e3f7e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb0e3f7590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb0e3f7910>]}


============================== 22:21:51.100855 | d4a1db27-2128-44a1-94cc-9bf337787c49 ==============================
[0m22:21:51.100855 [info ] [MainThread]: Running with dbt=1.7.0
[0m22:21:51.116250 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/app', 'log_path': '/app/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /app/dbt', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:21:53.688104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd4a1db27-2128-44a1-94cc-9bf337787c49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb0cb5fcd0>]}
[0m22:21:54.624471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd4a1db27-2128-44a1-94cc-9bf337787c49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb0cb77650>]}
[0m22:21:54.831508 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m22:21:56.577334 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m22:22:00.658689 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:22:00.672554 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:22:00.719892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd4a1db27-2128-44a1-94cc-9bf337787c49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb0cb41e90>]}
[0m22:22:01.175102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd4a1db27-2128-44a1-94cc-9bf337787c49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb0c9dd890>]}
[0m22:22:01.188439 [info ] [MainThread]: Found 7 models, 14 tests, 2 sources, 0 exposures, 0 metrics, 403 macros, 0 groups, 0 semantic models
[0m22:22:01.202898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4a1db27-2128-44a1-94cc-9bf337787c49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb11d9bc90>]}
[0m22:22:01.227821 [info ] [MainThread]:
[0m22:22:01.247775 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:22:01.263076 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse'
[0m22:22:01.266110 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse'
[0m22:22:01.415201 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse"
[0m22:22:01.448134 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse"
[0m22:22:01.455555 [debug] [ThreadPool]: On list_crypto_warehouse: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse"} */

    select distinct nspname from pg_namespace

[0m22:22:01.468525 [debug] [ThreadPool]: On list_crypto_warehouse: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse"} */

    select distinct nspname from pg_namespace

[0m22:22:01.483644 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:22:01.495340 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:22:01.521993 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m22:22:01.541577 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m22:22:01.548602 [debug] [ThreadPool]: On list_crypto_warehouse: Close
[0m22:22:01.561165 [debug] [ThreadPool]: On list_crypto_warehouse: Close
[0m22:22:01.594519 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_warehouse, now list_crypto_warehouse_public_staging)
[0m22:22:01.597332 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_warehouse, now list_crypto_warehouse_public_marts)
[0m22:22:01.642346 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_marts"
[0m22:22:01.636181 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_staging"
[0m22:22:01.603572 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse_public_dbt_test__audit'
[0m22:22:01.655337 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: BEGIN
[0m22:22:01.670939 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: BEGIN
[0m22:22:01.693384 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_dbt_test__audit"
[0m22:22:01.711387 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:22:01.735376 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:22:01.753358 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: BEGIN
[0m22:22:01.773749 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:22:01.802303 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:22:01.912537 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:22:02.109708 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_marts"
[0m22:22:02.123429 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_staging"
[0m22:22:02.147574 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:22:02.159577 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_marts"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'

[0m22:22:02.173696 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_staging"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'

[0m22:22:02.184926 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_dbt_test__audit"
[0m22:22:02.202089 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m22:22:02.218232 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m22:22:02.219461 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_dbt_test__audit"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'

[0m22:22:02.227944 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: ROLLBACK
[0m22:22:02.239983 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: ROLLBACK
[0m22:22:02.257313 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m22:22:02.259809 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: Close
[0m22:22:02.272385 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: Close
[0m22:22:02.279784 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: ROLLBACK
[0m22:22:02.318617 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: Close
[0m22:22:02.350804 [debug] [MainThread]: Using postgres connection "master"
[0m22:22:02.359902 [debug] [MainThread]: On master: BEGIN
[0m22:22:02.373293 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:22:02.406601 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:22:02.418127 [debug] [MainThread]: Using postgres connection "master"
[0m22:22:02.425798 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:22:02.485727 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m22:22:02.510260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4a1db27-2128-44a1-94cc-9bf337787c49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb0ca0e390>]}
[0m22:22:02.527446 [debug] [MainThread]: On master: ROLLBACK
[0m22:22:02.542342 [debug] [MainThread]: Using postgres connection "master"
[0m22:22:02.556773 [debug] [MainThread]: On master: BEGIN
[0m22:22:02.573794 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:22:02.642564 [debug] [MainThread]: On master: COMMIT
[0m22:22:02.741353 [debug] [MainThread]: Using postgres connection "master"
[0m22:22:03.094287 [debug] [MainThread]: On master: COMMIT
[0m22:22:03.151853 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:22:03.167889 [debug] [MainThread]: On master: Close
[0m22:22:03.213270 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:22:03.260408 [info ] [MainThread]:
[0m22:22:03.385331 [debug] [Thread-2 (]: Began running node model.crypto_analytics.stg_crypto_prices
[0m22:22:03.414584 [info ] [Thread-2 (]: 1 of 5 START sql table model public_staging.stg_crypto_prices .................. [RUN]
[0m22:22:03.386467 [debug] [Thread-3 (]: Began running node model.crypto_analytics.stg_pipeline_runs
[0m22:22:03.441582 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_marts, now model.crypto_analytics.stg_crypto_prices)
[0m22:22:03.454933 [info ] [Thread-3 (]: 2 of 5 START sql view model public_staging.stg_pipeline_runs ................... [RUN]
[0m22:22:03.466713 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics.stg_crypto_prices
[0m22:22:03.475161 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_dbt_test__audit, now model.crypto_analytics.stg_pipeline_runs)
[0m22:22:03.509172 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics.stg_crypto_prices"
[0m22:22:03.517451 [debug] [Thread-3 (]: Began compiling node model.crypto_analytics.stg_pipeline_runs
[0m22:22:03.542374 [debug] [Thread-3 (]: Writing injected SQL for node "model.crypto_analytics.stg_pipeline_runs"
[0m22:22:03.589941 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.stg_crypto_prices (compile): 22:22:03.487130 => 22:22:03.589215
[0m22:22:03.600822 [debug] [Thread-3 (]: Timing info for model.crypto_analytics.stg_pipeline_runs (compile): 22:22:03.536135 => 22:22:03.600159
[0m22:22:03.606605 [debug] [Thread-2 (]: Began executing node model.crypto_analytics.stg_crypto_prices
[0m22:22:03.618092 [debug] [Thread-3 (]: Began executing node model.crypto_analytics.stg_pipeline_runs
[0m22:22:03.822564 [debug] [Thread-3 (]: Writing runtime sql for node "model.crypto_analytics.stg_pipeline_runs"
[0m22:22:03.840618 [debug] [Thread-2 (]: Writing runtime sql for node "model.crypto_analytics.stg_crypto_prices"
[0m22:22:03.923898 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:22:03.938025 [debug] [Thread-2 (]: On model.crypto_analytics.stg_crypto_prices: BEGIN
[0m22:22:03.939196 [debug] [Thread-3 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m22:22:03.951145 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:22:03.959299 [debug] [Thread-3 (]: On model.crypto_analytics.stg_pipeline_runs: BEGIN
[0m22:22:03.977579 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:22:03.984995 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:22:03.993612 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:22:04.010033 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:22:04.018911 [debug] [Thread-2 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */




  create  table "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_tmp"


    as

  (


WITH source_data AS (
    SELECT
        id as price_id,
        UPPER(TRIM(symbol)) as symbol,
        TRIM(name) as crypto_name,
        current_price as price_usd,
        market_cap,
        total_volume as volume_24h,
        price_change_24h,
        price_change_percentage_24h as price_change_pct_24h,
        market_cap_rank,
        extracted_at,
        created_at,

        CASE WHEN current_price <= 0 THEN TRUE ELSE FALSE END as is_invalid_price,
        CASE WHEN market_cap <= 0 THEN TRUE ELSE FALSE END as is_invalid_market_cap,
        CASE WHEN total_volume < 0 THEN TRUE ELSE FALSE END as is_invalid_volume
    FROM "crypto_warehouse"."public"."crypto_prices_raw"
),

cleaned_data AS (
    SELECT
        *,
        DATE(extracted_at) as extraction_date,
        DATE_TRUNC('hour', extracted_at) as extraction_hour,
        CASE
            WHEN LAG(price_usd) OVER (
                PARTITION BY symbol ORDER BY extracted_at
            ) IS NOT NULL THEN
                ((price_usd - LAG(price_usd) OVER (
                    PARTITION BY symbol ORDER BY extracted_at
                )) / LAG(price_usd) OVER (
                    PARTITION BY symbol ORDER BY extracted_at
                )) * 100
        END as price_change_pct_from_previous
    FROM source_data
    WHERE NOT is_invalid_price AND NOT is_invalid_volume
)

SELECT * FROM cleaned_data
  );

[0m22:22:04.033506 [debug] [Thread-3 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m22:22:04.058797 [debug] [Thread-3 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */

  create view "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_tmp"


  as (
    SELECT
    id as run_id,
    run_id as run_identifier,
    stage,
    status,
    records_processed,
    error_message,
    started_at,
    completed_at,
    CASE
        WHEN completed_at IS NOT NULL
        THEN EXTRACT(EPOCH FROM (completed_at - started_at))
        ELSE NULL
    END as duration_seconds
FROM "crypto_warehouse"."public"."pipeline_runs"
  );
[0m22:22:04.123671 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m22:22:04.151244 [debug] [Thread-3 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m22:22:04.158637 [debug] [Thread-3 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */
alter table "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_tmp" rename to "stg_pipeline_runs"
[0m22:22:04.170558 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:22:04.224386 [debug] [Thread-3 (]: On model.crypto_analytics.stg_pipeline_runs: COMMIT
[0m22:22:04.237935 [debug] [Thread-3 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m22:22:04.248572 [debug] [Thread-2 (]: SQL status: SELECT 15 in 0.0 seconds
[0m22:22:04.251514 [debug] [Thread-3 (]: On model.crypto_analytics.stg_pipeline_runs: COMMIT
[0m22:22:04.278432 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:22:04.307498 [debug] [Thread-2 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */
alter table "crypto_warehouse"."public_staging"."stg_crypto_prices" rename to "stg_crypto_prices__dbt_backup"
[0m22:22:04.372330 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:22:04.389567 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m22:22:04.418506 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:22:04.480869 [debug] [Thread-3 (]: Applying DROP to: "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_backup"
[0m22:22:04.486415 [debug] [Thread-2 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */
alter table "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_tmp" rename to "stg_crypto_prices"
[0m22:22:04.538414 [debug] [Thread-3 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m22:22:04.575350 [debug] [Thread-3 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */
drop view if exists "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_backup" cascade
[0m22:22:04.550126 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:22:04.605613 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m22:22:04.664066 [debug] [Thread-3 (]: Timing info for model.crypto_analytics.stg_pipeline_runs (execute): 22:22:03.672909 => 22:22:04.663352
[0m22:22:04.644265 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:22:04.686032 [debug] [Thread-3 (]: On model.crypto_analytics.stg_pipeline_runs: Close
[0m22:22:04.705789 [debug] [Thread-2 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */

        CREATE INDEX IF NOT EXISTS idx_stg_crypto_prices_symbol_time ON "crypto_warehouse"."public_staging"."stg_crypto_prices" (symbol, extracted_at)

[0m22:22:04.732082 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4a1db27-2128-44a1-94cc-9bf337787c49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb0c86c610>]}
[0m22:22:04.750605 [debug] [Thread-2 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:22:04.789553 [debug] [Thread-2 (]: On model.crypto_analytics.stg_crypto_prices: COMMIT
[0m22:22:04.803873 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:22:04.758115 [info ] [Thread-3 (]: 2 of 5 OK created sql view model public_staging.stg_pipeline_runs .............. [[32mCREATE VIEW[0m in 1.26s]
[0m22:22:04.818704 [debug] [Thread-2 (]: On model.crypto_analytics.stg_crypto_prices: COMMIT
[0m22:22:04.833880 [debug] [Thread-3 (]: Finished running node model.crypto_analytics.stg_pipeline_runs
[0m22:22:04.884891 [debug] [Thread-1 (]: Began running node model.crypto_analytics.mart_pipeline_monitoring
[0m22:22:04.940015 [info ] [Thread-1 (]: 3 of 5 START sql table model public_marts.mart_pipeline_monitoring ............. [RUN]
[0m22:22:04.946821 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m22:22:04.982804 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_staging, now model.crypto_analytics.mart_pipeline_monitoring)
[0m22:22:05.004135 [debug] [Thread-2 (]: Applying DROP to: "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_backup"
[0m22:22:05.007620 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics.mart_pipeline_monitoring
[0m22:22:05.025678 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:22:05.054309 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:22:05.061724 [debug] [Thread-2 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */
drop table if exists "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_backup" cascade
[0m22:22:05.121747 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.mart_pipeline_monitoring (compile): 22:22:05.037701 => 22:22:05.120943
[0m22:22:05.134774 [debug] [Thread-1 (]: Began executing node model.crypto_analytics.mart_pipeline_monitoring
[0m22:22:05.135809 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:22:05.156085 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:22:05.169021 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.stg_crypto_prices (execute): 22:22:03.625389 => 22:22:05.168219
[0m22:22:05.204389 [debug] [Thread-2 (]: On model.crypto_analytics.stg_crypto_prices: Close
[0m22:22:05.218722 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4a1db27-2128-44a1-94cc-9bf337787c49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb0c81d910>]}
[0m22:22:05.234101 [info ] [Thread-2 (]: 1 of 5 OK created sql table model public_staging.stg_crypto_prices ............. [[32mSELECT 15[0m in 1.78s]
[0m22:22:05.247888 [debug] [Thread-2 (]: Finished running node model.crypto_analytics.stg_crypto_prices
[0m22:22:05.256105 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:22:05.258557 [debug] [Thread-3 (]: Began running node model.crypto_analytics.int_crypto_daily_aggs
[0m22:22:05.260448 [debug] [Thread-4 (]: Began running node model.crypto_analytics.int_crypto_hourly_aggs
[0m22:22:05.263403 [debug] [Thread-2 (]: Began running node model.crypto_analytics.mart_crypto_latest_prices
[0m22:22:05.271294 [debug] [Thread-1 (]: On model.crypto_analytics.mart_pipeline_monitoring: BEGIN
[0m22:22:05.282807 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.stg_pipeline_runs, now model.crypto_analytics.int_crypto_daily_aggs)
[0m22:22:05.290884 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.crypto_analytics.int_crypto_hourly_aggs'
[0m22:22:05.302448 [info ] [Thread-2 (]: 4 of 5 START sql table model public_marts.mart_crypto_latest_prices ............ [RUN]
[0m22:22:05.315105 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:22:05.321117 [debug] [Thread-3 (]: Began compiling node model.crypto_analytics.int_crypto_daily_aggs
[0m22:22:05.333689 [debug] [Thread-4 (]: Began compiling node model.crypto_analytics.int_crypto_hourly_aggs
[0m22:22:05.343287 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.stg_crypto_prices, now model.crypto_analytics.mart_crypto_latest_prices)
[0m22:22:05.360400 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:22:05.379840 [debug] [Thread-3 (]: Writing injected SQL for node "model.crypto_analytics.int_crypto_daily_aggs"
[0m22:22:05.398594 [debug] [Thread-4 (]: Writing injected SQL for node "model.crypto_analytics.int_crypto_hourly_aggs"
[0m22:22:05.402472 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics.mart_crypto_latest_prices
[0m22:22:05.413865 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:22:05.620721 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:22:05.626901 [debug] [Thread-3 (]: Timing info for model.crypto_analytics.int_crypto_daily_aggs (compile): 22:22:05.368001 => 22:22:05.626122
[0m22:22:05.632835 [debug] [Thread-4 (]: Timing info for model.crypto_analytics.int_crypto_hourly_aggs (compile): 22:22:05.383955 => 22:22:05.632024
[0m22:22:05.634919 [debug] [Thread-1 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */




  create  table "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_tmp"


    as

  (


WITH pipeline_metrics AS (
    SELECT
        run_id,
        stage,
        status,
        records_processed,
        error_message,
        started_at,
        completed_at,
        EXTRACT(EPOCH FROM completed_at - started_at) AS duration_seconds,

        -- Flag to compute success rate
        CASE WHEN status = 'success' THEN 1 ELSE 0 END AS is_success,

        -- Classify performance
        CASE
            WHEN completed_at IS NULL THEN 'Running'
            WHEN EXTRACT(EPOCH FROM completed_at - started_at) < 30 THEN 'Fast'
            WHEN EXTRACT(EPOCH FROM completed_at - started_at) < 120 THEN 'Normal'
            ELSE 'Slow'
        END AS performance_category

    FROM "crypto_warehouse"."public_staging"."stg_pipeline_runs"
),

latest_status_per_day_stage AS (
    SELECT
        DATE(started_at) AS run_date,
        stage,
        FIRST_VALUE(status) OVER (
            PARTITION BY DATE(started_at), stage
            ORDER BY started_at DESC
        ) AS latest_run_status
    FROM pipeline_metrics
),

daily_summary AS (
    SELECT
        DATE(started_at) AS run_date,
        stage,

        COUNT(*) AS total_runs,
        SUM(is_success) AS successful_runs,
        SUM(records_processed) AS total_records_processed,
        AVG(duration_seconds) AS avg_duration_seconds,
        MAX(duration_seconds) AS max_duration_seconds,
        ROUND(((SUM(is_success)::FLOAT / COUNT(*)) * 100)::NUMERIC, 2) AS success_rate_pct


    FROM pipeline_metrics
    WHERE started_at >= CURRENT_DATE - INTERVAL '30 days'
    GROUP BY DATE(started_at), stage
)

-- Final result combining metrics with latest run status
SELECT
    ds.*,
    ls.latest_run_status
FROM daily_summary ds
LEFT JOIN latest_status_per_day_stage ls
  ON ds.run_date = ls.run_date AND ds.stage = ls.stage
  );

[0m22:22:05.667641 [debug] [Thread-3 (]: Finished running node model.crypto_analytics.int_crypto_daily_aggs
[0m22:22:05.687607 [debug] [Thread-4 (]: Finished running node model.crypto_analytics.int_crypto_hourly_aggs
[0m22:22:05.758064 [debug] [Thread-3 (]: Began running node model.crypto_analytics.mart_crypto_hourly_performance
[0m22:22:05.781250 [info ] [Thread-3 (]: 5 of 5 START sql table model public_marts.mart_crypto_hourly_performance ....... [RUN]
[0m22:22:05.788300 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.mart_crypto_latest_prices (compile): 22:22:05.449356 => 22:22:05.787666
[0m22:22:05.803468 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.int_crypto_daily_aggs, now model.crypto_analytics.mart_crypto_hourly_performance)
[0m22:22:05.817285 [debug] [Thread-2 (]: Began executing node model.crypto_analytics.mart_crypto_latest_prices
[0m22:22:05.830204 [debug] [Thread-3 (]: Began compiling node model.crypto_analytics.mart_crypto_hourly_performance
[0m22:22:05.864465 [debug] [Thread-2 (]: Writing runtime sql for node "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:22:05.880252 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m22:22:06.001926 [debug] [Thread-3 (]: Writing injected SQL for node "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:22:06.021823 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:22:06.067465 [debug] [Thread-1 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */
alter table "crypto_warehouse"."public_marts"."mart_pipeline_monitoring" rename to "mart_pipeline_monitoring__dbt_backup"
[0m22:22:06.085720 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:22:06.106981 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:22:06.120774 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:22:06.130604 [debug] [Thread-1 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */
alter table "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_tmp" rename to "mart_pipeline_monitoring"
[0m22:22:06.139602 [debug] [Thread-3 (]: Timing info for model.crypto_analytics.mart_crypto_hourly_performance (compile): 22:22:05.885614 => 22:22:06.138948
[0m22:22:06.145769 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_latest_prices: BEGIN
[0m22:22:06.154549 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:22:06.165270 [debug] [Thread-3 (]: Began executing node model.crypto_analytics.mart_crypto_hourly_performance
[0m22:22:06.173077 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:22:06.228141 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:22:06.238517 [debug] [Thread-3 (]: Writing runtime sql for node "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:22:06.254968 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:22:06.265128 [debug] [Thread-1 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */

    create  index if not exists
  "c23f4d08fd12830c8095ccd08c81a512"
  on "crypto_warehouse"."public_marts"."mart_pipeline_monitoring" using btree
  (run_date);

[0m22:22:06.286105 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:22:06.315316 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */




  create  table "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_tmp"


    as

  (


WITH latest_prices AS (
    SELECT
        symbol,
        crypto_name,
        price_usd,
        market_cap,
        volume_24h,
        price_change_24h,
        price_change_pct_24h,
        market_cap_rank,
        extracted_at,

        ROW_NUMBER() OVER (
            PARTITION BY symbol
            ORDER BY extracted_at DESC
        ) as rn

    FROM "crypto_warehouse"."public_staging"."stg_crypto_prices"
    WHERE extraction_date = CURRENT_DATE
),

price_changes AS (
    SELECT
        symbol,
        crypto_name,
        price_usd as current_price,
        market_cap,
        volume_24h,
        price_change_24h,
        price_change_pct_24h,
        market_cap_rank,
        extracted_at as last_updated,

        -- Calculate additional metrics
        CASE
            WHEN price_change_pct_24h > 10 THEN 'Strong Gain'
            WHEN price_change_pct_24h > 5 THEN 'Moderate Gain'
            WHEN price_change_pct_24h > 0 THEN 'Slight Gain'
            WHEN price_change_pct_24h > -5 THEN 'Slight Loss'
            WHEN price_change_pct_24h > -10 THEN 'Moderate Loss'
            ELSE 'Strong Loss'
        END as price_trend_category,

        -- Market cap category
        CASE
            WHEN market_cap_rank <= 10 THEN 'Large Cap'
            WHEN market_cap_rank <= 50 THEN 'Mid Cap'
            WHEN market_cap_rank <= 100 THEN 'Small Cap'
            ELSE 'Micro Cap'
        END as market_cap_category

    FROM latest_prices
    WHERE rn = 1
)

SELECT * FROM price_changes
  );

[0m22:22:06.347256 [debug] [Thread-3 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:22:06.354858 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: BEGIN
[0m22:22:06.366128 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:22:06.385070 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:22:06.397310 [debug] [Thread-3 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:22:06.405271 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */




  create  table "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_tmp"


    as

  (


WITH  __dbt__cte__int_crypto_hourly_aggs as (


WITH base_data AS (
    SELECT
        symbol,
        crypto_name,
        DATE_TRUNC('hour', extracted_at) AS extraction_hour,
        price_usd,
        volume_24h,
        market_cap,
        CASE WHEN price_usd <= 0 THEN 1 ELSE 0 END AS is_invalid
    FROM "crypto_warehouse"."public_staging"."stg_crypto_prices"
)

SELECT
    symbol,
    crypto_name,
    extraction_hour,
    COUNT(*) AS total_records,
    SUM(is_invalid) AS invalid_price_records,
    AVG(price_usd) AS avg_price_usd,
    MIN(price_usd) AS min_price_usd,
    MAX(price_usd) AS max_price_usd,
    STDDEV(price_usd) AS price_volatility,
    AVG(volume_24h) AS avg_volume_24h,
    AVG(market_cap) AS avg_market_cap
FROM base_data
GROUP BY symbol, crypto_name, extraction_hour
), hourly_data AS (
    SELECT
        symbol,
        crypto_name,
        extraction_hour,
        avg_price_usd,
        min_price_usd,
        max_price_usd,
        price_volatility,
        avg_volume_24h,
        avg_market_cap,
        total_records,

        -- Calculate hourly change
        LAG(avg_price_usd) OVER (
            PARTITION BY symbol
            ORDER BY extraction_hour
        ) as previous_hour_price,

        -- Data quality score
        (1.0 - (invalid_price_records::FLOAT / GREATEST(total_records, 1))) * 100 as data_quality_score

    FROM __dbt__cte__int_crypto_hourly_aggs
),

performance_metrics AS (
    SELECT
        *,
        CASE
            WHEN previous_hour_price IS NOT NULL AND previous_hour_price > 0 THEN
                ((avg_price_usd - previous_hour_price) / previous_hour_price) * 100
            ELSE NULL
        END as hourly_change_pct,

        -- Volatility category
        CASE
            WHEN price_volatility IS NULL THEN 'Unknown'
            WHEN price_volatility < avg_price_usd * 0.01 THEN 'Low Volatility'
            WHEN price_volatility < avg_price_usd * 0.05 THEN 'Medium Volatility'
            ELSE 'High Volatility'
        END as volatility_category

    FROM hourly_data
)

SELECT * FROM performance_metrics
  );

[0m22:22:06.479272 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:22:06.491191 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:22:06.506093 [debug] [Thread-1 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */

    create  index if not exists
  "781cbd63754715f3b87b2c5a3256078c"
  on "crypto_warehouse"."public_marts"."mart_pipeline_monitoring" using btree
  (stage);

[0m22:22:06.683905 [debug] [Thread-3 (]: SQL status: SELECT 10 in 0.0 seconds
[0m22:22:06.685090 [debug] [Thread-2 (]: SQL status: SELECT 5 in 0.0 seconds
[0m22:22:06.716934 [debug] [Thread-3 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:22:06.739474 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:22:06.782240 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance" rename to "mart_crypto_hourly_performance__dbt_backup"
[0m22:22:06.801942 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_latest_prices" rename to "mart_crypto_latest_prices__dbt_backup"
[0m22:22:06.818269 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:22:06.831649 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:22:06.865370 [debug] [Thread-3 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:22:06.911618 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:22:06.922707 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_tmp" rename to "mart_crypto_hourly_performance"
[0m22:22:06.937773 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_tmp" rename to "mart_crypto_latest_prices"
[0m22:22:06.967879 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:22:06.991503 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:22:07.008912 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:22:07.036367 [debug] [Thread-3 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:22:07.056031 [debug] [Thread-1 (]: On model.crypto_analytics.mart_pipeline_monitoring: COMMIT
[0m22:22:07.083303 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:22:07.089381 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */

    create  index if not exists
  "f1516f7a8dfb2a2fa11a8fa2c02e08af"
  on "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance" using btree
  (symbol, extraction_hour);

[0m22:22:07.103011 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:22:07.115110 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */

    create  index if not exists
  "1e19feea4eb563f649c7c0725a0d54ce"
  on "crypto_warehouse"."public_marts"."mart_crypto_latest_prices" using btree
  (symbol);

[0m22:22:07.133645 [debug] [Thread-1 (]: On model.crypto_analytics.mart_pipeline_monitoring: COMMIT
[0m22:22:07.312800 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:22:07.313817 [debug] [Thread-3 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:22:07.346674 [debug] [Thread-1 (]: Applying DROP to: "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_backup"
[0m22:22:07.355004 [debug] [Thread-3 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:22:07.369506 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:22:07.385338 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */

    create  index if not exists
  "3313600fa5db23dcfb7abf3e11f9cced"
  on "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance" using btree
  (extraction_hour);

[0m22:22:07.399037 [debug] [Thread-1 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */
drop table if exists "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_backup" cascade
[0m22:22:07.424745 [debug] [Thread-2 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:22:07.438178 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:22:07.462132 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */

    create  index if not exists
  "6a93532307cfacc758496299dc036bb4"
  on "crypto_warehouse"."public_marts"."mart_crypto_latest_prices" using btree
  (market_cap_rank);

[0m22:22:07.502170 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:22:07.543529 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.mart_pipeline_monitoring (execute): 22:22:05.146550 => 22:22:07.541732
[0m22:22:07.602686 [debug] [Thread-1 (]: On model.crypto_analytics.mart_pipeline_monitoring: Close
[0m22:22:07.615638 [debug] [Thread-3 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:22:07.679171 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4a1db27-2128-44a1-94cc-9bf337787c49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb0e2fa1d0>]}
[0m22:22:07.821007 [info ] [Thread-1 (]: 3 of 5 OK created sql table model public_marts.mart_pipeline_monitoring ........ [[32mSELECT 6[0m in 2.70s]
[0m22:22:07.804703 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: COMMIT
[0m22:22:07.935966 [debug] [Thread-3 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:22:07.855041 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.mart_pipeline_monitoring
[0m22:22:07.735768 [debug] [Thread-2 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:22:07.999906 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: COMMIT
[0m22:22:08.190153 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_latest_prices: COMMIT
[0m22:22:08.285831 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:22:08.314489 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m22:22:08.315762 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_latest_prices: COMMIT
[0m22:22:08.361211 [debug] [Thread-3 (]: Applying DROP to: "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_backup"
[0m22:22:08.417368 [debug] [Thread-3 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:22:08.437540 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */
drop table if exists "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_backup" cascade
[0m22:22:08.447284 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m22:22:08.487809 [debug] [Thread-2 (]: Applying DROP to: "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_backup"
[0m22:22:08.501250 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:22:08.513204 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:22:08.533667 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */
drop table if exists "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_backup" cascade
[0m22:22:08.550741 [debug] [Thread-3 (]: Timing info for model.crypto_analytics.mart_crypto_hourly_performance (execute): 22:22:06.229210 => 22:22:08.550208
[0m22:22:08.578845 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: Close
[0m22:22:08.587542 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4a1db27-2128-44a1-94cc-9bf337787c49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb0c819bd0>]}
[0m22:22:08.602386 [info ] [Thread-3 (]: 5 of 5 OK created sql table model public_marts.mart_crypto_hourly_performance .. [[32mSELECT 10[0m in 2.78s]
[0m22:22:08.613874 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:22:08.617508 [debug] [Thread-3 (]: Finished running node model.crypto_analytics.mart_crypto_hourly_performance
[0m22:22:08.636236 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.mart_crypto_latest_prices (execute): 22:22:05.839355 => 22:22:08.635722
[0m22:22:08.660215 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_latest_prices: Close
[0m22:22:08.669131 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4a1db27-2128-44a1-94cc-9bf337787c49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb0c819a50>]}
[0m22:22:08.681896 [info ] [Thread-2 (]: 4 of 5 OK created sql table model public_marts.mart_crypto_latest_prices ....... [[32mSELECT 5[0m in 3.33s]
[0m22:22:08.698405 [debug] [Thread-2 (]: Finished running node model.crypto_analytics.mart_crypto_latest_prices
[0m22:22:08.715120 [debug] [MainThread]: Using postgres connection "master"
[0m22:22:08.727111 [debug] [MainThread]: On master: BEGIN
[0m22:22:08.734757 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:22:08.755568 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:22:08.768915 [debug] [MainThread]: On master: COMMIT
[0m22:22:08.782493 [debug] [MainThread]: Using postgres connection "master"
[0m22:22:08.800519 [debug] [MainThread]: On master: COMMIT
[0m22:22:08.818328 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:22:08.831598 [debug] [MainThread]: On master: Close
[0m22:22:08.845316 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:22:08.860191 [debug] [MainThread]: Connection 'model.crypto_analytics.mart_crypto_latest_prices' was properly closed.
[0m22:22:08.878190 [debug] [MainThread]: Connection 'model.crypto_analytics.mart_pipeline_monitoring' was properly closed.
[0m22:22:08.897637 [debug] [MainThread]: Connection 'model.crypto_analytics.mart_crypto_hourly_performance' was properly closed.
[0m22:22:08.934078 [debug] [MainThread]: Connection 'model.crypto_analytics.int_crypto_hourly_aggs' was properly closed.
[0m22:22:08.960572 [info ] [MainThread]:
[0m22:22:08.970270 [info ] [MainThread]: Finished running 1 view model, 4 table models in 0 hours 0 minutes and 7.71 seconds (7.71s).
[0m22:22:08.984599 [debug] [MainThread]: Command end result
[0m22:22:09.230052 [info ] [MainThread]:
[0m22:22:09.245715 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:22:09.277420 [info ] [MainThread]:
[0m22:22:09.285553 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m22:22:09.300717 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 18.465572, "process_user_time": 12.331014, "process_kernel_time": 1.0917, "process_mem_max_rss": "122156", "process_out_blocks": "1976", "process_in_blocks": "0"}
[0m22:22:09.314466 [debug] [MainThread]: Command `dbt run` succeeded at 22:22:09.314092 after 18.48 seconds
[0m22:22:09.326749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb12d61690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb12d60890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb12d61890>]}
[0m22:22:09.335642 [debug] [MainThread]: Flushing usage events
[0m22:22:10.079099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd304048990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd30403e250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3044f1d50>]}


============================== 22:22:10.092724 | d999cb1a-a757-4c9b-bfdf-f7d2c56521fc ==============================
[0m22:22:10.092724 [info ] [MainThread]: Running with dbt=1.7.0
[0m22:22:10.110184 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /app/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:22:11.649912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd999cb1a-a757-4c9b-bfdf-f7d2c56521fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3027e7ad0>]}
[0m22:23:52.830585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b75feff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b74595fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b745a33d0>]}


============================== 22:23:52.843627 | 11d96f5f-88a6-4152-833f-34d08c1f9586 ==============================
[0m22:23:52.843627 [info ] [MainThread]: Running with dbt=1.7.0
[0m22:23:52.849960 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'profiles_dir': '/app', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /app/dbt', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:23:53.393929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '11d96f5f-88a6-4152-833f-34d08c1f9586', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b7461a010>]}
[0m22:23:53.698384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '11d96f5f-88a6-4152-833f-34d08c1f9586', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b72c19b10>]}
[0m22:23:53.712735 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m22:23:53.794399 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m22:24:00.755577 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:24:00.769519 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:24:00.803647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11d96f5f-88a6-4152-833f-34d08c1f9586', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b72d42510>]}
[0m22:24:01.240134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11d96f5f-88a6-4152-833f-34d08c1f9586', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b72d7e150>]}
[0m22:24:01.287070 [info ] [MainThread]: Found 7 models, 14 tests, 2 sources, 0 exposures, 0 metrics, 403 macros, 0 groups, 0 semantic models
[0m22:24:01.306177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11d96f5f-88a6-4152-833f-34d08c1f9586', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b74618c90>]}
[0m22:24:01.340464 [info ] [MainThread]:
[0m22:24:01.363429 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:24:01.382564 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse'
[0m22:24:01.384568 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse'
[0m22:24:01.451977 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse"
[0m22:24:01.484574 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse"
[0m22:24:01.496759 [debug] [ThreadPool]: On list_crypto_warehouse: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse"} */

    select distinct nspname from pg_namespace

[0m22:24:01.536611 [debug] [ThreadPool]: On list_crypto_warehouse: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse"} */

    select distinct nspname from pg_namespace

[0m22:24:01.567555 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:24:01.581307 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:24:01.615048 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m22:24:01.673155 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m22:24:01.688668 [debug] [ThreadPool]: On list_crypto_warehouse: Close
[0m22:24:01.708770 [debug] [ThreadPool]: On list_crypto_warehouse: Close
[0m22:24:01.740122 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_warehouse, now list_crypto_warehouse_public_staging)
[0m22:24:01.742964 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_warehouse, now list_crypto_warehouse_public_marts)
[0m22:24:01.745254 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse_public_dbt_test__audit'
[0m22:24:01.815252 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_staging"
[0m22:24:01.836423 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_marts"
[0m22:24:01.857731 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_dbt_test__audit"
[0m22:24:01.868373 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: BEGIN
[0m22:24:01.882569 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: BEGIN
[0m22:24:01.895566 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: BEGIN
[0m22:24:01.904473 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:24:01.918670 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:24:01.934084 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:24:01.979922 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:24:01.952290 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:24:02.019234 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_staging"
[0m22:24:02.034538 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_staging"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'

[0m22:24:01.998917 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_marts"
[0m22:24:02.012683 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:24:02.054800 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m22:24:02.062673 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_marts"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'

[0m22:24:02.071283 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_dbt_test__audit"
[0m22:24:02.086730 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: ROLLBACK
[0m22:24:02.105283 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m22:24:02.112124 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_dbt_test__audit"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'

[0m22:24:02.121146 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: Close
[0m22:24:02.134679 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: ROLLBACK
[0m22:24:02.152598 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m22:24:02.170701 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: Close
[0m22:24:02.184436 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: ROLLBACK
[0m22:24:02.213033 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: Close
[0m22:24:02.238015 [debug] [MainThread]: Using postgres connection "master"
[0m22:24:02.250504 [debug] [MainThread]: On master: BEGIN
[0m22:24:02.265280 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:24:02.281974 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:24:02.294765 [debug] [MainThread]: Using postgres connection "master"
[0m22:24:02.304036 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:24:02.332882 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m22:24:02.347040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11d96f5f-88a6-4152-833f-34d08c1f9586', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b72dfa010>]}
[0m22:24:02.354926 [debug] [MainThread]: On master: ROLLBACK
[0m22:24:02.367306 [debug] [MainThread]: Using postgres connection "master"
[0m22:24:02.380237 [debug] [MainThread]: On master: BEGIN
[0m22:24:02.393738 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:24:02.402280 [debug] [MainThread]: On master: COMMIT
[0m22:24:02.416016 [debug] [MainThread]: Using postgres connection "master"
[0m22:24:02.425860 [debug] [MainThread]: On master: COMMIT
[0m22:24:02.436452 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:24:02.450215 [debug] [MainThread]: On master: Close
[0m22:24:02.463607 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:24:02.476126 [info ] [MainThread]:
[0m22:24:02.494782 [debug] [Thread-1 (]: Began running node model.crypto_analytics.stg_crypto_prices
[0m22:24:02.496234 [debug] [Thread-2 (]: Began running node model.crypto_analytics.stg_pipeline_runs
[0m22:24:02.504263 [info ] [Thread-1 (]: 1 of 5 START sql table model public_staging.stg_crypto_prices .................. [RUN]
[0m22:24:02.579438 [info ] [Thread-2 (]: 2 of 5 START sql view model public_staging.stg_pipeline_runs ................... [RUN]
[0m22:24:02.588789 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_marts, now model.crypto_analytics.stg_crypto_prices)
[0m22:24:02.598147 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_staging, now model.crypto_analytics.stg_pipeline_runs)
[0m22:24:02.653316 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics.stg_crypto_prices
[0m22:24:02.671032 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics.stg_pipeline_runs
[0m22:24:02.717430 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics.stg_crypto_prices"
[0m22:24:02.733187 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics.stg_pipeline_runs"
[0m22:24:02.804226 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.stg_pipeline_runs (compile): 22:24:02.718245 => 22:24:02.803425
[0m22:24:02.816910 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.stg_crypto_prices (compile): 22:24:02.686392 => 22:24:02.816080
[0m22:24:02.818489 [debug] [Thread-2 (]: Began executing node model.crypto_analytics.stg_pipeline_runs
[0m22:24:02.831441 [debug] [Thread-1 (]: Began executing node model.crypto_analytics.stg_crypto_prices
[0m22:24:03.187359 [debug] [Thread-2 (]: Writing runtime sql for node "model.crypto_analytics.stg_pipeline_runs"
[0m22:24:03.202594 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics.stg_crypto_prices"
[0m22:24:03.246874 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:24:03.258896 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: BEGIN
[0m22:24:03.265546 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m22:24:03.270438 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:24:03.290567 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: BEGIN
[0m22:24:03.316743 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:24:03.318837 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:24:03.340657 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:24:03.350487 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:24:03.362340 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m22:24:03.369811 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */




  create  table "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_tmp"


    as

  (


WITH source_data AS (
    SELECT
        id as price_id,
        UPPER(TRIM(symbol)) as symbol,
        TRIM(name) as crypto_name,
        current_price as price_usd,
        market_cap,
        total_volume as volume_24h,
        price_change_24h,
        price_change_percentage_24h as price_change_pct_24h,
        market_cap_rank,
        extracted_at,
        created_at,

        CASE WHEN current_price <= 0 THEN TRUE ELSE FALSE END as is_invalid_price,
        CASE WHEN market_cap <= 0 THEN TRUE ELSE FALSE END as is_invalid_market_cap,
        CASE WHEN total_volume < 0 THEN TRUE ELSE FALSE END as is_invalid_volume
    FROM "crypto_warehouse"."public"."crypto_prices_raw"
),

cleaned_data AS (
    SELECT
        *,
        DATE(extracted_at) as extraction_date,
        DATE_TRUNC('hour', extracted_at) as extraction_hour,
        CASE
            WHEN LAG(price_usd) OVER (
                PARTITION BY symbol ORDER BY extracted_at
            ) IS NOT NULL THEN
                ((price_usd - LAG(price_usd) OVER (
                    PARTITION BY symbol ORDER BY extracted_at
                )) / LAG(price_usd) OVER (
                    PARTITION BY symbol ORDER BY extracted_at
                )) * 100
        END as price_change_pct_from_previous
    FROM source_data
    WHERE NOT is_invalid_price AND NOT is_invalid_volume
)

SELECT * FROM cleaned_data
  );

[0m22:24:03.380684 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */

  create view "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_tmp"


  as (
    SELECT
    id as run_id,
    run_id as run_identifier,
    stage,
    status,
    records_processed,
    error_message,
    started_at,
    completed_at,
    CASE
        WHEN completed_at IS NOT NULL
        THEN EXTRACT(EPOCH FROM (completed_at - started_at))
        ELSE NULL
    END as duration_seconds
FROM "crypto_warehouse"."public"."pipeline_runs"
  );
[0m22:24:03.401819 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m22:24:03.425215 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m22:24:03.433639 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */
alter table "crypto_warehouse"."public_staging"."stg_pipeline_runs" rename to "stg_pipeline_runs__dbt_backup"
[0m22:24:03.445577 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:24:03.461979 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m22:24:03.468014 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */
alter table "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_tmp" rename to "stg_pipeline_runs"
[0m22:24:03.480543 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:24:03.528564 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: COMMIT
[0m22:24:03.537485 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m22:24:03.549429 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: COMMIT
[0m22:24:03.564407 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.0 seconds
[0m22:24:03.588639 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:24:03.598654 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */
alter table "crypto_warehouse"."public_staging"."stg_crypto_prices" rename to "stg_crypto_prices__dbt_backup"
[0m22:24:03.607859 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:24:03.622922 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:24:03.642758 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */
alter table "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_tmp" rename to "stg_crypto_prices"
[0m22:24:03.658390 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:24:03.683979 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:24:03.685820 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m22:24:03.696453 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */

        CREATE INDEX IF NOT EXISTS idx_stg_crypto_prices_symbol_time ON "crypto_warehouse"."public_staging"."stg_crypto_prices" (symbol, extracted_at)

[0m22:24:03.720680 [debug] [Thread-2 (]: Applying DROP to: "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_backup"
[0m22:24:03.751027 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m22:24:03.763335 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */
drop view if exists "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_backup" cascade
[0m22:24:03.908371 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m22:24:03.911321 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:24:03.922902 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.stg_pipeline_runs (execute): 22:24:02.840207 => 22:24:03.922085
[0m22:24:03.936997 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: COMMIT
[0m22:24:03.949351 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: Close
[0m22:24:03.966874 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:24:03.985399 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11d96f5f-88a6-4152-833f-34d08c1f9586', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b72c062d0>]}
[0m22:24:04.001995 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: COMMIT
[0m22:24:04.018471 [info ] [Thread-2 (]: 2 of 5 OK created sql view model public_staging.stg_pipeline_runs .............. [[32mCREATE VIEW[0m in 1.39s]
[0m22:24:04.054901 [debug] [Thread-2 (]: Finished running node model.crypto_analytics.stg_pipeline_runs
[0m22:24:04.073724 [debug] [Thread-4 (]: Began running node model.crypto_analytics.mart_pipeline_monitoring
[0m22:24:04.096768 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:24:04.098799 [info ] [Thread-4 (]: 3 of 5 START sql table model public_marts.mart_pipeline_monitoring ............. [RUN]
[0m22:24:04.122596 [debug] [Thread-1 (]: Applying DROP to: "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_backup"
[0m22:24:04.136644 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.crypto_analytics.mart_pipeline_monitoring'
[0m22:24:04.178301 [debug] [Thread-4 (]: Began compiling node model.crypto_analytics.mart_pipeline_monitoring
[0m22:24:04.165748 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:24:04.214864 [debug] [Thread-4 (]: Writing injected SQL for node "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:24:04.221869 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */
drop table if exists "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_backup" cascade
[0m22:24:04.320385 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:24:04.353061 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.stg_crypto_prices (execute): 22:24:02.895499 => 22:24:04.352475
[0m22:24:04.368689 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: Close
[0m22:24:04.370077 [debug] [Thread-4 (]: Timing info for model.crypto_analytics.mart_pipeline_monitoring (compile): 22:24:04.194269 => 22:24:04.369450
[0m22:24:04.384587 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11d96f5f-88a6-4152-833f-34d08c1f9586', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b72b54190>]}
[0m22:24:04.417941 [debug] [Thread-4 (]: Began executing node model.crypto_analytics.mart_pipeline_monitoring
[0m22:24:04.678100 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public_staging.stg_crypto_prices ............. [[32mSELECT 15[0m in 1.80s]
[0m22:24:05.000686 [debug] [Thread-4 (]: Writing runtime sql for node "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:24:05.226862 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.stg_crypto_prices
[0m22:24:05.518966 [debug] [Thread-2 (]: Began running node model.crypto_analytics.int_crypto_daily_aggs
[0m22:24:05.520629 [debug] [Thread-3 (]: Began running node model.crypto_analytics.int_crypto_hourly_aggs
[0m22:24:05.521742 [debug] [Thread-1 (]: Began running node model.crypto_analytics.mart_crypto_latest_prices
[0m22:24:05.543193 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.stg_pipeline_runs, now model.crypto_analytics.int_crypto_daily_aggs)
[0m22:24:05.560851 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_dbt_test__audit, now model.crypto_analytics.int_crypto_hourly_aggs)
[0m22:24:05.686146 [debug] [Thread-3 (]: Began compiling node model.crypto_analytics.int_crypto_hourly_aggs
[0m22:24:05.622161 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics.int_crypto_daily_aggs
[0m22:24:05.583006 [info ] [Thread-1 (]: 4 of 5 START sql table model public_marts.mart_crypto_latest_prices ............ [RUN]
[0m22:24:05.795287 [debug] [Thread-3 (]: Writing injected SQL for node "model.crypto_analytics.int_crypto_hourly_aggs"
[0m22:24:05.855305 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics.int_crypto_daily_aggs"
[0m22:24:05.877377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.stg_crypto_prices, now model.crypto_analytics.mart_crypto_latest_prices)
[0m22:24:05.883164 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:24:05.929074 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics.mart_crypto_latest_prices
[0m22:24:05.950139 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: BEGIN
[0m22:24:05.967952 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.int_crypto_daily_aggs (compile): 22:24:05.826111 => 22:24:05.966888
[0m22:24:05.983125 [debug] [Thread-3 (]: Timing info for model.crypto_analytics.int_crypto_hourly_aggs (compile): 22:24:05.762662 => 22:24:05.969552
[0m22:24:05.994320 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:24:05.999235 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:24:06.014456 [debug] [Thread-2 (]: Finished running node model.crypto_analytics.int_crypto_daily_aggs
[0m22:24:06.027896 [debug] [Thread-3 (]: Finished running node model.crypto_analytics.int_crypto_hourly_aggs
[0m22:24:06.056022 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m22:24:06.079556 [debug] [Thread-2 (]: Began running node model.crypto_analytics.mart_crypto_hourly_performance
[0m22:24:06.084564 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:24:06.096061 [info ] [Thread-2 (]: 5 of 5 START sql table model public_marts.mart_crypto_hourly_performance ....... [RUN]
[0m22:24:06.108430 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */




  create  table "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_tmp"


    as

  (


WITH pipeline_metrics AS (
    SELECT
        run_id,
        stage,
        status,
        records_processed,
        error_message,
        started_at,
        completed_at,
        EXTRACT(EPOCH FROM completed_at - started_at) AS duration_seconds,

        -- Flag to compute success rate
        CASE WHEN status = 'success' THEN 1 ELSE 0 END AS is_success,

        -- Classify performance
        CASE
            WHEN completed_at IS NULL THEN 'Running'
            WHEN EXTRACT(EPOCH FROM completed_at - started_at) < 30 THEN 'Fast'
            WHEN EXTRACT(EPOCH FROM completed_at - started_at) < 120 THEN 'Normal'
            ELSE 'Slow'
        END AS performance_category

    FROM "crypto_warehouse"."public_staging"."stg_pipeline_runs"
),

latest_status_per_day_stage AS (
    SELECT
        DATE(started_at) AS run_date,
        stage,
        FIRST_VALUE(status) OVER (
            PARTITION BY DATE(started_at), stage
            ORDER BY started_at DESC
        ) AS latest_run_status
    FROM pipeline_metrics
),

daily_summary AS (
    SELECT
        DATE(started_at) AS run_date,
        stage,

        COUNT(*) AS total_runs,
        SUM(is_success) AS successful_runs,
        SUM(records_processed) AS total_records_processed,
        AVG(duration_seconds) AS avg_duration_seconds,
        MAX(duration_seconds) AS max_duration_seconds,
        ROUND(((SUM(is_success)::FLOAT / COUNT(*)) * 100)::NUMERIC, 2) AS success_rate_pct


    FROM pipeline_metrics
    WHERE started_at >= CURRENT_DATE - INTERVAL '30 days'
    GROUP BY DATE(started_at), stage
)

-- Final result combining metrics with latest run status
SELECT
    ds.*,
    ls.latest_run_status
FROM daily_summary ds
LEFT JOIN latest_status_per_day_stage ls
  ON ds.run_date = ls.run_date AND ds.stage = ls.stage
  );

[0m22:24:06.116588 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.mart_crypto_latest_prices (compile): 22:24:05.977173 => 22:24:06.115860
[0m22:24:06.120551 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.int_crypto_daily_aggs, now model.crypto_analytics.mart_crypto_hourly_performance)
[0m22:24:06.140174 [debug] [Thread-1 (]: Began executing node model.crypto_analytics.mart_crypto_latest_prices
[0m22:24:06.149158 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics.mart_crypto_hourly_performance
[0m22:24:06.263597 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:24:06.316851 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:24:06.326049 [debug] [Thread-4 (]: SQL status: SELECT 6 in 0.0 seconds
[0m22:24:06.373708 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:24:06.384320 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */
alter table "crypto_warehouse"."public_marts"."mart_pipeline_monitoring" rename to "mart_pipeline_monitoring__dbt_backup"
[0m22:24:06.399971 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:24:06.410535 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:24:06.423438 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:24:06.460773 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: BEGIN
[0m22:24:06.481282 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */
alter table "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_tmp" rename to "mart_pipeline_monitoring"
[0m22:24:06.491903 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.mart_crypto_hourly_performance (compile): 22:24:06.265113 => 22:24:06.490439
[0m22:24:06.499649 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:24:06.530894 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:24:06.544168 [debug] [Thread-2 (]: Began executing node model.crypto_analytics.mart_crypto_hourly_performance
[0m22:24:06.565320 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:24:06.649156 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:24:06.655517 [debug] [Thread-2 (]: Writing runtime sql for node "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:24:06.676500 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:24:06.726000 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */

    create  index if not exists
  "1fca0d74c3ca571378a9ab59f284d68f"
  on "crypto_warehouse"."public_marts"."mart_pipeline_monitoring" using btree
  (run_date);

[0m22:24:06.797215 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */




  create  table "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_tmp"


    as

  (


WITH latest_prices AS (
    SELECT
        symbol,
        crypto_name,
        price_usd,
        market_cap,
        volume_24h,
        price_change_24h,
        price_change_pct_24h,
        market_cap_rank,
        extracted_at,

        ROW_NUMBER() OVER (
            PARTITION BY symbol
            ORDER BY extracted_at DESC
        ) as rn

    FROM "crypto_warehouse"."public_staging"."stg_crypto_prices"
    WHERE extraction_date = CURRENT_DATE
),

price_changes AS (
    SELECT
        symbol,
        crypto_name,
        price_usd as current_price,
        market_cap,
        volume_24h,
        price_change_24h,
        price_change_pct_24h,
        market_cap_rank,
        extracted_at as last_updated,

        -- Calculate additional metrics
        CASE
            WHEN price_change_pct_24h > 10 THEN 'Strong Gain'
            WHEN price_change_pct_24h > 5 THEN 'Moderate Gain'
            WHEN price_change_pct_24h > 0 THEN 'Slight Gain'
            WHEN price_change_pct_24h > -5 THEN 'Slight Loss'
            WHEN price_change_pct_24h > -10 THEN 'Moderate Loss'
            ELSE 'Strong Loss'
        END as price_trend_category,

        -- Market cap category
        CASE
            WHEN market_cap_rank <= 10 THEN 'Large Cap'
            WHEN market_cap_rank <= 50 THEN 'Mid Cap'
            WHEN market_cap_rank <= 100 THEN 'Small Cap'
            ELSE 'Micro Cap'
        END as market_cap_category

    FROM latest_prices
    WHERE rn = 1
)

SELECT * FROM price_changes
  );

[0m22:24:06.894297 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:24:06.925828 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: BEGIN
[0m22:24:06.957158 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:24:06.992829 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:24:07.010967 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:24:07.021310 [debug] [Thread-4 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:24:07.027121 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */




  create  table "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_tmp"


    as

  (


WITH  __dbt__cte__int_crypto_hourly_aggs as (


WITH base_data AS (
    SELECT
        symbol,
        crypto_name,
        DATE_TRUNC('hour', extracted_at) AS extraction_hour,
        price_usd,
        volume_24h,
        market_cap,
        CASE WHEN price_usd <= 0 THEN 1 ELSE 0 END AS is_invalid
    FROM "crypto_warehouse"."public_staging"."stg_crypto_prices"
)

SELECT
    symbol,
    crypto_name,
    extraction_hour,
    COUNT(*) AS total_records,
    SUM(is_invalid) AS invalid_price_records,
    AVG(price_usd) AS avg_price_usd,
    MIN(price_usd) AS min_price_usd,
    MAX(price_usd) AS max_price_usd,
    STDDEV(price_usd) AS price_volatility,
    AVG(volume_24h) AS avg_volume_24h,
    AVG(market_cap) AS avg_market_cap
FROM base_data
GROUP BY symbol, crypto_name, extraction_hour
), hourly_data AS (
    SELECT
        symbol,
        crypto_name,
        extraction_hour,
        avg_price_usd,
        min_price_usd,
        max_price_usd,
        price_volatility,
        avg_volume_24h,
        avg_market_cap,
        total_records,

        -- Calculate hourly change
        LAG(avg_price_usd) OVER (
            PARTITION BY symbol
            ORDER BY extraction_hour
        ) as previous_hour_price,

        -- Data quality score
        (1.0 - (invalid_price_records::FLOAT / GREATEST(total_records, 1))) * 100 as data_quality_score

    FROM __dbt__cte__int_crypto_hourly_aggs
),

performance_metrics AS (
    SELECT
        *,
        CASE
            WHEN previous_hour_price IS NOT NULL AND previous_hour_price > 0 THEN
                ((avg_price_usd - previous_hour_price) / previous_hour_price) * 100
            ELSE NULL
        END as hourly_change_pct,

        -- Volatility category
        CASE
            WHEN price_volatility IS NULL THEN 'Unknown'
            WHEN price_volatility < avg_price_usd * 0.01 THEN 'Low Volatility'
            WHEN price_volatility < avg_price_usd * 0.05 THEN 'Medium Volatility'
            ELSE 'High Volatility'
        END as volatility_category

    FROM hourly_data
)

SELECT * FROM performance_metrics
  );

[0m22:24:07.043567 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:24:07.064485 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */

    create  index if not exists
  "bd16f764c1036af0b8f57445076eeb80"
  on "crypto_warehouse"."public_marts"."mart_pipeline_monitoring" using btree
  (stage);

[0m22:24:07.209239 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.0 seconds
[0m22:24:07.232958 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:24:07.245824 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_latest_prices" rename to "mart_crypto_latest_prices__dbt_backup"
[0m22:24:07.258822 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:24:07.276592 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:24:07.289841 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_tmp" rename to "mart_crypto_latest_prices"
[0m22:24:07.299570 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:24:07.318073 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:24:07.331027 [debug] [Thread-4 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:24:07.332014 [debug] [Thread-2 (]: SQL status: SELECT 10 in 0.0 seconds
[0m22:24:07.358102 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */

    create  index if not exists
  "09cc59c692111aeb6d73d865bf3c8de5"
  on "crypto_warehouse"."public_marts"."mart_crypto_latest_prices" using btree
  (symbol);

[0m22:24:07.378668 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: COMMIT
[0m22:24:07.405951 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:24:07.425110 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:24:07.432920 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance" rename to "mart_crypto_hourly_performance__dbt_backup"
[0m22:24:07.444265 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: COMMIT
[0m22:24:07.458534 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:24:07.488036 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:24:07.498395 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_tmp" rename to "mart_crypto_hourly_performance"
[0m22:24:07.510296 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:24:07.524245 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:24:07.537976 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */

    create  index if not exists
  "363f855fc8f3294e0426effc9c3a97dd"
  on "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance" using btree
  (symbol, extraction_hour);

[0m22:24:07.605501 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m22:24:07.606437 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:24:07.638296 [debug] [Thread-4 (]: Applying DROP to: "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_backup"
[0m22:24:07.643234 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:24:07.660907 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:24:07.679990 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */

    create  index if not exists
  "e0b5c0bcf303abd731e2400e7157d019"
  on "crypto_warehouse"."public_marts"."mart_crypto_latest_prices" using btree
  (market_cap_rank);

[0m22:24:07.698697 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */
drop table if exists "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_backup" cascade
[0m22:24:07.771347 [debug] [Thread-2 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:24:07.780489 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:24:07.813195 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */

    create  index if not exists
  "78f3cd58452ba1fdda1e85e6ad94778a"
  on "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance" using btree
  (extraction_hour);

[0m22:24:07.874421 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:24:07.910110 [debug] [Thread-4 (]: Timing info for model.crypto_analytics.mart_pipeline_monitoring (execute): 22:24:04.978878 => 22:24:07.909667
[0m22:24:07.951241 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: Close
[0m22:24:07.975920 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11d96f5f-88a6-4152-833f-34d08c1f9586', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b72b07890>]}
[0m22:24:07.988111 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:24:08.020741 [info ] [Thread-4 (]: 3 of 5 OK created sql table model public_marts.mart_pipeline_monitoring ........ [[32mSELECT 6[0m in 3.84s]
[0m22:24:08.075661 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: COMMIT
[0m22:24:08.104298 [debug] [Thread-4 (]: Finished running node model.crypto_analytics.mart_pipeline_monitoring
[0m22:24:08.125182 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:24:08.157979 [debug] [Thread-2 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:24:08.171340 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: COMMIT
[0m22:24:08.207086 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: COMMIT
[0m22:24:08.245909 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:24:08.262545 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: COMMIT
[0m22:24:08.339185 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:24:08.378553 [debug] [Thread-1 (]: Applying DROP to: "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_backup"
[0m22:24:08.400516 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:24:08.428349 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m22:24:08.429984 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */
drop table if exists "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_backup" cascade
[0m22:24:08.464444 [debug] [Thread-2 (]: Applying DROP to: "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_backup"
[0m22:24:08.506182 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:24:08.537982 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */
drop table if exists "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_backup" cascade
[0m22:24:08.587361 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:24:08.601417 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.mart_crypto_latest_prices (execute): 22:24:06.159199 => 22:24:08.599999
[0m22:24:08.610210 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: Close
[0m22:24:08.623848 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11d96f5f-88a6-4152-833f-34d08c1f9586', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b72d67090>]}
[0m22:24:08.639545 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public_marts.mart_crypto_latest_prices ....... [[32mSELECT 5[0m in 2.75s]
[0m22:24:08.648661 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.mart_crypto_latest_prices
[0m22:24:08.665065 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:24:08.700207 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.mart_crypto_hourly_performance (execute): 22:24:06.631328 => 22:24:08.699567
[0m22:24:08.714454 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: Close
[0m22:24:08.756021 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11d96f5f-88a6-4152-833f-34d08c1f9586', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b72c78250>]}
[0m22:24:08.765526 [info ] [Thread-2 (]: 5 of 5 OK created sql table model public_marts.mart_crypto_hourly_performance .. [[32mSELECT 10[0m in 2.64s]
[0m22:24:08.777384 [debug] [Thread-2 (]: Finished running node model.crypto_analytics.mart_crypto_hourly_performance
[0m22:24:08.793703 [debug] [MainThread]: Using postgres connection "master"
[0m22:24:08.807398 [debug] [MainThread]: On master: BEGIN
[0m22:24:08.820290 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:24:08.834577 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:24:08.847560 [debug] [MainThread]: On master: COMMIT
[0m22:24:08.875495 [debug] [MainThread]: Using postgres connection "master"
[0m22:24:08.892812 [debug] [MainThread]: On master: COMMIT
[0m22:24:08.910181 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:24:08.926067 [debug] [MainThread]: On master: Close
[0m22:24:08.943624 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:24:08.976321 [debug] [MainThread]: Connection 'model.crypto_analytics.mart_crypto_latest_prices' was properly closed.
[0m22:24:09.008581 [debug] [MainThread]: Connection 'model.crypto_analytics.mart_crypto_hourly_performance' was properly closed.
[0m22:24:09.040074 [debug] [MainThread]: Connection 'model.crypto_analytics.int_crypto_hourly_aggs' was properly closed.
[0m22:24:09.058701 [debug] [MainThread]: Connection 'model.crypto_analytics.mart_pipeline_monitoring' was properly closed.
[0m22:24:09.074298 [info ] [MainThread]:
[0m22:24:09.089341 [info ] [MainThread]: Finished running 1 view model, 4 table models in 0 hours 0 minutes and 7.71 seconds (7.71s).
[0m22:24:09.121371 [debug] [MainThread]: Command end result
[0m22:24:09.561317 [info ] [MainThread]:
[0m22:24:09.592861 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:24:09.623095 [info ] [MainThread]:
[0m22:24:09.651563 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m22:24:09.700632 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 17.020817, "process_user_time": 10.808398, "process_kernel_time": 1.300637, "process_mem_max_rss": "121228", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:24:09.796227 [debug] [MainThread]: Command `dbt run` succeeded at 22:24:09.795805 after 17.12 seconds
[0m22:24:09.829426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b745ea190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b78f65510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b78f64ad0>]}
[0m22:24:09.860418 [debug] [MainThread]: Flushing usage events
[0m22:24:10.698242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea0f3c22d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea0f875d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea0f3c35d0>]}


============================== 22:24:10.720335 | 5c006fe1-31f3-4ae6-b9db-b4ad14ae129d ==============================
[0m22:24:10.720335 [info ] [MainThread]: Running with dbt=1.7.0
[0m22:24:10.767227 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'debug': 'False', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --project-dir /app/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:25:22.649024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6129288b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f612928ac90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f612928ad10>]}


============================== 22:25:22.664542 | 19766284-3c3c-46ee-a36c-21312d57a492 ==============================
[0m22:25:22.664542 [info ] [MainThread]: Running with dbt=1.7.0
[0m22:25:22.677213 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /app/dbt', 'send_anonymous_usage_stats': 'True'}
[0m22:25:23.443245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '19766284-3c3c-46ee-a36c-21312d57a492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6127b95250>]}
[0m22:25:23.692514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '19766284-3c3c-46ee-a36c-21312d57a492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6127b8e410>]}
[0m22:25:23.704870 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m22:25:23.744548 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m22:25:25.036478 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:25:25.058539 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:25:25.142113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '19766284-3c3c-46ee-a36c-21312d57a492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6127a1f590>]}
[0m22:25:25.569832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '19766284-3c3c-46ee-a36c-21312d57a492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6127a66550>]}
[0m22:25:25.577518 [info ] [MainThread]: Found 7 models, 14 tests, 2 sources, 0 exposures, 0 metrics, 403 macros, 0 groups, 0 semantic models
[0m22:25:25.589309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19766284-3c3c-46ee-a36c-21312d57a492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f612cd14210>]}
[0m22:25:25.607078 [info ] [MainThread]:
[0m22:25:25.620928 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:25:25.638404 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse'
[0m22:25:25.640878 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse'
[0m22:25:25.708714 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse"
[0m22:25:25.721484 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse"
[0m22:25:25.725864 [debug] [ThreadPool]: On list_crypto_warehouse: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse"} */

    select distinct nspname from pg_namespace

[0m22:25:25.742709 [debug] [ThreadPool]: On list_crypto_warehouse: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse"} */

    select distinct nspname from pg_namespace

[0m22:25:25.761012 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:25:25.777020 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:25:25.820683 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m22:25:25.828134 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m22:25:25.845391 [debug] [ThreadPool]: On list_crypto_warehouse: Close
[0m22:25:25.860640 [debug] [ThreadPool]: On list_crypto_warehouse: Close
[0m22:25:25.889659 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_warehouse, now list_crypto_warehouse_public_dbt_test__audit)
[0m22:25:25.891836 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_warehouse, now list_crypto_warehouse_public_marts)
[0m22:25:25.893962 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse_public_staging'
[0m22:25:25.938214 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_dbt_test__audit"
[0m22:25:25.944025 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_marts"
[0m22:25:25.977776 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_staging"
[0m22:25:25.990088 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: BEGIN
[0m22:25:26.003849 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: BEGIN
[0m22:25:26.017601 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: BEGIN
[0m22:25:26.025905 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:25:26.041119 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:25:26.056948 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:25:26.078450 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:25:26.093782 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:25:26.108895 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:25:26.119214 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_dbt_test__audit"
[0m22:25:26.138906 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_marts"
[0m22:25:26.155821 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_staging"
[0m22:25:26.173313 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_dbt_test__audit"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'

[0m22:25:26.191681 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_marts"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'

[0m22:25:26.206412 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_staging"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'

[0m22:25:26.225007 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m22:25:26.242831 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m22:25:26.260068 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m22:25:26.267094 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: ROLLBACK
[0m22:25:26.277937 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: ROLLBACK
[0m22:25:26.291847 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: ROLLBACK
[0m22:25:26.304774 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: Close
[0m22:25:26.310564 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: Close
[0m22:25:26.324997 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: Close
[0m22:25:26.372555 [debug] [MainThread]: Using postgres connection "master"
[0m22:25:26.381568 [debug] [MainThread]: On master: BEGIN
[0m22:25:26.390860 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:25:26.407735 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:25:26.425701 [debug] [MainThread]: Using postgres connection "master"
[0m22:25:26.443727 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:25:26.472537 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m22:25:26.486010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19766284-3c3c-46ee-a36c-21312d57a492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6127bc2790>]}
[0m22:25:26.492831 [debug] [MainThread]: On master: ROLLBACK
[0m22:25:26.505844 [debug] [MainThread]: Using postgres connection "master"
[0m22:25:26.517752 [debug] [MainThread]: On master: BEGIN
[0m22:25:26.526329 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:25:26.538008 [debug] [MainThread]: On master: COMMIT
[0m22:25:26.544031 [debug] [MainThread]: Using postgres connection "master"
[0m22:25:26.555259 [debug] [MainThread]: On master: COMMIT
[0m22:25:26.568415 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:25:26.574673 [debug] [MainThread]: On master: Close
[0m22:25:26.587379 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:25:26.595042 [info ] [MainThread]:
[0m22:25:26.613210 [debug] [Thread-1 (]: Began running node model.crypto_analytics.stg_crypto_prices
[0m22:25:26.615438 [debug] [Thread-2 (]: Began running node model.crypto_analytics.stg_pipeline_runs
[0m22:25:26.622643 [info ] [Thread-1 (]: 1 of 5 START sql table model public_staging.stg_crypto_prices .................. [RUN]
[0m22:25:26.634434 [info ] [Thread-2 (]: 2 of 5 START sql view model public_staging.stg_pipeline_runs ................... [RUN]
[0m22:25:26.642795 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_staging, now model.crypto_analytics.stg_crypto_prices)
[0m22:25:26.654668 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_marts, now model.crypto_analytics.stg_pipeline_runs)
[0m22:25:26.665305 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics.stg_crypto_prices
[0m22:25:26.674511 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics.stg_pipeline_runs
[0m22:25:26.707472 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics.stg_crypto_prices"
[0m22:25:26.716002 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics.stg_pipeline_runs"
[0m22:25:26.773422 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.stg_crypto_prices (compile): 22:25:26.685462 => 22:25:26.772586
[0m22:25:26.786136 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.stg_pipeline_runs (compile): 22:25:26.708412 => 22:25:26.785054
[0m22:25:26.787650 [debug] [Thread-1 (]: Began executing node model.crypto_analytics.stg_crypto_prices
[0m22:25:26.794439 [debug] [Thread-2 (]: Began executing node model.crypto_analytics.stg_pipeline_runs
[0m22:25:27.031911 [debug] [Thread-2 (]: Writing runtime sql for node "model.crypto_analytics.stg_pipeline_runs"
[0m22:25:27.045451 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics.stg_crypto_prices"
[0m22:25:27.102916 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m22:25:27.107572 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:25:27.111138 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: BEGIN
[0m22:25:27.127069 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: BEGIN
[0m22:25:27.140510 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:25:27.160315 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:25:27.188032 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:25:27.207411 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:25:27.225785 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m22:25:27.239022 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:25:27.254688 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */

  create view "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_tmp"


  as (
    SELECT
    id as run_id,
    run_id as run_identifier,
    stage,
    status,
    records_processed,
    error_message,
    started_at,
    completed_at,
    CASE
        WHEN completed_at IS NOT NULL
        THEN EXTRACT(EPOCH FROM (completed_at - started_at))
        ELSE NULL
    END as duration_seconds
FROM "crypto_warehouse"."public"."pipeline_runs"
  );
[0m22:25:27.266896 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */




  create  table "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_tmp"


    as

  (


WITH source_data AS (
    SELECT
        id as price_id,
        UPPER(TRIM(symbol)) as symbol,
        TRIM(name) as crypto_name,
        current_price as price_usd,
        market_cap,
        total_volume as volume_24h,
        price_change_24h,
        price_change_percentage_24h as price_change_pct_24h,
        market_cap_rank,
        extracted_at,
        created_at,

        CASE WHEN current_price <= 0 THEN TRUE ELSE FALSE END as is_invalid_price,
        CASE WHEN market_cap <= 0 THEN TRUE ELSE FALSE END as is_invalid_market_cap,
        CASE WHEN total_volume < 0 THEN TRUE ELSE FALSE END as is_invalid_volume
    FROM "crypto_warehouse"."public"."crypto_prices_raw"
),

cleaned_data AS (
    SELECT
        *,
        DATE(extracted_at) as extraction_date,
        DATE_TRUNC('hour', extracted_at) as extraction_hour,
        CASE
            WHEN LAG(price_usd) OVER (
                PARTITION BY symbol ORDER BY extracted_at
            ) IS NOT NULL THEN
                ((price_usd - LAG(price_usd) OVER (
                    PARTITION BY symbol ORDER BY extracted_at
                )) / LAG(price_usd) OVER (
                    PARTITION BY symbol ORDER BY extracted_at
                )) * 100
        END as price_change_pct_from_previous
    FROM source_data
    WHERE NOT is_invalid_price AND NOT is_invalid_volume
)

SELECT * FROM cleaned_data
  );

[0m22:25:27.277468 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m22:25:27.320342 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m22:25:27.326507 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */
alter table "crypto_warehouse"."public_staging"."stg_pipeline_runs" rename to "stg_pipeline_runs__dbt_backup"
[0m22:25:27.339854 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:25:27.362354 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m22:25:27.375592 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */
alter table "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_tmp" rename to "stg_pipeline_runs"
[0m22:25:27.388690 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:25:27.452860 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: COMMIT
[0m22:25:27.502395 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m22:25:27.518022 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: COMMIT
[0m22:25:27.542359 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.0 seconds
[0m22:25:27.586486 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m22:25:27.616135 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:25:27.654696 [debug] [Thread-2 (]: Applying DROP to: "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_backup"
[0m22:25:27.656378 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */
alter table "crypto_warehouse"."public_staging"."stg_crypto_prices" rename to "stg_crypto_prices__dbt_backup"
[0m22:25:27.694710 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m22:25:27.704530 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:25:27.718913 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */
drop view if exists "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_backup" cascade
[0m22:25:27.742463 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:25:27.788293 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */
alter table "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_tmp" rename to "stg_crypto_prices"
[0m22:25:27.808094 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:25:27.851218 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m22:25:27.866928 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:25:27.932115 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.stg_pipeline_runs (execute): 22:25:26.859638 => 22:25:27.931351
[0m22:25:27.999135 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */

        CREATE INDEX IF NOT EXISTS idx_stg_crypto_prices_symbol_time ON "crypto_warehouse"."public_staging"."stg_crypto_prices" (symbol, extracted_at)

[0m22:25:28.017691 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: Close
[0m22:25:28.054292 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:25:28.089442 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19766284-3c3c-46ee-a36c-21312d57a492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6127acc050>]}
[0m22:25:28.131692 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: COMMIT
[0m22:25:28.201653 [info ] [Thread-2 (]: 2 of 5 OK created sql view model public_staging.stg_pipeline_runs .............. [[32mCREATE VIEW[0m in 1.43s]
[0m22:25:28.239530 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:25:28.259148 [debug] [Thread-2 (]: Finished running node model.crypto_analytics.stg_pipeline_runs
[0m22:25:28.323025 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: COMMIT
[0m22:25:28.366725 [debug] [Thread-4 (]: Began running node model.crypto_analytics.mart_pipeline_monitoring
[0m22:25:28.420432 [info ] [Thread-4 (]: 3 of 5 START sql table model public_marts.mart_pipeline_monitoring ............. [RUN]
[0m22:25:28.436855 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.crypto_analytics.mart_pipeline_monitoring'
[0m22:25:28.454959 [debug] [Thread-4 (]: Began compiling node model.crypto_analytics.mart_pipeline_monitoring
[0m22:25:28.487705 [debug] [Thread-4 (]: Writing injected SQL for node "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:25:28.488741 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:25:28.538676 [debug] [Thread-1 (]: Applying DROP to: "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_backup"
[0m22:25:28.572869 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:25:28.591618 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */
drop table if exists "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_backup" cascade
[0m22:25:28.650268 [debug] [Thread-4 (]: Timing info for model.crypto_analytics.mart_pipeline_monitoring (compile): 22:25:28.468784 => 22:25:28.649368
[0m22:25:28.665372 [debug] [Thread-4 (]: Began executing node model.crypto_analytics.mart_pipeline_monitoring
[0m22:25:28.686175 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:25:28.691755 [debug] [Thread-4 (]: Writing runtime sql for node "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:25:28.702696 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.stg_crypto_prices (execute): 22:25:26.806626 => 22:25:28.702219
[0m22:25:28.721573 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: Close
[0m22:25:28.736051 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19766284-3c3c-46ee-a36c-21312d57a492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6127a37810>]}
[0m22:25:28.750172 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public_staging.stg_crypto_prices ............. [[32mSELECT 15[0m in 2.09s]
[0m22:25:28.758324 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.stg_crypto_prices
[0m22:25:28.772723 [debug] [Thread-2 (]: Began running node model.crypto_analytics.int_crypto_daily_aggs
[0m22:25:28.773869 [debug] [Thread-3 (]: Began running node model.crypto_analytics.int_crypto_hourly_aggs
[0m22:25:28.774945 [debug] [Thread-1 (]: Began running node model.crypto_analytics.mart_crypto_latest_prices
[0m22:25:28.783291 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:25:28.786497 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.stg_pipeline_runs, now model.crypto_analytics.int_crypto_daily_aggs)
[0m22:25:28.798276 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_dbt_test__audit, now model.crypto_analytics.int_crypto_hourly_aggs)
[0m22:25:28.807269 [info ] [Thread-1 (]: 4 of 5 START sql table model public_marts.mart_crypto_latest_prices ............ [RUN]
[0m22:25:28.820553 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: BEGIN
[0m22:25:28.832251 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics.int_crypto_daily_aggs
[0m22:25:28.839593 [debug] [Thread-3 (]: Began compiling node model.crypto_analytics.int_crypto_hourly_aggs
[0m22:25:28.852700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.stg_crypto_prices, now model.crypto_analytics.mart_crypto_latest_prices)
[0m22:25:28.867272 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:25:28.884006 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics.int_crypto_daily_aggs"
[0m22:25:28.898819 [debug] [Thread-3 (]: Writing injected SQL for node "model.crypto_analytics.int_crypto_hourly_aggs"
[0m22:25:28.903601 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics.mart_crypto_latest_prices
[0m22:25:28.933071 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m22:25:29.074003 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:25:29.076526 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:25:29.088239 [debug] [Thread-3 (]: Timing info for model.crypto_analytics.int_crypto_hourly_aggs (compile): 22:25:28.887226 => 22:25:29.087557
[0m22:25:29.098783 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.int_crypto_daily_aggs (compile): 22:25:28.873593 => 22:25:29.098056
[0m22:25:29.100805 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */




  create  table "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_tmp"


    as

  (


WITH pipeline_metrics AS (
    SELECT
        run_id,
        stage,
        status,
        records_processed,
        error_message,
        started_at,
        completed_at,
        EXTRACT(EPOCH FROM completed_at - started_at) AS duration_seconds,

        -- Flag to compute success rate
        CASE WHEN status = 'success' THEN 1 ELSE 0 END AS is_success,

        -- Classify performance
        CASE
            WHEN completed_at IS NULL THEN 'Running'
            WHEN EXTRACT(EPOCH FROM completed_at - started_at) < 30 THEN 'Fast'
            WHEN EXTRACT(EPOCH FROM completed_at - started_at) < 120 THEN 'Normal'
            ELSE 'Slow'
        END AS performance_category

    FROM "crypto_warehouse"."public_staging"."stg_pipeline_runs"
),

latest_status_per_day_stage AS (
    SELECT
        DATE(started_at) AS run_date,
        stage,
        FIRST_VALUE(status) OVER (
            PARTITION BY DATE(started_at), stage
            ORDER BY started_at DESC
        ) AS latest_run_status
    FROM pipeline_metrics
),

daily_summary AS (
    SELECT
        DATE(started_at) AS run_date,
        stage,

        COUNT(*) AS total_runs,
        SUM(is_success) AS successful_runs,
        SUM(records_processed) AS total_records_processed,
        AVG(duration_seconds) AS avg_duration_seconds,
        MAX(duration_seconds) AS max_duration_seconds,
        ROUND(((SUM(is_success)::FLOAT / COUNT(*)) * 100)::NUMERIC, 2) AS success_rate_pct


    FROM pipeline_metrics
    WHERE started_at >= CURRENT_DATE - INTERVAL '30 days'
    GROUP BY DATE(started_at), stage
)

-- Final result combining metrics with latest run status
SELECT
    ds.*,
    ls.latest_run_status
FROM daily_summary ds
LEFT JOIN latest_status_per_day_stage ls
  ON ds.run_date = ls.run_date AND ds.stage = ls.stage
  );

[0m22:25:29.120966 [debug] [Thread-3 (]: Finished running node model.crypto_analytics.int_crypto_hourly_aggs
[0m22:25:29.157109 [debug] [Thread-2 (]: Finished running node model.crypto_analytics.int_crypto_daily_aggs
[0m22:25:29.201554 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.mart_crypto_latest_prices (compile): 22:25:28.941499 => 22:25:29.200751
[0m22:25:29.203919 [debug] [Thread-3 (]: Began running node model.crypto_analytics.mart_crypto_hourly_performance
[0m22:25:29.223311 [debug] [Thread-1 (]: Began executing node model.crypto_analytics.mart_crypto_latest_prices
[0m22:25:29.235932 [info ] [Thread-3 (]: 5 of 5 START sql table model public_marts.mart_crypto_hourly_performance ....... [RUN]
[0m22:25:29.268347 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:25:29.273249 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.int_crypto_hourly_aggs, now model.crypto_analytics.mart_crypto_hourly_performance)
[0m22:25:29.299539 [debug] [Thread-3 (]: Began compiling node model.crypto_analytics.mart_crypto_hourly_performance
[0m22:25:29.322397 [debug] [Thread-4 (]: SQL status: SELECT 6 in 0.0 seconds
[0m22:25:29.370089 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:25:29.383652 [debug] [Thread-3 (]: Writing injected SQL for node "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:25:29.385113 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */
alter table "crypto_warehouse"."public_marts"."mart_pipeline_monitoring" rename to "mart_pipeline_monitoring__dbt_backup"
[0m22:25:29.387435 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:25:29.406134 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:25:29.418428 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: BEGIN
[0m22:25:29.437867 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:25:29.448428 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:25:29.456091 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */
alter table "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_tmp" rename to "mart_pipeline_monitoring"
[0m22:25:29.465621 [debug] [Thread-3 (]: Timing info for model.crypto_analytics.mart_crypto_hourly_performance (compile): 22:25:29.313318 => 22:25:29.464856
[0m22:25:29.476560 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:25:29.488347 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:25:29.498100 [debug] [Thread-3 (]: Began executing node model.crypto_analytics.mart_crypto_hourly_performance
[0m22:25:29.505267 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:25:29.564892 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:25:29.573633 [debug] [Thread-3 (]: Writing runtime sql for node "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:25:29.582187 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */




  create  table "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_tmp"


    as

  (


WITH latest_prices AS (
    SELECT
        symbol,
        crypto_name,
        price_usd,
        market_cap,
        volume_24h,
        price_change_24h,
        price_change_pct_24h,
        market_cap_rank,
        extracted_at,

        ROW_NUMBER() OVER (
            PARTITION BY symbol
            ORDER BY extracted_at DESC
        ) as rn

    FROM "crypto_warehouse"."public_staging"."stg_crypto_prices"
    WHERE extraction_date = CURRENT_DATE
),

price_changes AS (
    SELECT
        symbol,
        crypto_name,
        price_usd as current_price,
        market_cap,
        volume_24h,
        price_change_24h,
        price_change_pct_24h,
        market_cap_rank,
        extracted_at as last_updated,

        -- Calculate additional metrics
        CASE
            WHEN price_change_pct_24h > 10 THEN 'Strong Gain'
            WHEN price_change_pct_24h > 5 THEN 'Moderate Gain'
            WHEN price_change_pct_24h > 0 THEN 'Slight Gain'
            WHEN price_change_pct_24h > -5 THEN 'Slight Loss'
            WHEN price_change_pct_24h > -10 THEN 'Moderate Loss'
            ELSE 'Strong Loss'
        END as price_trend_category,

        -- Market cap category
        CASE
            WHEN market_cap_rank <= 10 THEN 'Large Cap'
            WHEN market_cap_rank <= 50 THEN 'Mid Cap'
            WHEN market_cap_rank <= 100 THEN 'Small Cap'
            ELSE 'Micro Cap'
        END as market_cap_category

    FROM latest_prices
    WHERE rn = 1
)

SELECT * FROM price_changes
  );

[0m22:25:29.588151 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */

    create  index if not exists
  "5c8ddf66a02264f09c5730fc1e8c29d1"
  on "crypto_warehouse"."public_marts"."mart_pipeline_monitoring" using btree
  (run_date);

[0m22:25:29.645039 [debug] [Thread-3 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:25:29.652293 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: BEGIN
[0m22:25:29.686054 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:25:29.716849 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:25:29.733350 [debug] [Thread-3 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:25:29.763658 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */




  create  table "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_tmp"


    as

  (


WITH  __dbt__cte__int_crypto_hourly_aggs as (


WITH base_data AS (
    SELECT
        symbol,
        crypto_name,
        DATE_TRUNC('hour', extracted_at) AS extraction_hour,
        price_usd,
        volume_24h,
        market_cap,
        CASE WHEN price_usd <= 0 THEN 1 ELSE 0 END AS is_invalid
    FROM "crypto_warehouse"."public_staging"."stg_crypto_prices"
)

SELECT
    symbol,
    crypto_name,
    extraction_hour,
    COUNT(*) AS total_records,
    SUM(is_invalid) AS invalid_price_records,
    AVG(price_usd) AS avg_price_usd,
    MIN(price_usd) AS min_price_usd,
    MAX(price_usd) AS max_price_usd,
    STDDEV(price_usd) AS price_volatility,
    AVG(volume_24h) AS avg_volume_24h,
    AVG(market_cap) AS avg_market_cap
FROM base_data
GROUP BY symbol, crypto_name, extraction_hour
), hourly_data AS (
    SELECT
        symbol,
        crypto_name,
        extraction_hour,
        avg_price_usd,
        min_price_usd,
        max_price_usd,
        price_volatility,
        avg_volume_24h,
        avg_market_cap,
        total_records,

        -- Calculate hourly change
        LAG(avg_price_usd) OVER (
            PARTITION BY symbol
            ORDER BY extraction_hour
        ) as previous_hour_price,

        -- Data quality score
        (1.0 - (invalid_price_records::FLOAT / GREATEST(total_records, 1))) * 100 as data_quality_score

    FROM __dbt__cte__int_crypto_hourly_aggs
),

performance_metrics AS (
    SELECT
        *,
        CASE
            WHEN previous_hour_price IS NOT NULL AND previous_hour_price > 0 THEN
                ((avg_price_usd - previous_hour_price) / previous_hour_price) * 100
            ELSE NULL
        END as hourly_change_pct,

        -- Volatility category
        CASE
            WHEN price_volatility IS NULL THEN 'Unknown'
            WHEN price_volatility < avg_price_usd * 0.01 THEN 'Low Volatility'
            WHEN price_volatility < avg_price_usd * 0.05 THEN 'Medium Volatility'
            ELSE 'High Volatility'
        END as volatility_category

    FROM hourly_data
)

SELECT * FROM performance_metrics
  );

[0m22:25:29.765649 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.0 seconds
[0m22:25:29.766746 [debug] [Thread-4 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:25:29.806886 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:25:29.818885 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:25:29.825815 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_latest_prices" rename to "mart_crypto_latest_prices__dbt_backup"
[0m22:25:29.835051 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */

    create  index if not exists
  "b464a941a2281b0a07687fc736a64148"
  on "crypto_warehouse"."public_marts"."mart_pipeline_monitoring" using btree
  (stage);

[0m22:25:29.842304 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:25:29.866004 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:25:29.871842 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_tmp" rename to "mart_crypto_latest_prices"
[0m22:25:29.883958 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:25:29.895334 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:25:29.901590 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */

    create  index if not exists
  "cb83f97f35c3498c9ecae62e406ccb68"
  on "crypto_warehouse"."public_marts"."mart_crypto_latest_prices" using btree
  (symbol);

[0m22:25:29.988404 [debug] [Thread-3 (]: SQL status: SELECT 10 in 0.0 seconds
[0m22:25:30.005205 [debug] [Thread-3 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:25:30.014940 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance" rename to "mart_crypto_hourly_performance__dbt_backup"
[0m22:25:30.021731 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:25:30.036768 [debug] [Thread-3 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:25:30.048975 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_tmp" rename to "mart_crypto_hourly_performance"
[0m22:25:30.057653 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:25:30.076724 [debug] [Thread-3 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:25:30.086346 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */

    create  index if not exists
  "dfbd28b3f943f9b7ad57418e9e5a00a1"
  on "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance" using btree
  (symbol, extraction_hour);

[0m22:25:30.131235 [debug] [Thread-4 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:25:30.132411 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:25:30.178493 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: COMMIT
[0m22:25:30.196726 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:25:30.204942 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:25:30.217433 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */

    create  index if not exists
  "32c6d56389a3935c5086687ad69b485e"
  on "crypto_warehouse"."public_marts"."mart_crypto_latest_prices" using btree
  (market_cap_rank);

[0m22:25:30.230768 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: COMMIT
[0m22:25:30.253209 [debug] [Thread-3 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:25:30.272845 [debug] [Thread-3 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:25:30.287133 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */

    create  index if not exists
  "4b40789b864d199a1eb4cf02f9b89f56"
  on "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance" using btree
  (extraction_hour);

[0m22:25:30.331377 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m22:25:30.354629 [debug] [Thread-4 (]: Applying DROP to: "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_backup"
[0m22:25:30.370620 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:25:30.384657 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */
drop table if exists "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_backup" cascade
[0m22:25:30.445451 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:25:30.454820 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: COMMIT
[0m22:25:30.468519 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:25:30.480462 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: COMMIT
[0m22:25:30.528027 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:25:30.537063 [debug] [Thread-4 (]: Timing info for model.crypto_analytics.mart_pipeline_monitoring (execute): 22:25:28.675130 => 22:25:30.536593
[0m22:25:30.548754 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: Close
[0m22:25:30.556737 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19766284-3c3c-46ee-a36c-21312d57a492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61277cc0d0>]}
[0m22:25:30.615211 [info ] [Thread-4 (]: 3 of 5 OK created sql table model public_marts.mart_pipeline_monitoring ........ [[32mSELECT 6[0m in 2.12s]
[0m22:25:30.623360 [debug] [Thread-4 (]: Finished running node model.crypto_analytics.mart_pipeline_monitoring
[0m22:25:30.677605 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:25:30.686982 [debug] [Thread-1 (]: Applying DROP to: "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_backup"
[0m22:25:30.698151 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:25:30.703930 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */
drop table if exists "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_backup" cascade
[0m22:25:30.730951 [debug] [Thread-3 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:25:30.739044 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: COMMIT
[0m22:25:30.748694 [debug] [Thread-3 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:25:30.754534 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: COMMIT
[0m22:25:30.789169 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:25:30.800946 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.mart_crypto_latest_prices (execute): 22:25:29.249506 => 22:25:30.800571
[0m22:25:30.807924 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: Close
[0m22:25:30.817126 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19766284-3c3c-46ee-a36c-21312d57a492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61278fe4d0>]}
[0m22:25:30.824266 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public_marts.mart_crypto_latest_prices ....... [[32mSELECT 5[0m in 1.96s]
[0m22:25:30.834770 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.mart_crypto_latest_prices
[0m22:25:30.888651 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m22:25:30.902475 [debug] [Thread-3 (]: Applying DROP to: "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_backup"
[0m22:25:30.913590 [debug] [Thread-3 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:25:30.919532 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */
drop table if exists "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_backup" cascade
[0m22:25:30.978587 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:25:30.986265 [debug] [Thread-3 (]: Timing info for model.crypto_analytics.mart_crypto_hourly_performance (execute): 22:25:29.565881 => 22:25:30.985930
[0m22:25:30.996473 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: Close
[0m22:25:31.002989 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19766284-3c3c-46ee-a36c-21312d57a492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6127999f90>]}
[0m22:25:31.014073 [info ] [Thread-3 (]: 5 of 5 OK created sql table model public_marts.mart_crypto_hourly_performance .. [[32mSELECT 10[0m in 1.73s]
[0m22:25:31.020917 [debug] [Thread-3 (]: Finished running node model.crypto_analytics.mart_crypto_hourly_performance
[0m22:25:31.033381 [debug] [MainThread]: Using postgres connection "master"
[0m22:25:31.039031 [debug] [MainThread]: On master: BEGIN
[0m22:25:31.048426 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:25:31.062158 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:25:31.068611 [debug] [MainThread]: On master: COMMIT
[0m22:25:31.079751 [debug] [MainThread]: Using postgres connection "master"
[0m22:25:31.085334 [debug] [MainThread]: On master: COMMIT
[0m22:25:31.097055 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:25:31.102675 [debug] [MainThread]: On master: Close
[0m22:25:31.116334 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:25:31.139582 [debug] [MainThread]: Connection 'model.crypto_analytics.int_crypto_daily_aggs' was properly closed.
[0m22:25:31.170983 [debug] [MainThread]: Connection 'model.crypto_analytics.mart_crypto_hourly_performance' was properly closed.
[0m22:25:31.188305 [debug] [MainThread]: Connection 'model.crypto_analytics.mart_crypto_latest_prices' was properly closed.
[0m22:25:31.202602 [debug] [MainThread]: Connection 'model.crypto_analytics.mart_pipeline_monitoring' was properly closed.
[0m22:25:31.214690 [info ] [MainThread]:
[0m22:25:31.224741 [info ] [MainThread]: Finished running 1 view model, 4 table models in 0 hours 0 minutes and 5.59 seconds (5.59s).
[0m22:25:31.238046 [debug] [MainThread]: Command end result
[0m22:25:31.478348 [info ] [MainThread]:
[0m22:25:31.489171 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:25:31.504551 [info ] [MainThread]:
[0m22:25:31.530111 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m22:25:31.539190 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.03228, "process_user_time": 9.406749, "process_kernel_time": 0.683227, "process_mem_max_rss": "121724", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:25:31.551761 [debug] [MainThread]: Command `dbt run` succeeded at 22:25:31.551301 after 9.04 seconds
[0m22:25:31.582463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f612778ec10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f612dcc0a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f612dcc1550>]}
[0m22:25:31.594846 [debug] [MainThread]: Flushing usage events
[0m22:26:50.052071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bf695c950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bf6957d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bf6e2e590>]}


============================== 22:26:50.071063 | 24e2caa1-3080-4d10-a79a-a6dffb067e0c ==============================
[0m22:26:50.071063 [info ] [MainThread]: Running with dbt=1.7.0
[0m22:26:50.086517 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/app', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test --project-dir /app/dbt', 'send_anonymous_usage_stats': 'True'}
[0m22:26:51.558875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '24e2caa1-3080-4d10-a79a-a6dffb067e0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bf50d4f90>]}
[0m22:26:51.997760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '24e2caa1-3080-4d10-a79a-a6dffb067e0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bf6957d10>]}
[0m22:26:52.016982 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m22:26:52.417922 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m22:26:53.779357 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:26:53.786812 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:26:53.809139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '24e2caa1-3080-4d10-a79a-a6dffb067e0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bf5133ad0>]}
[0m22:26:54.068933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '24e2caa1-3080-4d10-a79a-a6dffb067e0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bf4fc43d0>]}
[0m22:26:54.089721 [info ] [MainThread]: Found 7 models, 14 tests, 2 sources, 0 exposures, 0 metrics, 403 macros, 0 groups, 0 semantic models
[0m22:26:54.116314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24e2caa1-3080-4d10-a79a-a6dffb067e0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bf687a0d0>]}
[0m22:26:54.274780 [info ] [MainThread]:
[0m22:26:54.355319 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:26:54.385148 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse'
[0m22:26:54.476637 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse"
[0m22:26:54.489033 [debug] [ThreadPool]: On list_crypto_warehouse: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse"} */

    select distinct nspname from pg_namespace

[0m22:26:54.496584 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:26:54.516748 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m22:26:54.530887 [debug] [ThreadPool]: On list_crypto_warehouse: Close
[0m22:26:54.544176 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_warehouse, now create_crypto_warehouse_public_dbt_test__audit)
[0m22:26:54.558879 [debug] [ThreadPool]: Creating schema "database: "crypto_warehouse"
schema: "public_dbt_test__audit"
"
[0m22:26:54.594123 [debug] [ThreadPool]: Using postgres connection "create_crypto_warehouse_public_dbt_test__audit"
[0m22:26:54.637773 [debug] [ThreadPool]: On create_crypto_warehouse_public_dbt_test__audit: BEGIN
[0m22:26:54.693099 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:26:54.715703 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:26:54.795023 [debug] [ThreadPool]: Using postgres connection "create_crypto_warehouse_public_dbt_test__audit"
[0m22:26:54.823916 [debug] [ThreadPool]: On create_crypto_warehouse_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "create_crypto_warehouse_public_dbt_test__audit"} */
create schema if not exists "public_dbt_test__audit"
[0m22:26:54.863362 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m22:26:54.889392 [debug] [ThreadPool]: On create_crypto_warehouse_public_dbt_test__audit: COMMIT
[0m22:26:54.904673 [debug] [ThreadPool]: Using postgres connection "create_crypto_warehouse_public_dbt_test__audit"
[0m22:26:54.913138 [debug] [ThreadPool]: On create_crypto_warehouse_public_dbt_test__audit: COMMIT
[0m22:26:54.966587 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m22:26:54.976728 [debug] [ThreadPool]: On create_crypto_warehouse_public_dbt_test__audit: Close
[0m22:26:55.003084 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_warehouse_public_dbt_test__audit, now list_crypto_warehouse_public_dbt_test__audit)
[0m22:26:55.012014 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse_public_marts'
[0m22:26:55.014796 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse_public_staging'
[0m22:26:55.052052 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_dbt_test__audit"
[0m22:26:55.062217 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_marts"
[0m22:26:55.085739 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_staging"
[0m22:26:55.094117 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: BEGIN
[0m22:26:55.123325 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: BEGIN
[0m22:26:55.145096 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: BEGIN
[0m22:26:55.170638 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:26:55.220131 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:26:55.259459 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:26:55.303829 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:26:55.369564 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_dbt_test__audit"
[0m22:26:55.386124 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_dbt_test__audit"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'

[0m22:26:55.328720 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:26:55.346913 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:26:55.423751 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m22:26:55.437449 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_marts"
[0m22:26:55.453056 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_staging"
[0m22:26:55.470488 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: ROLLBACK
[0m22:26:55.510450 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_marts"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'

[0m22:26:55.568748 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_staging"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'

[0m22:26:55.606350 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: Close
[0m22:26:55.660981 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m22:26:55.694050 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m22:26:55.740874 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: ROLLBACK
[0m22:26:55.752460 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: ROLLBACK
[0m22:26:55.758359 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: Close
[0m22:26:55.768158 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: Close
[0m22:26:55.802384 [debug] [MainThread]: Using postgres connection "master"
[0m22:26:55.807512 [debug] [MainThread]: On master: BEGIN
[0m22:26:55.815008 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:26:55.827438 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:26:55.839087 [debug] [MainThread]: Using postgres connection "master"
[0m22:26:55.845207 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:26:55.864769 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m22:26:55.874621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24e2caa1-3080-4d10-a79a-a6dffb067e0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bf7837b10>]}
[0m22:26:55.884882 [debug] [MainThread]: On master: ROLLBACK
[0m22:26:55.890690 [debug] [MainThread]: Using postgres connection "master"
[0m22:26:55.899054 [debug] [MainThread]: On master: BEGIN
[0m22:26:55.906551 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:26:55.912097 [debug] [MainThread]: On master: COMMIT
[0m22:26:55.922926 [debug] [MainThread]: Using postgres connection "master"
[0m22:26:55.928142 [debug] [MainThread]: On master: COMMIT
[0m22:26:55.938247 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:26:55.943829 [debug] [MainThread]: On master: Close
[0m22:26:55.955202 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:26:55.975939 [info ] [MainThread]:
[0m22:26:56.044155 [debug] [Thread-1 (]: Began running node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30
[0m22:26:56.045253 [debug] [Thread-2 (]: Began running node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7
[0m22:26:56.046355 [debug] [Thread-3 (]: Began running node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300
[0m22:26:56.048082 [debug] [Thread-4 (]: Began running node test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at__extracted_at_CURRENT_TIMESTAMP.175723c5d5
[0m22:26:56.245865 [info ] [Thread-1 (]: 1 of 14 START test dbt_utils_accepted_range_stg_crypto_prices_market_cap__0 .... [RUN]
[0m22:26:56.279394 [info ] [Thread-2 (]: 2 of 14 START test dbt_utils_accepted_range_stg_crypto_prices_price_usd__0 ..... [RUN]
[0m22:26:56.289094 [info ] [Thread-3 (]: 3 of 14 START test dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0 .... [RUN]
[0m22:26:56.299586 [info ] [Thread-4 (]: 4 of 14 START test dbt_utils_expression_is_true_stg_crypto_prices_extracted_at__extracted_at_CURRENT_TIMESTAMP  [RUN]
[0m22:26:56.309487 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_staging, now test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30)
[0m22:26:56.318325 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_marts, now test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7)
[0m22:26:56.326813 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_dbt_test__audit, now test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300)
[0m22:26:56.337341 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at__extracted_at_CURRENT_TIMESTAMP.175723c5d5'
[0m22:26:56.348799 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30
[0m22:26:56.356770 [debug] [Thread-2 (]: Began compiling node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7
[0m22:26:56.364661 [debug] [Thread-3 (]: Began compiling node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300
[0m22:26:56.373232 [debug] [Thread-4 (]: Began compiling node test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at__extracted_at_CURRENT_TIMESTAMP.175723c5d5
[0m22:26:56.461440 [debug] [Thread-1 (]: Timing info for test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30 (compile): 22:26:56.379721 => 22:26:56.460880
[0m22:26:56.465246 [debug] [Thread-2 (]: Timing info for test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7 (compile): 22:26:56.404089 => 22:26:56.462375
[0m22:26:56.466833 [debug] [Thread-3 (]: Timing info for test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300 (compile): 22:26:56.432915 => 22:26:56.466197
[0m22:26:56.468642 [debug] [Thread-4 (]: Timing info for test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at__extracted_at_CURRENT_TIMESTAMP.175723c5d5 (compile): 22:26:56.445503 => 22:26:56.467872
[0m22:26:56.520025 [debug] [Thread-4 (]: Compilation Error in test dbt_utils_expression_is_true_stg_crypto_prices_extracted_at__extracted_at_CURRENT_TIMESTAMP (models/staging/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:26:56.523130 [debug] [Thread-2 (]: Compilation Error in test dbt_utils_accepted_range_stg_crypto_prices_price_usd__0 (models/staging/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:26:56.526839 [debug] [Thread-1 (]: Compilation Error in test dbt_utils_accepted_range_stg_crypto_prices_market_cap__0 (models/staging/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:26:56.530080 [debug] [Thread-3 (]: Compilation Error in test dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0 (models/staging/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:26:56.532465 [error] [Thread-4 (]: 4 of 14 ERROR dbt_utils_expression_is_true_stg_crypto_prices_extracted_at__extracted_at_CURRENT_TIMESTAMP  [[31mERROR[0m in 0.20s]
[0m22:26:56.544023 [error] [Thread-2 (]: 2 of 14 ERROR dbt_utils_accepted_range_stg_crypto_prices_price_usd__0 .......... [[31mERROR[0m in 0.23s]
[0m22:26:56.556466 [error] [Thread-1 (]: 1 of 14 ERROR dbt_utils_accepted_range_stg_crypto_prices_market_cap__0 ......... [[31mERROR[0m in 0.25s]
[0m22:26:56.618125 [error] [Thread-3 (]: 3 of 14 ERROR dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0 ......... [[31mERROR[0m in 0.29s]
[0m22:26:56.660932 [debug] [Thread-4 (]: Finished running node test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at__extracted_at_CURRENT_TIMESTAMP.175723c5d5
[0m22:26:56.697209 [debug] [Thread-2 (]: Finished running node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7
[0m22:26:56.746237 [debug] [Thread-1 (]: Finished running node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30
[0m22:26:56.761612 [debug] [Thread-3 (]: Finished running node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300
[0m22:26:56.784463 [debug] [Thread-4 (]: Began running node test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5
[0m22:26:56.802054 [debug] [Thread-2 (]: Began running node test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79
[0m22:26:56.809676 [debug] [Thread-1 (]: Began running node test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f
[0m22:26:56.897913 [debug] [Thread-3 (]: Began running node test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf
[0m22:26:56.921345 [info ] [Thread-4 (]: 5 of 14 START test not_null_stg_crypto_prices_extracted_at ..................... [RUN]
[0m22:26:56.931540 [info ] [Thread-2 (]: 6 of 14 START test not_null_stg_crypto_prices_market_cap ....................... [RUN]
[0m22:26:56.939555 [info ] [Thread-1 (]: 7 of 14 START test not_null_stg_crypto_prices_price_id ......................... [RUN]
[0m22:26:56.949111 [info ] [Thread-3 (]: 8 of 14 START test not_null_stg_crypto_prices_price_usd ........................ [RUN]
[0m22:26:56.958468 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at__extracted_at_CURRENT_TIMESTAMP.175723c5d5, now test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5)
[0m22:26:56.966311 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7, now test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79)
[0m22:26:56.974609 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30, now test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f)
[0m22:26:56.982693 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300, now test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf)
[0m22:26:56.989717 [debug] [Thread-4 (]: Began compiling node test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5
[0m22:26:56.996588 [debug] [Thread-2 (]: Began compiling node test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79
[0m22:26:57.004455 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f
[0m22:26:57.039371 [debug] [Thread-3 (]: Began compiling node test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf
[0m22:26:57.084039 [debug] [Thread-4 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5"
[0m22:26:57.133323 [debug] [Thread-2 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79"
[0m22:26:57.152912 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f"
[0m22:26:57.201619 [debug] [Thread-3 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf"
[0m22:26:57.286627 [debug] [Thread-1 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f (compile): 22:26:57.139955 => 22:26:57.285682
[0m22:26:57.301603 [debug] [Thread-1 (]: Began executing node test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f
[0m22:26:57.305621 [debug] [Thread-3 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf (compile): 22:26:57.176195 => 22:26:57.304698
[0m22:26:57.348329 [debug] [Thread-3 (]: Began executing node test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf
[0m22:26:57.384245 [debug] [Thread-1 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_price_id"
[0m22:26:57.385669 [debug] [Thread-2 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79 (compile): 22:26:57.108530 => 22:26:57.385050
[0m22:26:57.393702 [debug] [Thread-3 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_price_usd"
[0m22:26:57.403246 [debug] [Thread-4 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5 (compile): 22:26:57.053453 => 22:26:57.402488
[0m22:26:57.435654 [debug] [Thread-2 (]: Began executing node test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79
[0m22:26:57.493229 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f"
[0m22:26:57.499058 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf"
[0m22:26:57.508279 [debug] [Thread-4 (]: Began executing node test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5
[0m22:26:57.526969 [debug] [Thread-2 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_market_cap"
[0m22:26:57.540578 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f: BEGIN
[0m22:26:57.552826 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf: BEGIN
[0m22:26:57.566000 [debug] [Thread-4 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_extracted_at"
[0m22:26:57.574866 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79"
[0m22:26:57.584347 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:26:57.592252 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:26:57.602475 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5"
[0m22:26:57.625420 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79: BEGIN
[0m22:26:57.664720 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:26:57.705874 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:26:57.712109 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5: BEGIN
[0m22:26:57.720276 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:26:57.730229 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f"
[0m22:26:57.737901 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf"
[0m22:26:57.746310 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:26:57.761466 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:26:57.770790 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f"} */





  create  table "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_price_id"


    as

  (






select *
from "crypto_warehouse"."public_staging"."stg_crypto_prices"
where price_id is null



  );


[0m22:26:57.783128 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf"} */





  create  table "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_price_usd"


    as

  (






select *
from "crypto_warehouse"."public_staging"."stg_crypto_prices"
where price_usd is null



  );


[0m22:26:57.806520 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m22:26:57.812684 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79"
[0m22:26:57.882281 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5"
[0m22:26:57.890124 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79"} */





  create  table "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_market_cap"


    as

  (






select *
from "crypto_warehouse"."public_staging"."stg_crypto_prices"
where market_cap is null



  );


[0m22:26:57.902780 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5"} */





  create  table "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_extracted_at"


    as

  (






select *
from "crypto_warehouse"."public_staging"."stg_crypto_prices"
where extracted_at is null



  );


[0m22:26:58.137623 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m22:26:58.157856 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f: COMMIT
[0m22:26:58.206665 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f"
[0m22:26:58.225749 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f: COMMIT
[0m22:26:58.281204 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.0 seconds
[0m22:26:58.282179 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.0 seconds
[0m22:26:58.285229 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.0 seconds
[0m22:26:58.291862 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf: COMMIT
[0m22:26:58.303110 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79: COMMIT
[0m22:26:58.316191 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5: COMMIT
[0m22:26:58.325066 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf"
[0m22:26:58.337457 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79"
[0m22:26:58.352638 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5"
[0m22:26:58.366509 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:26:58.371706 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf: COMMIT
[0m22:26:58.386981 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79: COMMIT
[0m22:26:58.404902 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5: COMMIT
[0m22:26:58.424080 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f"
[0m22:26:58.478394 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m22:26:58.495677 [debug] [Thread-3 (]: Writing runtime sql for node "test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf"
[0m22:26:58.516628 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f"
[0m22:26:58.526561 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f: BEGIN
[0m22:26:58.533812 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf"
[0m22:26:58.535082 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m22:26:58.536006 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m22:26:58.537115 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:26:58.543660 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf: BEGIN
[0m22:26:58.553007 [debug] [Thread-2 (]: Writing runtime sql for node "test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79"
[0m22:26:58.559737 [debug] [Thread-4 (]: Writing runtime sql for node "test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5"
[0m22:26:58.567183 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f"
[0m22:26:58.573877 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:26:58.600670 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (

        select *
        from "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_price_id"


    ) dbt_internal_test
[0m22:26:58.611612 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79"
[0m22:26:58.614727 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf"
[0m22:26:58.625247 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:26:58.632947 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79: BEGIN
[0m22:26:58.637011 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5"
[0m22:26:58.663418 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (

        select *
        from "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_price_usd"


    ) dbt_internal_test
[0m22:26:58.683743 [debug] [Thread-1 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f (execute): 22:26:57.317142 => 22:26:58.683061
[0m22:26:58.692552 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:26:58.700857 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5: BEGIN
[0m22:26:58.710358 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:26:58.718803 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f: ROLLBACK
[0m22:26:58.729554 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79"
[0m22:26:58.737246 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m22:26:58.746079 [debug] [Thread-3 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf (execute): 22:26:57.387994 => 22:26:58.745356
[0m22:26:58.754903 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f: Close
[0m22:26:58.761724 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (

        select *
        from "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_market_cap"


    ) dbt_internal_test
[0m22:26:58.769469 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5"
[0m22:26:58.776900 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf: ROLLBACK
[0m22:26:58.786588 [info ] [Thread-1 (]: 7 of 14 PASS not_null_stg_crypto_prices_price_id ............................... [[32mPASS[0m in 1.81s]
[0m22:26:58.801793 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:26:58.812641 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (

        select *
        from "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_extracted_at"


    ) dbt_internal_test
[0m22:26:58.829122 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf: Close
[0m22:26:59.005302 [debug] [Thread-1 (]: Finished running node test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f
[0m22:26:59.065107 [debug] [Thread-2 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79 (execute): 22:26:57.522256 => 22:26:59.064455
[0m22:26:59.080085 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:26:59.087270 [info ] [Thread-3 (]: 8 of 14 PASS not_null_stg_crypto_prices_price_usd .............................. [[32mPASS[0m in 2.10s]
[0m22:26:59.096590 [debug] [Thread-1 (]: Began running node test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a
[0m22:26:59.110516 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79: ROLLBACK
[0m22:26:59.122151 [debug] [Thread-4 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5 (execute): 22:26:57.559764 => 22:26:59.121439
[0m22:26:59.137987 [debug] [Thread-3 (]: Finished running node test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf
[0m22:26:59.150630 [info ] [Thread-1 (]: 9 of 14 START test not_null_stg_crypto_prices_symbol ........................... [RUN]
[0m22:26:59.170184 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79: Close
[0m22:26:59.182904 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5: ROLLBACK
[0m22:26:59.192957 [debug] [Thread-3 (]: Began running node test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438
[0m22:26:59.201669 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f, now test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a)
[0m22:26:59.210905 [info ] [Thread-2 (]: 6 of 14 PASS not_null_stg_crypto_prices_market_cap ............................. [[32mPASS[0m in 2.24s]
[0m22:26:59.218904 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5: Close
[0m22:26:59.230285 [info ] [Thread-3 (]: 10 of 14 START test not_null_stg_crypto_prices_volume_24h ...................... [RUN]
[0m22:26:59.242897 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a
[0m22:26:59.254376 [debug] [Thread-2 (]: Finished running node test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79
[0m22:26:59.264154 [info ] [Thread-4 (]: 5 of 14 PASS not_null_stg_crypto_prices_extracted_at ........................... [[32mPASS[0m in 2.31s]
[0m22:26:59.291743 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf, now test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438)
[0m22:26:59.323051 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a"
[0m22:26:59.330343 [debug] [Thread-2 (]: Began running node test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39
[0m22:26:59.342394 [debug] [Thread-4 (]: Finished running node test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5
[0m22:26:59.350044 [debug] [Thread-3 (]: Began compiling node test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438
[0m22:26:59.367752 [info ] [Thread-2 (]: 11 of 14 START test not_null_stg_pipeline_runs_run_id .......................... [RUN]
[0m22:26:59.381346 [debug] [Thread-4 (]: Began running node test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e
[0m22:26:59.414576 [debug] [Thread-3 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438"
[0m22:26:59.418862 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79, now test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39)
[0m22:26:59.427615 [info ] [Thread-4 (]: 12 of 14 START test not_null_stg_pipeline_runs_stage ........................... [RUN]
[0m22:26:59.518163 [debug] [Thread-2 (]: Began compiling node test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39
[0m22:26:59.585875 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5, now test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e)
[0m22:26:59.903890 [debug] [Thread-2 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39"
[0m22:26:59.905863 [debug] [Thread-3 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438 (compile): 22:26:59.390078 => 22:26:59.905215
[0m22:26:59.920516 [debug] [Thread-1 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a (compile): 22:26:59.302370 => 22:26:59.919683
[0m22:26:59.922246 [debug] [Thread-4 (]: Began compiling node test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e
[0m22:26:59.944853 [debug] [Thread-3 (]: Began executing node test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438
[0m22:26:59.969329 [debug] [Thread-1 (]: Began executing node test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a
[0m22:27:00.000441 [debug] [Thread-4 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e"
[0m22:27:00.060046 [debug] [Thread-3 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_volume_24h"
[0m22:27:00.090959 [debug] [Thread-1 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_symbol"
[0m22:27:00.119136 [debug] [Thread-2 (]: Timing info for test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39 (compile): 22:26:59.621850 => 22:27:00.118104
[0m22:27:00.133336 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438"
[0m22:27:00.149987 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a"
[0m22:27:00.173555 [debug] [Thread-2 (]: Began executing node test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39
[0m22:27:00.196195 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438: BEGIN
[0m22:27:00.246866 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a: BEGIN
[0m22:27:00.323830 [debug] [Thread-2 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_run_id"
[0m22:27:00.372208 [debug] [Thread-4 (]: Timing info for test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e (compile): 22:26:59.980484 => 22:27:00.371154
[0m22:27:00.392963 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:27:00.402680 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:27:00.416985 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39"
[0m22:27:00.426958 [debug] [Thread-4 (]: Began executing node test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e
[0m22:27:00.440931 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:27:00.460495 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:27:00.477827 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39: BEGIN
[0m22:27:00.492042 [debug] [Thread-4 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_stage"
[0m22:27:00.500551 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438"
[0m22:27:00.509667 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a"
[0m22:27:00.519224 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:27:00.531899 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e"
[0m22:27:00.540588 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438"} */





  create  table "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_volume_24h"


    as

  (






select *
from "crypto_warehouse"."public_staging"."stg_crypto_prices"
where volume_24h is null



  );


[0m22:27:00.552213 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a"} */





  create  table "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_symbol"


    as

  (






select *
from "crypto_warehouse"."public_staging"."stg_crypto_prices"
where symbol is null



  );


[0m22:27:00.570349 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:27:00.576372 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e: BEGIN
[0m22:27:00.599955 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39"
[0m22:27:00.608357 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:27:00.618017 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39"} */





  create  table "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_run_id"


    as

  (






select *
from "crypto_warehouse"."public_staging"."stg_pipeline_runs"
where run_id is null



  );


[0m22:27:00.631762 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m22:27:00.642318 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e"
[0m22:27:00.650561 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e"} */





  create  table "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_stage"


    as

  (






select *
from "crypto_warehouse"."public_staging"."stg_pipeline_runs"
where stage is null



  );


[0m22:27:00.824233 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.0 seconds
[0m22:27:00.825208 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m22:27:00.834530 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438: COMMIT
[0m22:27:00.845133 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a: COMMIT
[0m22:27:00.853234 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438"
[0m22:27:00.864831 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a"
[0m22:27:00.872930 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438: COMMIT
[0m22:27:00.881349 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a: COMMIT
[0m22:27:00.966097 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.0 seconds
[0m22:27:00.967257 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.0 seconds
[0m22:27:00.976029 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e: COMMIT
[0m22:27:00.987160 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39: COMMIT
[0m22:27:00.995822 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e"
[0m22:27:01.001844 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m22:27:01.004505 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39"
[0m22:27:01.013133 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e: COMMIT
[0m22:27:01.022786 [debug] [Thread-3 (]: Writing runtime sql for node "test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438"
[0m22:27:01.031731 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39: COMMIT
[0m22:27:01.054794 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:27:01.066512 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a"
[0m22:27:01.090830 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m22:27:01.094262 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438"
[0m22:27:01.101503 [debug] [Thread-4 (]: Writing runtime sql for node "test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e"
[0m22:27:01.108655 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a"
[0m22:27:01.110223 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438: BEGIN
[0m22:27:01.126381 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a: BEGIN
[0m22:27:01.135598 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:27:01.143860 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:27:01.146014 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m22:27:01.151665 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438"
[0m22:27:01.161412 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a"
[0m22:27:01.168507 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e"
[0m22:27:01.171778 [debug] [Thread-2 (]: Writing runtime sql for node "test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39"
[0m22:27:01.180904 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (

        select *
        from "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_volume_24h"


    ) dbt_internal_test
[0m22:27:01.189608 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (

        select *
        from "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_symbol"


    ) dbt_internal_test
[0m22:27:01.198447 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e: BEGIN
[0m22:27:01.218805 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:27:01.227254 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:27:01.234274 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m22:27:01.247418 [debug] [Thread-3 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438 (execute): 22:27:00.053229 => 22:27:01.246710
[0m22:27:01.254959 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39"
[0m22:27:01.259317 [debug] [Thread-1 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a (execute): 22:27:00.078421 => 22:27:01.258599
[0m22:27:01.268895 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e"
[0m22:27:01.278834 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438: ROLLBACK
[0m22:27:01.287376 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39: BEGIN
[0m22:27:01.296911 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a: ROLLBACK
[0m22:27:01.305524 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (

        select *
        from "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_stage"


    ) dbt_internal_test
[0m22:27:01.315182 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438: Close
[0m22:27:01.322689 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:27:01.330381 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a: Close
[0m22:27:01.339829 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:27:01.349475 [info ] [Thread-3 (]: 10 of 14 PASS not_null_stg_crypto_prices_volume_24h ............................ [[32mPASS[0m in 2.06s]
[0m22:27:01.361039 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39"
[0m22:27:01.370463 [info ] [Thread-1 (]: 9 of 14 PASS not_null_stg_crypto_prices_symbol ................................. [[32mPASS[0m in 2.17s]
[0m22:27:01.392335 [debug] [Thread-4 (]: Timing info for test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e (execute): 22:27:00.485978 => 22:27:01.391490
[0m22:27:01.405178 [debug] [Thread-3 (]: Finished running node test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438
[0m22:27:01.429059 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (

        select *
        from "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_run_id"


    ) dbt_internal_test
[0m22:27:01.440539 [debug] [Thread-1 (]: Finished running node test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a
[0m22:27:01.449457 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e: ROLLBACK
[0m22:27:01.467846 [debug] [Thread-3 (]: Began running node test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd
[0m22:27:01.479050 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:27:01.485405 [debug] [Thread-1 (]: Began running node test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43
[0m22:27:01.495515 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e: Close
[0m22:27:01.515592 [info ] [Thread-3 (]: 13 of 14 START test not_null_stg_pipeline_runs_status .......................... [RUN]
[0m22:27:01.528724 [debug] [Thread-2 (]: Timing info for test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39 (execute): 22:27:00.317996 => 22:27:01.528092
[0m22:27:01.537403 [info ] [Thread-1 (]: 14 of 14 START test unique_stg_crypto_prices_price_id .......................... [RUN]
[0m22:27:01.548658 [info ] [Thread-4 (]: 12 of 14 PASS not_null_stg_pipeline_runs_stage ................................. [[32mPASS[0m in 1.96s]
[0m22:27:01.557006 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438, now test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd)
[0m22:27:01.566432 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39: ROLLBACK
[0m22:27:01.575389 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a, now test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43)
[0m22:27:01.584813 [debug] [Thread-4 (]: Finished running node test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e
[0m22:27:01.593708 [debug] [Thread-3 (]: Began compiling node test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd
[0m22:27:01.602272 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39: Close
[0m22:27:01.609492 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43
[0m22:27:01.646108 [debug] [Thread-3 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd"
[0m22:27:01.651405 [info ] [Thread-2 (]: 11 of 14 PASS not_null_stg_pipeline_runs_run_id ................................ [[32mPASS[0m in 2.23s]
[0m22:27:01.695031 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43"
[0m22:27:01.730582 [debug] [Thread-2 (]: Finished running node test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39
[0m22:27:01.935285 [debug] [Thread-3 (]: Timing info for test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd (compile): 22:27:01.625595 => 22:27:01.934437
[0m22:27:02.019979 [debug] [Thread-3 (]: Began executing node test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd
[0m22:27:02.118853 [debug] [Thread-3 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_status"
[0m22:27:02.216579 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd"
[0m22:27:02.225534 [debug] [Thread-1 (]: Timing info for test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43 (compile): 22:27:01.658949 => 22:27:02.224855
[0m22:27:02.274735 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd: BEGIN
[0m22:27:02.295667 [debug] [Thread-1 (]: Began executing node test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43
[0m22:27:02.446910 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:27:02.461495 [debug] [Thread-1 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."unique_stg_crypto_prices_price_id"
[0m22:27:02.475743 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:27:02.483319 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43"
[0m22:27:02.492277 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd"
[0m22:27:02.501016 [debug] [Thread-1 (]: On test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43: BEGIN
[0m22:27:02.510158 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd"} */





  create  table "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_status"


    as

  (






select *
from "crypto_warehouse"."public_staging"."stg_pipeline_runs"
where status is null



  );


[0m22:27:02.518521 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:27:02.542261 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:27:02.550708 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43"
[0m22:27:02.561057 [debug] [Thread-1 (]: On test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43"} */





  create  table "crypto_warehouse"."public_dbt_test__audit"."unique_stg_crypto_prices_price_id"


    as

  (




select
    price_id as unique_field,
    count(*) as n_records

from "crypto_warehouse"."public_staging"."stg_crypto_prices"
where price_id is not null
group by price_id
having count(*) > 1



  );


[0m22:27:02.573436 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m22:27:02.583738 [debug] [Thread-1 (]: On test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43: COMMIT
[0m22:27:02.593852 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43"
[0m22:27:02.603407 [debug] [Thread-1 (]: On test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43: COMMIT
[0m22:27:02.646499 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.0 seconds
[0m22:27:02.661145 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd: COMMIT
[0m22:27:02.675800 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd"
[0m22:27:02.690734 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:27:02.700326 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd: COMMIT
[0m22:27:02.716243 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43"
[0m22:27:02.840700 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m22:27:02.859821 [debug] [Thread-3 (]: Writing runtime sql for node "test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd"
[0m22:27:02.861004 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43"
[0m22:27:02.879785 [debug] [Thread-1 (]: On test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43: BEGIN
[0m22:27:02.896089 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:27:02.909937 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43"
[0m22:27:02.925860 [debug] [Thread-1 (]: On test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (

        select *
        from "crypto_warehouse"."public_dbt_test__audit"."unique_stg_crypto_prices_price_id"


    ) dbt_internal_test
[0m22:27:02.941243 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:27:02.954001 [debug] [Thread-1 (]: Timing info for test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43 (execute): 22:27:02.455403 => 22:27:02.953157
[0m22:27:02.977151 [debug] [Thread-1 (]: On test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43: ROLLBACK
[0m22:27:02.992284 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd"
[0m22:27:02.994949 [debug] [Thread-1 (]: On test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43: Close
[0m22:27:03.002929 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd: BEGIN
[0m22:27:03.013709 [info ] [Thread-1 (]: 14 of 14 PASS unique_stg_crypto_prices_price_id ................................ [[32mPASS[0m in 1.44s]
[0m22:27:03.040869 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:27:03.059049 [debug] [Thread-1 (]: Finished running node test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43
[0m22:27:03.292304 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd"
[0m22:27:03.334489 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (

        select *
        from "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_status"


    ) dbt_internal_test
[0m22:27:03.345319 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:27:03.355529 [debug] [Thread-3 (]: Timing info for test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd (execute): 22:27:02.113342 => 22:27:03.354902
[0m22:27:03.363990 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd: ROLLBACK
[0m22:27:03.387850 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd: Close
[0m22:27:03.397337 [info ] [Thread-3 (]: 13 of 14 PASS not_null_stg_pipeline_runs_status ................................ [[32mPASS[0m in 1.84s]
[0m22:27:03.407853 [debug] [Thread-3 (]: Finished running node test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd
[0m22:27:03.419157 [debug] [MainThread]: Using postgres connection "master"
[0m22:27:03.428835 [debug] [MainThread]: On master: BEGIN
[0m22:27:03.439813 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:27:03.455647 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:27:03.464633 [debug] [MainThread]: On master: COMMIT
[0m22:27:03.473650 [debug] [MainThread]: Using postgres connection "master"
[0m22:27:03.481925 [debug] [MainThread]: On master: COMMIT
[0m22:27:03.490060 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:27:03.498372 [debug] [MainThread]: On master: Close
[0m22:27:03.507804 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:27:03.521721 [debug] [MainThread]: Connection 'test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd' was properly closed.
[0m22:27:03.558280 [debug] [MainThread]: Connection 'test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39' was properly closed.
[0m22:27:03.567089 [debug] [MainThread]: Connection 'test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43' was properly closed.
[0m22:27:03.575592 [debug] [MainThread]: Connection 'test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e' was properly closed.
[0m22:27:03.584112 [info ] [MainThread]:
[0m22:27:03.596403 [info ] [MainThread]: Finished running 14 tests in 0 hours 0 minutes and 9.23 seconds (9.23s).
[0m22:27:03.623217 [debug] [MainThread]: Command end result
[0m22:27:03.803335 [info ] [MainThread]:
[0m22:27:03.813002 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m22:27:03.824252 [info ] [MainThread]:
[0m22:27:03.834725 [error] [MainThread]:   Compilation Error in test dbt_utils_expression_is_true_stg_crypto_prices_extracted_at__extracted_at_CURRENT_TIMESTAMP (models/staging/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:27:03.844110 [info ] [MainThread]:
[0m22:27:03.852258 [error] [MainThread]:   Compilation Error in test dbt_utils_accepted_range_stg_crypto_prices_price_usd__0 (models/staging/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:27:03.862147 [info ] [MainThread]:
[0m22:27:03.870592 [error] [MainThread]:   Compilation Error in test dbt_utils_accepted_range_stg_crypto_prices_market_cap__0 (models/staging/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:27:03.881318 [info ] [MainThread]:
[0m22:27:03.890617 [error] [MainThread]:   Compilation Error in test dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0 (models/staging/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:27:03.900262 [info ] [MainThread]:
[0m22:27:03.910107 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=4 SKIP=0 TOTAL=14
[0m22:27:03.920741 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 14.00561, "process_user_time": 9.251119, "process_kernel_time": 0.631684, "process_mem_max_rss": "122492", "process_in_blocks": "208", "process_out_blocks": "1976", "command_success": false}
[0m22:27:03.929206 [debug] [MainThread]: Command `dbt test` failed at 22:27:03.928848 after 14.01 seconds
[0m22:27:03.940460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bf699ff90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bf8f3f450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bfa35c250>]}
[0m22:27:03.951896 [debug] [MainThread]: Flushing usage events
[0m22:28:12.640992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca94f39710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca94f63fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca97dd8550>]}


============================== 22:28:12.658752 | 3edcdcf3-2c5c-4a06-8f94-2b07910dd457 ==============================
[0m22:28:12.658752 [info ] [MainThread]: Running with dbt=1.7.0
[0m22:28:12.677105 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/app/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --project-dir /app/dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:28:13.195034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3edcdcf3-2c5c-4a06-8f94-2b07910dd457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca94fe9550>]}
[0m22:28:13.226346 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-wpulxoms'
[0m22:28:13.245594 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:28:13.918636 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:28:13.927290 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:28:14.191052 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:28:14.254401 [info ] [MainThread]: Updating lock file in file path: /app/dbt/package-lock.yml
[0m22:28:14.723221 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-_pg049c3'
[0m22:28:14.739898 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:28:45.131445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea10458f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea10459010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea1045a9d0>]}


============================== 22:28:45.150512 | 01c8b156-9c87-4182-bf9d-1738cf1f47c1 ==============================
[0m22:28:45.150512 [info ] [MainThread]: Running with dbt=1.7.0
[0m22:28:45.168096 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/app/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug --project-dir /app/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:28:45.199759 [info ] [MainThread]: dbt version: 1.7.0
[0m22:28:45.215657 [info ] [MainThread]: python version: 3.11.13
[0m22:28:45.231019 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m22:28:45.263769 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m22:28:46.151971 [info ] [MainThread]: Using profiles dir at /app
[0m22:28:46.163677 [info ] [MainThread]: Using profiles.yml file at /app/profiles.yml
[0m22:28:46.174682 [info ] [MainThread]: Using dbt_project.yml file at /app/dbt/dbt_project.yml
[0m22:28:46.181778 [info ] [MainThread]: adapter type: postgres
[0m22:28:46.193322 [info ] [MainThread]: adapter version: 1.7.0
[0m22:28:46.615825 [info ] [MainThread]: Configuration:
[0m22:28:46.628937 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:28:46.645813 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:28:46.658331 [info ] [MainThread]: Required dependencies:
[0m22:28:46.669615 [debug] [MainThread]: Executing "git --help"
[0m22:28:46.719118 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:28:46.741158 [debug] [MainThread]: STDERR: "b''"
[0m22:28:46.749937 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:28:46.765771 [info ] [MainThread]: Connection:
[0m22:28:46.790710 [info ] [MainThread]:   host: postgres
[0m22:28:46.799314 [info ] [MainThread]:   port: 5432
[0m22:28:46.810366 [info ] [MainThread]:   user: postgres
[0m22:28:46.823053 [info ] [MainThread]:   database: crypto_warehouse
[0m22:28:46.834777 [info ] [MainThread]:   schema: public
[0m22:28:46.856831 [info ] [MainThread]:   connect_timeout: 10
[0m22:28:46.876322 [info ] [MainThread]:   role: None
[0m22:28:46.885074 [info ] [MainThread]:   search_path: None
[0m22:28:46.899060 [info ] [MainThread]:   keepalives_idle: 0
[0m22:28:46.909782 [info ] [MainThread]:   sslmode: None
[0m22:28:46.919237 [info ] [MainThread]:   sslcert: None
[0m22:28:46.932069 [info ] [MainThread]:   sslkey: None
[0m22:28:46.946054 [info ] [MainThread]:   sslrootcert: None
[0m22:28:46.961440 [info ] [MainThread]:   application_name: dbt
[0m22:28:46.971498 [info ] [MainThread]:   retries: 1
[0m22:28:46.981016 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m22:28:46.993178 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m22:28:47.007065 [debug] [MainThread]: Using postgres connection "debug"
[0m22:28:47.015163 [debug] [MainThread]: On debug: select 1 as id
[0m22:28:47.025986 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:28:47.051933 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m22:28:47.085115 [debug] [MainThread]: On debug: Close
[0m22:28:47.107940 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m22:28:47.125296 [info ] [MainThread]: [32mAll checks passed![0m
[0m22:28:47.141364 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.2258725, "process_user_time": 8.615476, "process_kernel_time": 0.492026, "process_mem_max_rss": "111028", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:28:47.158147 [debug] [MainThread]: Command `dbt debug` succeeded at 22:28:47.157787 after 2.24 seconds
[0m22:28:47.166317 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m22:28:47.180501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea107fc550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea10919ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea0eba0610>]}
[0m22:28:47.194121 [debug] [MainThread]: Flushing usage events
[0m22:29:25.798407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26c11eaad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26c121d850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26c1695b10>]}


============================== 22:29:25.812530 | 8bb72456-1335-4345-99e2-3b54a4a0e812 ==============================
[0m22:29:25.812530 [info ] [MainThread]: Running with dbt=1.7.0
[0m22:29:25.825707 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'debug': 'False', 'warn_error': 'None', 'log_path': '/app/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug --project-dir /app/dbt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:29:25.846163 [info ] [MainThread]: dbt version: 1.7.0
[0m22:29:25.857260 [info ] [MainThread]: python version: 3.11.13
[0m22:29:25.865017 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m22:29:25.877743 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m22:29:26.276093 [info ] [MainThread]: Using profiles dir at /app
[0m22:29:26.292318 [info ] [MainThread]: Using profiles.yml file at /app/profiles.yml
[0m22:29:26.307047 [info ] [MainThread]: Using dbt_project.yml file at /app/dbt/dbt_project.yml
[0m22:29:26.329725 [info ] [MainThread]: adapter type: postgres
[0m22:29:26.358848 [info ] [MainThread]: adapter version: 1.7.0
[0m22:29:26.810380 [info ] [MainThread]: Configuration:
[0m22:29:26.825798 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:29:26.861359 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:29:26.891148 [info ] [MainThread]: Required dependencies:
[0m22:29:26.910663 [debug] [MainThread]: Executing "git --help"
[0m22:29:26.932111 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:29:26.956849 [debug] [MainThread]: STDERR: "b''"
[0m22:29:26.977010 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:29:27.011130 [info ] [MainThread]: Connection:
[0m22:29:27.097773 [info ] [MainThread]:   host: postgres
[0m22:29:27.131339 [info ] [MainThread]:   port: 5432
[0m22:29:27.160813 [info ] [MainThread]:   user: postgres
[0m22:29:27.225230 [info ] [MainThread]:   database: crypto_warehouse
[0m22:29:27.278286 [info ] [MainThread]:   schema: public
[0m22:29:27.297035 [info ] [MainThread]:   connect_timeout: 10
[0m22:29:27.358654 [info ] [MainThread]:   role: None
[0m22:29:27.387731 [info ] [MainThread]:   search_path: None
[0m22:29:27.406290 [info ] [MainThread]:   keepalives_idle: 0
[0m22:29:27.424594 [info ] [MainThread]:   sslmode: None
[0m22:29:27.441501 [info ] [MainThread]:   sslcert: None
[0m22:29:27.455979 [info ] [MainThread]:   sslkey: None
[0m22:29:27.507227 [info ] [MainThread]:   sslrootcert: None
[0m22:29:27.546205 [info ] [MainThread]:   application_name: dbt
[0m22:29:27.647515 [info ] [MainThread]:   retries: 1
[0m22:29:27.675790 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m22:29:27.692206 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m22:29:27.729846 [debug] [MainThread]: Using postgres connection "debug"
[0m22:29:27.747445 [debug] [MainThread]: On debug: select 1 as id
[0m22:29:27.764110 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:29:27.798454 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m22:29:27.815844 [debug] [MainThread]: On debug: Close
[0m22:29:28.566609 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m22:29:28.652877 [info ] [MainThread]: [32mAll checks passed![0m
[0m22:29:28.808595 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 3.21095, "process_user_time": 8.847894, "process_kernel_time": 0.571802, "process_mem_max_rss": "111084", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:29:28.943521 [debug] [MainThread]: Command `dbt debug` succeeded at 22:29:28.943146 after 3.35 seconds
[0m22:29:29.006385 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m22:29:29.029466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26c2068710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26bf950210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26c1211dd0>]}
[0m22:29:29.104980 [debug] [MainThread]: Flushing usage events
[0m22:29:40.095844 [info ] [MainThread]: Installed from version 1.1.1
[0m22:29:40.111147 [info ] [MainThread]: Updated version available: 1.3.0
[0m22:29:40.132623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3edcdcf3-2c5c-4a06-8f94-2b07910dd457', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca94e13a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca94f900d0>]}
[0m22:29:40.157081 [info ] [MainThread]:
[0m22:29:40.165673 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']
Update your versions in packages.yml, then run dbt deps
[0m22:29:40.213058 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 87.73252, "process_user_time": 6.724018, "process_kernel_time": 0.946194, "process_mem_max_rss": "106824", "process_out_blocks": "2080", "process_in_blocks": "0"}
[0m22:29:40.231998 [debug] [MainThread]: Command `dbt deps` succeeded at 22:29:40.231607 after 87.75 seconds
[0m22:29:40.249540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca965c6ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca99938990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca99939550>]}
[0m22:29:40.276361 [debug] [MainThread]: Flushing usage events
[0m22:30:38.098453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff65af62d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff65af7a4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff65af63dd0>]}


============================== 22:30:38.170463 | b3fa3343-fc6c-4073-9be0-7cd478b71d85 ==============================
[0m22:30:38.170463 [info ] [MainThread]: Running with dbt=1.7.0
[0m22:30:38.451454 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'debug': 'False', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --project-dir /app/dbt', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:30:41.212434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b3fa3343-fc6c-4073-9be0-7cd478b71d85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6596f41d0>]}
[0m22:30:42.016177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b3fa3343-fc6c-4073-9be0-7cd478b71d85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff65ae4a990>]}
[0m22:30:42.595573 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m22:30:44.953358 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m22:30:45.577981 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m22:30:45.691700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b3fa3343-fc6c-4073-9be0-7cd478b71d85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff659504790>]}
[0m22:31:12.127017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4532739010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f453272e2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45327393d0>]}


============================== 22:31:12.140361 | 7c9f39b2-a8af-4a03-acac-543b2b1f21b8 ==============================
[0m22:31:12.140361 [info ] [MainThread]: Running with dbt=1.7.0
[0m22:31:12.150767 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/app/dbt/logs', 'profiles_dir': '/app', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug --project-dir /app/dbt', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:31:12.166069 [info ] [MainThread]: dbt version: 1.7.0
[0m22:31:12.173506 [info ] [MainThread]: python version: 3.11.13
[0m22:31:12.184653 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m22:31:12.190657 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m22:31:12.537674 [info ] [MainThread]: Using profiles dir at /app
[0m22:31:12.553111 [info ] [MainThread]: Using profiles.yml file at /app/profiles.yml
[0m22:31:12.566687 [info ] [MainThread]: Using dbt_project.yml file at /app/dbt/dbt_project.yml
[0m22:31:12.575306 [info ] [MainThread]: adapter type: postgres
[0m22:31:12.588454 [info ] [MainThread]: adapter version: 1.7.0
[0m22:31:13.168581 [info ] [MainThread]: Configuration:
[0m22:31:13.194772 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:31:13.215675 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:31:13.224132 [info ] [MainThread]: Required dependencies:
[0m22:31:13.241299 [debug] [MainThread]: Executing "git --help"
[0m22:31:13.307005 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:31:13.336781 [debug] [MainThread]: STDERR: "b''"
[0m22:31:13.354331 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:31:13.369234 [info ] [MainThread]: Connection:
[0m22:31:13.400241 [info ] [MainThread]:   host: postgres
[0m22:31:13.410687 [info ] [MainThread]:   port: 5432
[0m22:31:13.424054 [info ] [MainThread]:   user: postgres
[0m22:31:13.439002 [info ] [MainThread]:   database: crypto_warehouse
[0m22:31:13.464666 [info ] [MainThread]:   schema: public
[0m22:31:13.480790 [info ] [MainThread]:   connect_timeout: 10
[0m22:31:13.499119 [info ] [MainThread]:   role: None
[0m22:31:13.512748 [info ] [MainThread]:   search_path: None
[0m22:31:13.529175 [info ] [MainThread]:   keepalives_idle: 0
[0m22:31:13.553775 [info ] [MainThread]:   sslmode: None
[0m22:31:13.574185 [info ] [MainThread]:   sslcert: None
[0m22:31:13.589412 [info ] [MainThread]:   sslkey: None
[0m22:31:13.617205 [info ] [MainThread]:   sslrootcert: None
[0m22:31:13.648512 [info ] [MainThread]:   application_name: dbt
[0m22:31:13.657634 [info ] [MainThread]:   retries: 1
[0m22:31:13.691513 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m22:31:13.719385 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m22:31:13.736581 [debug] [MainThread]: Using postgres connection "debug"
[0m22:31:13.748372 [debug] [MainThread]: On debug: select 1 as id
[0m22:31:13.764830 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:31:13.803649 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m22:31:13.824106 [debug] [MainThread]: On debug: Close
[0m22:31:13.847063 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m22:31:13.869786 [info ] [MainThread]: [32mAll checks passed![0m
[0m22:31:13.887284 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.9148519, "process_user_time": 13.364232, "process_kernel_time": 0.699644, "process_mem_max_rss": "111160", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:31:13.930890 [debug] [MainThread]: Command `dbt debug` succeeded at 22:31:13.930503 after 1.96 seconds
[0m22:31:13.946659 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m22:31:13.967540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45327a9b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f453272ff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4532be5d50>]}
[0m22:31:14.033348 [debug] [MainThread]: Flushing usage events
[0m22:31:18.362658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b3fa3343-fc6c-4073-9be0-7cd478b71d85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6589f3d10>]}
[0m22:31:18.798297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b3fa3343-fc6c-4073-9be0-7cd478b71d85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6589d0850>]}
[0m22:31:18.813322 [info ] [MainThread]: Found 7 models, 14 tests, 2 sources, 0 exposures, 0 metrics, 517 macros, 0 groups, 0 semantic models
[0m22:31:18.841247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3fa3343-fc6c-4073-9be0-7cd478b71d85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6596a4b10>]}
[0m22:31:18.910807 [info ] [MainThread]:
[0m22:31:20.431143 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:31:20.540567 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse'
[0m22:31:20.765614 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse"
[0m22:31:20.825296 [debug] [ThreadPool]: On list_crypto_warehouse: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse"} */

    select distinct nspname from pg_namespace

[0m22:31:20.927409 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:31:20.993325 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m22:31:21.133212 [debug] [ThreadPool]: On list_crypto_warehouse: Close
[0m22:31:21.212955 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_warehouse, now list_crypto_warehouse_public_dbt_test__audit)
[0m22:31:21.214885 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse_public_marts'
[0m22:31:21.218406 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse_public_staging'
[0m22:31:21.330330 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_dbt_test__audit"
[0m22:31:21.513008 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_marts"
[0m22:31:21.698629 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_staging"
[0m22:31:21.989528 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: BEGIN
[0m22:31:22.074157 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: BEGIN
[0m22:31:22.107016 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: BEGIN
[0m22:31:22.123313 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:31:22.140827 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:31:22.160365 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:31:22.181153 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:31:22.197966 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:31:22.213750 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:31:22.224677 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_dbt_test__audit"
[0m22:31:22.238867 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_marts"
[0m22:31:22.291007 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_staging"
[0m22:31:22.306424 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_dbt_test__audit"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'

[0m22:31:22.321726 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_marts"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'

[0m22:31:22.337557 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_staging"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'

[0m22:31:22.364719 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m22:31:22.379881 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m22:31:22.395034 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m22:31:22.403037 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: ROLLBACK
[0m22:31:22.418162 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: ROLLBACK
[0m22:31:22.433872 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: ROLLBACK
[0m22:31:22.453721 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: Close
[0m22:31:22.497712 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: Close
[0m22:31:22.545741 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: Close
[0m22:31:22.652041 [debug] [MainThread]: Using postgres connection "master"
[0m22:31:22.663564 [debug] [MainThread]: On master: BEGIN
[0m22:31:22.678322 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:31:22.696891 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:31:22.711177 [debug] [MainThread]: Using postgres connection "master"
[0m22:31:22.730531 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:31:22.779217 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m22:31:22.804081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3fa3343-fc6c-4073-9be0-7cd478b71d85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6589382d0>]}
[0m22:31:22.821454 [debug] [MainThread]: On master: ROLLBACK
[0m22:31:22.841543 [debug] [MainThread]: Using postgres connection "master"
[0m22:31:22.855326 [debug] [MainThread]: On master: BEGIN
[0m22:31:22.889446 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:31:22.904902 [debug] [MainThread]: On master: COMMIT
[0m22:31:22.921133 [debug] [MainThread]: Using postgres connection "master"
[0m22:31:22.930514 [debug] [MainThread]: On master: COMMIT
[0m22:31:22.956634 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:31:22.997283 [debug] [MainThread]: On master: Close
[0m22:31:23.030611 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:31:23.225261 [info ] [MainThread]:
[0m22:31:23.536199 [debug] [Thread-1 (]: Began running node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30
[0m22:31:23.538216 [debug] [Thread-2 (]: Began running node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7
[0m22:31:23.539394 [debug] [Thread-3 (]: Began running node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300
[0m22:31:23.544186 [debug] [Thread-4 (]: Began running node test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at__extracted_at_CURRENT_TIMESTAMP.175723c5d5
[0m22:31:23.703814 [info ] [Thread-1 (]: 1 of 14 START test dbt_utils_accepted_range_stg_crypto_prices_market_cap__0 .... [RUN]
[0m22:31:23.728166 [info ] [Thread-2 (]: 2 of 14 START test dbt_utils_accepted_range_stg_crypto_prices_price_usd__0 ..... [RUN]
[0m22:31:23.755322 [info ] [Thread-3 (]: 3 of 14 START test dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0 .... [RUN]
[0m22:31:23.792753 [info ] [Thread-4 (]: 4 of 14 START test dbt_utils_expression_is_true_stg_crypto_prices_extracted_at__extracted_at_CURRENT_TIMESTAMP  [RUN]
[0m22:31:23.819916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_staging, now test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30)
[0m22:31:23.842169 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_marts, now test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7)
[0m22:31:23.858263 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_dbt_test__audit, now test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300)
[0m22:31:23.925165 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at__extracted_at_CURRENT_TIMESTAMP.175723c5d5'
[0m22:31:23.957985 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30
[0m22:31:24.294320 [debug] [Thread-2 (]: Began compiling node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7
[0m22:31:24.356478 [debug] [Thread-3 (]: Began compiling node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300
[0m22:31:24.378611 [debug] [Thread-4 (]: Began compiling node test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at__extracted_at_CURRENT_TIMESTAMP.175723c5d5
[0m22:31:24.483347 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30"
[0m22:31:24.559861 [debug] [Thread-2 (]: Writing injected SQL for node "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7"
[0m22:31:24.588813 [debug] [Thread-3 (]: Writing injected SQL for node "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300"
[0m22:31:24.622665 [debug] [Thread-4 (]: Writing injected SQL for node "test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at__extracted_at_CURRENT_TIMESTAMP.175723c5d5"
[0m22:31:24.806148 [debug] [Thread-2 (]: Timing info for test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7 (compile): 22:31:24.502384 => 22:31:24.805296
[0m22:31:24.852615 [debug] [Thread-2 (]: Began executing node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7
[0m22:31:24.886500 [debug] [Thread-3 (]: Timing info for test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300 (compile): 22:31:24.560475 => 22:31:24.885730
[0m22:31:25.039131 [debug] [Thread-2 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_price_usd__0"
[0m22:31:25.056371 [debug] [Thread-3 (]: Began executing node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300
[0m22:31:25.089789 [debug] [Thread-4 (]: Timing info for test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at__extracted_at_CURRENT_TIMESTAMP.175723c5d5 (compile): 22:31:24.592875 => 22:31:25.088636
[0m22:31:25.159201 [debug] [Thread-3 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0"
[0m22:31:25.182622 [debug] [Thread-1 (]: Timing info for test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30 (compile): 22:31:24.433388 => 22:31:25.180965
[0m22:31:25.229488 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7"
[0m22:31:25.244586 [debug] [Thread-4 (]: Began executing node test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at__extracted_at_CURRENT_TIMESTAMP.175723c5d5
[0m22:31:25.291559 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300"
[0m22:31:25.322340 [debug] [Thread-1 (]: Began executing node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30
[0m22:31:25.341455 [debug] [Thread-2 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7: BEGIN
[0m22:31:25.368415 [debug] [Thread-4 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_expression_is_true_s_dbcac56e78276f6c06717b2204c44676"
[0m22:31:25.374589 [debug] [Thread-3 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300: BEGIN
[0m22:31:25.406208 [debug] [Thread-1 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_market_cap__0"
[0m22:31:25.419440 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:31:25.434195 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at__extracted_at_CURRENT_TIMESTAMP.175723c5d5"
[0m22:31:25.450995 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:31:25.462139 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30"
[0m22:31:25.496243 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:31:25.506653 [debug] [Thread-4 (]: On test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at__extracted_at_CURRENT_TIMESTAMP.175723c5d5: BEGIN
[0m22:31:25.524621 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:31:25.534481 [debug] [Thread-1 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30: BEGIN
[0m22:31:25.542553 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7"
[0m22:31:25.552319 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:31:25.562818 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300"
[0m22:31:25.571937 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:31:25.583205 [debug] [Thread-2 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7"} */





  create  table "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_price_usd__0"


    as

  (


with meet_condition as(
  select *
  from "crypto_warehouse"."public_staging"."stg_crypto_prices"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not price_usd >= 0
)

select *
from validation_errors


  );


[0m22:31:25.598339 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m22:31:25.604084 [debug] [Thread-3 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300"} */





  create  table "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0"


    as

  (


with meet_condition as(
  select *
  from "crypto_warehouse"."public_staging"."stg_crypto_prices"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not volume_24h >= 0
)

select *
from validation_errors


  );


[0m22:31:25.618925 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:31:25.631976 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at__extracted_at_CURRENT_TIMESTAMP.175723c5d5"
[0m22:31:25.649532 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30"
[0m22:31:25.660809 [debug] [Thread-4 (]: On test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at__extracted_at_CURRENT_TIMESTAMP.175723c5d5: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at__extracted_at_CURRENT_TIMESTAMP.175723c5d5"} */





  create  table "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_expression_is_true_s_dbcac56e78276f6c06717b2204c44676"


    as

  (




select
    *
from "crypto_warehouse"."public_staging"."stg_crypto_prices"

where not(extracted_at extracted_at <= CURRENT_TIMESTAMP)


  );


[0m22:31:25.674381 [debug] [Thread-1 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30"} */





  create  table "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_market_cap__0"


    as

  (


with meet_condition as(
  select *
  from "crypto_warehouse"."public_staging"."stg_crypto_prices"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not market_cap >= 0
)

select *
from validation_errors


  );


[0m22:31:25.684409 [debug] [Thread-4 (]: Postgres adapter: Postgres error: syntax error at or near "extracted_at"
LINE 21: where not(extracted_at extracted_at <= CURRENT_TIMESTAMP)
                                ^

[0m22:31:25.699178 [debug] [Thread-4 (]: On test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at__extracted_at_CURRENT_TIMESTAMP.175723c5d5: ROLLBACK
[0m22:31:25.707825 [debug] [Thread-4 (]: Timing info for test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at__extracted_at_CURRENT_TIMESTAMP.175723c5d5 (execute): 22:31:25.358848 => 22:31:25.707024
[0m22:31:25.718495 [debug] [Thread-4 (]: On test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at__extracted_at_CURRENT_TIMESTAMP.175723c5d5: Close
[0m22:31:25.768091 [debug] [Thread-4 (]: Database Error in test dbt_utils_expression_is_true_stg_crypto_prices_extracted_at__extracted_at_CURRENT_TIMESTAMP (models/staging/schema.yml)
  syntax error at or near "extracted_at"
  LINE 21: where not(extracted_at extracted_at <= CURRENT_TIMESTAMP)
                                  ^
[0m22:31:25.777288 [error] [Thread-4 (]: 4 of 14 ERROR dbt_utils_expression_is_true_stg_crypto_prices_extracted_at__extracted_at_CURRENT_TIMESTAMP  [[31mERROR[0m in 1.85s]
[0m22:31:25.863599 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.0 seconds
[0m22:31:25.867353 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.0 seconds
[0m22:31:25.898180 [debug] [Thread-4 (]: Finished running node test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at__extracted_at_CURRENT_TIMESTAMP.175723c5d5
[0m22:31:25.936062 [debug] [Thread-3 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300: COMMIT
[0m22:31:25.970034 [debug] [Thread-2 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7: COMMIT
[0m22:31:25.986818 [debug] [Thread-4 (]: Began running node test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5
[0m22:31:25.998981 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m22:31:26.020736 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300"
[0m22:31:26.034856 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7"
[0m22:31:26.052658 [info ] [Thread-4 (]: 5 of 14 START test not_null_stg_crypto_prices_extracted_at ..................... [RUN]
[0m22:31:26.073878 [debug] [Thread-1 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30: COMMIT
[0m22:31:26.100056 [debug] [Thread-3 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300: COMMIT
[0m22:31:26.107862 [debug] [Thread-2 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7: COMMIT
[0m22:31:26.117985 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at__extracted_at_CURRENT_TIMESTAMP.175723c5d5, now test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5)
[0m22:31:26.126622 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30"
[0m22:31:26.153145 [debug] [Thread-4 (]: Began compiling node test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5
[0m22:31:26.162830 [debug] [Thread-1 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30: COMMIT
[0m22:31:26.191809 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m22:31:26.224188 [debug] [Thread-4 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5"
[0m22:31:26.256102 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m22:31:26.287411 [debug] [Thread-3 (]: Writing runtime sql for node "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300"
[0m22:31:26.308882 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:31:26.361149 [debug] [Thread-2 (]: Writing runtime sql for node "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7"
[0m22:31:26.398883 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30"
[0m22:31:26.524942 [debug] [Thread-4 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5 (compile): 22:31:26.171026 => 22:31:26.524019
[0m22:31:26.533617 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7"
[0m22:31:26.537557 [debug] [Thread-4 (]: Began executing node test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5
[0m22:31:26.542948 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300"
[0m22:31:26.554373 [debug] [Thread-2 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7: BEGIN
[0m22:31:26.565533 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30"
[0m22:31:26.610984 [debug] [Thread-4 (]: Applying DROP to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_extracted_at"
[0m22:31:26.612131 [debug] [Thread-3 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300: BEGIN
[0m22:31:26.621289 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:31:26.628189 [debug] [Thread-1 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30: BEGIN
[0m22:31:26.660609 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5"
[0m22:31:26.669934 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7"
[0m22:31:26.678999 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:31:26.680609 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:31:26.687696 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5"} */
drop table if exists "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_extracted_at" cascade
[0m22:31:26.697430 [debug] [Thread-2 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (

        select *
        from "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_price_usd__0"


    ) dbt_internal_test
[0m22:31:26.706528 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300"
[0m22:31:26.715575 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30"
[0m22:31:26.724947 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:31:26.737736 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:31:26.747486 [debug] [Thread-3 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (

        select *
        from "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0"


    ) dbt_internal_test
[0m22:31:26.757584 [debug] [Thread-1 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (

        select *
        from "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_market_cap__0"


    ) dbt_internal_test
[0m22:31:26.780605 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:31:26.790761 [debug] [Thread-2 (]: Timing info for test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7 (execute): 22:31:24.920567 => 22:31:26.789974
[0m22:31:26.809059 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:31:26.821930 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:31:26.834366 [debug] [Thread-4 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_extracted_at"
[0m22:31:26.848048 [debug] [Thread-2 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7: ROLLBACK
[0m22:31:26.877437 [debug] [Thread-3 (]: Timing info for test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300 (execute): 22:31:25.144653 => 22:31:26.876116
[0m22:31:26.894804 [debug] [Thread-1 (]: Timing info for test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30 (execute): 22:31:25.399539 => 22:31:26.893319
[0m22:31:26.915998 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5"
[0m22:31:26.924105 [debug] [Thread-2 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7: Close
[0m22:31:26.935532 [debug] [Thread-3 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300: ROLLBACK
[0m22:31:26.947626 [debug] [Thread-1 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30: ROLLBACK
[0m22:31:26.955850 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5: BEGIN
[0m22:31:26.969664 [info ] [Thread-2 (]: 2 of 14 PASS dbt_utils_accepted_range_stg_crypto_prices_price_usd__0 ........... [[32mPASS[0m in 3.13s]
[0m22:31:26.981414 [debug] [Thread-3 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300: Close
[0m22:31:26.989364 [debug] [Thread-1 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30: Close
[0m22:31:27.003362 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m22:31:27.015865 [debug] [Thread-2 (]: Finished running node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7
[0m22:31:27.025973 [info ] [Thread-3 (]: 3 of 14 PASS dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0 .......... [[32mPASS[0m in 3.17s]
[0m22:31:27.048467 [info ] [Thread-1 (]: 1 of 14 PASS dbt_utils_accepted_range_stg_crypto_prices_market_cap__0 .......... [[32mPASS[0m in 3.23s]
[0m22:31:27.071339 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5"
[0m22:31:27.089198 [debug] [Thread-2 (]: Began running node test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79
[0m22:31:27.099995 [debug] [Thread-3 (]: Finished running node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300
[0m22:31:27.109220 [debug] [Thread-1 (]: Finished running node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30
[0m22:31:27.121212 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5"} */





  create  table "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_extracted_at"


    as

  (






select *
from "crypto_warehouse"."public_staging"."stg_crypto_prices"
where extracted_at is null



  );


[0m22:31:27.130590 [info ] [Thread-2 (]: 6 of 14 START test not_null_stg_crypto_prices_market_cap ....................... [RUN]
[0m22:31:27.140329 [debug] [Thread-3 (]: Began running node test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f
[0m22:31:27.150099 [debug] [Thread-1 (]: Began running node test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf
[0m22:31:27.186284 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7, now test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79)
[0m22:31:27.198136 [info ] [Thread-3 (]: 7 of 14 START test not_null_stg_crypto_prices_price_id ......................... [RUN]
[0m22:31:27.208214 [info ] [Thread-1 (]: 8 of 14 START test not_null_stg_crypto_prices_price_usd ........................ [RUN]
[0m22:31:27.222430 [debug] [Thread-2 (]: Began compiling node test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79
[0m22:31:27.272728 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300, now test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f)
[0m22:31:27.287476 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30, now test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf)
[0m22:31:27.309960 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.0 seconds
[0m22:31:27.584776 [debug] [Thread-2 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79"
[0m22:31:27.595248 [debug] [Thread-3 (]: Began compiling node test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f
[0m22:31:27.605147 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf
[0m22:31:27.617305 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5: COMMIT
[0m22:31:27.657543 [debug] [Thread-3 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f"
[0m22:31:27.670724 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf"
[0m22:31:27.685654 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5"
[0m22:31:27.709647 [debug] [Thread-2 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79 (compile): 22:31:27.565201 => 22:31:27.708857
[0m22:31:27.719248 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5: COMMIT
[0m22:31:27.737800 [debug] [Thread-2 (]: Began executing node test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79
[0m22:31:27.746366 [debug] [Thread-3 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f (compile): 22:31:27.634883 => 22:31:27.744873
[0m22:31:27.749742 [debug] [Thread-1 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf (compile): 22:31:27.658847 => 22:31:27.748926
[0m22:31:27.788607 [debug] [Thread-2 (]: Applying DROP to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_market_cap"
[0m22:31:27.790243 [debug] [Thread-3 (]: Began executing node test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f
[0m22:31:27.807991 [debug] [Thread-1 (]: Began executing node test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf
[0m22:31:27.819205 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m22:31:27.821388 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79"
[0m22:31:27.856294 [debug] [Thread-3 (]: Applying DROP to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_price_id"
[0m22:31:27.898299 [debug] [Thread-1 (]: Applying DROP to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_price_usd"
[0m22:31:27.901144 [debug] [Thread-4 (]: Writing runtime sql for node "test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5"
[0m22:31:27.914781 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79"} */
drop table if exists "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_market_cap" cascade
[0m22:31:27.925258 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f"
[0m22:31:27.936652 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf"
[0m22:31:27.957875 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:31:27.969275 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f"} */
drop table if exists "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_price_id" cascade
[0m22:31:27.981072 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf"} */
drop table if exists "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_price_usd" cascade
[0m22:31:27.999190 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:31:28.004847 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:31:28.017498 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:31:28.026788 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5"
[0m22:31:28.031843 [debug] [Thread-2 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_market_cap"
[0m22:31:28.050582 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:31:28.088696 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:31:28.098734 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5: BEGIN
[0m22:31:28.109551 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79"
[0m22:31:28.121469 [debug] [Thread-3 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_price_id"
[0m22:31:28.135385 [debug] [Thread-1 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_price_usd"
[0m22:31:28.148120 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m22:31:28.168861 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79: BEGIN
[0m22:31:28.189169 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f"
[0m22:31:28.206295 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf"
[0m22:31:28.222535 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5"
[0m22:31:28.237792 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:31:28.257741 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f: BEGIN
[0m22:31:28.271687 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf: BEGIN
[0m22:31:28.302034 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (

        select *
        from "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_extracted_at"


    ) dbt_internal_test
[0m22:31:28.318114 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79"
[0m22:31:28.334445 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:31:28.344758 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:31:28.356901 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:31:28.370225 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79"} */





  create  table "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_market_cap"


    as

  (






select *
from "crypto_warehouse"."public_staging"."stg_crypto_prices"
where market_cap is null



  );


[0m22:31:28.385561 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f"
[0m22:31:28.403284 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf"
[0m22:31:28.419426 [debug] [Thread-4 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5 (execute): 22:31:26.566653 => 22:31:28.418667
[0m22:31:28.441268 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f"} */





  create  table "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_price_id"


    as

  (






select *
from "crypto_warehouse"."public_staging"."stg_crypto_prices"
where price_id is null



  );


[0m22:31:28.453768 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf"} */





  create  table "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_price_usd"


    as

  (






select *
from "crypto_warehouse"."public_staging"."stg_crypto_prices"
where price_usd is null



  );


[0m22:31:28.467197 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5: ROLLBACK
[0m22:31:28.504519 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5: Close
[0m22:31:28.522518 [info ] [Thread-4 (]: 5 of 14 PASS not_null_stg_crypto_prices_extracted_at ........................... [[32mPASS[0m in 2.41s]
[0m22:31:28.536339 [debug] [Thread-4 (]: Finished running node test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5
[0m22:31:28.587360 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.0 seconds
[0m22:31:28.588811 [debug] [Thread-4 (]: Began running node test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a
[0m22:31:28.608590 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79: COMMIT
[0m22:31:28.649998 [info ] [Thread-4 (]: 9 of 14 START test not_null_stg_crypto_prices_symbol ........................... [RUN]
[0m22:31:28.666296 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79"
[0m22:31:28.674925 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5, now test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a)
[0m22:31:28.683489 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79: COMMIT
[0m22:31:28.691845 [debug] [Thread-4 (]: Began compiling node test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a
[0m22:31:28.696683 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m22:31:28.697673 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.0 seconds
[0m22:31:28.726260 [debug] [Thread-4 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a"
[0m22:31:28.734265 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf: COMMIT
[0m22:31:28.752394 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f: COMMIT
[0m22:31:28.753607 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m22:31:28.796765 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf"
[0m22:31:28.806131 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f"
[0m22:31:28.819993 [debug] [Thread-2 (]: Writing runtime sql for node "test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79"
[0m22:31:28.833920 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf: COMMIT
[0m22:31:28.848838 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f: COMMIT
[0m22:31:28.918621 [debug] [Thread-4 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a (compile): 22:31:28.712690 => 22:31:28.917743
[0m22:31:28.939123 [debug] [Thread-4 (]: Began executing node test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a
[0m22:31:28.942334 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:31:28.977572 [debug] [Thread-4 (]: Applying DROP to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_symbol"
[0m22:31:29.003569 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf"
[0m22:31:29.009113 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m22:31:29.011580 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79"
[0m22:31:29.018883 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a"
[0m22:31:29.049285 [debug] [Thread-3 (]: Writing runtime sql for node "test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f"
[0m22:31:29.060274 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79: BEGIN
[0m22:31:29.070570 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a"} */
drop table if exists "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_symbol" cascade
[0m22:31:29.098606 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:31:29.109788 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf"
[0m22:31:29.110947 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:31:29.117641 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f"
[0m22:31:29.127791 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79"
[0m22:31:29.144028 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf: BEGIN
[0m22:31:29.160632 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:31:29.165730 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f: BEGIN
[0m22:31:29.179718 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (

        select *
        from "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_market_cap"


    ) dbt_internal_test
[0m22:31:29.188303 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:31:29.200888 [debug] [Thread-4 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_symbol"
[0m22:31:29.213459 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:31:29.221967 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:31:29.231782 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf"
[0m22:31:29.243267 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a"
[0m22:31:29.254523 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f"
[0m22:31:29.269458 [debug] [Thread-2 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79 (execute): 22:31:27.764603 => 22:31:29.268600
[0m22:31:29.282361 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (

        select *
        from "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_price_usd"


    ) dbt_internal_test
[0m22:31:29.292490 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a: BEGIN
[0m22:31:29.304284 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (

        select *
        from "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_price_id"


    ) dbt_internal_test
[0m22:31:29.316462 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79: ROLLBACK
[0m22:31:29.328839 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:31:29.337862 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m22:31:29.349131 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:31:29.356617 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79: Close
[0m22:31:29.369599 [debug] [Thread-1 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf (execute): 22:31:27.857761 => 22:31:29.368865
[0m22:31:29.381632 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a"
[0m22:31:29.395637 [debug] [Thread-3 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f (execute): 22:31:27.833696 => 22:31:29.393360
[0m22:31:29.407343 [info ] [Thread-2 (]: 6 of 14 PASS not_null_stg_crypto_prices_market_cap ............................. [[32mPASS[0m in 2.22s]
[0m22:31:29.427784 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf: ROLLBACK
[0m22:31:29.445575 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a"} */





  create  table "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_symbol"


    as

  (






select *
from "crypto_warehouse"."public_staging"."stg_crypto_prices"
where symbol is null



  );


[0m22:31:29.463660 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f: ROLLBACK
[0m22:31:29.484460 [debug] [Thread-2 (]: Finished running node test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79
[0m22:31:29.507463 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf: Close
[0m22:31:29.530772 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f: Close
[0m22:31:29.538534 [debug] [Thread-2 (]: Began running node test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438
[0m22:31:29.553963 [info ] [Thread-1 (]: 8 of 14 PASS not_null_stg_crypto_prices_price_usd .............................. [[32mPASS[0m in 2.27s]
[0m22:31:29.568225 [info ] [Thread-3 (]: 7 of 14 PASS not_null_stg_crypto_prices_price_id ............................... [[32mPASS[0m in 2.30s]
[0m22:31:29.582329 [info ] [Thread-2 (]: 10 of 14 START test not_null_stg_crypto_prices_volume_24h ...................... [RUN]
[0m22:31:29.592265 [debug] [Thread-1 (]: Finished running node test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf
[0m22:31:29.600914 [debug] [Thread-3 (]: Finished running node test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f
[0m22:31:29.612194 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79, now test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438)
[0m22:31:29.622303 [debug] [Thread-1 (]: Began running node test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39
[0m22:31:29.644428 [debug] [Thread-3 (]: Began running node test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e
[0m22:31:29.652857 [debug] [Thread-2 (]: Began compiling node test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438
[0m22:31:29.653898 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.0 seconds
[0m22:31:29.662853 [info ] [Thread-1 (]: 11 of 14 START test not_null_stg_pipeline_runs_run_id .......................... [RUN]
[0m22:31:29.672318 [info ] [Thread-3 (]: 12 of 14 START test not_null_stg_pipeline_runs_stage ........................... [RUN]
[0m22:31:29.694215 [debug] [Thread-2 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438"
[0m22:31:29.700671 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a: COMMIT
[0m22:31:29.710097 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf, now test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39)
[0m22:31:29.718893 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f, now test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e)
[0m22:31:29.738283 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a"
[0m22:31:29.749729 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39
[0m22:31:29.761531 [debug] [Thread-3 (]: Began compiling node test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e
[0m22:31:29.770054 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a: COMMIT
[0m22:31:29.802581 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39"
[0m22:31:29.827849 [debug] [Thread-3 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e"
[0m22:31:29.831898 [debug] [Thread-2 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438 (compile): 22:31:29.681963 => 22:31:29.831218
[0m22:31:29.862374 [debug] [Thread-2 (]: Began executing node test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438
[0m22:31:29.898255 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m22:31:29.900034 [debug] [Thread-2 (]: Applying DROP to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_volume_24h"
[0m22:31:29.935589 [debug] [Thread-4 (]: Writing runtime sql for node "test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a"
[0m22:31:29.947027 [debug] [Thread-1 (]: Timing info for test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39 (compile): 22:31:29.781791 => 22:31:29.946417
[0m22:31:29.950300 [debug] [Thread-3 (]: Timing info for test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e (compile): 22:31:29.804063 => 22:31:29.949524
[0m22:31:30.002962 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438"
[0m22:31:30.192251 [debug] [Thread-1 (]: Began executing node test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39
[0m22:31:30.315370 [debug] [Thread-3 (]: Began executing node test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e
[0m22:31:30.345200 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438"} */
drop table if exists "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_volume_24h" cascade
[0m22:31:30.395603 [debug] [Thread-1 (]: Applying DROP to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_run_id"
[0m22:31:30.421487 [debug] [Thread-3 (]: Applying DROP to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_stage"
[0m22:31:30.426489 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:31:30.428867 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a"
[0m22:31:30.436964 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39"
[0m22:31:30.497310 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e"
[0m22:31:30.523201 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:31:30.537379 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a: BEGIN
[0m22:31:30.559870 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39"} */
drop table if exists "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_run_id" cascade
[0m22:31:30.571534 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e"} */
drop table if exists "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_stage" cascade
[0m22:31:30.585947 [debug] [Thread-2 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_volume_24h"
[0m22:31:30.598123 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m22:31:30.612333 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:31:30.631867 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:31:30.660093 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438"
[0m22:31:30.698422 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a"
[0m22:31:30.746833 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:31:30.778550 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:31:30.824167 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438: BEGIN
[0m22:31:30.845949 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (

        select *
        from "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_symbol"


    ) dbt_internal_test
[0m22:31:30.923752 [debug] [Thread-1 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_run_id"
[0m22:31:30.937085 [debug] [Thread-3 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_stage"
[0m22:31:30.981946 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:31:31.032691 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:31:31.060461 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39"
[0m22:31:31.078135 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e"
[0m22:31:31.087482 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438"
[0m22:31:31.101374 [debug] [Thread-4 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a (execute): 22:31:28.953794 => 22:31:31.100511
[0m22:31:31.114002 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39: BEGIN
[0m22:31:31.124850 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e: BEGIN
[0m22:31:31.133731 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438"} */





  create  table "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_volume_24h"


    as

  (






select *
from "crypto_warehouse"."public_staging"."stg_crypto_prices"
where volume_24h is null



  );


[0m22:31:31.145299 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a: ROLLBACK
[0m22:31:31.159686 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:31:31.168984 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:31:31.186445 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a: Close
[0m22:31:31.193736 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39"
[0m22:31:31.202412 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e"
[0m22:31:31.212126 [info ] [Thread-4 (]: 9 of 14 PASS not_null_stg_crypto_prices_symbol ................................. [[32mPASS[0m in 2.54s]
[0m22:31:31.225585 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39"} */





  create  table "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_run_id"


    as

  (






select *
from "crypto_warehouse"."public_staging"."stg_pipeline_runs"
where run_id is null



  );


[0m22:31:31.240875 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e"} */





  create  table "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_stage"


    as

  (






select *
from "crypto_warehouse"."public_staging"."stg_pipeline_runs"
where stage is null



  );


[0m22:31:31.286568 [debug] [Thread-4 (]: Finished running node test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a
[0m22:31:31.442405 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.0 seconds
[0m22:31:31.450535 [debug] [Thread-4 (]: Began running node test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd
[0m22:31:31.461975 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438: COMMIT
[0m22:31:31.478858 [info ] [Thread-4 (]: 13 of 14 START test not_null_stg_pipeline_runs_status .......................... [RUN]
[0m22:31:31.490394 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438"
[0m22:31:31.499125 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a, now test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd)
[0m22:31:31.509857 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438: COMMIT
[0m22:31:31.517774 [debug] [Thread-4 (]: Began compiling node test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd
[0m22:31:31.569384 [debug] [Thread-4 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd"
[0m22:31:31.609196 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.0 seconds
[0m22:31:31.610360 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m22:31:31.619852 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e: COMMIT
[0m22:31:31.635308 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39: COMMIT
[0m22:31:31.637177 [debug] [Thread-4 (]: Timing info for test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd (compile): 22:31:31.548104 => 22:31:31.636459
[0m22:31:31.647381 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e"
[0m22:31:31.655979 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39"
[0m22:31:31.664327 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m22:31:31.665832 [debug] [Thread-4 (]: Began executing node test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd
[0m22:31:31.694142 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e: COMMIT
[0m22:31:31.704166 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39: COMMIT
[0m22:31:31.715865 [debug] [Thread-2 (]: Writing runtime sql for node "test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438"
[0m22:31:31.748496 [debug] [Thread-4 (]: Applying DROP to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_status"
[0m22:31:31.800728 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd"
[0m22:31:31.810451 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd"} */
drop table if exists "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_status" cascade
[0m22:31:31.820741 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m22:31:31.824211 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:31:31.834524 [debug] [Thread-3 (]: Writing runtime sql for node "test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e"
[0m22:31:31.852355 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:31:31.862390 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438"
[0m22:31:31.866818 [debug] [Thread-4 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_status"
[0m22:31:31.875886 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:31:31.876946 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438: BEGIN
[0m22:31:31.892790 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd"
[0m22:31:31.902986 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39"
[0m22:31:31.906319 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e"
[0m22:31:31.912088 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:31:31.919241 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd: BEGIN
[0m22:31:31.935737 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e: BEGIN
[0m22:31:31.944779 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438"
[0m22:31:31.953927 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m22:31:31.976799 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:31:31.987830 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (

        select *
        from "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_volume_24h"


    ) dbt_internal_test
[0m22:31:31.996698 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd"
[0m22:31:32.005522 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e"
[0m22:31:32.011008 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39"
[0m22:31:32.015798 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:31:32.023835 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd"} */





  create  table "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_status"


    as

  (






select *
from "crypto_warehouse"."public_staging"."stg_pipeline_runs"
where status is null



  );


[0m22:31:32.032366 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (

        select *
        from "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_stage"


    ) dbt_internal_test
[0m22:31:32.040995 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39: BEGIN
[0m22:31:32.052579 [debug] [Thread-2 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438 (execute): 22:31:29.877001 => 22:31:32.051990
[0m22:31:32.076184 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:31:32.083774 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:31:32.091430 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438: ROLLBACK
[0m22:31:32.102778 [debug] [Thread-3 (]: Timing info for test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e (execute): 22:31:30.396991 => 22:31:32.102032
[0m22:31:32.111476 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39"
[0m22:31:32.120714 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438: Close
[0m22:31:32.127944 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e: ROLLBACK
[0m22:31:32.137695 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (

        select *
        from "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_run_id"


    ) dbt_internal_test
[0m22:31:32.161628 [info ] [Thread-2 (]: 10 of 14 PASS not_null_stg_crypto_prices_volume_24h ............................ [[32mPASS[0m in 2.55s]
[0m22:31:32.182891 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e: Close
[0m22:31:32.200887 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:31:32.211745 [debug] [Thread-2 (]: Finished running node test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438
[0m22:31:32.236963 [info ] [Thread-3 (]: 12 of 14 PASS not_null_stg_pipeline_runs_stage ................................. [[32mPASS[0m in 2.52s]
[0m22:31:32.268066 [debug] [Thread-1 (]: Timing info for test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39 (execute): 22:31:30.359467 => 22:31:32.267425
[0m22:31:32.281402 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.0 seconds
[0m22:31:32.297580 [debug] [Thread-2 (]: Began running node test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43
[0m22:31:32.335954 [debug] [Thread-3 (]: Finished running node test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e
[0m22:31:32.344763 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39: ROLLBACK
[0m22:31:32.357181 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd: COMMIT
[0m22:31:32.365635 [info ] [Thread-2 (]: 14 of 14 START test unique_stg_crypto_prices_price_id .......................... [RUN]
[0m22:31:32.386888 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39: Close
[0m22:31:32.394016 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd"
[0m22:31:32.403545 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438, now test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43)
[0m22:31:32.413287 [info ] [Thread-1 (]: 11 of 14 PASS not_null_stg_pipeline_runs_run_id ................................ [[32mPASS[0m in 2.70s]
[0m22:31:32.436457 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd: COMMIT
[0m22:31:32.444986 [debug] [Thread-2 (]: Began compiling node test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43
[0m22:31:32.455344 [debug] [Thread-1 (]: Finished running node test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39
[0m22:31:32.516962 [debug] [Thread-2 (]: Writing injected SQL for node "test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43"
[0m22:31:32.531635 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m22:31:32.541354 [debug] [Thread-4 (]: Writing runtime sql for node "test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd"
[0m22:31:32.579102 [debug] [Thread-2 (]: Timing info for test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43 (compile): 22:31:32.479127 => 22:31:32.577937
[0m22:31:32.591664 [debug] [Thread-2 (]: Began executing node test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43
[0m22:31:32.605794 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd"
[0m22:31:32.621310 [debug] [Thread-2 (]: Applying DROP to: "crypto_warehouse"."public_dbt_test__audit"."unique_stg_crypto_prices_price_id"
[0m22:31:32.635909 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd: BEGIN
[0m22:31:32.647968 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43"
[0m22:31:32.657589 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m22:31:32.664432 [debug] [Thread-2 (]: On test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43"} */
drop table if exists "crypto_warehouse"."public_dbt_test__audit"."unique_stg_crypto_prices_price_id" cascade
[0m22:31:32.674154 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd"
[0m22:31:32.682596 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:31:32.691810 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (

        select *
        from "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_status"


    ) dbt_internal_test
[0m22:31:32.708070 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:31:32.715601 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:31:32.724367 [debug] [Thread-2 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."unique_stg_crypto_prices_price_id"
[0m22:31:32.735946 [debug] [Thread-4 (]: Timing info for test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd (execute): 22:31:31.725141 => 22:31:32.735102
[0m22:31:32.746727 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43"
[0m22:31:32.756156 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd: ROLLBACK
[0m22:31:32.765729 [debug] [Thread-2 (]: On test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43: BEGIN
[0m22:31:32.776313 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd: Close
[0m22:31:32.784208 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:31:32.792691 [info ] [Thread-4 (]: 13 of 14 PASS not_null_stg_pipeline_runs_status ................................ [[32mPASS[0m in 1.29s]
[0m22:31:32.912077 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43"
[0m22:31:33.123083 [debug] [Thread-4 (]: Finished running node test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd
[0m22:31:33.134869 [debug] [Thread-2 (]: On test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43"} */





  create  table "crypto_warehouse"."public_dbt_test__audit"."unique_stg_crypto_prices_price_id"


    as

  (




select
    price_id as unique_field,
    count(*) as n_records

from "crypto_warehouse"."public_staging"."stg_crypto_prices"
where price_id is not null
group by price_id
having count(*) > 1



  );


[0m22:31:33.167789 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.0 seconds
[0m22:31:33.197803 [debug] [Thread-2 (]: On test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43: COMMIT
[0m22:31:33.209364 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43"
[0m22:31:33.244982 [debug] [Thread-2 (]: On test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43: COMMIT
[0m22:31:33.309593 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m22:31:33.431938 [debug] [Thread-2 (]: Writing runtime sql for node "test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43"
[0m22:31:33.640705 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43"
[0m22:31:33.656869 [debug] [Thread-2 (]: On test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43: BEGIN
[0m22:31:33.666319 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:31:33.678692 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43"
[0m22:31:33.702797 [debug] [Thread-2 (]: On test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (

        select *
        from "crypto_warehouse"."public_dbt_test__audit"."unique_stg_crypto_prices_price_id"


    ) dbt_internal_test
[0m22:31:33.739015 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:31:33.761752 [debug] [Thread-2 (]: Timing info for test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43 (execute): 22:31:32.599547 => 22:31:33.760916
[0m22:31:33.780621 [debug] [Thread-2 (]: On test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43: ROLLBACK
[0m22:31:33.800903 [debug] [Thread-2 (]: On test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43: Close
[0m22:31:33.851431 [info ] [Thread-2 (]: 14 of 14 PASS unique_stg_crypto_prices_price_id ................................ [[32mPASS[0m in 1.45s]
[0m22:31:33.936057 [debug] [Thread-2 (]: Finished running node test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43
[0m22:31:33.991665 [debug] [MainThread]: Using postgres connection "master"
[0m22:31:34.041204 [debug] [MainThread]: On master: BEGIN
[0m22:31:34.077635 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:31:34.097051 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:31:34.106969 [debug] [MainThread]: On master: COMMIT
[0m22:31:34.114620 [debug] [MainThread]: Using postgres connection "master"
[0m22:31:34.129613 [debug] [MainThread]: On master: COMMIT
[0m22:31:34.140723 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:31:34.153191 [debug] [MainThread]: On master: Close
[0m22:31:34.161999 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:31:34.172504 [debug] [MainThread]: Connection 'test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e' was properly closed.
[0m22:31:34.183337 [debug] [MainThread]: Connection 'test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43' was properly closed.
[0m22:31:34.191922 [debug] [MainThread]: Connection 'test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39' was properly closed.
[0m22:31:34.199509 [debug] [MainThread]: Connection 'test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd' was properly closed.
[0m22:31:34.207623 [info ] [MainThread]:
[0m22:31:34.218962 [info ] [MainThread]: Finished running 14 tests in 0 hours 0 minutes and 13.78 seconds (13.78s).
[0m22:31:34.232408 [debug] [MainThread]: Command end result
[0m22:31:34.706330 [info ] [MainThread]:
[0m22:31:34.714700 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:31:34.804465 [info ] [MainThread]:
[0m22:31:34.832811 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_stg_crypto_prices_extracted_at__extracted_at_CURRENT_TIMESTAMP (models/staging/schema.yml)
  syntax error at or near "extracted_at"
  LINE 21: where not(extracted_at extracted_at <= CURRENT_TIMESTAMP)
                                  ^
[0m22:31:34.861307 [info ] [MainThread]:
[0m22:31:34.874168 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=1 SKIP=0 TOTAL=14
[0m22:31:34.884541 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 59.01258, "process_user_time": 21.156618, "process_kernel_time": 1.501827, "process_mem_max_rss": "129680", "process_in_blocks": "728", "process_out_blocks": "1976", "command_success": false}
[0m22:31:34.892985 [debug] [MainThread]: Command `dbt test` failed at 22:31:34.892624 after 59.02 seconds
[0m22:31:34.902913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff65bdad150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff65af48510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff65af4bf50>]}
[0m22:31:34.911809 [debug] [MainThread]: Flushing usage events
[0m22:32:57.839830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17279a2d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1726347150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17269ca150>]}


============================== 22:32:57.861997 | 84b85815-7acb-44bb-bc25-0200abd94c1f ==============================
[0m22:32:57.861997 [info ] [MainThread]: Running with dbt=1.7.0
[0m22:32:57.879358 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'debug': 'False', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --project-dir /app/dbt', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:32:58.837647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '84b85815-7acb-44bb-bc25-0200abd94c1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1726347e90>]}
[0m22:32:59.134937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '84b85815-7acb-44bb-bc25-0200abd94c1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1724bcb590>]}
[0m22:32:59.147002 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m22:32:59.374417 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m22:33:07.660951 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:33:07.671781 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/staging/schema.yml
[0m22:33:08.720888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '84b85815-7acb-44bb-bc25-0200abd94c1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f172413e890>]}
[0m22:33:08.903037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '84b85815-7acb-44bb-bc25-0200abd94c1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1724923b10>]}
[0m22:33:08.910073 [info ] [MainThread]: Found 7 models, 14 tests, 2 sources, 0 exposures, 0 metrics, 517 macros, 0 groups, 0 semantic models
[0m22:33:08.927091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84b85815-7acb-44bb-bc25-0200abd94c1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1724af6250>]}
[0m22:33:08.968543 [info ] [MainThread]:
[0m22:33:08.995046 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:33:09.286605 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse'
[0m22:33:09.371254 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse"
[0m22:33:09.450786 [debug] [ThreadPool]: On list_crypto_warehouse: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse"} */

    select distinct nspname from pg_namespace

[0m22:33:09.483850 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:33:09.504791 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m22:33:09.517238 [debug] [ThreadPool]: On list_crypto_warehouse: Close
[0m22:33:09.530980 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_warehouse, now list_crypto_warehouse_public_dbt_test__audit)
[0m22:33:09.535063 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse_public_marts'
[0m22:33:09.537282 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse_public_staging'
[0m22:33:09.564179 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_dbt_test__audit"
[0m22:33:09.571956 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_marts"
[0m22:33:09.588771 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_staging"
[0m22:33:09.601423 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: BEGIN
[0m22:33:09.609263 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: BEGIN
[0m22:33:09.620565 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: BEGIN
[0m22:33:09.654119 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:33:09.675390 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:33:09.688499 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:33:09.712546 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:33:09.730082 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:33:09.749744 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:33:09.754693 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_dbt_test__audit"
[0m22:33:09.762843 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_marts"
[0m22:33:09.773359 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_staging"
[0m22:33:09.784897 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_dbt_test__audit"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'

[0m22:33:09.792353 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_marts"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'

[0m22:33:09.806519 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_staging"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'

[0m22:33:09.825735 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m22:33:09.830373 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m22:33:09.846529 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m22:33:09.861039 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: ROLLBACK
[0m22:33:09.874790 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: ROLLBACK
[0m22:33:09.885954 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: ROLLBACK
[0m22:33:09.892125 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: Close
[0m22:33:09.901582 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: Close
[0m22:33:09.906635 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: Close
[0m22:33:09.952336 [debug] [MainThread]: Using postgres connection "master"
[0m22:33:09.958115 [debug] [MainThread]: On master: BEGIN
[0m22:33:09.967700 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:33:09.979495 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:33:09.988266 [debug] [MainThread]: Using postgres connection "master"
[0m22:33:09.995390 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:33:10.017443 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m22:33:10.025263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84b85815-7acb-44bb-bc25-0200abd94c1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f171fd6b6d0>]}
[0m22:33:10.039181 [debug] [MainThread]: On master: ROLLBACK
[0m22:33:10.051388 [debug] [MainThread]: Using postgres connection "master"
[0m22:33:10.067261 [debug] [MainThread]: On master: BEGIN
[0m22:33:10.078904 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:33:10.090835 [debug] [MainThread]: On master: COMMIT
[0m22:33:10.104110 [debug] [MainThread]: Using postgres connection "master"
[0m22:33:10.113629 [debug] [MainThread]: On master: COMMIT
[0m22:33:10.123575 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:33:10.133441 [debug] [MainThread]: On master: Close
[0m22:33:10.139643 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:33:10.159025 [info ] [MainThread]:
[0m22:33:10.199956 [debug] [Thread-1 (]: Began running node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30
[0m22:33:10.201388 [debug] [Thread-2 (]: Began running node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7
[0m22:33:10.202701 [debug] [Thread-3 (]: Began running node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300
[0m22:33:10.206266 [debug] [Thread-4 (]: Began running node test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd
[0m22:33:10.213896 [info ] [Thread-1 (]: 1 of 14 START test dbt_utils_accepted_range_stg_crypto_prices_market_cap__0 .... [RUN]
[0m22:33:10.239546 [info ] [Thread-2 (]: 2 of 14 START test dbt_utils_accepted_range_stg_crypto_prices_price_usd__0 ..... [RUN]
[0m22:33:10.251930 [info ] [Thread-3 (]: 3 of 14 START test dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0 .... [RUN]
[0m22:33:10.265744 [info ] [Thread-4 (]: 4 of 14 START test dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP  [RUN]
[0m22:33:10.289111 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_staging, now test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30)
[0m22:33:10.301036 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_marts, now test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7)
[0m22:33:10.320441 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_dbt_test__audit, now test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300)
[0m22:33:10.333474 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd'
[0m22:33:10.358431 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30
[0m22:33:10.367283 [debug] [Thread-2 (]: Began compiling node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7
[0m22:33:10.374602 [debug] [Thread-3 (]: Began compiling node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300
[0m22:33:10.382446 [debug] [Thread-4 (]: Began compiling node test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd
[0m22:33:10.408047 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30"
[0m22:33:10.419428 [debug] [Thread-2 (]: Writing injected SQL for node "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7"
[0m22:33:10.433414 [debug] [Thread-3 (]: Writing injected SQL for node "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300"
[0m22:33:10.449698 [debug] [Thread-4 (]: Writing injected SQL for node "test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd"
[0m22:33:10.513629 [debug] [Thread-1 (]: Timing info for test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30 (compile): 22:33:10.390590 => 22:33:10.512761
[0m22:33:10.526405 [debug] [Thread-2 (]: Timing info for test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7 (compile): 22:33:10.408915 => 22:33:10.525558
[0m22:33:10.529274 [debug] [Thread-1 (]: Began executing node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30
[0m22:33:10.538013 [debug] [Thread-2 (]: Began executing node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7
[0m22:33:10.547762 [debug] [Thread-4 (]: Timing info for test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd (compile): 22:33:10.436731 => 22:33:10.546753
[0m22:33:10.609929 [debug] [Thread-3 (]: Timing info for test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300 (compile): 22:33:10.423721 => 22:33:10.608944
[0m22:33:10.696876 [debug] [Thread-1 (]: Applying DROP to: "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_market_cap__0"
[0m22:33:10.725864 [debug] [Thread-2 (]: Applying DROP to: "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_price_usd__0"
[0m22:33:10.734326 [debug] [Thread-4 (]: Began executing node test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd
[0m22:33:10.757185 [debug] [Thread-3 (]: Began executing node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300
[0m22:33:10.800807 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30"
[0m22:33:10.913826 [debug] [Thread-1 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30"} */
drop table if exists "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_market_cap__0" cascade
[0m22:33:10.856943 [debug] [Thread-4 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_expression_is_true_s_7b822a4db60249ec680888478d412bb7"
[0m22:33:10.908765 [debug] [Thread-3 (]: Applying DROP to: "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0"
[0m22:33:10.818116 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7"
[0m22:33:11.035569 [debug] [Thread-2 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7"} */
drop table if exists "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_price_usd__0" cascade
[0m22:33:11.021129 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300"
[0m22:33:11.019193 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd"
[0m22:33:10.938148 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:33:11.055660 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:33:11.140445 [debug] [Thread-3 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300"} */
drop table if exists "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0" cascade
[0m22:33:11.155146 [debug] [Thread-4 (]: On test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd: BEGIN
[0m22:33:11.173066 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:33:11.193124 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:33:11.197741 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:33:11.206906 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:33:11.217963 [debug] [Thread-1 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_market_cap__0"
[0m22:33:11.227840 [debug] [Thread-2 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_price_usd__0"
[0m22:33:11.242323 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:33:11.256691 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30"
[0m22:33:11.257695 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m22:33:11.266009 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7"
[0m22:33:11.273820 [debug] [Thread-3 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0"
[0m22:33:11.281154 [debug] [Thread-1 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30: BEGIN
[0m22:33:11.287903 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd"
[0m22:33:11.298267 [debug] [Thread-2 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7: BEGIN
[0m22:33:11.306816 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300"
[0m22:33:11.316765 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:33:11.323292 [debug] [Thread-4 (]: On test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd"} */





  create  table "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_expression_is_true_s_7b822a4db60249ec680888478d412bb7"


    as

  (




select
    *
from "crypto_warehouse"."public_staging"."stg_crypto_prices"

where not(extracted_at  <= CURRENT_TIMESTAMP)


  );


[0m22:33:11.332148 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:33:11.338019 [debug] [Thread-3 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300: BEGIN
[0m22:33:11.346151 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30"
[0m22:33:11.361658 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7"
[0m22:33:11.375029 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:33:11.383090 [debug] [Thread-1 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30"} */





  create  table "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_market_cap__0"


    as

  (


with meet_condition as(
  select *
  from "crypto_warehouse"."public_staging"."stg_crypto_prices"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not market_cap >= 0
)

select *
from validation_errors


  );


[0m22:33:11.390851 [debug] [Thread-2 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7"} */





  create  table "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_price_usd__0"


    as

  (


with meet_condition as(
  select *
  from "crypto_warehouse"."public_staging"."stg_crypto_prices"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not price_usd >= 0
)

select *
from validation_errors


  );


[0m22:33:11.399210 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300"
[0m22:33:11.422619 [debug] [Thread-3 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300"} */





  create  table "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0"


    as

  (


with meet_condition as(
  select *
  from "crypto_warehouse"."public_staging"."stg_crypto_prices"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not volume_24h >= 0
)

select *
from validation_errors


  );


[0m22:33:11.556030 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.0 seconds
[0m22:33:11.563447 [debug] [Thread-4 (]: On test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd: COMMIT
[0m22:33:11.569418 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd"
[0m22:33:11.575858 [debug] [Thread-4 (]: On test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd: COMMIT
[0m22:33:11.689602 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m22:33:11.691006 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.0 seconds
[0m22:33:11.692124 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.0 seconds
[0m22:33:11.693064 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m22:33:11.704598 [debug] [Thread-4 (]: Writing runtime sql for node "test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd"
[0m22:33:11.710518 [debug] [Thread-2 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7: COMMIT
[0m22:33:11.717504 [debug] [Thread-3 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300: COMMIT
[0m22:33:11.724780 [debug] [Thread-1 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30: COMMIT
[0m22:33:11.739063 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7"
[0m22:33:11.746859 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300"
[0m22:33:11.754604 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30"
[0m22:33:11.764428 [debug] [Thread-2 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7: COMMIT
[0m22:33:11.773290 [debug] [Thread-3 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300: COMMIT
[0m22:33:11.774772 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd"
[0m22:33:11.780055 [debug] [Thread-1 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30: COMMIT
[0m22:33:11.801169 [debug] [Thread-4 (]: On test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd: BEGIN
[0m22:33:11.812607 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m22:33:11.818050 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd"
[0m22:33:11.824874 [debug] [Thread-4 (]: On test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (

        select *
        from "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_expression_is_true_s_7b822a4db60249ec680888478d412bb7"


    ) dbt_internal_test
[0m22:33:11.831270 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:33:11.839476 [debug] [Thread-4 (]: Timing info for test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd (execute): 22:33:10.835638 => 22:33:11.838930
[0m22:33:11.845128 [debug] [Thread-4 (]: On test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd: ROLLBACK
[0m22:33:11.851390 [debug] [Thread-4 (]: On test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd: Close
[0m22:33:11.862345 [info ] [Thread-4 (]: 4 of 14 PASS dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP  [[32mPASS[0m in 1.53s]
[0m22:33:11.876060 [debug] [Thread-4 (]: Finished running node test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd
[0m22:33:11.885658 [debug] [Thread-4 (]: Began running node test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5
[0m22:33:11.902353 [info ] [Thread-4 (]: 5 of 14 START test not_null_stg_crypto_prices_extracted_at ..................... [RUN]
[0m22:33:11.923064 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m22:33:12.034923 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:33:12.037851 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m22:33:12.281630 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd, now test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5)
[0m22:33:12.305360 [debug] [Thread-2 (]: Writing runtime sql for node "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7"
[0m22:33:12.314885 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30"
[0m22:33:12.324143 [debug] [Thread-3 (]: Writing runtime sql for node "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300"
[0m22:33:12.332542 [debug] [Thread-4 (]: Began compiling node test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5
[0m22:33:12.410246 [debug] [Thread-4 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5"
[0m22:33:12.414071 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300"
[0m22:33:12.418601 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30"
[0m22:33:12.427533 [debug] [Thread-3 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300: BEGIN
[0m22:33:12.436675 [debug] [Thread-1 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30: BEGIN
[0m22:33:12.439721 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7"
[0m22:33:12.448296 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:33:12.455822 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:33:12.464741 [debug] [Thread-2 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7: BEGIN
[0m22:33:12.475106 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300"
[0m22:33:12.482241 [debug] [Thread-4 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5 (compile): 22:33:12.382010 => 22:33:12.481471
[0m22:33:12.483843 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30"
[0m22:33:12.492451 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:33:12.499405 [debug] [Thread-3 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (

        select *
        from "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0"


    ) dbt_internal_test
[0m22:33:12.508057 [debug] [Thread-4 (]: Began executing node test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5
[0m22:33:12.516042 [debug] [Thread-1 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (

        select *
        from "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_market_cap__0"


    ) dbt_internal_test
[0m22:33:12.558073 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:33:12.532943 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:33:12.552184 [debug] [Thread-4 (]: Applying DROP to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_extracted_at"
[0m22:33:12.524240 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7"
[0m22:33:12.569615 [debug] [Thread-1 (]: Timing info for test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30 (execute): 22:33:10.549032 => 22:33:12.568630
[0m22:33:12.607565 [debug] [Thread-3 (]: Timing info for test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300 (execute): 22:33:10.888138 => 22:33:12.606349
[0m22:33:12.623507 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5"
[0m22:33:12.631951 [debug] [Thread-2 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (

        select *
        from "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_price_usd__0"


    ) dbt_internal_test
[0m22:33:12.641279 [debug] [Thread-1 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30: ROLLBACK
[0m22:33:12.653109 [debug] [Thread-3 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300: ROLLBACK
[0m22:33:12.666962 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5"} */
drop table if exists "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_extracted_at" cascade
[0m22:33:12.679074 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:33:12.688031 [debug] [Thread-1 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30: Close
[0m22:33:12.703459 [debug] [Thread-3 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300: Close
[0m22:33:12.710755 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:33:12.721874 [debug] [Thread-2 (]: Timing info for test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7 (execute): 22:33:10.603729 => 22:33:12.721120
[0m22:33:12.730416 [info ] [Thread-1 (]: 1 of 14 PASS dbt_utils_accepted_range_stg_crypto_prices_market_cap__0 .......... [[32mPASS[0m in 2.44s]
[0m22:33:12.744674 [info ] [Thread-3 (]: 3 of 14 PASS dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0 .......... [[32mPASS[0m in 2.42s]
[0m22:33:12.758941 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:33:12.765756 [debug] [Thread-2 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7: ROLLBACK
[0m22:33:12.775089 [debug] [Thread-1 (]: Finished running node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30
[0m22:33:12.785013 [debug] [Thread-3 (]: Finished running node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300
[0m22:33:12.794169 [debug] [Thread-4 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_extracted_at"
[0m22:33:12.802997 [debug] [Thread-2 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7: Close
[0m22:33:12.808961 [debug] [Thread-1 (]: Began running node test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79
[0m22:33:12.816237 [debug] [Thread-3 (]: Began running node test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f
[0m22:33:12.823457 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5"
[0m22:33:12.831587 [info ] [Thread-2 (]: 2 of 14 PASS dbt_utils_accepted_range_stg_crypto_prices_price_usd__0 ........... [[32mPASS[0m in 2.53s]
[0m22:33:12.837485 [info ] [Thread-1 (]: 6 of 14 START test not_null_stg_crypto_prices_market_cap ....................... [RUN]
[0m22:33:12.845812 [info ] [Thread-3 (]: 7 of 14 START test not_null_stg_crypto_prices_price_id ......................... [RUN]
[0m22:33:12.853230 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5: BEGIN
[0m22:33:12.861955 [debug] [Thread-2 (]: Finished running node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7
[0m22:33:12.867651 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30, now test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79)
[0m22:33:12.875315 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300, now test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f)
[0m22:33:12.882029 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m22:33:12.888324 [debug] [Thread-2 (]: Began running node test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf
[0m22:33:12.900373 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79
[0m22:33:12.908180 [debug] [Thread-3 (]: Began compiling node test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f
[0m22:33:12.916651 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5"
[0m22:33:12.932535 [info ] [Thread-2 (]: 8 of 14 START test not_null_stg_crypto_prices_price_usd ........................ [RUN]
[0m22:33:12.967560 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79"
[0m22:33:12.982808 [debug] [Thread-3 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f"
[0m22:33:13.002357 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5"} */





  create  table "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_extracted_at"


    as

  (






select *
from "crypto_warehouse"."public_staging"."stg_crypto_prices"
where extracted_at is null



  );


[0m22:33:13.021219 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7, now test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf)
[0m22:33:13.189937 [debug] [Thread-2 (]: Began compiling node test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf
[0m22:33:13.274033 [debug] [Thread-2 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf"
[0m22:33:13.283584 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.0 seconds
[0m22:33:13.324350 [debug] [Thread-3 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f (compile): 22:33:12.972094 => 22:33:13.323650
[0m22:33:13.333108 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5: COMMIT
[0m22:33:13.394013 [debug] [Thread-1 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79 (compile): 22:33:12.946944 => 22:33:13.393213
[0m22:33:13.395646 [debug] [Thread-3 (]: Began executing node test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f
[0m22:33:13.479625 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5"
[0m22:33:13.502692 [debug] [Thread-2 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf (compile): 22:33:13.211223 => 22:33:13.501915
[0m22:33:13.506646 [debug] [Thread-1 (]: Began executing node test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79
[0m22:33:13.595254 [debug] [Thread-3 (]: Applying DROP to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_price_id"
[0m22:33:13.599995 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5: COMMIT
[0m22:33:13.612481 [debug] [Thread-2 (]: Began executing node test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf
[0m22:33:13.650356 [debug] [Thread-1 (]: Applying DROP to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_market_cap"
[0m22:33:13.669806 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f"
[0m22:33:13.746313 [debug] [Thread-2 (]: Applying DROP to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_price_usd"
[0m22:33:13.762356 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79"
[0m22:33:13.768465 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m22:33:13.779852 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f"} */
drop table if exists "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_price_id" cascade
[0m22:33:13.897327 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:33:13.873068 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79"} */
drop table if exists "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_market_cap" cascade
[0m22:33:13.926563 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:33:13.819198 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf"
[0m22:33:13.948868 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf"} */
drop table if exists "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_price_usd" cascade
[0m22:33:13.931865 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:33:13.883830 [debug] [Thread-4 (]: Writing runtime sql for node "test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5"
[0m22:33:13.952219 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:33:13.958392 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:33:13.973144 [debug] [Thread-3 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_price_id"
[0m22:33:13.992005 [debug] [Thread-1 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_market_cap"
[0m22:33:14.018337 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:33:14.027365 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f"
[0m22:33:14.056038 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79"
[0m22:33:14.089615 [debug] [Thread-2 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_price_usd"
[0m22:33:14.113557 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f: BEGIN
[0m22:33:14.114864 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5"
[0m22:33:14.125553 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79: BEGIN
[0m22:33:14.135406 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf"
[0m22:33:14.145699 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:33:14.152252 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5: BEGIN
[0m22:33:14.160812 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:33:14.166010 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf: BEGIN
[0m22:33:14.175757 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f"
[0m22:33:14.183875 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m22:33:14.192969 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79"
[0m22:33:14.200009 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:33:14.206771 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f"} */





  create  table "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_price_id"


    as

  (






select *
from "crypto_warehouse"."public_staging"."stg_crypto_prices"
where price_id is null



  );


[0m22:33:14.213741 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5"
[0m22:33:14.221244 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79"} */





  create  table "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_market_cap"


    as

  (






select *
from "crypto_warehouse"."public_staging"."stg_crypto_prices"
where market_cap is null



  );


[0m22:33:14.228120 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf"
[0m22:33:14.243120 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (

        select *
        from "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_extracted_at"


    ) dbt_internal_test
[0m22:33:14.259048 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf"} */





  create  table "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_price_usd"


    as

  (






select *
from "crypto_warehouse"."public_staging"."stg_crypto_prices"
where price_usd is null



  );


[0m22:33:14.277030 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:33:14.292062 [debug] [Thread-4 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5 (execute): 22:33:12.538633 => 22:33:14.291507
[0m22:33:14.299533 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5: ROLLBACK
[0m22:33:14.308526 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5: Close
[0m22:33:14.317178 [info ] [Thread-4 (]: 5 of 14 PASS not_null_stg_crypto_prices_extracted_at ........................... [[32mPASS[0m in 2.04s]
[0m22:33:14.328847 [debug] [Thread-4 (]: Finished running node test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5
[0m22:33:14.340844 [debug] [Thread-4 (]: Began running node test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a
[0m22:33:14.355129 [info ] [Thread-4 (]: 9 of 14 START test not_null_stg_crypto_prices_symbol ........................... [RUN]
[0m22:33:14.390922 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5, now test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a)
[0m22:33:14.407292 [debug] [Thread-4 (]: Began compiling node test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a
[0m22:33:14.413399 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.0 seconds
[0m22:33:14.435837 [debug] [Thread-4 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a"
[0m22:33:14.455316 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f: COMMIT
[0m22:33:14.471606 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f"
[0m22:33:14.481003 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f: COMMIT
[0m22:33:14.532806 [debug] [Thread-4 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a (compile): 22:33:14.424731 => 22:33:14.532101
[0m22:33:14.542709 [debug] [Thread-4 (]: Began executing node test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a
[0m22:33:14.564038 [debug] [Thread-4 (]: Applying DROP to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_symbol"
[0m22:33:14.575237 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a"
[0m22:33:14.583642 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a"} */
drop table if exists "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_symbol" cascade
[0m22:33:14.592473 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m22:33:14.593653 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.0 seconds
[0m22:33:14.610557 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:33:14.619176 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79: COMMIT
[0m22:33:14.632730 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf: COMMIT
[0m22:33:14.649652 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:33:14.651196 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79"
[0m22:33:14.659266 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf"
[0m22:33:14.667841 [debug] [Thread-4 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_symbol"
[0m22:33:14.680754 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79: COMMIT
[0m22:33:14.690195 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m22:33:14.795607 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf: COMMIT
[0m22:33:14.928163 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a"
[0m22:33:15.031084 [debug] [Thread-3 (]: Writing runtime sql for node "test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f"
[0m22:33:15.057640 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:33:15.197429 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a: BEGIN
[0m22:33:15.218027 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79"
[0m22:33:15.228240 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m22:33:15.301782 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m22:33:15.443223 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a"
[0m22:33:15.453263 [debug] [Thread-2 (]: Writing runtime sql for node "test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf"
[0m22:33:15.463788 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a"} */





  create  table "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_symbol"


    as

  (






select *
from "crypto_warehouse"."public_staging"."stg_crypto_prices"
where symbol is null



  );


[0m22:33:15.478678 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f"
[0m22:33:15.488835 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79"
[0m22:33:15.495693 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f: BEGIN
[0m22:33:15.506986 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf"
[0m22:33:15.508069 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79: BEGIN
[0m22:33:15.517027 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:33:15.524606 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf: BEGIN
[0m22:33:15.534721 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:33:15.542926 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f"
[0m22:33:15.550683 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:33:15.557513 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79"
[0m22:33:15.566054 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (

        select *
        from "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_price_id"


    ) dbt_internal_test
[0m22:33:15.574161 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf"
[0m22:33:15.581618 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (

        select *
        from "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_market_cap"


    ) dbt_internal_test
[0m22:33:15.590515 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:33:15.596762 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (

        select *
        from "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_price_usd"


    ) dbt_internal_test
[0m22:33:15.606392 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:33:15.614477 [debug] [Thread-3 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f (execute): 22:33:13.561444 => 22:33:15.613749
[0m22:33:15.622931 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:33:15.631464 [debug] [Thread-1 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79 (execute): 22:33:13.626618 => 22:33:15.630937
[0m22:33:15.638686 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f: ROLLBACK
[0m22:33:15.650044 [debug] [Thread-2 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf (execute): 22:33:13.724023 => 22:33:15.649577
[0m22:33:15.657445 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79: ROLLBACK
[0m22:33:15.663419 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f: Close
[0m22:33:15.669030 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf: ROLLBACK
[0m22:33:15.675216 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79: Close
[0m22:33:15.681642 [info ] [Thread-3 (]: 7 of 14 PASS not_null_stg_crypto_prices_price_id ............................... [[32mPASS[0m in 2.81s]
[0m22:33:15.690777 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf: Close
[0m22:33:15.705069 [info ] [Thread-1 (]: 6 of 14 PASS not_null_stg_crypto_prices_market_cap ............................. [[32mPASS[0m in 2.84s]
[0m22:33:15.715145 [debug] [Thread-3 (]: Finished running node test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f
[0m22:33:15.724279 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.0 seconds
[0m22:33:15.981578 [info ] [Thread-2 (]: 8 of 14 PASS not_null_stg_crypto_prices_price_usd .............................. [[32mPASS[0m in 2.96s]
[0m22:33:16.062811 [debug] [Thread-1 (]: Finished running node test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79
[0m22:33:16.098281 [debug] [Thread-3 (]: Began running node test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438
[0m22:33:16.157587 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a: COMMIT
[0m22:33:16.242183 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a"
[0m22:33:16.207655 [debug] [Thread-1 (]: Began running node test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39
[0m22:33:16.216914 [info ] [Thread-3 (]: 10 of 14 START test not_null_stg_crypto_prices_volume_24h ...................... [RUN]
[0m22:33:16.187293 [debug] [Thread-2 (]: Finished running node test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf
[0m22:33:16.262893 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a: COMMIT
[0m22:33:16.271970 [info ] [Thread-1 (]: 11 of 14 START test not_null_stg_pipeline_runs_run_id .......................... [RUN]
[0m22:33:16.283426 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f, now test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438)
[0m22:33:16.292620 [debug] [Thread-2 (]: Began running node test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e
[0m22:33:16.347963 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79, now test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39)
[0m22:33:16.364256 [debug] [Thread-3 (]: Began compiling node test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438
[0m22:33:16.369306 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m22:33:16.375841 [info ] [Thread-2 (]: 12 of 14 START test not_null_stg_pipeline_runs_stage ........................... [RUN]
[0m22:33:16.387447 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39
[0m22:33:16.430838 [debug] [Thread-3 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438"
[0m22:33:16.454043 [debug] [Thread-4 (]: Writing runtime sql for node "test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a"
[0m22:33:16.470140 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf, now test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e)
[0m22:33:16.502331 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39"
[0m22:33:16.533837 [debug] [Thread-2 (]: Began compiling node test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e
[0m22:33:16.579275 [debug] [Thread-2 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e"
[0m22:33:16.616978 [debug] [Thread-1 (]: Timing info for test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39 (compile): 22:33:16.479444 => 22:33:16.616100
[0m22:33:16.622727 [debug] [Thread-3 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438 (compile): 22:33:16.403548 => 22:33:16.621663
[0m22:33:16.627086 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a"
[0m22:33:16.631932 [debug] [Thread-1 (]: Began executing node test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39
[0m22:33:16.656155 [debug] [Thread-3 (]: Began executing node test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438
[0m22:33:16.662082 [debug] [Thread-2 (]: Timing info for test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e (compile): 22:33:16.559834 => 22:33:16.661426
[0m22:33:16.665262 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a: BEGIN
[0m22:33:16.697459 [debug] [Thread-1 (]: Applying DROP to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_run_id"
[0m22:33:16.725835 [debug] [Thread-3 (]: Applying DROP to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_volume_24h"
[0m22:33:16.741473 [debug] [Thread-2 (]: Began executing node test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e
[0m22:33:16.778141 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m22:33:16.801148 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39"
[0m22:33:16.814862 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438"
[0m22:33:16.837627 [debug] [Thread-2 (]: Applying DROP to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_stage"
[0m22:33:16.842616 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a"
[0m22:33:16.850633 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39"} */
drop table if exists "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_run_id" cascade
[0m22:33:16.880407 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438"} */
drop table if exists "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_volume_24h" cascade
[0m22:33:16.890758 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e"
[0m22:33:16.898712 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (

        select *
        from "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_symbol"


    ) dbt_internal_test
[0m22:33:16.907502 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:33:16.915522 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:33:16.924317 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e"} */
drop table if exists "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_stage" cascade
[0m22:33:16.933063 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:33:16.945956 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:33:17.023097 [debug] [Thread-1 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_run_id"
[0m22:33:16.967096 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:33:17.005557 [debug] [Thread-4 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a (execute): 22:33:14.551009 => 22:33:17.004949
[0m22:33:16.962937 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:33:17.065503 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39"
[0m22:33:17.089565 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:33:17.180595 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a: ROLLBACK
[0m22:33:17.225990 [debug] [Thread-3 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_volume_24h"
[0m22:33:17.271930 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39: BEGIN
[0m22:33:17.306188 [debug] [Thread-2 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_stage"
[0m22:33:17.354850 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a: Close
[0m22:33:17.421063 [info ] [Thread-4 (]: 9 of 14 PASS not_null_stg_crypto_prices_symbol ................................. [[32mPASS[0m in 3.03s]
[0m22:33:17.393389 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:33:17.409585 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e"
[0m22:33:17.380874 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438"
[0m22:33:17.487106 [debug] [Thread-4 (]: Finished running node test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a
[0m22:33:17.562454 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39"
[0m22:33:17.586536 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e: BEGIN
[0m22:33:17.595887 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438: BEGIN
[0m22:33:17.691436 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:33:17.654528 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39"} */





  create  table "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_run_id"


    as

  (






select *
from "crypto_warehouse"."public_staging"."stg_pipeline_runs"
where run_id is null



  );


[0m22:33:17.676115 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:33:17.609427 [debug] [Thread-4 (]: Began running node test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd
[0m22:33:17.746944 [info ] [Thread-4 (]: 13 of 14 START test not_null_stg_pipeline_runs_status .......................... [RUN]
[0m22:33:17.737259 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e"
[0m22:33:17.705223 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438"
[0m22:33:17.758668 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a, now test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd)
[0m22:33:17.769609 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e"} */





  create  table "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_stage"


    as

  (






select *
from "crypto_warehouse"."public_staging"."stg_pipeline_runs"
where stage is null



  );


[0m22:33:17.778569 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438"} */





  create  table "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_volume_24h"


    as

  (






select *
from "crypto_warehouse"."public_staging"."stg_crypto_prices"
where volume_24h is null



  );


[0m22:33:17.791826 [debug] [Thread-4 (]: Began compiling node test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd
[0m22:33:17.824634 [debug] [Thread-4 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd"
[0m22:33:17.847024 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m22:33:17.874157 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39: COMMIT
[0m22:33:17.883267 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39"
[0m22:33:17.892324 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39: COMMIT
[0m22:33:17.916192 [debug] [Thread-4 (]: Timing info for test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd (compile): 22:33:17.813846 => 22:33:17.915153
[0m22:33:17.927969 [debug] [Thread-4 (]: Began executing node test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd
[0m22:33:17.954737 [debug] [Thread-4 (]: Applying DROP to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_status"
[0m22:33:17.964346 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd"
[0m22:33:17.973890 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd"} */
drop table if exists "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_status" cascade
[0m22:33:17.984637 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:33:18.001580 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:33:18.011981 [debug] [Thread-4 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_status"
[0m22:33:18.014094 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.0 seconds
[0m22:33:18.022957 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd"
[0m22:33:18.025052 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:33:18.032133 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e: COMMIT
[0m22:33:18.038842 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd: BEGIN
[0m22:33:18.048990 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39"
[0m22:33:18.056627 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e"
[0m22:33:18.065348 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m22:33:18.089606 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e: COMMIT
[0m22:33:18.100839 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd"
[0m22:33:18.124386 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd"} */





  create  table "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_status"


    as

  (






select *
from "crypto_warehouse"."public_staging"."stg_pipeline_runs"
where status is null



  );


[0m22:33:18.136044 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.0 seconds
[0m22:33:18.143718 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39"
[0m22:33:18.146804 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438: COMMIT
[0m22:33:18.155248 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39: BEGIN
[0m22:33:18.163461 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438"
[0m22:33:18.172546 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:33:18.179153 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438: COMMIT
[0m22:33:18.187592 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39"
[0m22:33:18.191994 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m22:33:18.204314 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (

        select *
        from "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_run_id"


    ) dbt_internal_test
[0m22:33:18.214082 [debug] [Thread-2 (]: Writing runtime sql for node "test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e"
[0m22:33:18.224064 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:33:18.241818 [debug] [Thread-1 (]: Timing info for test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39 (execute): 22:33:16.676079 => 22:33:18.241016
[0m22:33:18.256024 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39: ROLLBACK
[0m22:33:18.265656 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39: Close
[0m22:33:18.275801 [info ] [Thread-1 (]: 11 of 14 PASS not_null_stg_pipeline_runs_run_id ................................ [[32mPASS[0m in 1.93s]
[0m22:33:18.297226 [debug] [Thread-1 (]: Finished running node test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39
[0m22:33:18.316365 [debug] [Thread-1 (]: Began running node test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43
[0m22:33:18.317702 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e"
[0m22:33:18.327799 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.0 seconds
[0m22:33:18.328891 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m22:33:18.486019 [info ] [Thread-1 (]: 14 of 14 START test unique_stg_crypto_prices_price_id .......................... [RUN]
[0m22:33:18.533600 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e: BEGIN
[0m22:33:18.543575 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd: COMMIT
[0m22:33:18.553783 [debug] [Thread-3 (]: Writing runtime sql for node "test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438"
[0m22:33:18.563844 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39, now test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43)
[0m22:33:18.572816 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:33:18.580103 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd"
[0m22:33:18.596811 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43
[0m22:33:18.605552 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e"
[0m22:33:18.614723 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd: COMMIT
[0m22:33:18.647806 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43"
[0m22:33:18.655263 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (

        select *
        from "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_stage"


    ) dbt_internal_test
[0m22:33:18.662427 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438"
[0m22:33:18.681723 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:33:18.689299 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438: BEGIN
[0m22:33:18.702488 [debug] [Thread-2 (]: Timing info for test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e (execute): 22:33:16.825237 => 22:33:18.701701
[0m22:33:18.711426 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:33:18.734672 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e: ROLLBACK
[0m22:33:18.743820 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438"
[0m22:33:18.746887 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m22:33:18.752703 [debug] [Thread-1 (]: Timing info for test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43 (compile): 22:33:18.622955 => 22:33:18.751962
[0m22:33:18.754513 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e: Close
[0m22:33:18.762389 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (

        select *
        from "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_volume_24h"


    ) dbt_internal_test
[0m22:33:18.772464 [debug] [Thread-4 (]: Writing runtime sql for node "test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd"
[0m22:33:18.782472 [debug] [Thread-1 (]: Began executing node test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43
[0m22:33:18.792548 [info ] [Thread-2 (]: 12 of 14 PASS not_null_stg_pipeline_runs_stage ................................. [[32mPASS[0m in 2.32s]
[0m22:33:18.808806 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:33:18.852246 [debug] [Thread-1 (]: Applying DROP to: "crypto_warehouse"."public_dbt_test__audit"."unique_stg_crypto_prices_price_id"
[0m22:33:18.871750 [debug] [Thread-2 (]: Finished running node test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e
[0m22:33:18.894226 [debug] [Thread-3 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438 (execute): 22:33:16.703012 => 22:33:18.893590
[0m22:33:18.909546 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43"
[0m22:33:18.931427 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438: ROLLBACK
[0m22:33:18.941782 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd"
[0m22:33:18.943240 [debug] [Thread-1 (]: On test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43"} */
drop table if exists "crypto_warehouse"."public_dbt_test__audit"."unique_stg_crypto_prices_price_id" cascade
[0m22:33:18.963003 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438: Close
[0m22:33:18.970223 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd: BEGIN
[0m22:33:18.978670 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:33:18.988804 [info ] [Thread-3 (]: 10 of 14 PASS not_null_stg_crypto_prices_volume_24h ............................ [[32mPASS[0m in 2.71s]
[0m22:33:19.004167 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m22:33:19.018141 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:33:19.022929 [debug] [Thread-3 (]: Finished running node test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438
[0m22:33:19.033662 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd"
[0m22:33:19.041226 [debug] [Thread-1 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."unique_stg_crypto_prices_price_id"
[0m22:33:19.057812 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (

        select *
        from "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_status"


    ) dbt_internal_test
[0m22:33:19.066181 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43"
[0m22:33:19.073797 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:33:19.078190 [debug] [Thread-1 (]: On test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43: BEGIN
[0m22:33:19.091407 [debug] [Thread-4 (]: Timing info for test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd (execute): 22:33:17.935776 => 22:33:19.090360
[0m22:33:19.107314 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:33:19.122555 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd: ROLLBACK
[0m22:33:19.134960 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43"
[0m22:33:19.143031 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd: Close
[0m22:33:19.151498 [debug] [Thread-1 (]: On test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43"} */





  create  table "crypto_warehouse"."public_dbt_test__audit"."unique_stg_crypto_prices_price_id"


    as

  (




select
    price_id as unique_field,
    count(*) as n_records

from "crypto_warehouse"."public_staging"."stg_crypto_prices"
where price_id is not null
group by price_id
having count(*) > 1



  );


[0m22:33:19.162078 [info ] [Thread-4 (]: 13 of 14 PASS not_null_stg_pipeline_runs_status ................................ [[32mPASS[0m in 1.40s]
[0m22:33:19.176086 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m22:33:19.183970 [debug] [Thread-4 (]: Finished running node test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd
[0m22:33:19.194535 [debug] [Thread-1 (]: On test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43: COMMIT
[0m22:33:19.211733 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43"
[0m22:33:19.220505 [debug] [Thread-1 (]: On test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43: COMMIT
[0m22:33:19.351180 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:33:19.359964 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43"
[0m22:33:19.439792 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43"
[0m22:33:19.451709 [debug] [Thread-1 (]: On test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43: BEGIN
[0m22:33:19.462794 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:33:19.487605 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43"
[0m22:33:19.513278 [debug] [Thread-1 (]: On test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (

        select *
        from "crypto_warehouse"."public_dbt_test__audit"."unique_stg_crypto_prices_price_id"


    ) dbt_internal_test
[0m22:33:19.526383 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:33:19.542660 [debug] [Thread-1 (]: Timing info for test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43 (execute): 22:33:18.829274 => 22:33:19.541937
[0m22:33:19.553955 [debug] [Thread-1 (]: On test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43: ROLLBACK
[0m22:33:19.570018 [debug] [Thread-1 (]: On test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43: Close
[0m22:33:19.579818 [info ] [Thread-1 (]: 14 of 14 PASS unique_stg_crypto_prices_price_id ................................ [[32mPASS[0m in 1.02s]
[0m22:33:19.595718 [debug] [Thread-1 (]: Finished running node test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43
[0m22:33:19.613155 [debug] [MainThread]: Using postgres connection "master"
[0m22:33:19.658735 [debug] [MainThread]: On master: BEGIN
[0m22:33:19.677560 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:33:19.708439 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:33:19.719241 [debug] [MainThread]: On master: COMMIT
[0m22:33:19.727339 [debug] [MainThread]: Using postgres connection "master"
[0m22:33:19.736163 [debug] [MainThread]: On master: COMMIT
[0m22:33:19.744391 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:33:19.753112 [debug] [MainThread]: On master: Close
[0m22:33:19.761342 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:33:19.772825 [debug] [MainThread]: Connection 'test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438' was properly closed.
[0m22:33:19.794978 [debug] [MainThread]: Connection 'test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e' was properly closed.
[0m22:33:19.808596 [debug] [MainThread]: Connection 'test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43' was properly closed.
[0m22:33:19.818009 [debug] [MainThread]: Connection 'test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd' was properly closed.
[0m22:33:19.825362 [info ] [MainThread]:
[0m22:33:19.833880 [info ] [MainThread]: Finished running 14 tests in 0 hours 0 minutes and 10.83 seconds (10.83s).
[0m22:33:19.848337 [debug] [MainThread]: Command end result
[0m22:33:20.014820 [info ] [MainThread]:
[0m22:33:20.024925 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:33:20.036974 [info ] [MainThread]:
[0m22:33:20.049350 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
[0m22:33:20.063535 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 22.384842, "process_user_time": 10.075634, "process_kernel_time": 0.982247, "process_mem_max_rss": "130920", "process_out_blocks": "1976", "process_in_blocks": "0"}
[0m22:33:20.073421 [debug] [MainThread]: Command `dbt test` succeeded at 22:33:20.072985 after 22.39 seconds
[0m22:33:20.094148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1726347cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f171fc1a550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f171fda5850>]}
[0m22:33:20.114542 [debug] [MainThread]: Flushing usage events
[0m22:33:52.186446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44ea813350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44e9691d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44e91c4e50>]}


============================== 22:33:52.211611 | 7b2477e7-0921-4ff7-bc78-985e3b282da4 ==============================
[0m22:33:52.211611 [info ] [MainThread]: Running with dbt=1.7.0
[0m22:33:52.248817 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /app/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:33:54.894454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b2477e7-0921-4ff7-bc78-985e3b282da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44e91ff350>]}
[0m22:33:55.244725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b2477e7-0921-4ff7-bc78-985e3b282da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44e91ff350>]}
[0m22:33:55.258644 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m22:33:55.506732 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m22:34:03.633539 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:34:03.638573 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:34:03.663055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b2477e7-0921-4ff7-bc78-985e3b282da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44e77fc490>]}
[0m22:34:03.830886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b2477e7-0921-4ff7-bc78-985e3b282da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44e91fff90>]}
[0m22:34:03.838348 [info ] [MainThread]: Found 7 models, 14 tests, 2 sources, 0 exposures, 0 metrics, 517 macros, 0 groups, 0 semantic models
[0m22:34:03.870876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b2477e7-0921-4ff7-bc78-985e3b282da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44e7997410>]}
[0m22:34:03.892965 [info ] [MainThread]:
[0m22:34:03.921733 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:34:03.955218 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse'
[0m22:34:03.958183 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse'
[0m22:34:04.290681 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse"
[0m22:34:04.299349 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse"
[0m22:34:04.337740 [debug] [ThreadPool]: On list_crypto_warehouse: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse"} */

    select distinct nspname from pg_namespace

[0m22:34:04.370508 [debug] [ThreadPool]: On list_crypto_warehouse: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse"} */

    select distinct nspname from pg_namespace

[0m22:34:04.386107 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:34:04.397649 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:34:04.425580 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m22:34:04.432257 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m22:34:04.438807 [debug] [ThreadPool]: On list_crypto_warehouse: Close
[0m22:34:04.451401 [debug] [ThreadPool]: On list_crypto_warehouse: Close
[0m22:34:04.476389 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_warehouse, now list_crypto_warehouse_public_dbt_test__audit)
[0m22:34:04.480341 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_warehouse, now list_crypto_warehouse_public_marts)
[0m22:34:04.482860 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse_public_staging'
[0m22:34:04.508623 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_dbt_test__audit"
[0m22:34:04.515396 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_marts"
[0m22:34:04.555784 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_staging"
[0m22:34:04.569392 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: BEGIN
[0m22:34:04.585245 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: BEGIN
[0m22:34:04.602048 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: BEGIN
[0m22:34:04.617220 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:34:04.632295 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:34:04.646052 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:34:04.661492 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:34:04.682105 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:34:04.699022 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:34:04.711690 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_dbt_test__audit"
[0m22:34:04.725207 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_marts"
[0m22:34:04.747628 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_staging"
[0m22:34:04.763379 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_dbt_test__audit"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'

[0m22:34:04.841491 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_marts"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'

[0m22:34:04.854330 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_staging"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'

[0m22:34:04.879752 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m22:34:04.889765 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m22:34:04.904514 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m22:34:04.909371 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: ROLLBACK
[0m22:34:04.931533 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: ROLLBACK
[0m22:34:04.946123 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: ROLLBACK
[0m22:34:04.963101 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: Close
[0m22:34:04.970698 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: Close
[0m22:34:04.980877 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: Close
[0m22:34:05.051247 [debug] [MainThread]: Using postgres connection "master"
[0m22:34:05.078854 [debug] [MainThread]: On master: BEGIN
[0m22:34:05.089797 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:34:05.109560 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:34:05.119854 [debug] [MainThread]: Using postgres connection "master"
[0m22:34:05.133244 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:34:05.169527 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m22:34:05.196575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b2477e7-0921-4ff7-bc78-985e3b282da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44e9692250>]}
[0m22:34:05.213687 [debug] [MainThread]: On master: ROLLBACK
[0m22:34:05.224134 [debug] [MainThread]: Using postgres connection "master"
[0m22:34:05.234311 [debug] [MainThread]: On master: BEGIN
[0m22:34:05.249172 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:34:05.258233 [debug] [MainThread]: On master: COMMIT
[0m22:34:05.268276 [debug] [MainThread]: Using postgres connection "master"
[0m22:34:05.279225 [debug] [MainThread]: On master: COMMIT
[0m22:34:05.287383 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:34:05.297737 [debug] [MainThread]: On master: Close
[0m22:34:05.305689 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:34:05.437508 [info ] [MainThread]:
[0m22:34:05.498175 [debug] [Thread-1 (]: Began running node model.crypto_analytics.stg_crypto_prices
[0m22:34:05.499238 [debug] [Thread-2 (]: Began running node model.crypto_analytics.stg_pipeline_runs
[0m22:34:05.521322 [info ] [Thread-1 (]: 1 of 5 START sql table model public_staging.stg_crypto_prices .................. [RUN]
[0m22:34:05.587504 [info ] [Thread-2 (]: 2 of 5 START sql view model public_staging.stg_pipeline_runs ................... [RUN]
[0m22:34:05.605907 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_staging, now model.crypto_analytics.stg_crypto_prices)
[0m22:34:05.613532 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_marts, now model.crypto_analytics.stg_pipeline_runs)
[0m22:34:05.619573 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics.stg_crypto_prices
[0m22:34:05.627788 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics.stg_pipeline_runs
[0m22:34:05.656605 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics.stg_crypto_prices"
[0m22:34:05.668055 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics.stg_pipeline_runs"
[0m22:34:05.778644 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.stg_pipeline_runs (compile): 22:34:05.659549 => 22:34:05.777928
[0m22:34:05.797132 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.stg_crypto_prices (compile): 22:34:05.634950 => 22:34:05.796428
[0m22:34:05.803284 [debug] [Thread-2 (]: Began executing node model.crypto_analytics.stg_pipeline_runs
[0m22:34:05.834847 [debug] [Thread-1 (]: Began executing node model.crypto_analytics.stg_crypto_prices
[0m22:34:06.137829 [debug] [Thread-2 (]: Writing runtime sql for node "model.crypto_analytics.stg_pipeline_runs"
[0m22:34:06.146395 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics.stg_crypto_prices"
[0m22:34:06.180067 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m22:34:06.189739 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:34:06.204791 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: BEGIN
[0m22:34:06.213594 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: BEGIN
[0m22:34:06.223897 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:34:06.232017 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:34:06.245852 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:34:06.257117 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:34:06.262078 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m22:34:06.270353 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:34:06.277780 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */

  create view "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_tmp"


  as (
    SELECT
    id as run_id,
    run_id as run_identifier,
    stage,
    status,
    records_processed,
    error_message,
    started_at,
    completed_at,
    CASE
        WHEN completed_at IS NOT NULL
        THEN EXTRACT(EPOCH FROM (completed_at - started_at))
        ELSE NULL
    END as duration_seconds
FROM "crypto_warehouse"."public"."pipeline_runs"
  );
[0m22:34:06.284537 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */




  create  table "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_tmp"


    as

  (


WITH source_data AS (
    SELECT
        id as price_id,
        UPPER(TRIM(symbol)) as symbol,
        TRIM(name) as crypto_name,
        current_price as price_usd,
        market_cap,
        total_volume as volume_24h,
        price_change_24h,
        price_change_percentage_24h as price_change_pct_24h,
        market_cap_rank,
        extracted_at,
        created_at,

        CASE WHEN current_price <= 0 THEN TRUE ELSE FALSE END as is_invalid_price,
        CASE WHEN market_cap <= 0 THEN TRUE ELSE FALSE END as is_invalid_market_cap,
        CASE WHEN total_volume < 0 THEN TRUE ELSE FALSE END as is_invalid_volume
    FROM "crypto_warehouse"."public"."crypto_prices_raw"
),

cleaned_data AS (
    SELECT
        *,
        DATE(extracted_at) as extraction_date,
        DATE_TRUNC('hour', extracted_at) as extraction_hour,
        CASE
            WHEN LAG(price_usd) OVER (
                PARTITION BY symbol ORDER BY extracted_at
            ) IS NOT NULL THEN
                ((price_usd - LAG(price_usd) OVER (
                    PARTITION BY symbol ORDER BY extracted_at
                )) / LAG(price_usd) OVER (
                    PARTITION BY symbol ORDER BY extracted_at
                )) * 100
        END as price_change_pct_from_previous
    FROM source_data
    WHERE NOT is_invalid_price AND NOT is_invalid_volume
)

SELECT * FROM cleaned_data
  );

[0m22:34:06.294625 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m22:34:06.317182 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m22:34:06.327957 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */
alter table "crypto_warehouse"."public_staging"."stg_pipeline_runs" rename to "stg_pipeline_runs__dbt_backup"
[0m22:34:06.338521 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:34:06.355746 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m22:34:06.363111 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */
alter table "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_tmp" rename to "stg_pipeline_runs"
[0m22:34:06.371244 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:34:06.413068 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: COMMIT
[0m22:34:06.421318 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m22:34:06.427132 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: COMMIT
[0m22:34:06.477535 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.0 seconds
[0m22:34:06.490626 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:34:06.497032 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */
alter table "crypto_warehouse"."public_staging"."stg_crypto_prices" rename to "stg_crypto_prices__dbt_backup"
[0m22:34:06.504159 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:34:06.519454 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:34:06.528124 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */
alter table "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_tmp" rename to "stg_crypto_prices"
[0m22:34:06.532820 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m22:34:06.536458 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:34:06.657730 [debug] [Thread-2 (]: Applying DROP to: "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_backup"
[0m22:34:06.669579 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:34:06.686638 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m22:34:06.690876 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */

        CREATE INDEX IF NOT EXISTS idx_stg_crypto_prices_symbol_time ON "crypto_warehouse"."public_staging"."stg_crypto_prices" (symbol, extracted_at)

[0m22:34:06.697594 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */
drop view if exists "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_backup" cascade
[0m22:34:06.864991 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m22:34:06.881979 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.stg_pipeline_runs (execute): 22:34:05.865575 => 22:34:06.881230
[0m22:34:06.891805 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: Close
[0m22:34:06.901730 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b2477e7-0921-4ff7-bc78-985e3b282da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44e777fe10>]}
[0m22:34:06.911759 [info ] [Thread-2 (]: 2 of 5 OK created sql view model public_staging.stg_pipeline_runs .............. [[32mCREATE VIEW[0m in 1.29s]
[0m22:34:06.921758 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:34:06.927814 [debug] [Thread-2 (]: Finished running node model.crypto_analytics.stg_pipeline_runs
[0m22:34:06.943559 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: COMMIT
[0m22:34:06.974808 [debug] [Thread-4 (]: Began running node model.crypto_analytics.mart_pipeline_monitoring
[0m22:34:07.212202 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:34:07.252699 [info ] [Thread-4 (]: 3 of 5 START sql table model public_marts.mart_pipeline_monitoring ............. [RUN]
[0m22:34:07.262135 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: COMMIT
[0m22:34:07.296208 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.crypto_analytics.mart_pipeline_monitoring'
[0m22:34:07.326617 [debug] [Thread-4 (]: Began compiling node model.crypto_analytics.mart_pipeline_monitoring
[0m22:34:07.346214 [debug] [Thread-4 (]: Writing injected SQL for node "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:34:07.394244 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:34:07.411250 [debug] [Thread-4 (]: Timing info for model.crypto_analytics.mart_pipeline_monitoring (compile): 22:34:07.336085 => 22:34:07.410491
[0m22:34:07.412727 [debug] [Thread-1 (]: Applying DROP to: "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_backup"
[0m22:34:07.443729 [debug] [Thread-4 (]: Began executing node model.crypto_analytics.mart_pipeline_monitoring
[0m22:34:07.484195 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:34:07.514843 [debug] [Thread-4 (]: Writing runtime sql for node "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:34:07.526312 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */
drop table if exists "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_backup" cascade
[0m22:34:07.634215 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:34:07.677750 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.stg_crypto_prices (execute): 22:34:05.935493 => 22:34:07.676991
[0m22:34:07.694125 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:34:07.700400 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: Close
[0m22:34:07.715010 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: BEGIN
[0m22:34:07.732373 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b2477e7-0921-4ff7-bc78-985e3b282da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44e7938650>]}
[0m22:34:07.743695 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:34:07.756994 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public_staging.stg_crypto_prices ............. [[32mSELECT 15[0m in 2.13s]
[0m22:34:07.776307 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m22:34:07.783706 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.stg_crypto_prices
[0m22:34:07.794330 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:34:07.805488 [debug] [Thread-2 (]: Began running node model.crypto_analytics.int_crypto_daily_aggs
[0m22:34:07.806574 [debug] [Thread-3 (]: Began running node model.crypto_analytics.int_crypto_hourly_aggs
[0m22:34:07.807709 [debug] [Thread-1 (]: Began running node model.crypto_analytics.mart_crypto_latest_prices
[0m22:34:07.815153 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */




  create  table "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_tmp"


    as

  (


WITH pipeline_metrics AS (
    SELECT
        run_id,
        stage,
        status,
        records_processed,
        error_message,
        started_at,
        completed_at,
        EXTRACT(EPOCH FROM completed_at - started_at) AS duration_seconds,

        -- Flag to compute success rate
        CASE WHEN status = 'success' THEN 1 ELSE 0 END AS is_success,

        -- Classify performance
        CASE
            WHEN completed_at IS NULL THEN 'Running'
            WHEN EXTRACT(EPOCH FROM completed_at - started_at) < 30 THEN 'Fast'
            WHEN EXTRACT(EPOCH FROM completed_at - started_at) < 120 THEN 'Normal'
            ELSE 'Slow'
        END AS performance_category

    FROM "crypto_warehouse"."public_staging"."stg_pipeline_runs"
),

latest_status_per_day_stage AS (
    SELECT
        DATE(started_at) AS run_date,
        stage,
        FIRST_VALUE(status) OVER (
            PARTITION BY DATE(started_at), stage
            ORDER BY started_at DESC
        ) AS latest_run_status
    FROM pipeline_metrics
),

daily_summary AS (
    SELECT
        DATE(started_at) AS run_date,
        stage,

        COUNT(*) AS total_runs,
        SUM(is_success) AS successful_runs,
        SUM(records_processed) AS total_records_processed,
        AVG(duration_seconds) AS avg_duration_seconds,
        MAX(duration_seconds) AS max_duration_seconds,
        ROUND(((SUM(is_success)::FLOAT / COUNT(*)) * 100)::NUMERIC, 2) AS success_rate_pct


    FROM pipeline_metrics
    WHERE started_at >= CURRENT_DATE - INTERVAL '30 days'
    GROUP BY DATE(started_at), stage
)

-- Final result combining metrics with latest run status
SELECT
    ds.*,
    ls.latest_run_status
FROM daily_summary ds
LEFT JOIN latest_status_per_day_stage ls
  ON ds.run_date = ls.run_date AND ds.stage = ls.stage
  );

[0m22:34:07.827287 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.stg_pipeline_runs, now model.crypto_analytics.int_crypto_daily_aggs)
[0m22:34:07.839345 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_dbt_test__audit, now model.crypto_analytics.int_crypto_hourly_aggs)
[0m22:34:07.859849 [info ] [Thread-1 (]: 4 of 5 START sql table model public_marts.mart_crypto_latest_prices ............ [RUN]
[0m22:34:07.898434 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics.int_crypto_daily_aggs
[0m22:34:07.911353 [debug] [Thread-3 (]: Began compiling node model.crypto_analytics.int_crypto_hourly_aggs
[0m22:34:07.924274 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.stg_crypto_prices, now model.crypto_analytics.mart_crypto_latest_prices)
[0m22:34:07.946024 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics.int_crypto_daily_aggs"
[0m22:34:07.980986 [debug] [Thread-3 (]: Writing injected SQL for node "model.crypto_analytics.int_crypto_hourly_aggs"
[0m22:34:08.021737 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics.mart_crypto_latest_prices
[0m22:34:08.044702 [debug] [Thread-4 (]: SQL status: SELECT 6 in 0.0 seconds
[0m22:34:08.059536 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:34:08.078395 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:34:08.109026 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.int_crypto_daily_aggs (compile): 22:34:07.937596 => 22:34:08.108422
[0m22:34:08.115652 [debug] [Thread-3 (]: Timing info for model.crypto_analytics.int_crypto_hourly_aggs (compile): 22:34:07.962734 => 22:34:08.114989
[0m22:34:08.119671 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */
alter table "crypto_warehouse"."public_marts"."mart_pipeline_monitoring" rename to "mart_pipeline_monitoring__dbt_backup"
[0m22:34:08.129035 [debug] [Thread-2 (]: Finished running node model.crypto_analytics.int_crypto_daily_aggs
[0m22:34:08.143872 [debug] [Thread-3 (]: Finished running node model.crypto_analytics.int_crypto_hourly_aggs
[0m22:34:08.159044 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:34:08.177198 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.mart_crypto_latest_prices (compile): 22:34:08.050118 => 22:34:08.176328
[0m22:34:08.238746 [debug] [Thread-2 (]: Began running node model.crypto_analytics.mart_crypto_hourly_performance
[0m22:34:08.258633 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:34:08.264747 [debug] [Thread-1 (]: Began executing node model.crypto_analytics.mart_crypto_latest_prices
[0m22:34:08.276687 [info ] [Thread-2 (]: 5 of 5 START sql table model public_marts.mart_crypto_hourly_performance ....... [RUN]
[0m22:34:08.299933 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */
alter table "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_tmp" rename to "mart_pipeline_monitoring"
[0m22:34:08.335698 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:34:08.405064 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.int_crypto_daily_aggs, now model.crypto_analytics.mart_crypto_hourly_performance)
[0m22:34:08.415361 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:34:08.432231 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics.mart_crypto_hourly_performance
[0m22:34:08.512436 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:34:08.534483 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:34:08.536112 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */

    create  index if not exists
  "728c8906ad7e92ca46f5a57b2aebd5a2"
  on "crypto_warehouse"."public_marts"."mart_pipeline_monitoring" using btree
  (run_date);

[0m22:34:08.549391 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: BEGIN
[0m22:34:08.592749 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:34:08.601012 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:34:08.629591 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:34:08.649946 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:34:08.664458 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */




  create  table "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_tmp"


    as

  (


WITH latest_prices AS (
    SELECT
        symbol,
        crypto_name,
        price_usd,
        market_cap,
        volume_24h,
        price_change_24h,
        price_change_pct_24h,
        market_cap_rank,
        extracted_at,

        ROW_NUMBER() OVER (
            PARTITION BY symbol
            ORDER BY extracted_at DESC
        ) as rn

    FROM "crypto_warehouse"."public_staging"."stg_crypto_prices"
    WHERE extraction_date = CURRENT_DATE
),

price_changes AS (
    SELECT
        symbol,
        crypto_name,
        price_usd as current_price,
        market_cap,
        volume_24h,
        price_change_24h,
        price_change_pct_24h,
        market_cap_rank,
        extracted_at as last_updated,

        -- Calculate additional metrics
        CASE
            WHEN price_change_pct_24h > 10 THEN 'Strong Gain'
            WHEN price_change_pct_24h > 5 THEN 'Moderate Gain'
            WHEN price_change_pct_24h > 0 THEN 'Slight Gain'
            WHEN price_change_pct_24h > -5 THEN 'Slight Loss'
            WHEN price_change_pct_24h > -10 THEN 'Moderate Loss'
            ELSE 'Strong Loss'
        END as price_trend_category,

        -- Market cap category
        CASE
            WHEN market_cap_rank <= 10 THEN 'Large Cap'
            WHEN market_cap_rank <= 50 THEN 'Mid Cap'
            WHEN market_cap_rank <= 100 THEN 'Small Cap'
            ELSE 'Micro Cap'
        END as market_cap_category

    FROM latest_prices
    WHERE rn = 1
)

SELECT * FROM price_changes
  );

[0m22:34:08.698394 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.mart_crypto_hourly_performance (compile): 22:34:08.483026 => 22:34:08.697694
[0m22:34:08.707455 [debug] [Thread-2 (]: Began executing node model.crypto_analytics.mart_crypto_hourly_performance
[0m22:34:08.736101 [debug] [Thread-2 (]: Writing runtime sql for node "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:34:08.833459 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:34:08.900778 [debug] [Thread-4 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:34:08.910236 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: BEGIN
[0m22:34:08.944653 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:34:08.984544 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:34:09.010543 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */

    create  index if not exists
  "60ec186cb373053832523c35c338d030"
  on "crypto_warehouse"."public_marts"."mart_pipeline_monitoring" using btree
  (stage);

[0m22:34:09.044636 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:34:09.055998 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.0 seconds
[0m22:34:09.096116 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:34:09.160124 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:34:09.179063 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */




  create  table "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_tmp"


    as

  (


WITH  __dbt__cte__int_crypto_hourly_aggs as (


WITH base_data AS (
    SELECT
        symbol,
        crypto_name,
        DATE_TRUNC('hour', extracted_at) AS extraction_hour,
        price_usd,
        volume_24h,
        market_cap,
        CASE WHEN price_usd <= 0 THEN 1 ELSE 0 END AS is_invalid
    FROM "crypto_warehouse"."public_staging"."stg_crypto_prices"
)

SELECT
    symbol,
    crypto_name,
    extraction_hour,
    COUNT(*) AS total_records,
    SUM(is_invalid) AS invalid_price_records,
    AVG(price_usd) AS avg_price_usd,
    MIN(price_usd) AS min_price_usd,
    MAX(price_usd) AS max_price_usd,
    STDDEV(price_usd) AS price_volatility,
    AVG(volume_24h) AS avg_volume_24h,
    AVG(market_cap) AS avg_market_cap
FROM base_data
GROUP BY symbol, crypto_name, extraction_hour
), hourly_data AS (
    SELECT
        symbol,
        crypto_name,
        extraction_hour,
        avg_price_usd,
        min_price_usd,
        max_price_usd,
        price_volatility,
        avg_volume_24h,
        avg_market_cap,
        total_records,

        -- Calculate hourly change
        LAG(avg_price_usd) OVER (
            PARTITION BY symbol
            ORDER BY extraction_hour
        ) as previous_hour_price,

        -- Data quality score
        (1.0 - (invalid_price_records::FLOAT / GREATEST(total_records, 1))) * 100 as data_quality_score

    FROM __dbt__cte__int_crypto_hourly_aggs
),

performance_metrics AS (
    SELECT
        *,
        CASE
            WHEN previous_hour_price IS NOT NULL AND previous_hour_price > 0 THEN
                ((avg_price_usd - previous_hour_price) / previous_hour_price) * 100
            ELSE NULL
        END as hourly_change_pct,

        -- Volatility category
        CASE
            WHEN price_volatility IS NULL THEN 'Unknown'
            WHEN price_volatility < avg_price_usd * 0.01 THEN 'Low Volatility'
            WHEN price_volatility < avg_price_usd * 0.05 THEN 'Medium Volatility'
            ELSE 'High Volatility'
        END as volatility_category

    FROM hourly_data
)

SELECT * FROM performance_metrics
  );

[0m22:34:09.208816 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_latest_prices" rename to "mart_crypto_latest_prices__dbt_backup"
[0m22:34:09.209944 [debug] [Thread-4 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:34:09.261115 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:34:09.309254 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: COMMIT
[0m22:34:09.335793 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:34:09.340463 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:34:09.350586 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_tmp" rename to "mart_crypto_latest_prices"
[0m22:34:09.359447 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: COMMIT
[0m22:34:09.368931 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:34:09.388838 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:34:09.403535 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */

    create  index if not exists
  "41cf9b83d2e853770205ec7fd9fe308d"
  on "crypto_warehouse"."public_marts"."mart_crypto_latest_prices" using btree
  (symbol);

[0m22:34:09.412268 [debug] [Thread-2 (]: SQL status: SELECT 10 in 0.0 seconds
[0m22:34:09.440648 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:34:09.449997 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance" rename to "mart_crypto_hourly_performance__dbt_backup"
[0m22:34:09.461487 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:34:09.487681 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:34:09.496115 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_tmp" rename to "mart_crypto_hourly_performance"
[0m22:34:09.500278 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m22:34:09.506737 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:34:09.522020 [debug] [Thread-4 (]: Applying DROP to: "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_backup"
[0m22:34:09.534764 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:34:09.544443 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:34:09.553369 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */

    create  index if not exists
  "50e7e4536596669a21a8f4605f1f75ac"
  on "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance" using btree
  (symbol, extraction_hour);

[0m22:34:09.561902 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */
drop table if exists "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_backup" cascade
[0m22:34:09.567379 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:34:09.592235 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:34:09.600372 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */

    create  index if not exists
  "e1bbc0ea80b5ada24dc4138d0152e04e"
  on "crypto_warehouse"."public_marts"."mart_crypto_latest_prices" using btree
  (market_cap_rank);

[0m22:34:09.722793 [debug] [Thread-2 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:34:09.724999 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:34:09.734600 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:34:09.746080 [debug] [Thread-4 (]: Timing info for model.crypto_analytics.mart_pipeline_monitoring (execute): 22:34:07.492350 => 22:34:09.745484
[0m22:34:09.754862 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */

    create  index if not exists
  "5a027ddee001541d2154d6eeefedf966"
  on "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance" using btree
  (extraction_hour);

[0m22:34:09.763529 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: Close
[0m22:34:09.781213 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b2477e7-0921-4ff7-bc78-985e3b282da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44e7538f50>]}
[0m22:34:09.791190 [info ] [Thread-4 (]: 3 of 5 OK created sql table model public_marts.mart_pipeline_monitoring ........ [[32mSELECT 6[0m in 2.49s]
[0m22:34:09.803562 [debug] [Thread-4 (]: Finished running node model.crypto_analytics.mart_pipeline_monitoring
[0m22:34:09.884136 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:34:10.061306 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: COMMIT
[0m22:34:10.095148 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:34:10.104574 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: COMMIT
[0m22:34:10.122973 [debug] [Thread-2 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:34:10.135353 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: COMMIT
[0m22:34:10.161264 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:34:10.170568 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: COMMIT
[0m22:34:10.200825 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:34:10.220155 [debug] [Thread-1 (]: Applying DROP to: "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_backup"
[0m22:34:10.239353 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:34:10.247763 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */
drop table if exists "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_backup" cascade
[0m22:34:10.267043 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m22:34:10.315678 [debug] [Thread-2 (]: Applying DROP to: "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_backup"
[0m22:34:10.334680 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:34:10.362698 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:34:10.391369 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.mart_crypto_latest_prices (execute): 22:34:08.312100 => 22:34:10.390823
[0m22:34:10.407354 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */
drop table if exists "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_backup" cascade
[0m22:34:10.431441 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: Close
[0m22:34:10.453970 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b2477e7-0921-4ff7-bc78-985e3b282da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44e79a7090>]}
[0m22:34:10.469844 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public_marts.mart_crypto_latest_prices ....... [[32mSELECT 5[0m in 2.53s]
[0m22:34:10.481573 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.mart_crypto_latest_prices
[0m22:34:10.501060 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:34:10.513381 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.mart_crypto_hourly_performance (execute): 22:34:08.715378 => 22:34:10.512600
[0m22:34:10.531491 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: Close
[0m22:34:10.544707 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b2477e7-0921-4ff7-bc78-985e3b282da4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44e910c690>]}
[0m22:34:10.559551 [info ] [Thread-2 (]: 5 of 5 OK created sql table model public_marts.mart_crypto_hourly_performance .. [[32mSELECT 10[0m in 2.14s]
[0m22:34:10.572853 [debug] [Thread-2 (]: Finished running node model.crypto_analytics.mart_crypto_hourly_performance
[0m22:34:10.584929 [debug] [MainThread]: Using postgres connection "master"
[0m22:34:10.593544 [debug] [MainThread]: On master: BEGIN
[0m22:34:10.604004 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:34:10.620950 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:34:10.629021 [debug] [MainThread]: On master: COMMIT
[0m22:34:10.637903 [debug] [MainThread]: Using postgres connection "master"
[0m22:34:10.649278 [debug] [MainThread]: On master: COMMIT
[0m22:34:10.659896 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:34:10.675683 [debug] [MainThread]: On master: Close
[0m22:34:10.686353 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:34:10.696304 [debug] [MainThread]: Connection 'model.crypto_analytics.mart_crypto_hourly_performance' was properly closed.
[0m22:34:10.706745 [debug] [MainThread]: Connection 'model.crypto_analytics.int_crypto_hourly_aggs' was properly closed.
[0m22:34:10.718654 [debug] [MainThread]: Connection 'model.crypto_analytics.mart_crypto_latest_prices' was properly closed.
[0m22:34:10.728587 [debug] [MainThread]: Connection 'model.crypto_analytics.mart_pipeline_monitoring' was properly closed.
[0m22:34:10.739280 [info ] [MainThread]:
[0m22:34:10.754716 [info ] [MainThread]: Finished running 1 view model, 4 table models in 0 hours 0 minutes and 6.82 seconds (6.82s).
[0m22:34:10.794604 [debug] [MainThread]: Command end result
[0m22:34:10.966293 [info ] [MainThread]:
[0m22:34:10.979473 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:34:10.993349 [info ] [MainThread]:
[0m22:34:11.009138 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m22:34:11.029663 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 19.01075, "process_user_time": 9.368299, "process_kernel_time": 0.808989, "process_mem_max_rss": "123908", "process_out_blocks": "1976", "process_in_blocks": "0"}
[0m22:34:11.046264 [debug] [MainThread]: Command `dbt run` succeeded at 22:34:11.045751 after 19.03 seconds
[0m22:34:11.058942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44edb61650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44edb60790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44edb61850>]}
[0m22:34:11.130434 [debug] [MainThread]: Flushing usage events
[0m22:34:53.387569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6c650c950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6c650c850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6c650ee10>]}


============================== 22:34:53.400574 | fdc31f44-a3df-4e91-a40e-94fdd7f5e450 ==============================
[0m22:34:53.400574 [info ] [MainThread]: Running with dbt=1.7.0
[0m22:34:53.406457 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/app/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir /app/dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:34:53.864135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fdc31f44-a3df-4e91-a40e-94fdd7f5e450', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6c4e60050>]}
[0m22:34:54.046840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fdc31f44-a3df-4e91-a40e-94fdd7f5e450', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6c6584310>]}
[0m22:34:54.052951 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m22:34:54.164262 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m22:35:10.139075 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:35:10.163359 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:35:10.196979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fdc31f44-a3df-4e91-a40e-94fdd7f5e450', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6c4e3f5d0>]}
[0m22:35:10.467064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fdc31f44-a3df-4e91-a40e-94fdd7f5e450', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6c4eb6a50>]}
[0m22:35:10.478479 [info ] [MainThread]: Found 7 models, 14 tests, 2 sources, 0 exposures, 0 metrics, 517 macros, 0 groups, 0 semantic models
[0m22:35:10.489746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fdc31f44-a3df-4e91-a40e-94fdd7f5e450', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6c4e1c210>]}
[0m22:35:10.504682 [info ] [MainThread]:
[0m22:35:10.517327 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:35:10.534413 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse'
[0m22:35:10.537536 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse'
[0m22:35:10.607876 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse"
[0m22:35:10.617912 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse"
[0m22:35:10.627591 [debug] [ThreadPool]: On list_crypto_warehouse: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse"} */

    select distinct nspname from pg_namespace

[0m22:35:10.635892 [debug] [ThreadPool]: On list_crypto_warehouse: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse"} */

    select distinct nspname from pg_namespace

[0m22:35:10.646628 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:35:10.654386 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:35:10.685104 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m22:35:10.704035 [debug] [ThreadPool]: On list_crypto_warehouse: Close
[0m22:35:10.712922 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m22:35:10.796808 [debug] [ThreadPool]: On list_crypto_warehouse: Close
[0m22:35:10.825833 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_warehouse, now list_crypto_warehouse_public_staging)
[0m22:35:10.828314 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_warehouse, now list_crypto_warehouse_public_marts)
[0m22:35:10.839589 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse_public_dbt_test__audit'
[0m22:35:10.878274 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_staging"
[0m22:35:10.887074 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_marts"
[0m22:35:10.920256 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_dbt_test__audit"
[0m22:35:10.929632 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: BEGIN
[0m22:35:10.940614 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: BEGIN
[0m22:35:10.950102 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: BEGIN
[0m22:35:10.965597 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:35:10.982113 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:35:10.993858 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:35:11.006432 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:35:11.018260 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:35:11.030931 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:35:11.033718 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_staging"
[0m22:35:11.046509 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_marts"
[0m22:35:11.056003 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_dbt_test__audit"
[0m22:35:11.065678 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_staging"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'

[0m22:35:11.077807 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_marts"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'

[0m22:35:11.085633 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_dbt_test__audit"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'

[0m22:35:11.106916 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m22:35:11.121387 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m22:35:11.131542 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m22:35:11.134875 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: ROLLBACK
[0m22:35:11.148201 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: ROLLBACK
[0m22:35:11.162665 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: ROLLBACK
[0m22:35:11.173101 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: Close
[0m22:35:11.182124 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: Close
[0m22:35:11.190025 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: Close
[0m22:35:11.244480 [debug] [MainThread]: Using postgres connection "master"
[0m22:35:11.249914 [debug] [MainThread]: On master: BEGIN
[0m22:35:11.262510 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:35:11.301420 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:35:11.313255 [debug] [MainThread]: Using postgres connection "master"
[0m22:35:11.321831 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:35:11.351335 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m22:35:11.359616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67744f76d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67744f6f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67744f7510>]}
[0m22:35:11.364303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fdc31f44-a3df-4e91-a40e-94fdd7f5e450', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6c4e4bb50>]}
[0m22:35:11.376572 [debug] [MainThread]: On master: ROLLBACK


============================== 22:35:11.376567 | 22a9fcc6-e795-4f06-89ab-c113f3f3fc22 ==============================
[0m22:35:11.376567 [info ] [MainThread]: Running with dbt=1.7.0
[0m22:35:11.390748 [debug] [MainThread]: Using postgres connection "master"
[0m22:35:11.390780 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/app', 'log_path': '/app/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /app/dbt', 'send_anonymous_usage_stats': 'True'}
[0m22:35:11.415039 [debug] [MainThread]: On master: BEGIN
[0m22:35:11.431146 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:35:11.580626 [debug] [MainThread]: On master: COMMIT
[0m22:35:11.857759 [debug] [MainThread]: Using postgres connection "master"
[0m22:35:12.011414 [debug] [MainThread]: On master: COMMIT
[0m22:35:12.244738 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:35:12.498366 [debug] [MainThread]: On master: Close
[0m22:35:12.531792 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:35:12.579425 [info ] [MainThread]:
[0m22:35:12.729227 [debug] [Thread-1 (]: Began running node model.crypto_analytics.stg_crypto_prices
[0m22:35:12.730602 [debug] [Thread-2 (]: Began running node model.crypto_analytics.stg_pipeline_runs
[0m22:35:12.747296 [info ] [Thread-1 (]: 1 of 5 START sql table model public_staging.stg_crypto_prices .................. [RUN]
[0m22:35:12.764052 [info ] [Thread-2 (]: 2 of 5 START sql view model public_staging.stg_pipeline_runs ................... [RUN]
[0m22:35:12.790269 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_dbt_test__audit, now model.crypto_analytics.stg_crypto_prices)
[0m22:35:12.807013 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_marts, now model.crypto_analytics.stg_pipeline_runs)
[0m22:35:12.827581 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics.stg_crypto_prices
[0m22:35:12.842020 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics.stg_pipeline_runs
[0m22:35:12.914161 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics.stg_crypto_prices"
[0m22:35:12.926729 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics.stg_pipeline_runs"
[0m22:35:13.043135 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.stg_crypto_prices (compile): 22:35:12.854314 => 22:35:13.042368
[0m22:35:13.062656 [debug] [Thread-1 (]: Began executing node model.crypto_analytics.stg_crypto_prices
[0m22:35:13.071798 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.stg_pipeline_runs (compile): 22:35:12.908409 => 22:35:13.071098
[0m22:35:13.131381 [debug] [Thread-2 (]: Began executing node model.crypto_analytics.stg_pipeline_runs
[0m22:35:13.469118 [debug] [Thread-2 (]: Writing runtime sql for node "model.crypto_analytics.stg_pipeline_runs"
[0m22:35:13.502708 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics.stg_crypto_prices"
[0m22:35:13.582440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '22a9fcc6-e795-4f06-89ab-c113f3f3fc22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6774569550>]}
[0m22:35:13.629747 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m22:35:13.961651 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: BEGIN
[0m22:35:14.013126 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:35:14.025586 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:35:14.037812 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:35:14.054068 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: BEGIN
[0m22:35:14.075035 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m22:35:14.088609 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:35:14.107386 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */

  create view "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_tmp"


  as (
    SELECT
    id as run_id,
    run_id as run_identifier,
    stage,
    status,
    records_processed,
    error_message,
    started_at,
    completed_at,
    CASE
        WHEN completed_at IS NOT NULL
        THEN EXTRACT(EPOCH FROM (completed_at - started_at))
        ELSE NULL
    END as duration_seconds
FROM "crypto_warehouse"."public"."pipeline_runs"
  );
[0m22:35:14.131940 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:35:14.159238 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m22:35:14.170460 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:35:14.219439 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m22:35:14.241964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '22a9fcc6-e795-4f06-89ab-c113f3f3fc22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67744f0d10>]}
[0m22:35:14.220771 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */




  create  table "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_tmp"


    as

  (


WITH source_data AS (
    SELECT
        id as price_id,
        UPPER(TRIM(symbol)) as symbol,
        TRIM(name) as crypto_name,
        current_price as price_usd,
        market_cap,
        total_volume as volume_24h,
        price_change_24h,
        price_change_percentage_24h as price_change_pct_24h,
        market_cap_rank,
        extracted_at,
        created_at,

        CASE WHEN current_price <= 0 THEN TRUE ELSE FALSE END as is_invalid_price,
        CASE WHEN market_cap <= 0 THEN TRUE ELSE FALSE END as is_invalid_market_cap,
        CASE WHEN total_volume < 0 THEN TRUE ELSE FALSE END as is_invalid_volume
    FROM "crypto_warehouse"."public"."crypto_prices_raw"
),

cleaned_data AS (
    SELECT
        *,
        DATE(extracted_at) as extraction_date,
        DATE_TRUNC('hour', extracted_at) as extraction_hour,
        CASE
            WHEN LAG(price_usd) OVER (
                PARTITION BY symbol ORDER BY extracted_at
            ) IS NOT NULL THEN
                ((price_usd - LAG(price_usd) OVER (
                    PARTITION BY symbol ORDER BY extracted_at
                )) / LAG(price_usd) OVER (
                    PARTITION BY symbol ORDER BY extracted_at
                )) * 100
        END as price_change_pct_from_previous
    FROM source_data
    WHERE NOT is_invalid_price AND NOT is_invalid_volume
)

SELECT * FROM cleaned_data
  );

[0m22:35:14.256561 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */
alter table "crypto_warehouse"."public_staging"."stg_pipeline_runs" rename to "stg_pipeline_runs__dbt_backup"
[0m22:35:14.262499 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m22:35:14.324698 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:35:14.431746 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m22:35:14.457347 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */
alter table "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_tmp" rename to "stg_pipeline_runs"
[0m22:35:14.476240 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.0 seconds
[0m22:35:14.483934 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:35:14.510801 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:35:14.587469 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */
alter table "crypto_warehouse"."public_staging"."stg_crypto_prices" rename to "stg_crypto_prices__dbt_backup"
[0m22:35:14.634155 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:35:14.663476 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: COMMIT
[0m22:35:14.697638 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:35:14.699456 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m22:35:14.710322 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */
alter table "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_tmp" rename to "stg_crypto_prices"
[0m22:35:14.714958 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m22:35:14.725671 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: COMMIT
[0m22:35:14.738138 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:35:14.806847 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:35:14.808868 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m22:35:14.841086 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */

        CREATE INDEX IF NOT EXISTS idx_stg_crypto_prices_symbol_time ON "crypto_warehouse"."public_staging"."stg_crypto_prices" (symbol, extracted_at)

[0m22:35:15.137980 [debug] [Thread-2 (]: Applying DROP to: "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_backup"
[0m22:35:15.140265 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:35:15.174545 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m22:35:15.180609 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: COMMIT
[0m22:35:15.192045 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */
drop view if exists "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_backup" cascade
[0m22:35:15.205196 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:35:15.227286 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: COMMIT
[0m22:35:15.275493 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m22:35:15.290730 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.stg_pipeline_runs (execute): 22:35:13.184174 => 22:35:15.289864
[0m22:35:15.306402 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: Close
[0m22:35:15.319129 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fdc31f44-a3df-4e91-a40e-94fdd7f5e450', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6c4cf9150>]}
[0m22:35:15.328502 [info ] [Thread-2 (]: 2 of 5 OK created sql view model public_staging.stg_pipeline_runs .............. [[32mCREATE VIEW[0m in 2.51s]
[0m22:35:15.337743 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:35:15.341462 [debug] [Thread-2 (]: Finished running node model.crypto_analytics.stg_pipeline_runs
[0m22:35:15.360466 [debug] [Thread-1 (]: Applying DROP to: "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_backup"
[0m22:35:15.370521 [debug] [Thread-4 (]: Began running node model.crypto_analytics.mart_pipeline_monitoring
[0m22:35:15.398336 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:35:15.405269 [info ] [Thread-4 (]: 3 of 5 START sql table model public_marts.mart_pipeline_monitoring ............. [RUN]
[0m22:35:15.414580 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */
drop table if exists "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_backup" cascade
[0m22:35:15.426776 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.crypto_analytics.mart_pipeline_monitoring'
[0m22:35:15.447231 [debug] [Thread-4 (]: Began compiling node model.crypto_analytics.mart_pipeline_monitoring
[0m22:35:15.472638 [debug] [Thread-4 (]: Writing injected SQL for node "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:35:15.542104 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:35:15.547120 [debug] [Thread-4 (]: Timing info for model.crypto_analytics.mart_pipeline_monitoring (compile): 22:35:15.457903 => 22:35:15.546322
[0m22:35:15.559023 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.stg_crypto_prices (execute): 22:35:13.076300 => 22:35:15.558392
[0m22:35:15.572448 [debug] [Thread-4 (]: Began executing node model.crypto_analytics.mart_pipeline_monitoring
[0m22:35:15.585800 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: Close
[0m22:35:15.628144 [debug] [Thread-4 (]: Writing runtime sql for node "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:35:15.632574 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fdc31f44-a3df-4e91-a40e-94fdd7f5e450', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6c4c04fd0>]}
[0m22:35:15.653725 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public_staging.stg_crypto_prices ............. [[32mSELECT 15[0m in 2.84s]
[0m22:35:15.694779 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.stg_crypto_prices
[0m22:35:15.740514 [debug] [Thread-2 (]: Began running node model.crypto_analytics.int_crypto_daily_aggs
[0m22:35:15.741493 [debug] [Thread-3 (]: Began running node model.crypto_analytics.int_crypto_hourly_aggs
[0m22:35:15.742414 [debug] [Thread-1 (]: Began running node model.crypto_analytics.mart_crypto_latest_prices
[0m22:35:15.777288 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.stg_pipeline_runs, now model.crypto_analytics.int_crypto_daily_aggs)
[0m22:35:15.835929 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_staging, now model.crypto_analytics.int_crypto_hourly_aggs)
[0m22:35:15.890526 [info ] [Thread-1 (]: 4 of 5 START sql table model public_marts.mart_crypto_latest_prices ............ [RUN]
[0m22:35:15.923810 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics.int_crypto_daily_aggs
[0m22:35:15.925612 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:35:15.955066 [debug] [Thread-3 (]: Began compiling node model.crypto_analytics.int_crypto_hourly_aggs
[0m22:35:15.977085 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.stg_crypto_prices, now model.crypto_analytics.mart_crypto_latest_prices)
[0m22:35:16.041635 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics.int_crypto_daily_aggs"
[0m22:35:16.081457 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: BEGIN
[0m22:35:16.326507 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:35:16.220516 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics.mart_crypto_latest_prices
[0m22:35:16.133453 [debug] [Thread-3 (]: Writing injected SQL for node "model.crypto_analytics.int_crypto_hourly_aggs"
[0m22:35:16.393106 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m22:35:16.535247 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:35:16.490177 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:35:16.560161 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */




  create  table "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_tmp"


    as

  (


WITH pipeline_metrics AS (
    SELECT
        run_id,
        stage,
        status,
        records_processed,
        error_message,
        started_at,
        completed_at,
        EXTRACT(EPOCH FROM completed_at - started_at) AS duration_seconds,

        -- Flag to compute success rate
        CASE WHEN status = 'success' THEN 1 ELSE 0 END AS is_success,

        -- Classify performance
        CASE
            WHEN completed_at IS NULL THEN 'Running'
            WHEN EXTRACT(EPOCH FROM completed_at - started_at) < 30 THEN 'Fast'
            WHEN EXTRACT(EPOCH FROM completed_at - started_at) < 120 THEN 'Normal'
            ELSE 'Slow'
        END AS performance_category

    FROM "crypto_warehouse"."public_staging"."stg_pipeline_runs"
),

latest_status_per_day_stage AS (
    SELECT
        DATE(started_at) AS run_date,
        stage,
        FIRST_VALUE(status) OVER (
            PARTITION BY DATE(started_at), stage
            ORDER BY started_at DESC
        ) AS latest_run_status
    FROM pipeline_metrics
),

daily_summary AS (
    SELECT
        DATE(started_at) AS run_date,
        stage,

        COUNT(*) AS total_runs,
        SUM(is_success) AS successful_runs,
        SUM(records_processed) AS total_records_processed,
        AVG(duration_seconds) AS avg_duration_seconds,
        MAX(duration_seconds) AS max_duration_seconds,
        ROUND(((SUM(is_success)::FLOAT / COUNT(*)) * 100)::NUMERIC, 2) AS success_rate_pct


    FROM pipeline_metrics
    WHERE started_at >= CURRENT_DATE - INTERVAL '30 days'
    GROUP BY DATE(started_at), stage
)

-- Final result combining metrics with latest run status
SELECT
    ds.*,
    ls.latest_run_status
FROM daily_summary ds
LEFT JOIN latest_status_per_day_stage ls
  ON ds.run_date = ls.run_date AND ds.stage = ls.stage
  );

[0m22:35:16.701453 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.int_crypto_daily_aggs (compile): 22:35:16.009296 => 22:35:16.700727
[0m22:35:16.715510 [debug] [Thread-3 (]: Timing info for model.crypto_analytics.int_crypto_hourly_aggs (compile): 22:35:16.122299 => 22:35:16.714807
[0m22:35:16.742265 [debug] [Thread-2 (]: Finished running node model.crypto_analytics.int_crypto_daily_aggs
[0m22:35:16.793062 [debug] [Thread-3 (]: Finished running node model.crypto_analytics.int_crypto_hourly_aggs
[0m22:35:16.857317 [debug] [Thread-2 (]: Began running node model.crypto_analytics.mart_crypto_hourly_performance
[0m22:35:16.887258 [info ] [Thread-2 (]: 5 of 5 START sql table model public_marts.mart_crypto_hourly_performance ....... [RUN]
[0m22:35:16.891859 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.mart_crypto_latest_prices (compile): 22:35:16.439270 => 22:35:16.891145
[0m22:35:16.901012 [debug] [Thread-4 (]: SQL status: SELECT 6 in 0.0 seconds
[0m22:35:16.903403 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.int_crypto_daily_aggs, now model.crypto_analytics.mart_crypto_hourly_performance)
[0m22:35:16.921645 [debug] [Thread-1 (]: Began executing node model.crypto_analytics.mart_crypto_latest_prices
[0m22:35:16.943091 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:35:17.017810 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */
alter table "crypto_warehouse"."public_marts"."mart_pipeline_monitoring" rename to "mart_pipeline_monitoring__dbt_backup"
[0m22:35:17.007243 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:35:16.957706 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics.mart_crypto_hourly_performance
[0m22:35:17.039539 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:35:17.170715 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:35:17.219428 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */
alter table "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_tmp" rename to "mart_pipeline_monitoring"
[0m22:35:17.304347 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:35:17.196102 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:35:17.336619 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:35:17.419202 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:35:17.447849 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: BEGIN
[0m22:35:17.485946 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */

    create  index if not exists
  "1acd3240b1af4414b198653545b123cb"
  on "crypto_warehouse"."public_marts"."mart_pipeline_monitoring" using btree
  (run_date);

[0m22:35:17.532935 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:35:17.603093 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:35:17.627192 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:35:17.656631 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */




  create  table "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_tmp"


    as

  (


WITH latest_prices AS (
    SELECT
        symbol,
        crypto_name,
        price_usd,
        market_cap,
        volume_24h,
        price_change_24h,
        price_change_pct_24h,
        market_cap_rank,
        extracted_at,

        ROW_NUMBER() OVER (
            PARTITION BY symbol
            ORDER BY extracted_at DESC
        ) as rn

    FROM "crypto_warehouse"."public_staging"."stg_crypto_prices"
    WHERE extraction_date = CURRENT_DATE
),

price_changes AS (
    SELECT
        symbol,
        crypto_name,
        price_usd as current_price,
        market_cap,
        volume_24h,
        price_change_24h,
        price_change_pct_24h,
        market_cap_rank,
        extracted_at as last_updated,

        -- Calculate additional metrics
        CASE
            WHEN price_change_pct_24h > 10 THEN 'Strong Gain'
            WHEN price_change_pct_24h > 5 THEN 'Moderate Gain'
            WHEN price_change_pct_24h > 0 THEN 'Slight Gain'
            WHEN price_change_pct_24h > -5 THEN 'Slight Loss'
            WHEN price_change_pct_24h > -10 THEN 'Moderate Loss'
            ELSE 'Strong Loss'
        END as price_trend_category,

        -- Market cap category
        CASE
            WHEN market_cap_rank <= 10 THEN 'Large Cap'
            WHEN market_cap_rank <= 50 THEN 'Mid Cap'
            WHEN market_cap_rank <= 100 THEN 'Small Cap'
            ELSE 'Micro Cap'
        END as market_cap_category

    FROM latest_prices
    WHERE rn = 1
)

SELECT * FROM price_changes
  );

[0m22:35:17.737862 [debug] [Thread-4 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:35:17.749728 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.mart_crypto_hourly_performance (compile): 22:35:17.074857 => 22:35:17.748777
[0m22:35:17.777012 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:35:17.834711 [debug] [Thread-2 (]: Began executing node model.crypto_analytics.mart_crypto_hourly_performance
[0m22:35:17.873598 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */

    create  index if not exists
  "686deae59aa4841c6022c3e911031eb8"
  on "crypto_warehouse"."public_marts"."mart_pipeline_monitoring" using btree
  (stage);

[0m22:35:17.877765 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.0 seconds
[0m22:35:17.950318 [debug] [Thread-2 (]: Writing runtime sql for node "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:35:17.974717 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:35:18.035600 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_latest_prices" rename to "mart_crypto_latest_prices__dbt_backup"
[0m22:35:18.073141 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:35:18.130311 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:35:18.191306 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_tmp" rename to "mart_crypto_latest_prices"
[0m22:35:18.226502 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:35:18.243094 [debug] [Thread-4 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:35:18.264725 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:35:18.305949 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:35:18.367174 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: BEGIN
[0m22:35:18.392585 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:35:18.297476 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: COMMIT
[0m22:35:18.324648 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */

    create  index if not exists
  "0aa5782d7402d07ac9eb9d2f95c9c7a9"
  on "crypto_warehouse"."public_marts"."mart_crypto_latest_prices" using btree
  (symbol);

[0m22:35:18.438232 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:35:18.440818 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:35:18.538847 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:35:18.486495 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: COMMIT
[0m22:35:18.587838 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */




  create  table "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_tmp"


    as

  (


WITH  __dbt__cte__int_crypto_hourly_aggs as (


WITH base_data AS (
    SELECT
        symbol,
        crypto_name,
        DATE_TRUNC('hour', extracted_at) AS extraction_hour,
        price_usd,
        volume_24h,
        market_cap,
        CASE WHEN price_usd <= 0 THEN 1 ELSE 0 END AS is_invalid
    FROM "crypto_warehouse"."public_staging"."stg_crypto_prices"
)

SELECT
    symbol,
    crypto_name,
    extraction_hour,
    COUNT(*) AS total_records,
    SUM(is_invalid) AS invalid_price_records,
    AVG(price_usd) AS avg_price_usd,
    MIN(price_usd) AS min_price_usd,
    MAX(price_usd) AS max_price_usd,
    STDDEV(price_usd) AS price_volatility,
    AVG(volume_24h) AS avg_volume_24h,
    AVG(market_cap) AS avg_market_cap
FROM base_data
GROUP BY symbol, crypto_name, extraction_hour
), hourly_data AS (
    SELECT
        symbol,
        crypto_name,
        extraction_hour,
        avg_price_usd,
        min_price_usd,
        max_price_usd,
        price_volatility,
        avg_volume_24h,
        avg_market_cap,
        total_records,

        -- Calculate hourly change
        LAG(avg_price_usd) OVER (
            PARTITION BY symbol
            ORDER BY extraction_hour
        ) as previous_hour_price,

        -- Data quality score
        (1.0 - (invalid_price_records::FLOAT / GREATEST(total_records, 1))) * 100 as data_quality_score

    FROM __dbt__cte__int_crypto_hourly_aggs
),

performance_metrics AS (
    SELECT
        *,
        CASE
            WHEN previous_hour_price IS NOT NULL AND previous_hour_price > 0 THEN
                ((avg_price_usd - previous_hour_price) / previous_hour_price) * 100
            ELSE NULL
        END as hourly_change_pct,

        -- Volatility category
        CASE
            WHEN price_volatility IS NULL THEN 'Unknown'
            WHEN price_volatility < avg_price_usd * 0.01 THEN 'Low Volatility'
            WHEN price_volatility < avg_price_usd * 0.05 THEN 'Medium Volatility'
            ELSE 'High Volatility'
        END as volatility_category

    FROM hourly_data
)

SELECT * FROM performance_metrics
  );

[0m22:35:18.804697 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m22:35:18.805700 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:35:18.928295 [debug] [Thread-4 (]: Applying DROP to: "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_backup"
[0m22:35:18.947278 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:35:18.963756 [debug] [Thread-2 (]: SQL status: SELECT 10 in 0.0 seconds
[0m22:35:18.984992 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:35:19.012895 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */

    create  index if not exists
  "6f01b77d0d64d11bfc919f2e9be10b78"
  on "crypto_warehouse"."public_marts"."mart_crypto_latest_prices" using btree
  (market_cap_rank);

[0m22:35:19.046352 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:35:19.084423 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */
drop table if exists "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_backup" cascade
[0m22:35:19.155819 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance" rename to "mart_crypto_hourly_performance__dbt_backup"
[0m22:35:19.231766 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:35:19.274962 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:35:19.338069 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_tmp" rename to "mart_crypto_hourly_performance"
[0m22:35:19.340030 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:35:19.364617 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:35:19.384858 [debug] [Thread-4 (]: Timing info for model.crypto_analytics.mart_pipeline_monitoring (execute): 22:35:15.596536 => 22:35:19.384289
[0m22:35:19.419962 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: Close
[0m22:35:19.439410 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fdc31f44-a3df-4e91-a40e-94fdd7f5e450', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6c4c44c10>]}
[0m22:35:19.402141 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:35:19.449370 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:35:19.455920 [info ] [Thread-4 (]: 3 of 5 OK created sql table model public_marts.mart_pipeline_monitoring ........ [[32mSELECT 6[0m in 4.01s]
[0m22:35:19.481458 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */

    create  index if not exists
  "3e6360b912524379a6c2c46291f9c135"
  on "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance" using btree
  (symbol, extraction_hour);

[0m22:35:19.501604 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: COMMIT
[0m22:35:19.519427 [debug] [Thread-4 (]: Finished running node model.crypto_analytics.mart_pipeline_monitoring
[0m22:35:19.561657 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:35:19.583867 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: COMMIT
[0m22:35:19.711211 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:35:19.712201 [debug] [Thread-2 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:35:19.731395 [debug] [Thread-1 (]: Applying DROP to: "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_backup"
[0m22:35:19.780050 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:35:19.822091 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:35:19.852575 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */

    create  index if not exists
  "d5b02e7990061516d05c220663134101"
  on "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance" using btree
  (extraction_hour);

[0m22:35:19.871701 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */
drop table if exists "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_backup" cascade
[0m22:35:19.987984 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:35:20.014595 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.mart_crypto_latest_prices (execute): 22:35:16.970616 => 22:35:20.013886
[0m22:35:20.027196 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: Close
[0m22:35:20.036255 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fdc31f44-a3df-4e91-a40e-94fdd7f5e450', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6c497acd0>]}
[0m22:35:20.052050 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public_marts.mart_crypto_latest_prices ....... [[32mSELECT 5[0m in 4.06s]
[0m22:35:20.070037 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.mart_crypto_latest_prices
[0m22:35:20.132474 [debug] [Thread-2 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:35:20.149418 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: COMMIT
[0m22:35:20.163026 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:35:20.171475 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: COMMIT
[0m22:35:20.277295 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m22:35:20.299064 [debug] [Thread-2 (]: Applying DROP to: "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_backup"
[0m22:35:20.313841 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:35:20.322275 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */
drop table if exists "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_backup" cascade
[0m22:35:20.420964 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:35:20.436180 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.mart_crypto_hourly_performance (execute): 22:35:17.907697 => 22:35:20.435595
[0m22:35:20.450450 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: Close
[0m22:35:20.464266 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fdc31f44-a3df-4e91-a40e-94fdd7f5e450', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6bcf4ebd0>]}
[0m22:35:20.482270 [info ] [Thread-2 (]: 5 of 5 OK created sql table model public_marts.mart_crypto_hourly_performance .. [[32mSELECT 10[0m in 3.56s]
[0m22:35:20.497017 [debug] [Thread-2 (]: Finished running node model.crypto_analytics.mart_crypto_hourly_performance
[0m22:35:20.514972 [debug] [MainThread]: Using postgres connection "master"
[0m22:35:20.528261 [debug] [MainThread]: On master: BEGIN
[0m22:35:20.537061 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:35:20.557102 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:35:20.567452 [debug] [MainThread]: On master: COMMIT
[0m22:35:20.580831 [debug] [MainThread]: Using postgres connection "master"
[0m22:35:20.594910 [debug] [MainThread]: On master: COMMIT
[0m22:35:20.611531 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:35:20.620949 [debug] [MainThread]: On master: Close
[0m22:35:20.634327 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:35:20.650892 [debug] [MainThread]: Connection 'model.crypto_analytics.mart_crypto_hourly_performance' was properly closed.
[0m22:35:20.662725 [debug] [MainThread]: Connection 'model.crypto_analytics.int_crypto_hourly_aggs' was properly closed.
[0m22:35:20.679254 [debug] [MainThread]: Connection 'model.crypto_analytics.mart_crypto_latest_prices' was properly closed.
[0m22:35:20.687082 [debug] [MainThread]: Connection 'model.crypto_analytics.mart_pipeline_monitoring' was properly closed.
[0m22:35:20.700940 [info ] [MainThread]:
[0m22:35:20.719052 [info ] [MainThread]: Finished running 1 view model, 4 table models in 0 hours 0 minutes and 10.18 seconds (10.18s).
[0m22:35:20.735655 [debug] [MainThread]: Command end result
[0m22:35:21.060991 [info ] [MainThread]:
[0m22:35:21.078322 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:35:21.092436 [info ] [MainThread]:
[0m22:35:21.104735 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m22:35:21.118668 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 27.885061, "process_user_time": 10.20676, "process_kernel_time": 1.400132, "process_mem_max_rss": "121964", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:35:21.138061 [debug] [MainThread]: Command `dbt run` succeeded at 22:35:21.137686 after 27.90 seconds
[0m22:35:21.161979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6c6bc9bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6c6bc9a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6caf45890>]}
[0m22:35:21.180413 [debug] [MainThread]: Flushing usage events
[0m22:40:16.963665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eef183650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eef616550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eef182e50>]}


============================== 22:40:16.982218 | 3e9dbd41-8401-48cf-8fe1-a4dfdcc7809b ==============================
[0m22:40:16.982218 [info ] [MainThread]: Running with dbt=1.7.0
[0m22:40:16.999518 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/app/dbt/logs', 'profiles_dir': '/app', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /app/dbt', 'send_anonymous_usage_stats': 'True'}
[0m22:40:18.726140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e9dbd41-8401-48cf-8fe1-a4dfdcc7809b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eed8e44d0>]}
[0m22:40:19.212976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e9dbd41-8401-48cf-8fe1-a4dfdcc7809b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eef15b5d0>]}
[0m22:40:19.226394 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m22:40:19.524092 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m22:40:27.755096 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:40:27.768080 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:40:27.794849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e9dbd41-8401-48cf-8fe1-a4dfdcc7809b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eed6cf690>]}
[0m22:40:27.986177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e9dbd41-8401-48cf-8fe1-a4dfdcc7809b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eefbad8d0>]}
[0m22:40:27.999689 [info ] [MainThread]: Found 7 models, 14 tests, 2 sources, 0 exposures, 0 metrics, 517 macros, 0 groups, 0 semantic models
[0m22:40:28.037358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e9dbd41-8401-48cf-8fe1-a4dfdcc7809b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eed8e4c50>]}
[0m22:40:28.073458 [info ] [MainThread]:
[0m22:40:28.294833 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:40:28.426003 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse'
[0m22:40:28.428912 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse'
[0m22:40:28.485412 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse"
[0m22:40:28.496876 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse"
[0m22:40:28.501862 [debug] [ThreadPool]: On list_crypto_warehouse: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse"} */

    select distinct nspname from pg_namespace

[0m22:40:28.513281 [debug] [ThreadPool]: On list_crypto_warehouse: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse"} */

    select distinct nspname from pg_namespace

[0m22:40:28.520089 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:40:28.531798 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:40:28.548038 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m22:40:28.561795 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m22:40:28.567744 [debug] [ThreadPool]: On list_crypto_warehouse: Close
[0m22:40:28.599689 [debug] [ThreadPool]: On list_crypto_warehouse: Close
[0m22:40:28.632549 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_warehouse, now list_crypto_warehouse_public_staging)
[0m22:40:28.634561 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_warehouse, now list_crypto_warehouse_public_dbt_test__audit)
[0m22:40:28.637156 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse_public_marts'
[0m22:40:28.682371 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_staging"
[0m22:40:28.695302 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_dbt_test__audit"
[0m22:40:28.710139 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_marts"
[0m22:40:28.719360 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: BEGIN
[0m22:40:28.746851 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: BEGIN
[0m22:40:28.765488 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: BEGIN
[0m22:40:28.780011 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:40:28.796601 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:40:28.804641 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:40:28.824071 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:40:28.838777 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:40:28.860031 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:40:28.899744 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_staging"
[0m22:40:28.945863 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_dbt_test__audit"
[0m22:40:28.978295 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_marts"
[0m22:40:28.993261 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_staging"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'

[0m22:40:29.002858 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_dbt_test__audit"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'

[0m22:40:29.020817 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_marts"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'

[0m22:40:29.039963 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m22:40:29.055765 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m22:40:29.070459 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m22:40:29.083273 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: ROLLBACK
[0m22:40:29.101675 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: ROLLBACK
[0m22:40:29.117963 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: ROLLBACK
[0m22:40:29.131836 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: Close
[0m22:40:29.145102 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: Close
[0m22:40:29.152971 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: Close
[0m22:40:29.233421 [debug] [MainThread]: Using postgres connection "master"
[0m22:40:29.245829 [debug] [MainThread]: On master: BEGIN
[0m22:40:29.253123 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:40:29.270814 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:40:29.283288 [debug] [MainThread]: Using postgres connection "master"
[0m22:40:29.296602 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:40:29.343339 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m22:40:29.352817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e9dbd41-8401-48cf-8fe1-a4dfdcc7809b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eed77cbd0>]}
[0m22:40:29.366631 [debug] [MainThread]: On master: ROLLBACK
[0m22:40:29.381089 [debug] [MainThread]: Using postgres connection "master"
[0m22:40:29.397961 [debug] [MainThread]: On master: BEGIN
[0m22:40:29.411733 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:40:29.419518 [debug] [MainThread]: On master: COMMIT
[0m22:40:29.431759 [debug] [MainThread]: Using postgres connection "master"
[0m22:40:29.443593 [debug] [MainThread]: On master: COMMIT
[0m22:40:29.451568 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:40:29.464201 [debug] [MainThread]: On master: Close
[0m22:40:29.476246 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:40:29.495599 [info ] [MainThread]:
[0m22:40:29.556956 [debug] [Thread-1 (]: Began running node model.crypto_analytics.stg_crypto_prices
[0m22:40:29.558295 [debug] [Thread-2 (]: Began running node model.crypto_analytics.stg_pipeline_runs
[0m22:40:29.570000 [info ] [Thread-1 (]: 1 of 5 START sql table model public_staging.stg_crypto_prices .................. [RUN]
[0m22:40:29.601163 [info ] [Thread-2 (]: 2 of 5 START sql view model public_staging.stg_pipeline_runs ................... [RUN]
[0m22:40:29.627188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_marts, now model.crypto_analytics.stg_crypto_prices)
[0m22:40:29.757645 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_dbt_test__audit, now model.crypto_analytics.stg_pipeline_runs)
[0m22:40:29.791376 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics.stg_crypto_prices
[0m22:40:29.808988 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics.stg_pipeline_runs
[0m22:40:29.847787 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics.stg_crypto_prices"
[0m22:40:29.864074 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics.stg_pipeline_runs"
[0m22:40:30.678497 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.stg_crypto_prices (compile): 22:40:29.818208 => 22:40:30.677787
[0m22:40:30.774489 [debug] [Thread-1 (]: Began executing node model.crypto_analytics.stg_crypto_prices
[0m22:40:30.827446 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.stg_pipeline_runs (compile): 22:40:29.857118 => 22:40:30.826773
[0m22:40:30.900772 [debug] [Thread-2 (]: Began executing node model.crypto_analytics.stg_pipeline_runs
[0m22:40:31.172656 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics.stg_crypto_prices"
[0m22:40:31.174461 [debug] [Thread-2 (]: Writing runtime sql for node "model.crypto_analytics.stg_pipeline_runs"
[0m22:40:31.284200 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m22:40:31.331437 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:40:31.346677 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: BEGIN
[0m22:40:31.408295 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: BEGIN
[0m22:40:31.423060 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:40:31.434293 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:40:31.454577 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:40:31.471397 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:40:31.482240 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m22:40:31.508020 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:40:31.522612 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */

  create view "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_tmp"


  as (
    SELECT
    id as run_id,
    run_id as run_identifier,
    stage,
    status,
    records_processed,
    error_message,
    started_at,
    completed_at,
    CASE
        WHEN completed_at IS NOT NULL
        THEN EXTRACT(EPOCH FROM (completed_at - started_at))
        ELSE NULL
    END as duration_seconds
FROM "crypto_warehouse"."public"."pipeline_runs"
  );
[0m22:40:31.542110 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */




  create  table "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_tmp"


    as

  (


WITH source_data AS (
    SELECT
        id as price_id,
        UPPER(TRIM(symbol)) as symbol,
        TRIM(name) as crypto_name,
        current_price as price_usd,
        market_cap,
        total_volume as volume_24h,
        price_change_24h,
        price_change_percentage_24h as price_change_pct_24h,
        market_cap_rank,
        extracted_at,
        created_at,

        CASE WHEN current_price <= 0 THEN TRUE ELSE FALSE END as is_invalid_price,
        CASE WHEN market_cap <= 0 THEN TRUE ELSE FALSE END as is_invalid_market_cap,
        CASE WHEN total_volume < 0 THEN TRUE ELSE FALSE END as is_invalid_volume
    FROM "crypto_warehouse"."public"."crypto_prices_raw"
),

cleaned_data AS (
    SELECT
        *,
        DATE(extracted_at) as extraction_date,
        DATE_TRUNC('hour', extracted_at) as extraction_hour,
        CASE
            WHEN LAG(price_usd) OVER (
                PARTITION BY symbol ORDER BY extracted_at
            ) IS NOT NULL THEN
                ((price_usd - LAG(price_usd) OVER (
                    PARTITION BY symbol ORDER BY extracted_at
                )) / LAG(price_usd) OVER (
                    PARTITION BY symbol ORDER BY extracted_at
                )) * 100
        END as price_change_pct_from_previous
    FROM source_data
    WHERE NOT is_invalid_price AND NOT is_invalid_volume
)

SELECT * FROM cleaned_data
  );

[0m22:40:31.553366 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m22:40:31.602981 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m22:40:31.610829 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */
alter table "crypto_warehouse"."public_staging"."stg_pipeline_runs" rename to "stg_pipeline_runs__dbt_backup"
[0m22:40:31.620428 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:40:31.636033 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m22:40:31.643887 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */
alter table "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_tmp" rename to "stg_pipeline_runs"
[0m22:40:31.652533 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:40:31.696820 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: COMMIT
[0m22:40:31.704095 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m22:40:31.711541 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: COMMIT
[0m22:40:31.767498 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.0 seconds
[0m22:40:31.783100 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:40:31.791461 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */
alter table "crypto_warehouse"."public_staging"."stg_crypto_prices" rename to "stg_crypto_prices__dbt_backup"
[0m22:40:31.799805 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:40:31.818653 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:40:31.824021 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m22:40:31.826998 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */
alter table "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_tmp" rename to "stg_crypto_prices"
[0m22:40:32.011820 [debug] [Thread-2 (]: Applying DROP to: "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_backup"
[0m22:40:32.013740 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:40:32.034832 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m22:40:32.054592 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:40:32.056111 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */
drop view if exists "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_backup" cascade
[0m22:40:32.062769 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */

        CREATE INDEX IF NOT EXISTS idx_stg_crypto_prices_symbol_time ON "crypto_warehouse"."public_staging"."stg_crypto_prices" (symbol, extracted_at)

[0m22:40:32.167107 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m22:40:32.175357 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.stg_pipeline_runs (execute): 22:40:30.961496 => 22:40:32.175069
[0m22:40:32.181169 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: Close
[0m22:40:32.187801 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e9dbd41-8401-48cf-8fe1-a4dfdcc7809b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eed6602d0>]}
[0m22:40:32.195650 [info ] [Thread-2 (]: 2 of 5 OK created sql view model public_staging.stg_pipeline_runs .............. [[32mCREATE VIEW[0m in 2.43s]
[0m22:40:32.212637 [debug] [Thread-2 (]: Finished running node model.crypto_analytics.stg_pipeline_runs
[0m22:40:32.222512 [debug] [Thread-4 (]: Began running node model.crypto_analytics.mart_pipeline_monitoring
[0m22:40:32.232011 [info ] [Thread-4 (]: 3 of 5 START sql table model public_marts.mart_pipeline_monitoring ............. [RUN]
[0m22:40:32.247264 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:40:32.524091 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.crypto_analytics.mart_pipeline_monitoring'
[0m22:40:32.579471 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: COMMIT
[0m22:40:32.588433 [debug] [Thread-4 (]: Began compiling node model.crypto_analytics.mart_pipeline_monitoring
[0m22:40:32.608677 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:40:32.627758 [debug] [Thread-4 (]: Writing injected SQL for node "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:40:32.632805 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: COMMIT
[0m22:40:32.692598 [debug] [Thread-4 (]: Timing info for model.crypto_analytics.mart_pipeline_monitoring (compile): 22:40:32.616753 => 22:40:32.691905
[0m22:40:32.708213 [debug] [Thread-4 (]: Began executing node model.crypto_analytics.mart_pipeline_monitoring
[0m22:40:32.716796 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:40:32.760734 [debug] [Thread-4 (]: Writing runtime sql for node "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:40:32.771450 [debug] [Thread-1 (]: Applying DROP to: "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_backup"
[0m22:40:32.850987 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:40:32.874512 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */
drop table if exists "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_backup" cascade
[0m22:40:32.971482 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:40:32.982216 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: BEGIN
[0m22:40:32.996849 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:40:33.014477 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:40:33.017366 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m22:40:33.045746 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.stg_crypto_prices (execute): 22:40:30.832427 => 22:40:33.044898
[0m22:40:33.063390 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:40:33.092235 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: Close
[0m22:40:33.104739 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */




  create  table "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_tmp"


    as

  (


WITH pipeline_metrics AS (
    SELECT
        run_id,
        stage,
        status,
        records_processed,
        error_message,
        started_at,
        completed_at,
        EXTRACT(EPOCH FROM completed_at - started_at) AS duration_seconds,

        -- Flag to compute success rate
        CASE WHEN status = 'success' THEN 1 ELSE 0 END AS is_success,

        -- Classify performance
        CASE
            WHEN completed_at IS NULL THEN 'Running'
            WHEN EXTRACT(EPOCH FROM completed_at - started_at) < 30 THEN 'Fast'
            WHEN EXTRACT(EPOCH FROM completed_at - started_at) < 120 THEN 'Normal'
            ELSE 'Slow'
        END AS performance_category

    FROM "crypto_warehouse"."public_staging"."stg_pipeline_runs"
),

latest_status_per_day_stage AS (
    SELECT
        DATE(started_at) AS run_date,
        stage,
        FIRST_VALUE(status) OVER (
            PARTITION BY DATE(started_at), stage
            ORDER BY started_at DESC
        ) AS latest_run_status
    FROM pipeline_metrics
),

daily_summary AS (
    SELECT
        DATE(started_at) AS run_date,
        stage,

        COUNT(*) AS total_runs,
        SUM(is_success) AS successful_runs,
        SUM(records_processed) AS total_records_processed,
        AVG(duration_seconds) AS avg_duration_seconds,
        MAX(duration_seconds) AS max_duration_seconds,
        ROUND(((SUM(is_success)::FLOAT / COUNT(*)) * 100)::NUMERIC, 2) AS success_rate_pct


    FROM pipeline_metrics
    WHERE started_at >= CURRENT_DATE - INTERVAL '30 days'
    GROUP BY DATE(started_at), stage
)

-- Final result combining metrics with latest run status
SELECT
    ds.*,
    ls.latest_run_status
FROM daily_summary ds
LEFT JOIN latest_status_per_day_stage ls
  ON ds.run_date = ls.run_date AND ds.stage = ls.stage
  );

[0m22:40:33.117624 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e9dbd41-8401-48cf-8fe1-a4dfdcc7809b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eef1a9d50>]}
[0m22:40:33.143002 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public_staging.stg_crypto_prices ............. [[32mSELECT 15[0m in 3.49s]
[0m22:40:33.243855 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.stg_crypto_prices
[0m22:40:33.279542 [debug] [Thread-2 (]: Began running node model.crypto_analytics.int_crypto_daily_aggs
[0m22:40:33.280873 [debug] [Thread-3 (]: Began running node model.crypto_analytics.int_crypto_hourly_aggs
[0m22:40:33.282034 [debug] [Thread-1 (]: Began running node model.crypto_analytics.mart_crypto_latest_prices
[0m22:40:33.302035 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.stg_pipeline_runs, now model.crypto_analytics.int_crypto_daily_aggs)
[0m22:40:33.338962 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_staging, now model.crypto_analytics.int_crypto_hourly_aggs)
[0m22:40:33.363935 [info ] [Thread-1 (]: 4 of 5 START sql table model public_marts.mart_crypto_latest_prices ............ [RUN]
[0m22:40:33.384886 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics.int_crypto_daily_aggs
[0m22:40:33.395108 [debug] [Thread-4 (]: SQL status: SELECT 6 in 0.0 seconds
[0m22:40:33.397024 [debug] [Thread-3 (]: Began compiling node model.crypto_analytics.int_crypto_hourly_aggs
[0m22:40:33.412271 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.stg_crypto_prices, now model.crypto_analytics.mart_crypto_latest_prices)
[0m22:40:33.444467 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics.int_crypto_daily_aggs"
[0m22:40:33.497271 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:40:33.511044 [debug] [Thread-3 (]: Writing injected SQL for node "model.crypto_analytics.int_crypto_hourly_aggs"
[0m22:40:33.522093 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics.mart_crypto_latest_prices
[0m22:40:33.577954 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */
alter table "crypto_warehouse"."public_marts"."mart_pipeline_monitoring" rename to "mart_pipeline_monitoring__dbt_backup"
[0m22:40:33.623391 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:40:33.627951 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:40:33.680237 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:40:33.747849 [debug] [Thread-3 (]: Timing info for model.crypto_analytics.int_crypto_hourly_aggs (compile): 22:40:33.501607 => 22:40:33.746794
[0m22:40:33.756816 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */
alter table "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_tmp" rename to "mart_pipeline_monitoring"
[0m22:40:33.764026 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.int_crypto_daily_aggs (compile): 22:40:33.424712 => 22:40:33.763342
[0m22:40:34.182815 [debug] [Thread-3 (]: Finished running node model.crypto_analytics.int_crypto_hourly_aggs
[0m22:40:34.236059 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.mart_crypto_latest_prices (compile): 22:40:33.602548 => 22:40:34.235341
[0m22:40:34.239422 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:40:34.276091 [debug] [Thread-2 (]: Finished running node model.crypto_analytics.int_crypto_daily_aggs
[0m22:40:34.293455 [debug] [Thread-3 (]: Began running node model.crypto_analytics.mart_crypto_hourly_performance
[0m22:40:34.309145 [debug] [Thread-1 (]: Began executing node model.crypto_analytics.mart_crypto_latest_prices
[0m22:40:34.371428 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:40:34.378580 [info ] [Thread-3 (]: 5 of 5 START sql table model public_marts.mart_crypto_hourly_performance ....... [RUN]
[0m22:40:34.415666 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:40:34.427781 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */

    create  index if not exists
  "e4dd4ce3865084838f746d1d66af9421"
  on "crypto_warehouse"."public_marts"."mart_pipeline_monitoring" using btree
  (run_date);

[0m22:40:34.441688 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.int_crypto_hourly_aggs, now model.crypto_analytics.mart_crypto_hourly_performance)
[0m22:40:34.477332 [debug] [Thread-3 (]: Began compiling node model.crypto_analytics.mart_crypto_hourly_performance
[0m22:40:34.590374 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:40:34.594097 [debug] [Thread-3 (]: Writing injected SQL for node "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:40:34.600052 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: BEGIN
[0m22:40:34.615750 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:40:34.630495 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:40:34.640344 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:40:34.649084 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */




  create  table "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_tmp"


    as

  (


WITH latest_prices AS (
    SELECT
        symbol,
        crypto_name,
        price_usd,
        market_cap,
        volume_24h,
        price_change_24h,
        price_change_pct_24h,
        market_cap_rank,
        extracted_at,

        ROW_NUMBER() OVER (
            PARTITION BY symbol
            ORDER BY extracted_at DESC
        ) as rn

    FROM "crypto_warehouse"."public_staging"."stg_crypto_prices"
    WHERE extraction_date = CURRENT_DATE
),

price_changes AS (
    SELECT
        symbol,
        crypto_name,
        price_usd as current_price,
        market_cap,
        volume_24h,
        price_change_24h,
        price_change_pct_24h,
        market_cap_rank,
        extracted_at as last_updated,

        -- Calculate additional metrics
        CASE
            WHEN price_change_pct_24h > 10 THEN 'Strong Gain'
            WHEN price_change_pct_24h > 5 THEN 'Moderate Gain'
            WHEN price_change_pct_24h > 0 THEN 'Slight Gain'
            WHEN price_change_pct_24h > -5 THEN 'Slight Loss'
            WHEN price_change_pct_24h > -10 THEN 'Moderate Loss'
            ELSE 'Strong Loss'
        END as price_trend_category,

        -- Market cap category
        CASE
            WHEN market_cap_rank <= 10 THEN 'Large Cap'
            WHEN market_cap_rank <= 50 THEN 'Mid Cap'
            WHEN market_cap_rank <= 100 THEN 'Small Cap'
            ELSE 'Micro Cap'
        END as market_cap_category

    FROM latest_prices
    WHERE rn = 1
)

SELECT * FROM price_changes
  );

[0m22:40:34.661598 [debug] [Thread-3 (]: Timing info for model.crypto_analytics.mart_crypto_hourly_performance (compile): 22:40:34.489293 => 22:40:34.660744
[0m22:40:34.671210 [debug] [Thread-3 (]: Began executing node model.crypto_analytics.mart_crypto_hourly_performance
[0m22:40:34.699756 [debug] [Thread-3 (]: Writing runtime sql for node "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:40:34.748280 [debug] [Thread-4 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:40:34.765870 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:40:34.785961 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */

    create  index if not exists
  "d65721df2d3c8252bb771b2454193e58"
  on "crypto_warehouse"."public_marts"."mart_pipeline_monitoring" using btree
  (stage);

[0m22:40:34.834298 [debug] [Thread-3 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:40:34.870014 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: BEGIN
[0m22:40:34.917205 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:40:34.935421 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:40:34.982192 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.0 seconds
[0m22:40:34.984235 [debug] [Thread-3 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:40:35.011418 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:40:35.028211 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */




  create  table "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_tmp"


    as

  (


WITH  __dbt__cte__int_crypto_hourly_aggs as (


WITH base_data AS (
    SELECT
        symbol,
        crypto_name,
        DATE_TRUNC('hour', extracted_at) AS extraction_hour,
        price_usd,
        volume_24h,
        market_cap,
        CASE WHEN price_usd <= 0 THEN 1 ELSE 0 END AS is_invalid
    FROM "crypto_warehouse"."public_staging"."stg_crypto_prices"
)

SELECT
    symbol,
    crypto_name,
    extraction_hour,
    COUNT(*) AS total_records,
    SUM(is_invalid) AS invalid_price_records,
    AVG(price_usd) AS avg_price_usd,
    MIN(price_usd) AS min_price_usd,
    MAX(price_usd) AS max_price_usd,
    STDDEV(price_usd) AS price_volatility,
    AVG(volume_24h) AS avg_volume_24h,
    AVG(market_cap) AS avg_market_cap
FROM base_data
GROUP BY symbol, crypto_name, extraction_hour
), hourly_data AS (
    SELECT
        symbol,
        crypto_name,
        extraction_hour,
        avg_price_usd,
        min_price_usd,
        max_price_usd,
        price_volatility,
        avg_volume_24h,
        avg_market_cap,
        total_records,

        -- Calculate hourly change
        LAG(avg_price_usd) OVER (
            PARTITION BY symbol
            ORDER BY extraction_hour
        ) as previous_hour_price,

        -- Data quality score
        (1.0 - (invalid_price_records::FLOAT / GREATEST(total_records, 1))) * 100 as data_quality_score

    FROM __dbt__cte__int_crypto_hourly_aggs
),

performance_metrics AS (
    SELECT
        *,
        CASE
            WHEN previous_hour_price IS NOT NULL AND previous_hour_price > 0 THEN
                ((avg_price_usd - previous_hour_price) / previous_hour_price) * 100
            ELSE NULL
        END as hourly_change_pct,

        -- Volatility category
        CASE
            WHEN price_volatility IS NULL THEN 'Unknown'
            WHEN price_volatility < avg_price_usd * 0.01 THEN 'Low Volatility'
            WHEN price_volatility < avg_price_usd * 0.05 THEN 'Medium Volatility'
            ELSE 'High Volatility'
        END as volatility_category

    FROM hourly_data
)

SELECT * FROM performance_metrics
  );

[0m22:40:35.042289 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_latest_prices" rename to "mart_crypto_latest_prices__dbt_backup"
[0m22:40:35.071382 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:40:35.086829 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:40:35.097281 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_tmp" rename to "mart_crypto_latest_prices"
[0m22:40:35.103577 [debug] [Thread-4 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:40:35.110162 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:40:35.121473 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: COMMIT
[0m22:40:35.132738 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:40:35.141268 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:40:35.149484 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */

    create  index if not exists
  "5688fedbf168616208893190b72fb352"
  on "crypto_warehouse"."public_marts"."mart_crypto_latest_prices" using btree
  (symbol);

[0m22:40:35.157722 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: COMMIT
[0m22:40:35.272743 [debug] [Thread-3 (]: SQL status: SELECT 10 in 0.0 seconds
[0m22:40:35.289019 [debug] [Thread-3 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:40:35.297577 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance" rename to "mart_crypto_hourly_performance__dbt_backup"
[0m22:40:35.307056 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:40:35.324765 [debug] [Thread-3 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:40:35.335028 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_tmp" rename to "mart_crypto_hourly_performance"
[0m22:40:35.345312 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:40:35.358319 [debug] [Thread-3 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:40:35.368004 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */

    create  index if not exists
  "eec115ab522837be36a090cc4a03ec18"
  on "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance" using btree
  (symbol, extraction_hour);

[0m22:40:35.541210 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m22:40:35.542346 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:40:35.556003 [debug] [Thread-4 (]: Applying DROP to: "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_backup"
[0m22:40:35.565248 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:40:35.620176 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:40:35.635128 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */

    create  index if not exists
  "db4c71c8b408484b4017f65b51c1a80c"
  on "crypto_warehouse"."public_marts"."mart_crypto_latest_prices" using btree
  (market_cap_rank);

[0m22:40:35.647398 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */
drop table if exists "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_backup" cascade
[0m22:40:35.733611 [debug] [Thread-3 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:40:35.747005 [debug] [Thread-3 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:40:35.756159 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */

    create  index if not exists
  "c0b4b5b4df3c56ad3cefb48fac4671a3"
  on "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance" using btree
  (extraction_hour);

[0m22:40:35.760594 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:40:35.776911 [debug] [Thread-4 (]: Timing info for model.crypto_analytics.mart_pipeline_monitoring (execute): 22:40:32.726469 => 22:40:35.776229
[0m22:40:35.786619 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: Close
[0m22:40:35.797421 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e9dbd41-8401-48cf-8fe1-a4dfdcc7809b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eed4dd590>]}
[0m22:40:35.806921 [info ] [Thread-4 (]: 3 of 5 OK created sql table model public_marts.mart_pipeline_monitoring ........ [[32mSELECT 6[0m in 3.27s]
[0m22:40:35.821313 [debug] [Thread-4 (]: Finished running node model.crypto_analytics.mart_pipeline_monitoring
[0m22:40:35.903890 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:40:36.103591 [debug] [Thread-3 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:40:36.108490 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: COMMIT
[0m22:40:36.134230 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: COMMIT
[0m22:40:36.143039 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:40:36.151555 [debug] [Thread-3 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:40:36.159214 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: COMMIT
[0m22:40:36.167732 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: COMMIT
[0m22:40:36.225886 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:40:36.243382 [debug] [Thread-1 (]: Applying DROP to: "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_backup"
[0m22:40:36.252679 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:40:36.260337 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */
drop table if exists "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_backup" cascade
[0m22:40:36.273243 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m22:40:36.291653 [debug] [Thread-3 (]: Applying DROP to: "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_backup"
[0m22:40:36.303098 [debug] [Thread-3 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:40:36.311554 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */
drop table if exists "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_backup" cascade
[0m22:40:36.315847 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:40:36.331314 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.mart_crypto_latest_prices (execute): 22:40:34.391277 => 22:40:36.330494
[0m22:40:36.339320 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: Close
[0m22:40:36.349341 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e9dbd41-8401-48cf-8fe1-a4dfdcc7809b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eed628fd0>]}
[0m22:40:36.358345 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public_marts.mart_crypto_latest_prices ....... [[32mSELECT 5[0m in 2.94s]
[0m22:40:36.383036 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.mart_crypto_latest_prices
[0m22:40:36.438310 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:40:36.457194 [debug] [Thread-3 (]: Timing info for model.crypto_analytics.mart_crypto_hourly_performance (execute): 22:40:34.678753 => 22:40:36.456798
[0m22:40:36.465785 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: Close
[0m22:40:36.483538 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e9dbd41-8401-48cf-8fe1-a4dfdcc7809b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eed737390>]}
[0m22:40:36.492743 [info ] [Thread-3 (]: 5 of 5 OK created sql table model public_marts.mart_crypto_hourly_performance .. [[32mSELECT 10[0m in 2.04s]
[0m22:40:36.512201 [debug] [Thread-3 (]: Finished running node model.crypto_analytics.mart_crypto_hourly_performance
[0m22:40:36.530872 [debug] [MainThread]: Using postgres connection "master"
[0m22:40:36.543384 [debug] [MainThread]: On master: BEGIN
[0m22:40:36.553917 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:40:36.571061 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:40:36.584198 [debug] [MainThread]: On master: COMMIT
[0m22:40:36.592124 [debug] [MainThread]: Using postgres connection "master"
[0m22:40:36.598900 [debug] [MainThread]: On master: COMMIT
[0m22:40:36.606497 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:40:36.613397 [debug] [MainThread]: On master: Close
[0m22:40:36.622015 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:40:36.628885 [debug] [MainThread]: Connection 'model.crypto_analytics.int_crypto_daily_aggs' was properly closed.
[0m22:40:36.637591 [debug] [MainThread]: Connection 'model.crypto_analytics.mart_crypto_hourly_performance' was properly closed.
[0m22:40:36.643624 [debug] [MainThread]: Connection 'model.crypto_analytics.mart_crypto_latest_prices' was properly closed.
[0m22:40:36.652571 [debug] [MainThread]: Connection 'model.crypto_analytics.mart_pipeline_monitoring' was properly closed.
[0m22:40:36.659688 [info ] [MainThread]:
[0m22:40:36.670048 [info ] [MainThread]: Finished running 1 view model, 4 table models in 0 hours 0 minutes and 8.37 seconds (8.37s).
[0m22:40:36.679405 [debug] [MainThread]: Command end result
[0m22:40:36.784254 [info ] [MainThread]:
[0m22:40:36.792253 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:40:36.800269 [info ] [MainThread]:
[0m22:40:36.808748 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m22:40:36.819026 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 20.018147, "process_user_time": 12.576165, "process_kernel_time": 1.116763, "process_mem_max_rss": "123216", "process_out_blocks": "1976", "process_in_blocks": "0"}
[0m22:40:36.826721 [debug] [MainThread]: Command `dbt run` succeeded at 22:40:36.826458 after 20.03 seconds
[0m22:40:36.834631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eef616050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ef3aec890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ef3aed190>]}
[0m22:40:36.843021 [debug] [MainThread]: Flushing usage events
[0m22:41:27.753071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18e0e99710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18e0e99650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18e0e9a850>]}


============================== 22:41:27.776934 | ef8df481-1bc6-4114-96d7-dd323628a635 ==============================
[0m22:41:27.776934 [info ] [MainThread]: Running with dbt=1.7.0
[0m22:41:27.899131 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --project-dir /app/dbt', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:41:30.078829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef8df481-1bc6-4114-96d7-dd323628a635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18df62e910>]}
[0m22:41:30.577050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef8df481-1bc6-4114-96d7-dd323628a635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18e0ebbad0>]}
[0m22:41:30.586806 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m22:41:31.552986 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m22:41:42.184034 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:41:42.204552 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:41:42.310301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef8df481-1bc6-4114-96d7-dd323628a635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18df474a10>]}
[0m22:41:42.589806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef8df481-1bc6-4114-96d7-dd323628a635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18df6dcc10>]}
[0m22:41:42.603210 [info ] [MainThread]: Found 7 models, 14 tests, 2 sources, 0 exposures, 0 metrics, 517 macros, 0 groups, 0 semantic models
[0m22:41:42.671696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef8df481-1bc6-4114-96d7-dd323628a635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18e0e7bdd0>]}
[0m22:41:42.755545 [info ] [MainThread]:
[0m22:41:42.838917 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:41:42.902998 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse'
[0m22:41:43.021583 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse"
[0m22:41:43.035769 [debug] [ThreadPool]: On list_crypto_warehouse: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse"} */

    select distinct nspname from pg_namespace

[0m22:41:43.050336 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:41:43.071073 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m22:41:43.087145 [debug] [ThreadPool]: On list_crypto_warehouse: Close
[0m22:41:43.108457 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_warehouse, now list_crypto_warehouse_public_marts)
[0m22:41:43.112200 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse_public_dbt_test__audit'
[0m22:41:43.115641 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse_public_staging'
[0m22:41:43.154115 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_marts"
[0m22:41:43.297237 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_dbt_test__audit"
[0m22:41:43.340661 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_staging"
[0m22:41:43.437315 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: BEGIN
[0m22:41:43.455138 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: BEGIN
[0m22:41:43.713902 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: BEGIN
[0m22:41:43.820032 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:41:43.836955 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:41:43.872491 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:41:43.898987 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:41:43.927692 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:41:43.947533 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:41:43.948796 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_marts"
[0m22:41:43.958154 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_dbt_test__audit"
[0m22:41:43.969343 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_staging"
[0m22:41:43.982436 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_marts"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'

[0m22:41:43.991988 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_dbt_test__audit"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'

[0m22:41:44.003704 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_staging"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'

[0m22:41:44.023374 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m22:41:44.040560 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m22:41:44.042674 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m22:41:44.051970 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: ROLLBACK
[0m22:41:44.066830 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: ROLLBACK
[0m22:41:44.080747 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: ROLLBACK
[0m22:41:44.089265 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: Close
[0m22:41:44.101050 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: Close
[0m22:41:44.109996 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: Close
[0m22:41:44.196387 [debug] [MainThread]: Using postgres connection "master"
[0m22:41:44.204385 [debug] [MainThread]: On master: BEGIN
[0m22:41:44.216981 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:41:44.235489 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:41:44.249471 [debug] [MainThread]: Using postgres connection "master"
[0m22:41:44.267527 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:41:44.305751 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m22:41:44.351608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef8df481-1bc6-4114-96d7-dd323628a635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18df6b09d0>]}
[0m22:41:44.390872 [debug] [MainThread]: On master: ROLLBACK
[0m22:41:44.439916 [debug] [MainThread]: Using postgres connection "master"
[0m22:41:44.454667 [debug] [MainThread]: On master: BEGIN
[0m22:41:44.468600 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:41:44.480861 [debug] [MainThread]: On master: COMMIT
[0m22:41:44.491203 [debug] [MainThread]: Using postgres connection "master"
[0m22:41:44.503095 [debug] [MainThread]: On master: COMMIT
[0m22:41:44.516198 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:41:44.551345 [debug] [MainThread]: On master: Close
[0m22:41:44.567760 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:41:44.584060 [info ] [MainThread]:
[0m22:41:44.645685 [debug] [Thread-2 (]: Began running node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7
[0m22:41:44.646741 [debug] [Thread-1 (]: Began running node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30
[0m22:41:44.647977 [debug] [Thread-3 (]: Began running node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300
[0m22:41:44.649231 [debug] [Thread-4 (]: Began running node test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd
[0m22:41:44.654883 [info ] [Thread-2 (]: 2 of 14 START test dbt_utils_accepted_range_stg_crypto_prices_price_usd__0 ..... [RUN]
[0m22:41:44.668742 [info ] [Thread-1 (]: 1 of 14 START test dbt_utils_accepted_range_stg_crypto_prices_market_cap__0 .... [RUN]
[0m22:41:44.692485 [info ] [Thread-3 (]: 3 of 14 START test dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0 .... [RUN]
[0m22:41:44.708517 [info ] [Thread-4 (]: 4 of 14 START test dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP  [RUN]
[0m22:41:44.724206 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_dbt_test__audit, now test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7)
[0m22:41:44.737400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_staging, now test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30)
[0m22:41:44.818500 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_marts, now test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300)
[0m22:41:44.874955 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd'
[0m22:41:44.979859 [debug] [Thread-2 (]: Began compiling node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7
[0m22:41:44.995238 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30
[0m22:41:45.004348 [debug] [Thread-3 (]: Began compiling node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300
[0m22:41:45.017280 [debug] [Thread-4 (]: Began compiling node test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd
[0m22:41:45.159971 [debug] [Thread-2 (]: Writing injected SQL for node "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7"
[0m22:41:45.176792 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30"
[0m22:41:45.178404 [debug] [Thread-3 (]: Writing injected SQL for node "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300"
[0m22:41:45.239355 [debug] [Thread-4 (]: Writing injected SQL for node "test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd"
[0m22:41:45.469496 [debug] [Thread-3 (]: Timing info for test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300 (compile): 22:41:45.138669 => 22:41:45.468755
[0m22:41:45.535821 [debug] [Thread-2 (]: Timing info for test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7 (compile): 22:41:45.030659 => 22:41:45.535106
[0m22:41:45.536989 [debug] [Thread-3 (]: Began executing node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300
[0m22:41:45.556634 [debug] [Thread-4 (]: Timing info for test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd (compile): 22:41:45.180287 => 22:41:45.555874
[0m22:41:45.564308 [debug] [Thread-2 (]: Began executing node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7
[0m22:41:45.615616 [debug] [Thread-1 (]: Timing info for test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30 (compile): 22:41:45.083200 => 22:41:45.614907
[0m22:41:45.673241 [debug] [Thread-4 (]: Began executing node test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd
[0m22:41:45.700601 [debug] [Thread-3 (]: Applying DROP to: "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0"
[0m22:41:45.735890 [debug] [Thread-2 (]: Applying DROP to: "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_price_usd__0"
[0m22:41:45.744242 [debug] [Thread-1 (]: Began executing node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30
[0m22:41:45.794635 [debug] [Thread-4 (]: Applying DROP to: "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_expression_is_true_s_7b822a4db60249ec680888478d412bb7"
[0m22:41:45.822311 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300"
[0m22:41:45.825297 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7"
[0m22:41:45.949422 [debug] [Thread-1 (]: Applying DROP to: "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_market_cap__0"
[0m22:41:45.952405 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd"
[0m22:41:45.962016 [debug] [Thread-3 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300"} */
drop table if exists "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0" cascade
[0m22:41:45.971434 [debug] [Thread-2 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7"} */
drop table if exists "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_price_usd__0" cascade
[0m22:41:45.981863 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30"
[0m22:41:45.990918 [debug] [Thread-4 (]: On test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd"} */
drop table if exists "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_expression_is_true_s_7b822a4db60249ec680888478d412bb7" cascade
[0m22:41:45.999382 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:41:46.008156 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:41:46.016533 [debug] [Thread-1 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30"} */
drop table if exists "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_market_cap__0" cascade
[0m22:41:46.025150 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:41:46.045687 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:41:46.053572 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:41:46.061836 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:41:46.070179 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:41:46.077446 [debug] [Thread-3 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0"
[0m22:41:46.091196 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:41:46.095134 [debug] [Thread-2 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_price_usd__0"
[0m22:41:46.103869 [debug] [Thread-4 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_expression_is_true_s_7b822a4db60249ec680888478d412bb7"
[0m22:41:46.146526 [debug] [Thread-1 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_market_cap__0"
[0m22:41:46.146965 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300"
[0m22:41:46.156679 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7"
[0m22:41:46.166156 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd"
[0m22:41:46.176171 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30"
[0m22:41:46.182404 [debug] [Thread-3 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300: BEGIN
[0m22:41:46.191407 [debug] [Thread-2 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7: BEGIN
[0m22:41:46.198918 [debug] [Thread-4 (]: On test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd: BEGIN
[0m22:41:46.209572 [debug] [Thread-1 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30: BEGIN
[0m22:41:46.218082 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:41:46.225695 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:41:46.232941 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m22:41:46.240528 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:41:46.247235 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300"
[0m22:41:46.253772 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7"
[0m22:41:46.262264 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd"
[0m22:41:46.269355 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30"
[0m22:41:46.278059 [debug] [Thread-3 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300"} */





  create  table "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0"


    as

  (


with meet_condition as(
  select *
  from "crypto_warehouse"."public_staging"."stg_crypto_prices"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not volume_24h >= 0
)

select *
from validation_errors


  );


[0m22:41:46.285360 [debug] [Thread-2 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7"} */





  create  table "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_price_usd__0"


    as

  (


with meet_condition as(
  select *
  from "crypto_warehouse"."public_staging"."stg_crypto_prices"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not price_usd >= 0
)

select *
from validation_errors


  );


[0m22:41:46.294618 [debug] [Thread-4 (]: On test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd"} */





  create  table "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_expression_is_true_s_7b822a4db60249ec680888478d412bb7"


    as

  (




select
    *
from "crypto_warehouse"."public_staging"."stg_crypto_prices"

where not(extracted_at  <= CURRENT_TIMESTAMP)


  );


[0m22:41:46.301875 [debug] [Thread-1 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30"} */





  create  table "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_market_cap__0"


    as

  (


with meet_condition as(
  select *
  from "crypto_warehouse"."public_staging"."stg_crypto_prices"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not market_cap >= 0
)

select *
from validation_errors


  );


[0m22:41:46.606050 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.0 seconds
[0m22:41:46.607018 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.0 seconds
[0m22:41:46.614938 [debug] [Thread-3 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300: COMMIT
[0m22:41:46.623532 [debug] [Thread-2 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7: COMMIT
[0m22:41:46.629728 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300"
[0m22:41:46.636929 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7"
[0m22:41:46.644115 [debug] [Thread-3 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300: COMMIT
[0m22:41:46.651639 [debug] [Thread-2 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7: COMMIT
[0m22:41:46.757409 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m22:41:46.759169 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.0 seconds
[0m22:41:46.767928 [debug] [Thread-1 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30: COMMIT
[0m22:41:46.778218 [debug] [Thread-4 (]: On test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd: COMMIT
[0m22:41:46.786853 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30"
[0m22:41:46.795661 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd"
[0m22:41:46.804081 [debug] [Thread-1 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30: COMMIT
[0m22:41:46.813053 [debug] [Thread-4 (]: On test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd: COMMIT
[0m22:41:46.846585 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m22:41:46.847510 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m22:41:46.864729 [debug] [Thread-3 (]: Writing runtime sql for node "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300"
[0m22:41:46.870885 [debug] [Thread-2 (]: Writing runtime sql for node "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7"
[0m22:41:46.912496 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300"
[0m22:41:46.921297 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7"
[0m22:41:46.923306 [debug] [Thread-3 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300: BEGIN
[0m22:41:46.929688 [debug] [Thread-2 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7: BEGIN
[0m22:41:46.937634 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:41:46.945510 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:41:46.951399 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300"
[0m22:41:46.960050 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7"
[0m22:41:46.968061 [debug] [Thread-3 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (

        select *
        from "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0"


    ) dbt_internal_test
[0m22:41:46.976632 [debug] [Thread-2 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (

        select *
        from "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_price_usd__0"


    ) dbt_internal_test
[0m22:41:46.983915 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:41:46.996521 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:41:47.005537 [debug] [Thread-3 (]: Timing info for test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300 (execute): 22:41:45.580142 => 22:41:47.004897
[0m22:41:47.015644 [debug] [Thread-2 (]: Timing info for test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7 (execute): 22:41:45.708810 => 22:41:47.015195
[0m22:41:47.021117 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m22:41:47.022100 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:41:47.024079 [debug] [Thread-3 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300: ROLLBACK
[0m22:41:47.031593 [debug] [Thread-2 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7: ROLLBACK
[0m22:41:47.039768 [debug] [Thread-4 (]: Writing runtime sql for node "test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd"
[0m22:41:47.048928 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30"
[0m22:41:47.056817 [debug] [Thread-3 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300: Close
[0m22:41:47.064384 [debug] [Thread-2 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7: Close
[0m22:41:47.087852 [info ] [Thread-3 (]: 3 of 14 PASS dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0 .......... [[32mPASS[0m in 2.27s]
[0m22:41:47.115799 [info ] [Thread-2 (]: 2 of 14 PASS dbt_utils_accepted_range_stg_crypto_prices_price_usd__0 ........... [[32mPASS[0m in 2.39s]
[0m22:41:47.130057 [debug] [Thread-3 (]: Finished running node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300
[0m22:41:47.135203 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30"
[0m22:41:47.155843 [debug] [Thread-2 (]: Finished running node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7
[0m22:41:47.165907 [debug] [Thread-3 (]: Began running node test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5
[0m22:41:47.351795 [debug] [Thread-1 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30: BEGIN
[0m22:41:47.524475 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd"
[0m22:41:47.526102 [debug] [Thread-2 (]: Began running node test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79
[0m22:41:47.537835 [info ] [Thread-3 (]: 5 of 14 START test not_null_stg_crypto_prices_extracted_at ..................... [RUN]
[0m22:41:47.546705 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:41:47.557652 [debug] [Thread-4 (]: On test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd: BEGIN
[0m22:41:47.566374 [info ] [Thread-2 (]: 6 of 14 START test not_null_stg_crypto_prices_market_cap ....................... [RUN]
[0m22:41:47.579459 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300, now test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5)
[0m22:41:47.588976 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30"
[0m22:41:47.597377 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m22:41:47.605899 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7, now test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79)
[0m22:41:47.634270 [debug] [Thread-3 (]: Began compiling node test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5
[0m22:41:47.648947 [debug] [Thread-1 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (

        select *
        from "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_market_cap__0"


    ) dbt_internal_test
[0m22:41:47.657652 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd"
[0m22:41:47.665719 [debug] [Thread-2 (]: Began compiling node test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79
[0m22:41:47.700354 [debug] [Thread-3 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5"
[0m22:41:47.707505 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:41:47.713977 [debug] [Thread-4 (]: On test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (

        select *
        from "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_expression_is_true_s_7b822a4db60249ec680888478d412bb7"


    ) dbt_internal_test
[0m22:41:47.738875 [debug] [Thread-2 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79"
[0m22:41:47.756108 [debug] [Thread-1 (]: Timing info for test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30 (execute): 22:41:45.835866 => 22:41:47.755360
[0m22:41:47.817992 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:41:47.841992 [debug] [Thread-1 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30: ROLLBACK
[0m22:41:47.888891 [debug] [Thread-4 (]: Timing info for test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd (execute): 22:41:45.756812 => 22:41:47.888097
[0m22:41:47.938368 [debug] [Thread-1 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30: Close
[0m22:41:47.961757 [debug] [Thread-4 (]: On test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd: ROLLBACK
[0m22:41:47.964441 [debug] [Thread-3 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5 (compile): 22:41:47.674221 => 22:41:47.963668
[0m22:41:47.977096 [info ] [Thread-1 (]: 1 of 14 PASS dbt_utils_accepted_range_stg_crypto_prices_market_cap__0 .......... [[32mPASS[0m in 3.24s]
[0m22:41:47.982350 [debug] [Thread-2 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79 (compile): 22:41:47.724996 => 22:41:47.981620
[0m22:41:47.996747 [debug] [Thread-4 (]: On test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd: Close
[0m22:41:48.014880 [debug] [Thread-3 (]: Began executing node test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5
[0m22:41:48.027949 [debug] [Thread-1 (]: Finished running node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30
[0m22:41:48.041316 [debug] [Thread-2 (]: Began executing node test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79
[0m22:41:48.050609 [info ] [Thread-4 (]: 4 of 14 PASS dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP  [[32mPASS[0m in 3.18s]
[0m22:41:48.095627 [debug] [Thread-3 (]: Applying DROP to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_extracted_at"
[0m22:41:48.099741 [debug] [Thread-1 (]: Began running node test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f
[0m22:41:48.132670 [debug] [Thread-2 (]: Applying DROP to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_market_cap"
[0m22:41:48.143418 [debug] [Thread-4 (]: Finished running node test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd
[0m22:41:48.160255 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5"
[0m22:41:48.172046 [info ] [Thread-1 (]: 7 of 14 START test not_null_stg_crypto_prices_price_id ......................... [RUN]
[0m22:41:48.189730 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79"
[0m22:41:48.199525 [debug] [Thread-4 (]: Began running node test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf
[0m22:41:48.216685 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5"} */
drop table if exists "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_extracted_at" cascade
[0m22:41:48.242306 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30, now test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f)
[0m22:41:48.260296 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79"} */
drop table if exists "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_market_cap" cascade
[0m22:41:48.276071 [info ] [Thread-4 (]: 8 of 14 START test not_null_stg_crypto_prices_price_usd ........................ [RUN]
[0m22:41:48.305123 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:41:48.338918 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f
[0m22:41:48.361383 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:41:48.374463 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd, now test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf)
[0m22:41:48.393973 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:41:48.434295 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f"
[0m22:41:48.465753 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:41:48.476846 [debug] [Thread-4 (]: Began compiling node test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf
[0m22:41:48.488834 [debug] [Thread-3 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_extracted_at"
[0m22:41:48.511610 [debug] [Thread-2 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_market_cap"
[0m22:41:48.576282 [debug] [Thread-4 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf"
[0m22:41:48.710040 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5"
[0m22:41:48.740124 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79"
[0m22:41:48.777342 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5: BEGIN
[0m22:41:48.794572 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79: BEGIN
[0m22:41:48.825134 [debug] [Thread-1 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f (compile): 22:41:48.424346 => 22:41:48.824253
[0m22:41:48.842233 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:41:48.872591 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:41:48.885441 [debug] [Thread-4 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf (compile): 22:41:48.551541 => 22:41:48.884471
[0m22:41:48.886775 [debug] [Thread-1 (]: Began executing node test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f
[0m22:41:48.897924 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5"
[0m22:41:48.906858 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79"
[0m22:41:48.917902 [debug] [Thread-4 (]: Began executing node test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf
[0m22:41:48.948193 [debug] [Thread-1 (]: Applying DROP to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_price_id"
[0m22:41:48.949896 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5"} */





  create  table "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_extracted_at"


    as

  (






select *
from "crypto_warehouse"."public_staging"."stg_crypto_prices"
where extracted_at is null



  );


[0m22:41:48.959660 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79"} */





  create  table "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_market_cap"


    as

  (






select *
from "crypto_warehouse"."public_staging"."stg_crypto_prices"
where market_cap is null



  );


[0m22:41:48.981111 [debug] [Thread-4 (]: Applying DROP to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_price_usd"
[0m22:41:48.986975 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f"
[0m22:41:49.013932 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf"
[0m22:41:49.027310 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f"} */
drop table if exists "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_price_id" cascade
[0m22:41:49.037023 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf"} */
drop table if exists "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_price_usd" cascade
[0m22:41:49.045270 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:41:49.054150 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:41:49.081373 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:41:49.111299 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:41:49.115111 [debug] [Thread-1 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_price_id"
[0m22:41:49.127225 [debug] [Thread-4 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_price_usd"
[0m22:41:49.146567 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f"
[0m22:41:49.158548 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf"
[0m22:41:49.167985 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f: BEGIN
[0m22:41:49.176624 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf: BEGIN
[0m22:41:49.203143 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:41:49.210701 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m22:41:49.213390 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.0 seconds
[0m22:41:49.218470 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f"
[0m22:41:49.227559 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf"
[0m22:41:49.237588 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5: COMMIT
[0m22:41:49.245736 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f"} */





  create  table "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_price_id"


    as

  (






select *
from "crypto_warehouse"."public_staging"."stg_crypto_prices"
where price_id is null



  );


[0m22:41:49.256169 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf"} */





  create  table "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_price_usd"


    as

  (






select *
from "crypto_warehouse"."public_staging"."stg_crypto_prices"
where price_usd is null



  );


[0m22:41:49.265005 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5"
[0m22:41:49.291378 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5: COMMIT
[0m22:41:49.416402 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m22:41:49.433205 [debug] [Thread-3 (]: Writing runtime sql for node "test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5"
[0m22:41:49.473976 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.0 seconds
[0m22:41:49.484113 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79: COMMIT
[0m22:41:49.498999 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79"
[0m22:41:49.509491 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79: COMMIT
[0m22:41:49.531825 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5"
[0m22:41:49.544382 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5: BEGIN
[0m22:41:49.556309 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:41:49.563793 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5"
[0m22:41:49.571940 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (

        select *
        from "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_extracted_at"


    ) dbt_internal_test
[0m22:41:49.580211 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:41:49.589339 [debug] [Thread-3 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5 (execute): 22:41:48.061606 => 22:41:49.588813
[0m22:41:49.596204 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5: ROLLBACK
[0m22:41:49.603912 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5: Close
[0m22:41:49.612385 [info ] [Thread-3 (]: 5 of 14 PASS not_null_stg_crypto_prices_extracted_at ........................... [[32mPASS[0m in 2.03s]
[0m22:41:49.637284 [debug] [Thread-3 (]: Finished running node test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5
[0m22:41:49.648089 [debug] [Thread-3 (]: Began running node test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a
[0m22:41:49.655331 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.0 seconds
[0m22:41:49.656449 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m22:41:49.657508 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m22:41:49.679991 [info ] [Thread-3 (]: 9 of 14 START test not_null_stg_crypto_prices_symbol ........................... [RUN]
[0m22:41:49.703504 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf: COMMIT
[0m22:41:49.713658 [debug] [Thread-2 (]: Writing runtime sql for node "test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79"
[0m22:41:49.728070 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f: COMMIT
[0m22:41:49.742534 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5, now test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a)
[0m22:41:49.752394 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf"
[0m22:41:49.769511 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f"
[0m22:41:49.778266 [debug] [Thread-3 (]: Began compiling node test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a
[0m22:41:49.789272 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf: COMMIT
[0m22:41:49.821443 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f: COMMIT
[0m22:41:49.879538 [debug] [Thread-3 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a"
[0m22:41:49.957776 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79"
[0m22:41:49.986070 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79: BEGIN
[0m22:41:49.993242 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m22:41:50.036237 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:41:50.055531 [debug] [Thread-4 (]: Writing runtime sql for node "test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf"
[0m22:41:50.069312 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:41:50.085310 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79"
[0m22:41:50.195897 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (

        select *
        from "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_market_cap"


    ) dbt_internal_test
[0m22:41:50.171593 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f"
[0m22:41:50.253021 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:41:50.300445 [debug] [Thread-2 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79 (execute): 22:41:48.110466 => 22:41:50.299754
[0m22:41:50.316597 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79: ROLLBACK
[0m22:41:50.344010 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79: Close
[0m22:41:50.349198 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f"
[0m22:41:50.358438 [info ] [Thread-2 (]: 6 of 14 PASS not_null_stg_crypto_prices_market_cap ............................. [[32mPASS[0m in 2.75s]
[0m22:41:50.379009 [debug] [Thread-3 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a (compile): 22:41:49.860097 => 22:41:50.378276
[0m22:41:50.380345 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f: BEGIN
[0m22:41:50.736153 [debug] [Thread-2 (]: Finished running node test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79
[0m22:41:50.793842 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf"
[0m22:41:50.806431 [debug] [Thread-3 (]: Began executing node test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a
[0m22:41:50.832798 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:41:50.852962 [debug] [Thread-2 (]: Began running node test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438
[0m22:41:50.889009 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf: BEGIN
[0m22:41:50.927355 [debug] [Thread-3 (]: Applying DROP to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_symbol"
[0m22:41:50.958235 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f"
[0m22:41:51.255584 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (

        select *
        from "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_price_id"


    ) dbt_internal_test
[0m22:41:50.994871 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m22:41:51.080069 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a"
[0m22:41:50.975843 [info ] [Thread-2 (]: 10 of 14 START test not_null_stg_crypto_prices_volume_24h ...................... [RUN]
[0m22:41:51.567033 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79, now test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438)
[0m22:41:51.388967 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf"
[0m22:41:51.500120 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a"} */
drop table if exists "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_symbol" cascade
[0m22:41:51.309750 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:41:51.597449 [debug] [Thread-2 (]: Began compiling node test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438
[0m22:41:51.617564 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (

        select *
        from "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_price_usd"


    ) dbt_internal_test
[0m22:41:51.780754 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:41:51.675058 [debug] [Thread-1 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f (execute): 22:41:48.925624 => 22:41:51.674401
[0m22:41:51.845359 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f: ROLLBACK
[0m22:41:51.642778 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:41:51.807419 [debug] [Thread-4 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf (execute): 22:41:48.968477 => 22:41:51.806720
[0m22:41:51.748010 [debug] [Thread-2 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438"
[0m22:41:51.866311 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f: Close
[0m22:41:51.886241 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:41:51.895324 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf: ROLLBACK
[0m22:41:51.923817 [info ] [Thread-1 (]: 7 of 14 PASS not_null_stg_crypto_prices_price_id ............................... [[32mPASS[0m in 3.68s]
[0m22:41:51.940262 [debug] [Thread-3 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_symbol"
[0m22:41:51.993401 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf: Close
[0m22:41:52.006328 [debug] [Thread-1 (]: Finished running node test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f
[0m22:41:52.025950 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a"
[0m22:41:52.039531 [info ] [Thread-4 (]: 8 of 14 PASS not_null_stg_crypto_prices_price_usd .............................. [[32mPASS[0m in 3.67s]
[0m22:41:52.057137 [debug] [Thread-1 (]: Began running node test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39
[0m22:41:52.066826 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a: BEGIN
[0m22:41:52.106681 [debug] [Thread-4 (]: Finished running node test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf
[0m22:41:52.117516 [info ] [Thread-1 (]: 11 of 14 START test not_null_stg_pipeline_runs_run_id .......................... [RUN]
[0m22:41:52.125152 [debug] [Thread-2 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438 (compile): 22:41:51.709828 => 22:41:52.124492
[0m22:41:52.133341 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:41:52.150049 [debug] [Thread-4 (]: Began running node test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e
[0m22:41:52.158833 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f, now test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39)
[0m22:41:52.170300 [debug] [Thread-2 (]: Began executing node test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438
[0m22:41:52.178543 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a"
[0m22:41:52.187717 [info ] [Thread-4 (]: 12 of 14 START test not_null_stg_pipeline_runs_stage ........................... [RUN]
[0m22:41:52.290712 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf, now test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e)
[0m22:41:52.239762 [debug] [Thread-2 (]: Applying DROP to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_volume_24h"
[0m22:41:52.241552 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a"} */





  create  table "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_symbol"


    as

  (






select *
from "crypto_warehouse"."public_staging"."stg_crypto_prices"
where symbol is null



  );


[0m22:41:52.205789 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39
[0m22:41:52.303093 [debug] [Thread-4 (]: Began compiling node test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e
[0m22:41:52.682092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01a1040490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01a1065850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01a1042090>]}
[0m22:41:52.589619 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438"


============================== 22:41:52.699697 | 857c4abd-2d4e-45ef-914c-ac2691914a97 ==============================
[0m22:41:52.699697 [info ] [MainThread]: Running with dbt=1.7.0
[0m22:41:52.668970 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39"
[0m22:41:52.718991 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/app/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug --project-dir /app/dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:41:52.702445 [debug] [Thread-4 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e"
[0m22:41:52.708637 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438"} */
drop table if exists "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_volume_24h" cascade
[0m22:41:52.757724 [info ] [MainThread]: dbt version: 1.7.0
[0m22:41:52.758614 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.0 seconds
[0m22:41:52.784398 [info ] [MainThread]: python version: 3.11.13
[0m22:41:52.767770 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:41:52.790020 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a: COMMIT
[0m22:41:52.799364 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m22:41:52.814144 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:41:52.823948 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m22:41:52.820736 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a"
[0m22:41:52.833203 [debug] [Thread-2 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_volume_24h"
[0m22:41:52.843572 [debug] [Thread-4 (]: Timing info for test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e (compile): 22:41:52.682370 => 22:41:52.842537
[0m22:41:52.888245 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a: COMMIT
[0m22:41:52.905585 [debug] [Thread-1 (]: Timing info for test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39 (compile): 22:41:52.646145 => 22:41:52.904727
[0m22:41:52.913465 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438"
[0m22:41:52.922723 [debug] [Thread-4 (]: Began executing node test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e
[0m22:41:52.941231 [debug] [Thread-1 (]: Began executing node test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39
[0m22:41:52.951745 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438: BEGIN
[0m22:41:52.981906 [debug] [Thread-4 (]: Applying DROP to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_stage"
[0m22:41:52.982911 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m22:41:53.010911 [debug] [Thread-1 (]: Applying DROP to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_run_id"
[0m22:41:53.028868 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:41:53.038821 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e"
[0m22:41:53.048598 [debug] [Thread-3 (]: Writing runtime sql for node "test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a"
[0m22:41:53.058405 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39"
[0m22:41:53.071241 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438"
[0m22:41:53.080354 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e"} */
drop table if exists "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_stage" cascade
[0m22:41:53.099886 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39"} */
drop table if exists "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_run_id" cascade
[0m22:41:53.108801 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438"} */





  create  table "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_volume_24h"


    as

  (






select *
from "crypto_warehouse"."public_staging"."stg_crypto_prices"
where volume_24h is null



  );


[0m22:41:53.120573 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:41:53.131846 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:41:53.174565 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:41:53.183156 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:41:53.185005 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a"
[0m22:41:53.188302 [debug] [Thread-1 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_run_id"
[0m22:41:53.202569 [debug] [Thread-4 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_stage"
[0m22:41:53.213633 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a: BEGIN
[0m22:41:53.243058 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39"
[0m22:41:53.257774 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e"
[0m22:41:53.269636 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:41:53.276561 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39: BEGIN
[0m22:41:53.285511 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e: BEGIN
[0m22:41:53.293544 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a"
[0m22:41:53.303852 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:41:53.315035 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.0 seconds
[0m22:41:53.321587 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m22:41:53.329213 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (

        select *
        from "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_symbol"


    ) dbt_internal_test
[0m22:41:53.338028 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39"
[0m22:41:53.374695 [info ] [MainThread]: Using profiles dir at /app
[0m22:41:53.349393 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438: COMMIT
[0m22:41:53.386037 [info ] [MainThread]: Using profiles.yml file at /app/profiles.yml
[0m22:41:53.358097 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e"
[0m22:41:53.396558 [info ] [MainThread]: Using dbt_project.yml file at /app/dbt/dbt_project.yml
[0m22:41:53.406808 [info ] [MainThread]: adapter type: postgres
[0m22:41:53.417656 [info ] [MainThread]: adapter version: 1.7.0
[0m22:41:53.373342 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:41:53.382674 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39"} */





  create  table "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_run_id"


    as

  (






select *
from "crypto_warehouse"."public_staging"."stg_pipeline_runs"
where run_id is null



  );


[0m22:41:53.391222 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438"
[0m22:41:53.405304 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e"} */





  create  table "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_stage"


    as

  (






select *
from "crypto_warehouse"."public_staging"."stg_pipeline_runs"
where stage is null



  );


[0m22:41:53.476643 [debug] [Thread-3 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a (execute): 22:41:50.904897 => 22:41:53.475693
[0m22:41:53.510975 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438: COMMIT
[0m22:41:53.532606 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a: ROLLBACK
[0m22:41:53.548068 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a: Close
[0m22:41:53.557738 [info ] [Thread-3 (]: 9 of 14 PASS not_null_stg_crypto_prices_symbol ................................. [[32mPASS[0m in 3.82s]
[0m22:41:53.651549 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m22:41:53.654038 [debug] [Thread-3 (]: Finished running node test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a
[0m22:41:53.661244 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m22:41:53.711271 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39: COMMIT
[0m22:41:53.798440 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39"
[0m22:41:53.773822 [debug] [Thread-2 (]: Writing runtime sql for node "test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438"
[0m22:41:53.755253 [debug] [Thread-3 (]: Began running node test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd
[0m22:41:53.874543 [info ] [Thread-3 (]: 13 of 14 START test not_null_stg_pipeline_runs_status .......................... [RUN]
[0m22:41:53.822377 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39: COMMIT
[0m22:41:53.814144 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.0 seconds
[0m22:41:53.921496 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a, now test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd)
[0m22:41:53.943248 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e: COMMIT
[0m22:41:53.954334 [debug] [Thread-3 (]: Began compiling node test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd
[0m22:41:53.965211 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e"
[0m22:41:54.033207 [info ] [MainThread]: Configuration:
[0m22:41:54.011058 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:41:54.045612 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:41:54.055303 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:41:54.015153 [debug] [Thread-3 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd"
[0m22:41:54.037863 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e: COMMIT
[0m22:41:54.067523 [info ] [MainThread]: Required dependencies:
[0m22:41:54.084472 [debug] [MainThread]: Executing "git --help"
[0m22:41:54.096528 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:41:54.039421 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438"
[0m22:41:54.114916 [debug] [MainThread]: STDERR: "b''"
[0m22:41:54.138660 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:41:54.053554 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39"
[0m22:41:54.119332 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438: BEGIN
[0m22:41:54.147361 [info ] [MainThread]: Connection:
[0m22:41:54.126532 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m22:41:54.172719 [info ] [MainThread]:   host: postgres
[0m22:41:54.164910 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:41:54.194143 [debug] [Thread-4 (]: Writing runtime sql for node "test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e"
[0m22:41:54.208737 [info ] [MainThread]:   port: 5432
[0m22:41:54.216167 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438"
[0m22:41:54.236585 [info ] [MainThread]:   user: postgres
[0m22:41:54.247546 [info ] [MainThread]:   database: crypto_warehouse
[0m22:41:54.240858 [debug] [Thread-3 (]: Timing info for test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd (compile): 22:41:53.986319 => 22:41:54.239882
[0m22:41:54.264508 [info ] [MainThread]:   schema: public
[0m22:41:54.242804 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (

        select *
        from "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_volume_24h"


    ) dbt_internal_test
[0m22:41:54.275735 [info ] [MainThread]:   connect_timeout: 10
[0m22:41:54.266483 [debug] [Thread-3 (]: Began executing node test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd
[0m22:41:54.308392 [info ] [MainThread]:   role: None
[0m22:41:54.326496 [info ] [MainThread]:   search_path: None
[0m22:41:54.348963 [info ] [MainThread]:   keepalives_idle: 0
[0m22:41:54.288769 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:41:54.350378 [debug] [Thread-3 (]: Applying DROP to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_status"
[0m22:41:54.364812 [info ] [MainThread]:   sslmode: None
[0m22:41:54.396299 [info ] [MainThread]:   sslcert: None
[0m22:41:54.354410 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e"
[0m22:41:54.369013 [debug] [Thread-2 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438 (execute): 22:41:52.216670 => 22:41:54.368185
[0m22:41:54.422418 [info ] [MainThread]:   sslkey: None
[0m22:41:54.370935 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39"
[0m22:41:54.475818 [info ] [MainThread]:   sslrootcert: None
[0m22:41:54.384728 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd"
[0m22:41:54.515356 [info ] [MainThread]:   application_name: dbt
[0m22:41:54.412689 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e: BEGIN
[0m22:41:54.541429 [info ] [MainThread]:   retries: 1
[0m22:41:54.467677 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438: ROLLBACK
[0m22:41:54.550703 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m22:41:54.505169 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39: BEGIN
[0m22:41:54.559284 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m22:41:54.539274 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd"} */
drop table if exists "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_status" cascade
[0m22:41:54.567554 [debug] [MainThread]: Using postgres connection "debug"
[0m22:41:54.575100 [debug] [MainThread]: On debug: select 1 as id
[0m22:41:54.551101 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m22:41:54.582925 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:41:54.559548 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438: Close
[0m22:41:54.567727 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:41:54.598912 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m22:41:54.608323 [debug] [MainThread]: On debug: Close
[0m22:41:54.574384 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:41:54.586131 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e"
[0m22:41:54.596719 [info ] [Thread-2 (]: 10 of 14 PASS not_null_stg_crypto_prices_volume_24h ............................ [[32mPASS[0m in 3.03s]
[0m22:41:54.606955 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39"
[0m22:41:54.632586 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:41:54.634979 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m22:41:54.645405 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (

        select *
        from "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_stage"


    ) dbt_internal_test
[0m22:41:54.654378 [debug] [Thread-2 (]: Finished running node test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438
[0m22:41:54.704484 [info ] [MainThread]: [32mAll checks passed![0m
[0m22:41:54.664322 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (

        select *
        from "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_run_id"


    ) dbt_internal_test
[0m22:41:54.676071 [debug] [Thread-3 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_status"
[0m22:41:54.754773 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.7644656, "process_user_time": 10.699195, "process_kernel_time": 0.72004, "process_mem_max_rss": "111100", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:41:54.704132 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:41:54.774965 [debug] [MainThread]: Command `dbt debug` succeeded at 22:41:54.774639 after 2.78 seconds
[0m22:41:54.787457 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m22:41:54.726759 [debug] [Thread-2 (]: Began running node test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43
[0m22:41:54.760533 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:41:54.772382 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd"
[0m22:41:54.787003 [debug] [Thread-4 (]: Timing info for test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e (execute): 22:41:52.959564 => 22:41:54.786225
[0m22:41:54.797080 [info ] [Thread-2 (]: 14 of 14 START test unique_stg_crypto_prices_price_id .......................... [RUN]
[0m22:41:54.795563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01a1029310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01a1040850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f019f7d5f50>]}
[0m22:41:54.808026 [debug] [Thread-1 (]: Timing info for test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39 (execute): 22:41:52.988058 => 22:41:54.807358
[0m22:41:54.840826 [debug] [MainThread]: Flushing usage events
[0m22:41:54.816381 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd: BEGIN
[0m22:41:54.825694 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e: ROLLBACK
[0m22:41:54.838628 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438, now test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43)
[0m22:41:54.853882 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39: ROLLBACK
[0m22:41:54.876436 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:41:54.888730 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e: Close
[0m22:41:54.896340 [debug] [Thread-2 (]: Began compiling node test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43
[0m22:41:54.904602 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39: Close
[0m22:41:54.912348 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd"
[0m22:41:54.921261 [info ] [Thread-4 (]: 12 of 14 PASS not_null_stg_pipeline_runs_stage ................................. [[32mPASS[0m in 2.63s]
[0m22:41:54.979144 [debug] [Thread-2 (]: Writing injected SQL for node "test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43"
[0m22:41:54.981576 [info ] [Thread-1 (]: 11 of 14 PASS not_null_stg_pipeline_runs_run_id ................................ [[32mPASS[0m in 2.82s]
[0m22:41:55.007005 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd"} */





  create  table "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_status"


    as

  (






select *
from "crypto_warehouse"."public_staging"."stg_pipeline_runs"
where status is null



  );


[0m22:41:55.017236 [debug] [Thread-4 (]: Finished running node test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e
[0m22:41:55.033472 [debug] [Thread-1 (]: Finished running node test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39
[0m22:41:55.097589 [debug] [Thread-2 (]: Timing info for test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43 (compile): 22:41:54.927905 => 22:41:55.096815
[0m22:41:55.108285 [debug] [Thread-2 (]: Began executing node test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43
[0m22:41:55.139588 [debug] [Thread-2 (]: Applying DROP to: "crypto_warehouse"."public_dbt_test__audit"."unique_stg_crypto_prices_price_id"
[0m22:41:55.154660 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43"
[0m22:41:55.165204 [debug] [Thread-2 (]: On test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43"} */
drop table if exists "crypto_warehouse"."public_dbt_test__audit"."unique_stg_crypto_prices_price_id" cascade
[0m22:41:55.171293 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.0 seconds
[0m22:41:55.174772 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:41:55.185268 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd: COMMIT
[0m22:41:55.202088 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:41:55.205685 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd"
[0m22:41:55.217551 [debug] [Thread-2 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."unique_stg_crypto_prices_price_id"
[0m22:41:55.226810 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd: COMMIT
[0m22:41:55.237054 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43"
[0m22:41:55.254544 [debug] [Thread-2 (]: On test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43: BEGIN
[0m22:41:55.263403 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:41:55.272874 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43"
[0m22:41:55.282336 [debug] [Thread-2 (]: On test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43"} */





  create  table "crypto_warehouse"."public_dbt_test__audit"."unique_stg_crypto_prices_price_id"


    as

  (




select
    price_id as unique_field,
    count(*) as n_records

from "crypto_warehouse"."public_staging"."stg_crypto_prices"
where price_id is not null
group by price_id
having count(*) > 1



  );


[0m22:41:55.294026 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.0 seconds
[0m22:41:55.304117 [debug] [Thread-2 (]: On test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43: COMMIT
[0m22:41:55.305309 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m22:41:55.314215 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43"
[0m22:41:55.324220 [debug] [Thread-3 (]: Writing runtime sql for node "test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd"
[0m22:41:55.333757 [debug] [Thread-2 (]: On test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43: COMMIT
[0m22:41:55.401359 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd"
[0m22:41:55.407318 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m22:41:55.411676 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd: BEGIN
[0m22:41:55.420353 [debug] [Thread-2 (]: Writing runtime sql for node "test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43"
[0m22:41:55.433792 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m22:41:55.453265 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd"
[0m22:41:55.465863 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (

        select *
        from "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_status"


    ) dbt_internal_test
[0m22:41:55.477294 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:41:55.489525 [debug] [Thread-3 (]: Timing info for test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd (execute): 22:41:54.325989 => 22:41:55.488899
[0m22:41:55.497983 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd: ROLLBACK
[0m22:41:55.506767 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd: Close
[0m22:41:55.509372 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43"
[0m22:41:55.517662 [info ] [Thread-3 (]: 13 of 14 PASS not_null_stg_pipeline_runs_status ................................ [[32mPASS[0m in 1.60s]
[0m22:41:55.527138 [debug] [Thread-2 (]: On test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43: BEGIN
[0m22:41:55.536545 [debug] [Thread-3 (]: Finished running node test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd
[0m22:41:55.546009 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:41:55.580061 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43"
[0m22:41:55.616057 [debug] [Thread-2 (]: On test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (

        select *
        from "crypto_warehouse"."public_dbt_test__audit"."unique_stg_crypto_prices_price_id"


    ) dbt_internal_test
[0m22:41:55.627382 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:41:55.647080 [debug] [Thread-2 (]: Timing info for test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43 (execute): 22:41:55.117799 => 22:41:55.646013
[0m22:41:55.666464 [debug] [Thread-2 (]: On test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43: ROLLBACK
[0m22:41:55.674918 [debug] [Thread-2 (]: On test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43: Close
[0m22:41:55.686919 [info ] [Thread-2 (]: 14 of 14 PASS unique_stg_crypto_prices_price_id ................................ [[32mPASS[0m in 0.85s]
[0m22:41:55.697661 [debug] [Thread-2 (]: Finished running node test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43
[0m22:41:55.710511 [debug] [MainThread]: Using postgres connection "master"
[0m22:41:55.718873 [debug] [MainThread]: On master: BEGIN
[0m22:41:55.726970 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:41:55.741135 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:41:55.749818 [debug] [MainThread]: On master: COMMIT
[0m22:41:55.758292 [debug] [MainThread]: Using postgres connection "master"
[0m22:41:55.766432 [debug] [MainThread]: On master: COMMIT
[0m22:41:55.774618 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:41:55.782692 [debug] [MainThread]: On master: Close
[0m22:41:55.807288 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:41:55.817598 [debug] [MainThread]: Connection 'test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd' was properly closed.
[0m22:41:55.826011 [debug] [MainThread]: Connection 'test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43' was properly closed.
[0m22:41:55.834499 [debug] [MainThread]: Connection 'test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39' was properly closed.
[0m22:41:55.842557 [debug] [MainThread]: Connection 'test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e' was properly closed.
[0m22:41:55.851343 [info ] [MainThread]:
[0m22:41:55.863155 [info ] [MainThread]: Finished running 14 tests in 0 hours 0 minutes and 13.01 seconds (13.01s).
[0m22:41:55.878703 [debug] [MainThread]: Command end result
[0m22:41:56.084468 [info ] [MainThread]:
[0m22:41:56.098536 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:41:56.117946 [info ] [MainThread]:
[0m22:41:56.139016 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
[0m22:41:56.169426 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 28.563158, "process_user_time": 19.016298, "process_kernel_time": 1.728754, "process_mem_max_rss": "124536", "process_out_blocks": "1976", "process_in_blocks": "0"}
[0m22:41:56.248720 [debug] [MainThread]: Command `dbt test` succeeded at 22:41:56.248303 after 28.64 seconds
[0m22:41:56.486069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18df661810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18e5890990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18e5891290>]}
[0m22:41:56.500255 [debug] [MainThread]: Flushing usage events
[0m22:49:08.676883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bdc9acc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bdce7eb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bdc9ad8d0>]}


============================== 22:49:08.697286 | ceb2cbd6-967a-4ffc-a471-35e6bb4003ce ==============================
[0m22:49:08.697286 [info ] [MainThread]: Running with dbt=1.7.0
[0m22:49:08.705768 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/app', 'log_path': '/app/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /app/dbt', 'send_anonymous_usage_stats': 'True'}
[0m22:49:09.300832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ceb2cbd6-967a-4ffc-a471-35e6bb4003ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bdc8ae910>]}
[0m22:49:09.638165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ceb2cbd6-967a-4ffc-a471-35e6bb4003ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bdb158a10>]}
[0m22:49:09.650412 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m22:49:10.048913 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m22:49:27.418226 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:49:27.434343 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:49:27.483861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ceb2cbd6-967a-4ffc-a471-35e6bb4003ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bdafafc10>]}
[0m22:49:27.724831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ceb2cbd6-967a-4ffc-a471-35e6bb4003ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bdb069ed0>]}
[0m22:49:27.736468 [info ] [MainThread]: Found 7 models, 14 tests, 2 sources, 0 exposures, 0 metrics, 517 macros, 0 groups, 0 semantic models
[0m22:49:27.748614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ceb2cbd6-967a-4ffc-a471-35e6bb4003ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bdc9eef90>]}
[0m22:49:27.762638 [info ] [MainThread]:
[0m22:49:27.777061 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:49:27.790785 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse'
[0m22:49:27.793089 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse'
[0m22:49:27.846805 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse"
[0m22:49:27.852892 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse"
[0m22:49:27.865089 [debug] [ThreadPool]: On list_crypto_warehouse: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse"} */

    select distinct nspname from pg_namespace

[0m22:49:27.876837 [debug] [ThreadPool]: On list_crypto_warehouse: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse"} */

    select distinct nspname from pg_namespace

[0m22:49:27.895339 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:49:27.910974 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:49:27.930808 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m22:49:27.949073 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m22:49:27.963499 [debug] [ThreadPool]: On list_crypto_warehouse: Close
[0m22:49:27.979720 [debug] [ThreadPool]: On list_crypto_warehouse: Close
[0m22:49:28.011344 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_warehouse, now list_crypto_warehouse_public_dbt_test__audit)
[0m22:49:28.017409 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_warehouse, now list_crypto_warehouse_public_staging)
[0m22:49:28.020611 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse_public_marts'
[0m22:49:28.098898 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_dbt_test__audit"
[0m22:49:28.112732 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_staging"
[0m22:49:28.242926 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_marts"
[0m22:49:28.284947 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: BEGIN
[0m22:49:28.335519 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: BEGIN
[0m22:49:28.434985 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: BEGIN
[0m22:49:28.466561 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:49:28.498503 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:49:28.649870 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:49:28.735276 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:49:28.756965 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:49:28.839242 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:49:29.027506 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_dbt_test__audit"
[0m22:49:29.080269 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_staging"
[0m22:49:29.100831 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_marts"
[0m22:49:29.127038 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_dbt_test__audit"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'

[0m22:49:29.146043 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_staging"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'

[0m22:49:29.166142 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_marts"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'

[0m22:49:29.199799 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m22:49:29.213808 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m22:49:29.248973 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m22:49:29.262603 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: ROLLBACK
[0m22:49:29.279608 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: ROLLBACK
[0m22:49:29.300879 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: ROLLBACK
[0m22:49:29.325922 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: Close
[0m22:49:29.341228 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: Close
[0m22:49:29.363277 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: Close
[0m22:49:29.567432 [debug] [MainThread]: Using postgres connection "master"
[0m22:49:29.707819 [debug] [MainThread]: On master: BEGIN
[0m22:49:29.733837 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:49:30.015560 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:49:30.149955 [debug] [MainThread]: Using postgres connection "master"
[0m22:49:30.232483 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:49:30.334406 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m22:49:30.385416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ceb2cbd6-967a-4ffc-a471-35e6bb4003ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bdb069510>]}
[0m22:49:30.448046 [debug] [MainThread]: On master: ROLLBACK
[0m22:49:30.492839 [debug] [MainThread]: Using postgres connection "master"
[0m22:49:30.510697 [debug] [MainThread]: On master: BEGIN
[0m22:49:30.526389 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:49:30.539765 [debug] [MainThread]: On master: COMMIT
[0m22:49:30.546687 [debug] [MainThread]: Using postgres connection "master"
[0m22:49:30.765384 [debug] [MainThread]: On master: COMMIT
[0m22:49:30.795714 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:49:30.828728 [debug] [MainThread]: On master: Close
[0m22:49:30.848394 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:49:30.894804 [info ] [MainThread]:
[0m22:49:30.974950 [debug] [Thread-1 (]: Began running node model.crypto_analytics.stg_crypto_prices
[0m22:49:30.976113 [debug] [Thread-2 (]: Began running node model.crypto_analytics.stg_pipeline_runs
[0m22:49:30.992569 [info ] [Thread-1 (]: 1 of 5 START sql table model public_staging.stg_crypto_prices .................. [RUN]
[0m22:49:31.011174 [info ] [Thread-2 (]: 2 of 5 START sql view model public_staging.stg_pipeline_runs ................... [RUN]
[0m22:49:31.030040 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_marts, now model.crypto_analytics.stg_crypto_prices)
[0m22:49:31.046074 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_staging, now model.crypto_analytics.stg_pipeline_runs)
[0m22:49:31.094857 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics.stg_crypto_prices
[0m22:49:31.113321 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics.stg_pipeline_runs
[0m22:49:31.197063 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics.stg_crypto_prices"
[0m22:49:31.212685 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics.stg_pipeline_runs"
[0m22:49:31.314046 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.stg_pipeline_runs (compile): 22:49:31.198179 => 22:49:31.313293
[0m22:49:31.360914 [debug] [Thread-2 (]: Began executing node model.crypto_analytics.stg_pipeline_runs
[0m22:49:31.362745 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.stg_crypto_prices (compile): 22:49:31.156398 => 22:49:31.361965
[0m22:49:31.463889 [debug] [Thread-1 (]: Began executing node model.crypto_analytics.stg_crypto_prices
[0m22:49:31.774060 [debug] [Thread-2 (]: Writing runtime sql for node "model.crypto_analytics.stg_pipeline_runs"
[0m22:49:31.821857 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics.stg_crypto_prices"
[0m22:49:31.955813 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m22:49:32.312766 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: BEGIN
[0m22:49:32.328184 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:49:32.329965 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:49:32.377049 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: BEGIN
[0m22:49:32.413076 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:49:32.441872 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:49:32.478397 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m22:49:32.530134 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:49:32.560196 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */

  create view "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_tmp"


  as (
    SELECT
    id as run_id,
    run_id as run_identifier,
    stage,
    status,
    records_processed,
    error_message,
    started_at,
    completed_at,
    CASE
        WHEN completed_at IS NOT NULL
        THEN EXTRACT(EPOCH FROM (completed_at - started_at))
        ELSE NULL
    END as duration_seconds
FROM "crypto_warehouse"."public"."pipeline_runs"
  );
[0m22:49:32.703963 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:49:32.787419 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m22:49:32.810156 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */




  create  table "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_tmp"


    as

  (


WITH source_data AS (
    SELECT
        id as price_id,
        UPPER(TRIM(symbol)) as symbol,
        TRIM(name) as crypto_name,
        current_price as price_usd,
        market_cap,
        total_volume as volume_24h,
        price_change_24h,
        price_change_percentage_24h as price_change_pct_24h,
        market_cap_rank,
        extracted_at,
        created_at,

        CASE WHEN current_price <= 0 THEN TRUE ELSE FALSE END as is_invalid_price,
        CASE WHEN market_cap <= 0 THEN TRUE ELSE FALSE END as is_invalid_market_cap,
        CASE WHEN total_volume < 0 THEN TRUE ELSE FALSE END as is_invalid_volume
    FROM "crypto_warehouse"."public"."crypto_prices_raw"
),

cleaned_data AS (
    SELECT
        *,
        DATE(extracted_at) as extraction_date,
        DATE_TRUNC('hour', extracted_at) as extraction_hour,
        CASE
            WHEN LAG(price_usd) OVER (
                PARTITION BY symbol ORDER BY extracted_at
            ) IS NOT NULL THEN
                ((price_usd - LAG(price_usd) OVER (
                    PARTITION BY symbol ORDER BY extracted_at
                )) / LAG(price_usd) OVER (
                    PARTITION BY symbol ORDER BY extracted_at
                )) * 100
        END as price_change_pct_from_previous
    FROM source_data
    WHERE NOT is_invalid_price AND NOT is_invalid_volume
)

SELECT * FROM cleaned_data
  );

[0m22:49:33.039777 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m22:49:33.154038 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */
alter table "crypto_warehouse"."public_staging"."stg_pipeline_runs" rename to "stg_pipeline_runs__dbt_backup"
[0m22:49:33.207973 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:49:33.252388 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m22:49:33.289344 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */
alter table "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_tmp" rename to "stg_pipeline_runs"
[0m22:49:33.317601 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.0 seconds
[0m22:49:33.361022 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:49:33.477350 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:49:33.661124 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */
alter table "crypto_warehouse"."public_staging"."stg_crypto_prices" rename to "stg_crypto_prices__dbt_backup"
[0m22:49:33.691711 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: COMMIT
[0m22:49:33.710041 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:49:33.742026 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m22:49:33.890023 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: COMMIT
[0m22:49:33.841431 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:49:33.977939 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */
alter table "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_tmp" rename to "stg_crypto_prices"
[0m22:49:34.034383 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:49:34.067301 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m22:49:34.123045 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:49:34.503081 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */

        CREATE INDEX IF NOT EXISTS idx_stg_crypto_prices_symbol_time ON "crypto_warehouse"."public_staging"."stg_crypto_prices" (symbol, extracted_at)

[0m22:49:34.506217 [debug] [Thread-2 (]: Applying DROP to: "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_backup"
[0m22:49:34.516860 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:49:34.562608 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m22:49:34.570791 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: COMMIT
[0m22:49:34.603124 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */
drop view if exists "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_backup" cascade
[0m22:49:34.622657 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:49:34.650350 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: COMMIT
[0m22:49:34.696148 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m22:49:34.709690 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.stg_pipeline_runs (execute): 22:49:31.377201 => 22:49:34.709231
[0m22:49:34.722197 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: Close
[0m22:49:34.736854 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ceb2cbd6-967a-4ffc-a471-35e6bb4003ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bdc901c10>]}
[0m22:49:34.740634 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:49:34.761250 [info ] [Thread-2 (]: 2 of 5 OK created sql view model public_staging.stg_pipeline_runs .............. [[32mCREATE VIEW[0m in 3.69s]
[0m22:49:34.793123 [debug] [Thread-1 (]: Applying DROP to: "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_backup"
[0m22:49:34.803537 [debug] [Thread-2 (]: Finished running node model.crypto_analytics.stg_pipeline_runs
[0m22:49:34.824120 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:49:34.835285 [debug] [Thread-4 (]: Began running node model.crypto_analytics.mart_pipeline_monitoring
[0m22:49:34.842070 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */
drop table if exists "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_backup" cascade
[0m22:49:34.855315 [info ] [Thread-4 (]: 3 of 5 START sql table model public_marts.mart_pipeline_monitoring ............. [RUN]
[0m22:49:34.886907 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.crypto_analytics.mart_pipeline_monitoring'
[0m22:49:34.903294 [debug] [Thread-4 (]: Began compiling node model.crypto_analytics.mart_pipeline_monitoring
[0m22:49:34.923833 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:49:34.935694 [debug] [Thread-4 (]: Writing injected SQL for node "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:49:34.943280 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.stg_crypto_prices (execute): 22:49:31.526543 => 22:49:34.942736
[0m22:49:34.970529 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: Close
[0m22:49:34.984502 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ceb2cbd6-967a-4ffc-a471-35e6bb4003ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bdb0acc10>]}
[0m22:49:34.993872 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public_staging.stg_crypto_prices ............. [[32mSELECT 20[0m in 3.96s]
[0m22:49:35.007390 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.stg_crypto_prices
[0m22:49:35.023759 [debug] [Thread-2 (]: Began running node model.crypto_analytics.int_crypto_daily_aggs
[0m22:49:35.024885 [debug] [Thread-3 (]: Began running node model.crypto_analytics.int_crypto_hourly_aggs
[0m22:49:35.026032 [debug] [Thread-4 (]: Timing info for model.crypto_analytics.mart_pipeline_monitoring (compile): 22:49:34.915666 => 22:49:35.025476
[0m22:49:35.026876 [debug] [Thread-1 (]: Began running node model.crypto_analytics.mart_crypto_latest_prices
[0m22:49:35.037185 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.stg_pipeline_runs, now model.crypto_analytics.int_crypto_daily_aggs)
[0m22:49:35.052067 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_dbt_test__audit, now model.crypto_analytics.int_crypto_hourly_aggs)
[0m22:49:35.059561 [debug] [Thread-4 (]: Began executing node model.crypto_analytics.mart_pipeline_monitoring
[0m22:49:35.091217 [info ] [Thread-1 (]: 4 of 5 START sql table model public_marts.mart_crypto_latest_prices ............ [RUN]
[0m22:49:35.106066 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics.int_crypto_daily_aggs
[0m22:49:35.124048 [debug] [Thread-3 (]: Began compiling node model.crypto_analytics.int_crypto_hourly_aggs
[0m22:49:35.178384 [debug] [Thread-4 (]: Writing runtime sql for node "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:49:35.185685 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.stg_crypto_prices, now model.crypto_analytics.mart_crypto_latest_prices)
[0m22:49:35.229110 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics.int_crypto_daily_aggs"
[0m22:49:35.244415 [debug] [Thread-3 (]: Writing injected SQL for node "model.crypto_analytics.int_crypto_hourly_aggs"
[0m22:49:35.274859 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics.mart_crypto_latest_prices
[0m22:49:35.375993 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:49:35.418713 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:49:35.443158 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: BEGIN
[0m22:49:35.461232 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.int_crypto_daily_aggs (compile): 22:49:35.203901 => 22:49:35.459927
[0m22:49:35.491403 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:49:35.517905 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.mart_crypto_latest_prices (compile): 22:49:35.337276 => 22:49:35.517016
[0m22:49:35.525064 [debug] [Thread-2 (]: Finished running node model.crypto_analytics.int_crypto_daily_aggs
[0m22:49:35.540202 [debug] [Thread-3 (]: Timing info for model.crypto_analytics.int_crypto_hourly_aggs (compile): 22:49:35.236233 => 22:49:35.539329
[0m22:49:35.564039 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m22:49:35.654937 [debug] [Thread-1 (]: Began executing node model.crypto_analytics.mart_crypto_latest_prices
[0m22:49:35.708942 [debug] [Thread-3 (]: Finished running node model.crypto_analytics.int_crypto_hourly_aggs
[0m22:49:35.735833 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:49:35.775850 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:49:35.787300 [debug] [Thread-2 (]: Began running node model.crypto_analytics.mart_crypto_hourly_performance
[0m22:49:35.802014 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */




  create  table "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_tmp"


    as

  (


WITH pipeline_metrics AS (
    SELECT
        run_id,
        stage,
        status,
        records_processed,
        error_message,
        started_at,
        completed_at,
        EXTRACT(EPOCH FROM completed_at - started_at) AS duration_seconds,

        -- Flag to compute success rate
        CASE WHEN status = 'success' THEN 1 ELSE 0 END AS is_success,

        -- Classify performance
        CASE
            WHEN completed_at IS NULL THEN 'Running'
            WHEN EXTRACT(EPOCH FROM completed_at - started_at) < 30 THEN 'Fast'
            WHEN EXTRACT(EPOCH FROM completed_at - started_at) < 120 THEN 'Normal'
            ELSE 'Slow'
        END AS performance_category

    FROM "crypto_warehouse"."public_staging"."stg_pipeline_runs"
),

latest_status_per_day_stage AS (
    SELECT
        DATE(started_at) AS run_date,
        stage,
        FIRST_VALUE(status) OVER (
            PARTITION BY DATE(started_at), stage
            ORDER BY started_at DESC
        ) AS latest_run_status
    FROM pipeline_metrics
),

daily_summary AS (
    SELECT
        DATE(started_at) AS run_date,
        stage,

        COUNT(*) AS total_runs,
        SUM(is_success) AS successful_runs,
        SUM(records_processed) AS total_records_processed,
        AVG(duration_seconds) AS avg_duration_seconds,
        MAX(duration_seconds) AS max_duration_seconds,
        ROUND(((SUM(is_success)::FLOAT / COUNT(*)) * 100)::NUMERIC, 2) AS success_rate_pct


    FROM pipeline_metrics
    WHERE started_at >= CURRENT_DATE - INTERVAL '30 days'
    GROUP BY DATE(started_at), stage
)

-- Final result combining metrics with latest run status
SELECT
    ds.*,
    ls.latest_run_status
FROM daily_summary ds
LEFT JOIN latest_status_per_day_stage ls
  ON ds.run_date = ls.run_date AND ds.stage = ls.stage
  );

[0m22:49:35.832752 [info ] [Thread-2 (]: 5 of 5 START sql table model public_marts.mart_crypto_hourly_performance ....... [RUN]
[0m22:49:35.884113 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.int_crypto_daily_aggs, now model.crypto_analytics.mart_crypto_hourly_performance)
[0m22:49:35.903418 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics.mart_crypto_hourly_performance
[0m22:49:35.975993 [debug] [Thread-4 (]: SQL status: SELECT 8 in 0.0 seconds
[0m22:49:36.039156 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:49:36.092907 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:49:36.081871 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:49:36.107984 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: BEGIN
[0m22:49:36.122846 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */
alter table "crypto_warehouse"."public_marts"."mart_pipeline_monitoring" rename to "mart_pipeline_monitoring__dbt_backup"
[0m22:49:36.140425 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:49:36.154940 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:49:36.174847 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:49:36.240049 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:49:36.208372 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:49:36.184753 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.mart_crypto_hourly_performance (compile): 22:49:35.919197 => 22:49:36.183977
[0m22:49:36.288752 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */




  create  table "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_tmp"


    as

  (


WITH latest_prices AS (
    SELECT
        symbol,
        crypto_name,
        price_usd,
        market_cap,
        volume_24h,
        price_change_24h,
        price_change_pct_24h,
        market_cap_rank,
        extracted_at,

        ROW_NUMBER() OVER (
            PARTITION BY symbol
            ORDER BY extracted_at DESC
        ) as rn

    FROM "crypto_warehouse"."public_staging"."stg_crypto_prices"
    WHERE extraction_date = CURRENT_DATE
),

price_changes AS (
    SELECT
        symbol,
        crypto_name,
        price_usd as current_price,
        market_cap,
        volume_24h,
        price_change_24h,
        price_change_pct_24h,
        market_cap_rank,
        extracted_at as last_updated,

        -- Calculate additional metrics
        CASE
            WHEN price_change_pct_24h > 10 THEN 'Strong Gain'
            WHEN price_change_pct_24h > 5 THEN 'Moderate Gain'
            WHEN price_change_pct_24h > 0 THEN 'Slight Gain'
            WHEN price_change_pct_24h > -5 THEN 'Slight Loss'
            WHEN price_change_pct_24h > -10 THEN 'Moderate Loss'
            ELSE 'Strong Loss'
        END as price_trend_category,

        -- Market cap category
        CASE
            WHEN market_cap_rank <= 10 THEN 'Large Cap'
            WHEN market_cap_rank <= 50 THEN 'Mid Cap'
            WHEN market_cap_rank <= 100 THEN 'Small Cap'
            ELSE 'Micro Cap'
        END as market_cap_category

    FROM latest_prices
    WHERE rn = 1
)

SELECT * FROM price_changes
  );

[0m22:49:36.303492 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */
alter table "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_tmp" rename to "mart_pipeline_monitoring"
[0m22:49:36.320543 [debug] [Thread-2 (]: Began executing node model.crypto_analytics.mart_crypto_hourly_performance
[0m22:49:36.354080 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:49:36.388731 [debug] [Thread-2 (]: Writing runtime sql for node "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:49:36.483448 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.0 seconds
[0m22:49:36.515188 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:49:36.576778 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:49:36.587286 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */

    create  index if not exists
  "56e68037b21834e30a2a10b06e6e9138"
  on "crypto_warehouse"."public_marts"."mart_pipeline_monitoring" using btree
  (run_date);

[0m22:49:36.634412 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_latest_prices" rename to "mart_crypto_latest_prices__dbt_backup"
[0m22:49:36.675241 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:49:36.706695 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:49:36.719226 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:49:36.723524 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_tmp" rename to "mart_crypto_latest_prices"
[0m22:49:36.738293 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: BEGIN
[0m22:49:36.752895 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:49:36.784647 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:49:36.820638 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:49:36.830252 [debug] [Thread-4 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:49:36.884088 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:49:36.889259 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */

    create  index if not exists
  "0671828cff3149a1458c2cd6094ee757"
  on "crypto_warehouse"."public_marts"."mart_crypto_latest_prices" using btree
  (symbol);

[0m22:49:36.905761 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:49:36.919363 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:49:36.941814 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */

    create  index if not exists
  "66505593c8827831e6e8aeda808aae12"
  on "crypto_warehouse"."public_marts"."mart_pipeline_monitoring" using btree
  (stage);

[0m22:49:36.955641 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */




  create  table "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_tmp"


    as

  (


WITH  __dbt__cte__int_crypto_hourly_aggs as (


WITH base_data AS (
    SELECT
        symbol,
        crypto_name,
        DATE_TRUNC('hour', extracted_at) AS extraction_hour,
        price_usd,
        volume_24h,
        market_cap,
        CASE WHEN price_usd <= 0 THEN 1 ELSE 0 END AS is_invalid
    FROM "crypto_warehouse"."public_staging"."stg_crypto_prices"
)

SELECT
    symbol,
    crypto_name,
    extraction_hour,
    COUNT(*) AS total_records,
    SUM(is_invalid) AS invalid_price_records,
    AVG(price_usd) AS avg_price_usd,
    MIN(price_usd) AS min_price_usd,
    MAX(price_usd) AS max_price_usd,
    STDDEV(price_usd) AS price_volatility,
    AVG(volume_24h) AS avg_volume_24h,
    AVG(market_cap) AS avg_market_cap
FROM base_data
GROUP BY symbol, crypto_name, extraction_hour
), hourly_data AS (
    SELECT
        symbol,
        crypto_name,
        extraction_hour,
        avg_price_usd,
        min_price_usd,
        max_price_usd,
        price_volatility,
        avg_volume_24h,
        avg_market_cap,
        total_records,

        -- Calculate hourly change
        LAG(avg_price_usd) OVER (
            PARTITION BY symbol
            ORDER BY extraction_hour
        ) as previous_hour_price,

        -- Data quality score
        (1.0 - (invalid_price_records::FLOAT / GREATEST(total_records, 1))) * 100 as data_quality_score

    FROM __dbt__cte__int_crypto_hourly_aggs
),

performance_metrics AS (
    SELECT
        *,
        CASE
            WHEN previous_hour_price IS NOT NULL AND previous_hour_price > 0 THEN
                ((avg_price_usd - previous_hour_price) / previous_hour_price) * 100
            ELSE NULL
        END as hourly_change_pct,

        -- Volatility category
        CASE
            WHEN price_volatility IS NULL THEN 'Unknown'
            WHEN price_volatility < avg_price_usd * 0.01 THEN 'Low Volatility'
            WHEN price_volatility < avg_price_usd * 0.05 THEN 'Medium Volatility'
            ELSE 'High Volatility'
        END as volatility_category

    FROM hourly_data
)

SELECT * FROM performance_metrics
  );

[0m22:49:37.120668 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:49:37.138763 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:49:37.155244 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */

    create  index if not exists
  "ac93d29a06c0209c7a6ed1edf1d81da1"
  on "crypto_warehouse"."public_marts"."mart_crypto_latest_prices" using btree
  (market_cap_rank);

[0m22:49:37.263824 [debug] [Thread-4 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:49:37.265336 [debug] [Thread-2 (]: SQL status: SELECT 10 in 0.0 seconds
[0m22:49:37.279012 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: COMMIT
[0m22:49:37.306731 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:49:37.312566 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:49:37.321928 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance" rename to "mart_crypto_hourly_performance__dbt_backup"
[0m22:49:37.334545 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: COMMIT
[0m22:49:37.349744 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:49:37.385698 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:49:37.388036 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:49:37.404411 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: COMMIT
[0m22:49:37.417426 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_tmp" rename to "mart_crypto_hourly_performance"
[0m22:49:37.431055 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:49:37.440596 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:49:37.452435 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: COMMIT
[0m22:49:37.470013 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:49:37.498701 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */

    create  index if not exists
  "545572f902fb4f43dbaa1ebbad5c1540"
  on "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance" using btree
  (symbol, extraction_hour);

[0m22:49:37.507752 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m22:49:37.540839 [debug] [Thread-4 (]: Applying DROP to: "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_backup"
[0m22:49:37.555005 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:49:37.563080 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:49:37.568324 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */
drop table if exists "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_backup" cascade
[0m22:49:37.602100 [debug] [Thread-1 (]: Applying DROP to: "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_backup"
[0m22:49:37.646630 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:49:37.660667 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */
drop table if exists "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_backup" cascade
[0m22:49:37.707621 [debug] [Thread-2 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:49:37.719890 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:49:37.725444 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:49:37.740846 [debug] [Thread-4 (]: Timing info for model.crypto_analytics.mart_pipeline_monitoring (execute): 22:49:35.138426 => 22:49:37.740061
[0m22:49:37.753952 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */

    create  index if not exists
  "097da9090aa6cb39b538c51a6a916a90"
  on "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance" using btree
  (extraction_hour);

[0m22:49:37.767926 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: Close
[0m22:49:37.785563 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:49:37.797334 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ceb2cbd6-967a-4ffc-a471-35e6bb4003ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bdae4bf10>]}
[0m22:49:37.814670 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.mart_crypto_latest_prices (execute): 22:49:35.754045 => 22:49:37.808530
[0m22:49:37.823676 [info ] [Thread-4 (]: 3 of 5 OK created sql table model public_marts.mart_pipeline_monitoring ........ [[32mSELECT 8[0m in 2.91s]
[0m22:49:37.837157 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: Close
[0m22:49:37.852388 [debug] [Thread-4 (]: Finished running node model.crypto_analytics.mart_pipeline_monitoring
[0m22:49:37.870463 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ceb2cbd6-967a-4ffc-a471-35e6bb4003ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bdaf5a090>]}
[0m22:49:37.898542 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public_marts.mart_crypto_latest_prices ....... [[32mSELECT 5[0m in 2.69s]
[0m22:49:37.917741 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.mart_crypto_latest_prices
[0m22:49:38.013002 [debug] [Thread-2 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:49:38.039011 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: COMMIT
[0m22:49:38.169293 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:49:38.222072 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: COMMIT
[0m22:49:38.297080 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m22:49:38.504508 [debug] [Thread-2 (]: Applying DROP to: "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_backup"
[0m22:49:38.519504 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:49:38.535005 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */
drop table if exists "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_backup" cascade
[0m22:49:38.610172 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:49:38.651873 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.mart_crypto_hourly_performance (execute): 22:49:36.366689 => 22:49:38.651356
[0m22:49:38.678418 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: Close
[0m22:49:38.698248 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ceb2cbd6-967a-4ffc-a471-35e6bb4003ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bdada4250>]}
[0m22:49:38.722604 [info ] [Thread-2 (]: 5 of 5 OK created sql table model public_marts.mart_crypto_hourly_performance .. [[32mSELECT 10[0m in 2.82s]
[0m22:49:38.735362 [debug] [Thread-2 (]: Finished running node model.crypto_analytics.mart_crypto_hourly_performance
[0m22:49:38.759601 [debug] [MainThread]: Using postgres connection "master"
[0m22:49:38.770571 [debug] [MainThread]: On master: BEGIN
[0m22:49:38.784133 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:49:38.805242 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:49:38.818312 [debug] [MainThread]: On master: COMMIT
[0m22:49:38.832850 [debug] [MainThread]: Using postgres connection "master"
[0m22:49:38.846810 [debug] [MainThread]: On master: COMMIT
[0m22:49:38.856035 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:49:38.870172 [debug] [MainThread]: On master: Close
[0m22:49:38.885802 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:49:38.901821 [debug] [MainThread]: Connection 'model.crypto_analytics.mart_crypto_hourly_performance' was properly closed.
[0m22:49:38.915386 [debug] [MainThread]: Connection 'model.crypto_analytics.int_crypto_hourly_aggs' was properly closed.
[0m22:49:38.930696 [debug] [MainThread]: Connection 'model.crypto_analytics.mart_crypto_latest_prices' was properly closed.
[0m22:49:38.946046 [debug] [MainThread]: Connection 'model.crypto_analytics.mart_pipeline_monitoring' was properly closed.
[0m22:49:38.954240 [info ] [MainThread]:
[0m22:49:38.966105 [info ] [MainThread]: Finished running 1 view model, 4 table models in 0 hours 0 minutes and 11.18 seconds (11.18s).
[0m22:49:38.980426 [debug] [MainThread]: Command end result
[0m22:49:39.232858 [info ] [MainThread]:
[0m22:49:39.333162 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:49:39.569122 [info ] [MainThread]:
[0m22:49:39.911957 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m22:49:39.983573 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 31.483477, "process_user_time": 12.618137, "process_kernel_time": 1.766748, "process_mem_max_rss": "124120", "process_out_blocks": "1976", "process_in_blocks": "0"}
[0m22:49:40.033917 [debug] [MainThread]: Command `dbt run` succeeded at 22:49:40.033582 after 31.53 seconds
[0m22:49:40.265533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bdc9eff90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bdc9a7e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bdc9a7650>]}
[0m22:49:40.331776 [debug] [MainThread]: Flushing usage events
[0m22:52:17.560979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a23af5490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a23b37150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a23af4690>]}


============================== 22:52:17.580661 | 7a711d83-6bea-453f-b637-242404e740ff ==============================
[0m22:52:17.580661 [info ] [MainThread]: Running with dbt=1.7.0
[0m22:52:17.598193 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'version_check': 'True', 'debug': 'False', 'log_path': '/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /app/dbt', 'send_anonymous_usage_stats': 'True'}
[0m22:52:18.516533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a711d83-6bea-453f-b637-242404e740ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a23b3d250>]}
[0m22:52:18.858706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a711d83-6bea-453f-b637-242404e740ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a2229e6d0>]}
[0m22:52:18.870025 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m22:52:19.304589 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m22:52:28.195321 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:52:28.200600 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:52:28.226168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a711d83-6bea-453f-b637-242404e740ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a2229e450>]}
[0m22:52:28.391229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a711d83-6bea-453f-b637-242404e740ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a222d3dd0>]}
[0m22:52:28.400202 [info ] [MainThread]: Found 7 models, 14 tests, 2 sources, 0 exposures, 0 metrics, 517 macros, 0 groups, 0 semantic models
[0m22:52:28.414196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a711d83-6bea-453f-b637-242404e740ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a23b4f7d0>]}
[0m22:52:28.432627 [info ] [MainThread]:
[0m22:52:28.470382 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:52:28.486778 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse'
[0m22:52:28.491717 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse'
[0m22:52:28.579017 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse"
[0m22:52:28.612667 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse"
[0m22:52:28.644637 [debug] [ThreadPool]: On list_crypto_warehouse: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse"} */

    select distinct nspname from pg_namespace

[0m22:52:28.663549 [debug] [ThreadPool]: On list_crypto_warehouse: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse"} */

    select distinct nspname from pg_namespace

[0m22:52:28.671096 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:52:28.681752 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:52:28.714984 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m22:52:28.736340 [debug] [ThreadPool]: On list_crypto_warehouse: Close
[0m22:52:28.744673 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m22:52:28.765253 [debug] [ThreadPool]: On list_crypto_warehouse: Close
[0m22:52:28.782270 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_warehouse, now list_crypto_warehouse_public_marts)
[0m22:52:28.784281 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_warehouse, now list_crypto_warehouse_public_dbt_test__audit)
[0m22:52:28.787140 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse_public_staging'
[0m22:52:28.810292 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_marts"
[0m22:52:28.831976 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_dbt_test__audit"
[0m22:52:28.846938 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_staging"
[0m22:52:28.876214 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: BEGIN
[0m22:52:28.885022 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: BEGIN
[0m22:52:28.896004 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: BEGIN
[0m22:52:28.904287 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:52:28.914292 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:52:28.924206 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:52:28.938926 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:52:28.952996 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:52:28.965709 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:52:28.970480 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_marts"
[0m22:52:28.980520 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_dbt_test__audit"
[0m22:52:28.994400 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_staging"
[0m22:52:29.003812 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_marts"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'

[0m22:52:29.015216 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_dbt_test__audit"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'

[0m22:52:29.032546 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_staging"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'

[0m22:52:29.050472 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m22:52:29.096599 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: ROLLBACK
[0m22:52:29.112568 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m22:52:29.117635 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m22:52:29.132687 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: Close
[0m22:52:29.249961 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: ROLLBACK
[0m22:52:29.401972 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: ROLLBACK
[0m22:52:29.666208 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: Close
[0m22:52:29.737947 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: Close
[0m22:52:30.044787 [debug] [MainThread]: Using postgres connection "master"
[0m22:52:30.062152 [debug] [MainThread]: On master: BEGIN
[0m22:52:30.082999 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:52:30.133627 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:52:30.177309 [debug] [MainThread]: Using postgres connection "master"
[0m22:52:30.198862 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:52:30.293284 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m22:52:30.314874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a711d83-6bea-453f-b637-242404e740ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a22404dd0>]}
[0m22:52:30.331450 [debug] [MainThread]: On master: ROLLBACK
[0m22:52:30.348115 [debug] [MainThread]: Using postgres connection "master"
[0m22:52:30.394033 [debug] [MainThread]: On master: BEGIN
[0m22:52:30.411545 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:52:30.447040 [debug] [MainThread]: On master: COMMIT
[0m22:52:30.468515 [debug] [MainThread]: Using postgres connection "master"
[0m22:52:30.482013 [debug] [MainThread]: On master: COMMIT
[0m22:52:30.494915 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:52:30.514170 [debug] [MainThread]: On master: Close
[0m22:52:30.527317 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:52:30.570419 [info ] [MainThread]:
[0m22:52:31.057863 [debug] [Thread-1 (]: Began running node model.crypto_analytics.stg_crypto_prices
[0m22:52:31.058895 [debug] [Thread-2 (]: Began running node model.crypto_analytics.stg_pipeline_runs
[0m22:52:31.081553 [info ] [Thread-1 (]: 1 of 5 START sql table model public_staging.stg_crypto_prices .................. [RUN]
[0m22:52:31.092816 [info ] [Thread-2 (]: 2 of 5 START sql view model public_staging.stg_pipeline_runs ................... [RUN]
[0m22:52:31.104736 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_staging, now model.crypto_analytics.stg_crypto_prices)
[0m22:52:31.113031 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_dbt_test__audit, now model.crypto_analytics.stg_pipeline_runs)
[0m22:52:31.124392 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics.stg_crypto_prices
[0m22:52:31.132693 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics.stg_pipeline_runs
[0m22:52:31.182976 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics.stg_crypto_prices"
[0m22:52:31.194473 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics.stg_pipeline_runs"
[0m22:52:31.239180 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.stg_crypto_prices (compile): 22:52:31.140551 => 22:52:31.238410
[0m22:52:31.247548 [debug] [Thread-1 (]: Began executing node model.crypto_analytics.stg_crypto_prices
[0m22:52:31.255568 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.stg_pipeline_runs (compile): 22:52:31.187553 => 22:52:31.254842
[0m22:52:31.321125 [debug] [Thread-2 (]: Began executing node model.crypto_analytics.stg_pipeline_runs
[0m22:52:31.491225 [debug] [Thread-2 (]: Writing runtime sql for node "model.crypto_analytics.stg_pipeline_runs"
[0m22:52:31.503574 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics.stg_crypto_prices"
[0m22:52:31.555984 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:52:31.565138 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m22:52:31.569105 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: BEGIN
[0m22:52:31.577750 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: BEGIN
[0m22:52:31.589169 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:52:31.597905 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:52:31.634403 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:52:31.650892 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:52:31.661757 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:52:31.673330 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m22:52:31.684179 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */




  create  table "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_tmp"


    as

  (


WITH source_data AS (
    SELECT
        id as price_id,
        UPPER(TRIM(symbol)) as symbol,
        TRIM(name) as crypto_name,
        current_price as price_usd,
        market_cap,
        total_volume as volume_24h,
        price_change_24h,
        price_change_percentage_24h as price_change_pct_24h,
        market_cap_rank,
        extracted_at,
        created_at,

        CASE WHEN current_price <= 0 THEN TRUE ELSE FALSE END as is_invalid_price,
        CASE WHEN market_cap <= 0 THEN TRUE ELSE FALSE END as is_invalid_market_cap,
        CASE WHEN total_volume < 0 THEN TRUE ELSE FALSE END as is_invalid_volume
    FROM "crypto_warehouse"."public"."crypto_prices_raw"
),

cleaned_data AS (
    SELECT
        *,
        DATE(extracted_at) as extraction_date,
        DATE_TRUNC('hour', extracted_at) as extraction_hour,
        CASE
            WHEN LAG(price_usd) OVER (
                PARTITION BY symbol ORDER BY extracted_at
            ) IS NOT NULL THEN
                ((price_usd - LAG(price_usd) OVER (
                    PARTITION BY symbol ORDER BY extracted_at
                )) / LAG(price_usd) OVER (
                    PARTITION BY symbol ORDER BY extracted_at
                )) * 100
        END as price_change_pct_from_previous
    FROM source_data
    WHERE NOT is_invalid_price AND NOT is_invalid_volume
)

SELECT * FROM cleaned_data
  );

[0m22:52:31.696261 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */

  create view "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_tmp"


  as (
    SELECT
    id as run_id,
    run_id as run_identifier,
    stage,
    status,
    records_processed,
    error_message,
    started_at,
    completed_at,
    CASE
        WHEN completed_at IS NOT NULL
        THEN EXTRACT(EPOCH FROM (completed_at - started_at))
        ELSE NULL
    END as duration_seconds
FROM "crypto_warehouse"."public"."pipeline_runs"
  );
[0m22:52:31.723720 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m22:52:31.750543 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m22:52:31.759294 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */
alter table "crypto_warehouse"."public_staging"."stg_pipeline_runs" rename to "stg_pipeline_runs__dbt_backup"
[0m22:52:31.768630 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:52:31.784211 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m22:52:31.791000 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */
alter table "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_tmp" rename to "stg_pipeline_runs"
[0m22:52:31.797193 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:52:31.833221 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: COMMIT
[0m22:52:31.839144 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m22:52:31.845688 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: COMMIT
[0m22:52:31.979057 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m22:52:31.999249 [debug] [Thread-2 (]: Applying DROP to: "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_backup"
[0m22:52:32.018350 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.0 seconds
[0m22:52:32.021047 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m22:52:32.107288 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:52:32.110834 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */
drop view if exists "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_backup" cascade
[0m22:52:32.118293 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */
alter table "crypto_warehouse"."public_staging"."stg_crypto_prices" rename to "stg_crypto_prices__dbt_backup"
[0m22:52:32.131259 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:52:32.144100 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:52:32.152974 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */
alter table "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_tmp" rename to "stg_crypto_prices"
[0m22:52:32.160156 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:52:32.180607 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:52:32.187520 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */

        CREATE INDEX IF NOT EXISTS idx_stg_crypto_prices_symbol_time ON "crypto_warehouse"."public_staging"."stg_crypto_prices" (symbol, extracted_at)

[0m22:52:32.241685 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m22:52:32.260474 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.stg_pipeline_runs (execute): 22:52:31.361806 => 22:52:32.259750
[0m22:52:32.270988 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: Close
[0m22:52:32.280114 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a711d83-6bea-453f-b637-242404e740ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a22051450>]}
[0m22:52:32.290495 [info ] [Thread-2 (]: 2 of 5 OK created sql view model public_staging.stg_pipeline_runs .............. [[32mCREATE VIEW[0m in 1.17s]
[0m22:52:32.301950 [debug] [Thread-2 (]: Finished running node model.crypto_analytics.stg_pipeline_runs
[0m22:52:32.312635 [debug] [Thread-4 (]: Began running node model.crypto_analytics.mart_pipeline_monitoring
[0m22:52:32.320409 [info ] [Thread-4 (]: 3 of 5 START sql table model public_marts.mart_pipeline_monitoring ............. [RUN]
[0m22:52:32.329267 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.crypto_analytics.mart_pipeline_monitoring'
[0m22:52:32.337946 [debug] [Thread-4 (]: Began compiling node model.crypto_analytics.mart_pipeline_monitoring
[0m22:52:32.375073 [debug] [Thread-4 (]: Writing injected SQL for node "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:52:32.428518 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:52:32.816449 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: COMMIT
[0m22:52:32.837983 [debug] [Thread-4 (]: Timing info for model.crypto_analytics.mart_pipeline_monitoring (compile): 22:52:32.362211 => 22:52:32.837258
[0m22:52:32.839943 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:52:32.850220 [debug] [Thread-4 (]: Began executing node model.crypto_analytics.mart_pipeline_monitoring
[0m22:52:32.861519 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: COMMIT
[0m22:52:32.900252 [debug] [Thread-4 (]: Writing runtime sql for node "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:52:32.963999 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:52:32.983405 [debug] [Thread-1 (]: Applying DROP to: "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_backup"
[0m22:52:32.984834 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:52:33.039549 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:52:33.072190 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: BEGIN
[0m22:52:33.082962 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */
drop table if exists "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_backup" cascade
[0m22:52:33.101034 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:52:33.148542 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m22:52:33.157715 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:52:33.167919 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */




  create  table "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_tmp"


    as

  (


WITH pipeline_metrics AS (
    SELECT
        run_id,
        stage,
        status,
        records_processed,
        error_message,
        started_at,
        completed_at,
        EXTRACT(EPOCH FROM completed_at - started_at) AS duration_seconds,

        -- Flag to compute success rate
        CASE WHEN status = 'success' THEN 1 ELSE 0 END AS is_success,

        -- Classify performance
        CASE
            WHEN completed_at IS NULL THEN 'Running'
            WHEN EXTRACT(EPOCH FROM completed_at - started_at) < 30 THEN 'Fast'
            WHEN EXTRACT(EPOCH FROM completed_at - started_at) < 120 THEN 'Normal'
            ELSE 'Slow'
        END AS performance_category

    FROM "crypto_warehouse"."public_staging"."stg_pipeline_runs"
),

latest_status_per_day_stage AS (
    SELECT
        DATE(started_at) AS run_date,
        stage,
        FIRST_VALUE(status) OVER (
            PARTITION BY DATE(started_at), stage
            ORDER BY started_at DESC
        ) AS latest_run_status
    FROM pipeline_metrics
),

daily_summary AS (
    SELECT
        DATE(started_at) AS run_date,
        stage,

        COUNT(*) AS total_runs,
        SUM(is_success) AS successful_runs,
        SUM(records_processed) AS total_records_processed,
        AVG(duration_seconds) AS avg_duration_seconds,
        MAX(duration_seconds) AS max_duration_seconds,
        ROUND(((SUM(is_success)::FLOAT / COUNT(*)) * 100)::NUMERIC, 2) AS success_rate_pct


    FROM pipeline_metrics
    WHERE started_at >= CURRENT_DATE - INTERVAL '30 days'
    GROUP BY DATE(started_at), stage
)

-- Final result combining metrics with latest run status
SELECT
    ds.*,
    ls.latest_run_status
FROM daily_summary ds
LEFT JOIN latest_status_per_day_stage ls
  ON ds.run_date = ls.run_date AND ds.stage = ls.stage
  );

[0m22:52:33.190663 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:52:33.229488 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.stg_crypto_prices (execute): 22:52:31.258776 => 22:52:33.228952
[0m22:52:33.251607 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: Close
[0m22:52:33.291521 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a711d83-6bea-453f-b637-242404e740ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a2218b8d0>]}
[0m22:52:33.420821 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public_staging.stg_crypto_prices ............. [[32mSELECT 20[0m in 2.19s]
[0m22:52:33.468605 [debug] [Thread-4 (]: SQL status: SELECT 8 in 0.0 seconds
[0m22:52:33.510058 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.stg_crypto_prices
[0m22:52:33.568635 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:52:33.594632 [debug] [Thread-2 (]: Began running node model.crypto_analytics.int_crypto_daily_aggs
[0m22:52:33.595576 [debug] [Thread-3 (]: Began running node model.crypto_analytics.int_crypto_hourly_aggs
[0m22:52:33.596579 [debug] [Thread-1 (]: Began running node model.crypto_analytics.mart_crypto_latest_prices
[0m22:52:33.727105 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */
alter table "crypto_warehouse"."public_marts"."mart_pipeline_monitoring" rename to "mart_pipeline_monitoring__dbt_backup"
[0m22:52:33.825489 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.stg_pipeline_runs, now model.crypto_analytics.int_crypto_daily_aggs)
[0m22:52:33.894718 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_marts, now model.crypto_analytics.int_crypto_hourly_aggs)
[0m22:52:33.968448 [info ] [Thread-1 (]: 4 of 5 START sql table model public_marts.mart_crypto_latest_prices ............ [RUN]
[0m22:52:34.002244 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:52:34.019792 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics.int_crypto_daily_aggs
[0m22:52:34.044495 [debug] [Thread-3 (]: Began compiling node model.crypto_analytics.int_crypto_hourly_aggs
[0m22:52:34.060599 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.stg_crypto_prices, now model.crypto_analytics.mart_crypto_latest_prices)
[0m22:52:34.092486 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:52:34.111011 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics.int_crypto_daily_aggs"
[0m22:52:34.137410 [debug] [Thread-3 (]: Writing injected SQL for node "model.crypto_analytics.int_crypto_hourly_aggs"
[0m22:52:34.141340 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics.mart_crypto_latest_prices
[0m22:52:34.151983 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */
alter table "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_tmp" rename to "mart_pipeline_monitoring"
[0m22:52:34.204799 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:52:34.208281 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:52:34.283529 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:52:34.292558 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */

    create  index if not exists
  "a0ecbf9a098e5a37a9696eb7c56794ce"
  on "crypto_warehouse"."public_marts"."mart_pipeline_monitoring" using btree
  (run_date);

[0m22:52:34.295226 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.int_crypto_daily_aggs (compile): 22:52:34.101775 => 22:52:34.294524
[0m22:52:34.301775 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.mart_crypto_latest_prices (compile): 22:52:34.184524 => 22:52:34.301001
[0m22:52:34.305969 [debug] [Thread-3 (]: Timing info for model.crypto_analytics.int_crypto_hourly_aggs (compile): 22:52:34.118116 => 22:52:34.305297
[0m22:52:34.317247 [debug] [Thread-2 (]: Finished running node model.crypto_analytics.int_crypto_daily_aggs
[0m22:52:34.325396 [debug] [Thread-1 (]: Began executing node model.crypto_analytics.mart_crypto_latest_prices
[0m22:52:34.338089 [debug] [Thread-3 (]: Finished running node model.crypto_analytics.int_crypto_hourly_aggs
[0m22:52:34.371010 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:52:34.376570 [debug] [Thread-2 (]: Began running node model.crypto_analytics.mart_crypto_hourly_performance
[0m22:52:34.392360 [info ] [Thread-2 (]: 5 of 5 START sql table model public_marts.mart_crypto_hourly_performance ....... [RUN]
[0m22:52:34.410774 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.int_crypto_daily_aggs, now model.crypto_analytics.mart_crypto_hourly_performance)
[0m22:52:34.431099 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics.mart_crypto_hourly_performance
[0m22:52:34.542702 [debug] [Thread-4 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:52:34.547288 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:52:34.771930 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:52:34.799016 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */

    create  index if not exists
  "2cc80e14ba25a1a61b3f4d84ac6989e2"
  on "crypto_warehouse"."public_marts"."mart_pipeline_monitoring" using btree
  (stage);

[0m22:52:34.800481 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:52:34.821221 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: BEGIN
[0m22:52:34.834785 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:52:34.893793 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:52:34.895314 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.mart_crypto_hourly_performance (compile): 22:52:34.455556 => 22:52:34.894657
[0m22:52:34.905749 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:52:34.914145 [debug] [Thread-2 (]: Began executing node model.crypto_analytics.mart_crypto_hourly_performance
[0m22:52:34.924845 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */




  create  table "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_tmp"


    as

  (


WITH latest_prices AS (
    SELECT
        symbol,
        crypto_name,
        price_usd,
        market_cap,
        volume_24h,
        price_change_24h,
        price_change_pct_24h,
        market_cap_rank,
        extracted_at,

        ROW_NUMBER() OVER (
            PARTITION BY symbol
            ORDER BY extracted_at DESC
        ) as rn

    FROM "crypto_warehouse"."public_staging"."stg_crypto_prices"
    WHERE extraction_date = CURRENT_DATE
),

price_changes AS (
    SELECT
        symbol,
        crypto_name,
        price_usd as current_price,
        market_cap,
        volume_24h,
        price_change_24h,
        price_change_pct_24h,
        market_cap_rank,
        extracted_at as last_updated,

        -- Calculate additional metrics
        CASE
            WHEN price_change_pct_24h > 10 THEN 'Strong Gain'
            WHEN price_change_pct_24h > 5 THEN 'Moderate Gain'
            WHEN price_change_pct_24h > 0 THEN 'Slight Gain'
            WHEN price_change_pct_24h > -5 THEN 'Slight Loss'
            WHEN price_change_pct_24h > -10 THEN 'Moderate Loss'
            ELSE 'Strong Loss'
        END as price_trend_category,

        -- Market cap category
        CASE
            WHEN market_cap_rank <= 10 THEN 'Large Cap'
            WHEN market_cap_rank <= 50 THEN 'Mid Cap'
            WHEN market_cap_rank <= 100 THEN 'Small Cap'
            ELSE 'Micro Cap'
        END as market_cap_category

    FROM latest_prices
    WHERE rn = 1
)

SELECT * FROM price_changes
  );

[0m22:52:34.945716 [debug] [Thread-2 (]: Writing runtime sql for node "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:52:34.957879 [debug] [Thread-4 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:52:34.977768 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: COMMIT
[0m22:52:34.987301 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:52:34.999587 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: COMMIT
[0m22:52:35.038795 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:52:35.050492 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: BEGIN
[0m22:52:35.059231 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:52:35.078153 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:52:35.091107 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m22:52:35.097476 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:52:35.112976 [debug] [Thread-4 (]: Applying DROP to: "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_backup"
[0m22:52:35.120981 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */




  create  table "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_tmp"


    as

  (


WITH  __dbt__cte__int_crypto_hourly_aggs as (


WITH base_data AS (
    SELECT
        symbol,
        crypto_name,
        DATE_TRUNC('hour', extracted_at) AS extraction_hour,
        price_usd,
        volume_24h,
        market_cap,
        CASE WHEN price_usd <= 0 THEN 1 ELSE 0 END AS is_invalid
    FROM "crypto_warehouse"."public_staging"."stg_crypto_prices"
)

SELECT
    symbol,
    crypto_name,
    extraction_hour,
    COUNT(*) AS total_records,
    SUM(is_invalid) AS invalid_price_records,
    AVG(price_usd) AS avg_price_usd,
    MIN(price_usd) AS min_price_usd,
    MAX(price_usd) AS max_price_usd,
    STDDEV(price_usd) AS price_volatility,
    AVG(volume_24h) AS avg_volume_24h,
    AVG(market_cap) AS avg_market_cap
FROM base_data
GROUP BY symbol, crypto_name, extraction_hour
), hourly_data AS (
    SELECT
        symbol,
        crypto_name,
        extraction_hour,
        avg_price_usd,
        min_price_usd,
        max_price_usd,
        price_volatility,
        avg_volume_24h,
        avg_market_cap,
        total_records,

        -- Calculate hourly change
        LAG(avg_price_usd) OVER (
            PARTITION BY symbol
            ORDER BY extraction_hour
        ) as previous_hour_price,

        -- Data quality score
        (1.0 - (invalid_price_records::FLOAT / GREATEST(total_records, 1))) * 100 as data_quality_score

    FROM __dbt__cte__int_crypto_hourly_aggs
),

performance_metrics AS (
    SELECT
        *,
        CASE
            WHEN previous_hour_price IS NOT NULL AND previous_hour_price > 0 THEN
                ((avg_price_usd - previous_hour_price) / previous_hour_price) * 100
            ELSE NULL
        END as hourly_change_pct,

        -- Volatility category
        CASE
            WHEN price_volatility IS NULL THEN 'Unknown'
            WHEN price_volatility < avg_price_usd * 0.01 THEN 'Low Volatility'
            WHEN price_volatility < avg_price_usd * 0.05 THEN 'Medium Volatility'
            ELSE 'High Volatility'
        END as volatility_category

    FROM hourly_data
)

SELECT * FROM performance_metrics
  );

[0m22:52:35.124333 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.0 seconds
[0m22:52:35.135076 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:52:35.179782 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:52:35.186314 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */
drop table if exists "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_backup" cascade
[0m22:52:35.195286 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_latest_prices" rename to "mart_crypto_latest_prices__dbt_backup"
[0m22:52:35.214474 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:52:35.230394 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:52:35.255446 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_tmp" rename to "mart_crypto_latest_prices"
[0m22:52:35.291335 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:52:35.311656 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:52:35.324818 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */

    create  index if not exists
  "9eb013c5beb6f3034ef14f0c23a0a697"
  on "crypto_warehouse"."public_marts"."mart_crypto_latest_prices" using btree
  (symbol);

[0m22:52:35.457893 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:52:35.468987 [debug] [Thread-4 (]: Timing info for model.crypto_analytics.mart_pipeline_monitoring (execute): 22:52:32.877621 => 22:52:35.468448
[0m22:52:35.478164 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: Close
[0m22:52:35.487481 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a711d83-6bea-453f-b637-242404e740ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a23b357d0>]}
[0m22:52:35.496798 [info ] [Thread-4 (]: 3 of 5 OK created sql table model public_marts.mart_pipeline_monitoring ........ [[32mSELECT 8[0m in 3.16s]
[0m22:52:35.502783 [debug] [Thread-2 (]: SQL status: SELECT 10 in 0.0 seconds
[0m22:52:35.513199 [debug] [Thread-4 (]: Finished running node model.crypto_analytics.mart_pipeline_monitoring
[0m22:52:35.547762 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:52:35.594180 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance" rename to "mart_crypto_hourly_performance__dbt_backup"
[0m22:52:35.603980 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:52:35.622098 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:52:35.638702 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_tmp" rename to "mart_crypto_hourly_performance"
[0m22:52:35.717360 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:52:35.720736 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:52:35.733973 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:52:35.761055 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:52:35.769654 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */

    create  index if not exists
  "d6ad1d1b910a9b93b4c66e4c4651c550"
  on "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance" using btree
  (symbol, extraction_hour);

[0m22:52:35.781994 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */

    create  index if not exists
  "0da54a388d96f94e18af1c091c153611"
  on "crypto_warehouse"."public_marts"."mart_crypto_latest_prices" using btree
  (market_cap_rank);

[0m22:52:35.976970 [debug] [Thread-2 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:52:35.994819 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:52:36.010532 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */

    create  index if not exists
  "14bb62d08493588686d0dc3cfc6956e4"
  on "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance" using btree
  (extraction_hour);

[0m22:52:36.136471 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:52:36.153075 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: COMMIT
[0m22:52:36.176302 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:52:36.185627 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: COMMIT
[0m22:52:36.280487 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:52:36.313166 [debug] [Thread-2 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:52:36.338576 [debug] [Thread-1 (]: Applying DROP to: "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_backup"
[0m22:52:36.356260 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: COMMIT
[0m22:52:36.368275 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:52:36.376919 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:52:36.385482 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */
drop table if exists "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_backup" cascade
[0m22:52:36.393965 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: COMMIT
[0m22:52:36.458451 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:52:36.469817 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.mart_crypto_latest_prices (execute): 22:52:34.352631 => 22:52:36.469292
[0m22:52:36.478199 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: Close
[0m22:52:36.487365 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a711d83-6bea-453f-b637-242404e740ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a21ee7590>]}
[0m22:52:36.496334 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public_marts.mart_crypto_latest_prices ....... [[32mSELECT 5[0m in 2.43s]
[0m22:52:36.514527 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.mart_crypto_latest_prices
[0m22:52:36.543781 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m22:52:36.560188 [debug] [Thread-2 (]: Applying DROP to: "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_backup"
[0m22:52:36.574862 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:52:36.583600 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */
drop table if exists "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_backup" cascade
[0m22:52:36.711690 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:52:36.729106 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.mart_crypto_hourly_performance (execute): 22:52:34.934695 => 22:52:36.728528
[0m22:52:36.740491 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: Close
[0m22:52:36.772769 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a711d83-6bea-453f-b637-242404e740ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a21ee5f50>]}
[0m22:52:36.782731 [info ] [Thread-2 (]: 5 of 5 OK created sql table model public_marts.mart_crypto_hourly_performance .. [[32mSELECT 10[0m in 2.36s]
[0m22:52:36.793410 [debug] [Thread-2 (]: Finished running node model.crypto_analytics.mart_crypto_hourly_performance
[0m22:52:36.805119 [debug] [MainThread]: Using postgres connection "master"
[0m22:52:36.813391 [debug] [MainThread]: On master: BEGIN
[0m22:52:36.820938 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:52:36.834326 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:52:36.842051 [debug] [MainThread]: On master: COMMIT
[0m22:52:36.849786 [debug] [MainThread]: Using postgres connection "master"
[0m22:52:36.858189 [debug] [MainThread]: On master: COMMIT
[0m22:52:36.867076 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:52:36.875209 [debug] [MainThread]: On master: Close
[0m22:52:36.884208 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:52:36.893779 [debug] [MainThread]: Connection 'model.crypto_analytics.mart_crypto_hourly_performance' was properly closed.
[0m22:52:36.918327 [debug] [MainThread]: Connection 'model.crypto_analytics.int_crypto_hourly_aggs' was properly closed.
[0m22:52:36.927883 [debug] [MainThread]: Connection 'model.crypto_analytics.mart_crypto_latest_prices' was properly closed.
[0m22:52:36.936529 [debug] [MainThread]: Connection 'model.crypto_analytics.mart_pipeline_monitoring' was properly closed.
[0m22:52:36.948358 [info ] [MainThread]:
[0m22:52:36.965264 [info ] [MainThread]: Finished running 1 view model, 4 table models in 0 hours 0 minutes and 8.48 seconds (8.48s).
[0m22:52:36.980401 [debug] [MainThread]: Command end result
[0m22:52:37.131466 [info ] [MainThread]:
[0m22:52:37.140275 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:52:37.163989 [info ] [MainThread]:
[0m22:52:37.177253 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m22:52:37.190128 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 19.793053, "process_user_time": 9.843437, "process_kernel_time": 0.805372, "process_mem_max_rss": "123220", "process_out_blocks": "1976", "process_in_blocks": "0"}
[0m22:52:37.207120 [debug] [MainThread]: Command `dbt run` succeeded at 22:52:37.206397 after 19.81 seconds
[0m22:52:37.222508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a24b67090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a241b9c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a28505550>]}
[0m22:52:37.480371 [debug] [MainThread]: Flushing usage events
[0m22:58:13.232888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a4b497c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a4bd05110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a4b497c90>]}


============================== 22:58:13.270229 | d2f282e0-12d9-45bc-815b-bacce8eafd50 ==============================
[0m22:58:13.270229 [info ] [MainThread]: Running with dbt=1.7.0
[0m22:58:13.287219 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/app/dbt/logs', 'profiles_dir': '/app', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /app/dbt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:58:13.803678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd2f282e0-12d9-45bc-815b-bacce8eafd50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a4ade3050>]}
[0m22:58:14.062007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd2f282e0-12d9-45bc-815b-bacce8eafd50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a4b36e9d0>]}
[0m22:58:14.075668 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m22:58:14.246895 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m22:58:25.764590 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:58:25.772428 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:58:25.800897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2f282e0-12d9-45bc-815b-bacce8eafd50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a4aefb890>]}
[0m22:58:26.017577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2f282e0-12d9-45bc-815b-bacce8eafd50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a49610dd0>]}
[0m22:58:26.034604 [info ] [MainThread]: Found 7 models, 14 tests, 2 sources, 0 exposures, 0 metrics, 517 macros, 0 groups, 0 semantic models
[0m22:58:26.050755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2f282e0-12d9-45bc-815b-bacce8eafd50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a496aa310>]}
[0m22:58:26.067964 [info ] [MainThread]:
[0m22:58:26.081066 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:58:26.096096 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse'
[0m22:58:26.098538 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse'
[0m22:58:26.146469 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse"
[0m22:58:26.149551 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse"
[0m22:58:26.156133 [debug] [ThreadPool]: On list_crypto_warehouse: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse"} */

    select distinct nspname from pg_namespace

[0m22:58:26.164330 [debug] [ThreadPool]: On list_crypto_warehouse: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse"} */

    select distinct nspname from pg_namespace

[0m22:58:26.172994 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:58:26.181083 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:58:26.199575 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m22:58:26.210743 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m22:58:26.215490 [debug] [ThreadPool]: On list_crypto_warehouse: Close
[0m22:58:26.227037 [debug] [ThreadPool]: On list_crypto_warehouse: Close
[0m22:58:26.251871 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_warehouse, now list_crypto_warehouse_public_marts)
[0m22:58:26.254434 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_warehouse, now list_crypto_warehouse_public_staging)
[0m22:58:26.259724 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse_public_dbt_test__audit'
[0m22:58:26.292546 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_marts"
[0m22:58:26.301788 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_staging"
[0m22:58:26.334551 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_dbt_test__audit"
[0m22:58:26.349960 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: BEGIN
[0m22:58:26.397023 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:58:26.380289 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: BEGIN
[0m22:58:26.364363 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: BEGIN
[0m22:58:26.415102 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:58:26.423032 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:58:26.433053 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:58:26.446779 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_marts"
[0m22:58:26.470681 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:58:26.489010 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:58:26.510158 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_marts"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'

[0m22:58:26.544030 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_dbt_test__audit"
[0m22:58:26.560147 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_staging"
[0m22:58:26.582596 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_dbt_test__audit"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'

[0m22:58:26.588937 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m22:58:26.600938 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_staging"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'

[0m22:58:26.628464 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m22:58:26.637496 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: ROLLBACK
[0m22:58:26.656896 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m22:58:26.669957 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: ROLLBACK
[0m22:58:26.683238 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: Close
[0m22:58:26.695875 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: ROLLBACK
[0m22:58:26.705432 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: Close
[0m22:58:26.729114 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: Close
[0m22:58:26.772443 [debug] [MainThread]: Using postgres connection "master"
[0m22:58:26.781747 [debug] [MainThread]: On master: BEGIN
[0m22:58:26.792272 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:58:26.805546 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:58:26.815851 [debug] [MainThread]: Using postgres connection "master"
[0m22:58:26.827950 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:58:26.858999 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m22:58:26.867587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2f282e0-12d9-45bc-815b-bacce8eafd50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a494a1c10>]}
[0m22:58:26.880110 [debug] [MainThread]: On master: ROLLBACK
[0m22:58:26.891856 [debug] [MainThread]: Using postgres connection "master"
[0m22:58:26.909215 [debug] [MainThread]: On master: BEGIN
[0m22:58:26.919996 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:58:26.929609 [debug] [MainThread]: On master: COMMIT
[0m22:58:26.941314 [debug] [MainThread]: Using postgres connection "master"
[0m22:58:26.949274 [debug] [MainThread]: On master: COMMIT
[0m22:58:26.960973 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:58:26.982678 [debug] [MainThread]: On master: Close
[0m22:58:26.997154 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:58:27.013011 [info ] [MainThread]:
[0m22:58:27.052846 [debug] [Thread-1 (]: Began running node model.crypto_analytics.stg_crypto_prices
[0m22:58:27.054131 [debug] [Thread-2 (]: Began running node model.crypto_analytics.stg_pipeline_runs
[0m22:58:27.064474 [info ] [Thread-1 (]: 1 of 5 START sql table model public_staging.stg_crypto_prices .................. [RUN]
[0m22:58:27.077099 [info ] [Thread-2 (]: 2 of 5 START sql view model public_staging.stg_pipeline_runs ................... [RUN]
[0m22:58:27.086400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_staging, now model.crypto_analytics.stg_crypto_prices)
[0m22:58:27.096427 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_dbt_test__audit, now model.crypto_analytics.stg_pipeline_runs)
[0m22:58:27.108178 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics.stg_crypto_prices
[0m22:58:27.115149 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics.stg_pipeline_runs
[0m22:58:27.145527 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics.stg_crypto_prices"
[0m22:58:27.153073 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics.stg_pipeline_runs"
[0m22:58:27.210047 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.stg_pipeline_runs (compile): 22:58:27.146756 => 22:58:27.209163
[0m22:58:27.215603 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.stg_crypto_prices (compile): 22:58:27.125267 => 22:58:27.214799
[0m22:58:27.219031 [debug] [Thread-2 (]: Began executing node model.crypto_analytics.stg_pipeline_runs
[0m22:58:27.230054 [debug] [Thread-1 (]: Began executing node model.crypto_analytics.stg_crypto_prices
[0m22:58:27.410473 [debug] [Thread-2 (]: Writing runtime sql for node "model.crypto_analytics.stg_pipeline_runs"
[0m22:58:27.425772 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics.stg_crypto_prices"
[0m22:58:27.495098 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m22:58:27.503767 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:58:27.510335 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: BEGIN
[0m22:58:27.519212 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: BEGIN
[0m22:58:27.529733 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:58:27.540889 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:58:27.555537 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:58:27.569212 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:58:27.580688 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m22:58:27.595131 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:58:27.609233 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */

  create view "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_tmp"


  as (
    SELECT
    id as run_id,
    run_id as run_identifier,
    stage,
    status,
    records_processed,
    error_message,
    started_at,
    completed_at,
    CASE
        WHEN completed_at IS NOT NULL
        THEN EXTRACT(EPOCH FROM (completed_at - started_at))
        ELSE NULL
    END as duration_seconds
FROM "crypto_warehouse"."public"."pipeline_runs"
  );
[0m22:58:27.617597 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */




  create  table "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_tmp"


    as

  (


WITH source_data AS (
    SELECT
        id as price_id,
        UPPER(TRIM(symbol)) as symbol,
        TRIM(name) as crypto_name,
        current_price as price_usd,
        market_cap,
        total_volume as volume_24h,
        price_change_24h,
        price_change_percentage_24h as price_change_pct_24h,
        market_cap_rank,
        extracted_at,
        created_at,

        CASE WHEN current_price <= 0 THEN TRUE ELSE FALSE END as is_invalid_price,
        CASE WHEN market_cap <= 0 THEN TRUE ELSE FALSE END as is_invalid_market_cap,
        CASE WHEN total_volume < 0 THEN TRUE ELSE FALSE END as is_invalid_volume
    FROM "crypto_warehouse"."public"."crypto_prices_raw"
),

cleaned_data AS (
    SELECT
        *,
        DATE(extracted_at) as extraction_date,
        DATE_TRUNC('hour', extracted_at) as extraction_hour,
        CASE
            WHEN LAG(price_usd) OVER (
                PARTITION BY symbol ORDER BY extracted_at
            ) IS NOT NULL THEN
                ((price_usd - LAG(price_usd) OVER (
                    PARTITION BY symbol ORDER BY extracted_at
                )) / LAG(price_usd) OVER (
                    PARTITION BY symbol ORDER BY extracted_at
                )) * 100
        END as price_change_pct_from_previous
    FROM source_data
    WHERE NOT is_invalid_price AND NOT is_invalid_volume
)

SELECT * FROM cleaned_data
  );

[0m22:58:27.633042 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m22:58:27.679925 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m22:58:27.690508 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */
alter table "crypto_warehouse"."public_staging"."stg_pipeline_runs" rename to "stg_pipeline_runs__dbt_backup"
[0m22:58:27.699204 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:58:27.717015 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m22:58:27.729023 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */
alter table "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_tmp" rename to "stg_pipeline_runs"
[0m22:58:27.777188 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:58:27.844155 [debug] [Thread-1 (]: SQL status: SELECT 25 in 0.0 seconds
[0m22:58:28.016699 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: COMMIT
[0m22:58:28.210502 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:58:28.381284 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m22:58:28.560525 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */
alter table "crypto_warehouse"."public_staging"."stg_crypto_prices" rename to "stg_crypto_prices__dbt_backup"
[0m22:58:28.599148 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: COMMIT
[0m22:58:28.615287 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:58:28.839280 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:58:28.856074 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m22:58:28.863895 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */
alter table "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_tmp" rename to "stg_crypto_prices"
[0m22:58:29.115489 [debug] [Thread-2 (]: Applying DROP to: "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_backup"
[0m22:58:29.123489 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:58:29.166852 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m22:58:29.209371 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:58:29.210798 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */
drop view if exists "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_backup" cascade
[0m22:58:29.223410 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */

        CREATE INDEX IF NOT EXISTS idx_stg_crypto_prices_symbol_time ON "crypto_warehouse"."public_staging"."stg_crypto_prices" (symbol, extracted_at)

[0m22:58:29.242542 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:58:29.268066 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: COMMIT
[0m22:58:29.279338 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:58:29.288793 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m22:58:29.291848 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: COMMIT
[0m22:58:29.305457 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.stg_pipeline_runs (execute): 22:58:27.243420 => 22:58:29.304885
[0m22:58:29.329700 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: Close
[0m22:58:29.342208 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2f282e0-12d9-45bc-815b-bacce8eafd50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a495f6090>]}
[0m22:58:29.355313 [info ] [Thread-2 (]: 2 of 5 OK created sql view model public_staging.stg_pipeline_runs .............. [[32mCREATE VIEW[0m in 2.25s]
[0m22:58:29.364200 [debug] [Thread-2 (]: Finished running node model.crypto_analytics.stg_pipeline_runs
[0m22:58:29.376547 [debug] [Thread-4 (]: Began running node model.crypto_analytics.mart_pipeline_monitoring
[0m22:58:29.385995 [info ] [Thread-4 (]: 3 of 5 START sql table model public_marts.mart_pipeline_monitoring ............. [RUN]
[0m22:58:29.398056 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.crypto_analytics.mart_pipeline_monitoring'
[0m22:58:29.409505 [debug] [Thread-4 (]: Began compiling node model.crypto_analytics.mart_pipeline_monitoring
[0m22:58:29.410674 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:58:29.439356 [debug] [Thread-4 (]: Writing injected SQL for node "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:58:29.446783 [debug] [Thread-1 (]: Applying DROP to: "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_backup"
[0m22:58:29.474000 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m22:58:29.485458 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */
drop table if exists "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_backup" cascade
[0m22:58:29.523080 [debug] [Thread-4 (]: Timing info for model.crypto_analytics.mart_pipeline_monitoring (compile): 22:58:29.418145 => 22:58:29.522479
[0m22:58:29.528791 [debug] [Thread-4 (]: Began executing node model.crypto_analytics.mart_pipeline_monitoring
[0m22:58:29.546415 [debug] [Thread-4 (]: Writing runtime sql for node "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:58:29.555246 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:58:29.566422 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.stg_crypto_prices (execute): 22:58:27.308239 => 22:58:29.565720
[0m22:58:29.576434 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: Close
[0m22:58:29.588318 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2f282e0-12d9-45bc-815b-bacce8eafd50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a493eeb50>]}
[0m22:58:29.597000 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public_staging.stg_crypto_prices ............. [[32mSELECT 25[0m in 2.50s]
[0m22:58:29.608923 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.stg_crypto_prices
[0m22:58:29.610170 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:58:29.617191 [debug] [Thread-2 (]: Began running node model.crypto_analytics.int_crypto_daily_aggs
[0m22:58:29.618458 [debug] [Thread-3 (]: Began running node model.crypto_analytics.int_crypto_hourly_aggs
[0m22:58:29.621101 [debug] [Thread-1 (]: Began running node model.crypto_analytics.mart_crypto_latest_prices
[0m22:58:29.626403 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: BEGIN
[0m22:58:29.633701 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.stg_pipeline_runs, now model.crypto_analytics.int_crypto_daily_aggs)
[0m22:58:29.643388 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_marts, now model.crypto_analytics.int_crypto_hourly_aggs)
[0m22:58:29.651185 [info ] [Thread-1 (]: 4 of 5 START sql table model public_marts.mart_crypto_latest_prices ............ [RUN]
[0m22:58:29.659258 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:58:29.665673 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics.int_crypto_daily_aggs
[0m22:58:29.674302 [debug] [Thread-3 (]: Began compiling node model.crypto_analytics.int_crypto_hourly_aggs
[0m22:58:29.680500 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.stg_crypto_prices, now model.crypto_analytics.mart_crypto_latest_prices)
[0m22:58:29.695743 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m22:58:29.707545 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics.int_crypto_daily_aggs"
[0m22:58:29.716782 [debug] [Thread-3 (]: Writing injected SQL for node "model.crypto_analytics.int_crypto_hourly_aggs"
[0m22:58:29.724484 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics.mart_crypto_latest_prices
[0m22:58:29.731212 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:58:29.773868 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:58:29.780818 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */




  create  table "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_tmp"


    as

  (


WITH pipeline_metrics AS (
    SELECT
        run_id,
        stage,
        status,
        records_processed,
        error_message,
        started_at,
        completed_at,
        EXTRACT(EPOCH FROM completed_at - started_at) AS duration_seconds,

        -- Flag to compute success rate
        CASE WHEN status = 'success' THEN 1 ELSE 0 END AS is_success,

        -- Classify performance
        CASE
            WHEN completed_at IS NULL THEN 'Running'
            WHEN EXTRACT(EPOCH FROM completed_at - started_at) < 30 THEN 'Fast'
            WHEN EXTRACT(EPOCH FROM completed_at - started_at) < 120 THEN 'Normal'
            ELSE 'Slow'
        END AS performance_category

    FROM "crypto_warehouse"."public_staging"."stg_pipeline_runs"
),

latest_status_per_day_stage AS (
    SELECT
        DATE(started_at) AS run_date,
        stage,
        FIRST_VALUE(status) OVER (
            PARTITION BY DATE(started_at), stage
            ORDER BY started_at DESC
        ) AS latest_run_status
    FROM pipeline_metrics
),

daily_summary AS (
    SELECT
        DATE(started_at) AS run_date,
        stage,

        COUNT(*) AS total_runs,
        SUM(is_success) AS successful_runs,
        SUM(records_processed) AS total_records_processed,
        AVG(duration_seconds) AS avg_duration_seconds,
        MAX(duration_seconds) AS max_duration_seconds,
        ROUND(((SUM(is_success)::FLOAT / COUNT(*)) * 100)::NUMERIC, 2) AS success_rate_pct


    FROM pipeline_metrics
    WHERE started_at >= CURRENT_DATE - INTERVAL '30 days'
    GROUP BY DATE(started_at), stage
)

-- Final result combining metrics with latest run status
SELECT
    ds.*,
    ls.latest_run_status
FROM daily_summary ds
LEFT JOIN latest_status_per_day_stage ls
  ON ds.run_date = ls.run_date AND ds.stage = ls.stage
  );

[0m22:58:29.788299 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.int_crypto_daily_aggs (compile): 22:58:29.697307 => 22:58:29.787276
[0m22:58:29.796339 [debug] [Thread-3 (]: Timing info for model.crypto_analytics.int_crypto_hourly_aggs (compile): 22:58:29.710646 => 22:58:29.795656
[0m22:58:29.822539 [debug] [Thread-2 (]: Finished running node model.crypto_analytics.int_crypto_daily_aggs
[0m22:58:29.843147 [debug] [Thread-3 (]: Finished running node model.crypto_analytics.int_crypto_hourly_aggs
[0m22:58:29.872513 [debug] [Thread-2 (]: Began running node model.crypto_analytics.mart_crypto_hourly_performance
[0m22:58:29.880469 [info ] [Thread-2 (]: 5 of 5 START sql table model public_marts.mart_crypto_hourly_performance ....... [RUN]
[0m22:58:29.894867 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.int_crypto_daily_aggs, now model.crypto_analytics.mart_crypto_hourly_performance)
[0m22:58:29.896381 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.mart_crypto_latest_prices (compile): 22:58:29.761521 => 22:58:29.895675
[0m22:58:29.906173 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics.mart_crypto_hourly_performance
[0m22:58:29.913893 [debug] [Thread-1 (]: Began executing node model.crypto_analytics.mart_crypto_latest_prices
[0m22:58:29.983591 [debug] [Thread-4 (]: SQL status: SELECT 10 in 0.0 seconds
[0m22:58:29.994559 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:58:29.996757 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:58:30.039103 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:58:30.066140 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */
alter table "crypto_warehouse"."public_marts"."mart_pipeline_monitoring" rename to "mart_pipeline_monitoring__dbt_backup"
[0m22:58:30.079550 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:58:30.111127 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:58:30.141319 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */
alter table "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_tmp" rename to "mart_pipeline_monitoring"
[0m22:58:30.173100 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.mart_crypto_hourly_performance (compile): 22:58:29.923592 => 22:58:30.172272
[0m22:58:30.174231 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:58:30.175406 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:58:30.182544 [debug] [Thread-2 (]: Began executing node model.crypto_analytics.mart_crypto_hourly_performance
[0m22:58:30.238593 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: BEGIN
[0m22:58:30.241126 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:58:30.275814 [debug] [Thread-2 (]: Writing runtime sql for node "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:58:30.282773 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:58:30.295181 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */

    create  index if not exists
  "bfbfda7769d78d30ee5b39da9522ce07"
  on "crypto_warehouse"."public_marts"."mart_pipeline_monitoring" using btree
  (run_date);

[0m22:58:30.325316 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:58:30.342429 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:58:30.354851 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */




  create  table "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_tmp"


    as

  (


WITH latest_prices AS (
    SELECT
        symbol,
        crypto_name,
        price_usd,
        market_cap,
        volume_24h,
        price_change_24h,
        price_change_pct_24h,
        market_cap_rank,
        extracted_at,

        ROW_NUMBER() OVER (
            PARTITION BY symbol
            ORDER BY extracted_at DESC
        ) as rn

    FROM "crypto_warehouse"."public_staging"."stg_crypto_prices"
    WHERE extraction_date = CURRENT_DATE
),

price_changes AS (
    SELECT
        symbol,
        crypto_name,
        price_usd as current_price,
        market_cap,
        volume_24h,
        price_change_24h,
        price_change_pct_24h,
        market_cap_rank,
        extracted_at as last_updated,

        -- Calculate additional metrics
        CASE
            WHEN price_change_pct_24h > 10 THEN 'Strong Gain'
            WHEN price_change_pct_24h > 5 THEN 'Moderate Gain'
            WHEN price_change_pct_24h > 0 THEN 'Slight Gain'
            WHEN price_change_pct_24h > -5 THEN 'Slight Loss'
            WHEN price_change_pct_24h > -10 THEN 'Moderate Loss'
            ELSE 'Strong Loss'
        END as price_trend_category,

        -- Market cap category
        CASE
            WHEN market_cap_rank <= 10 THEN 'Large Cap'
            WHEN market_cap_rank <= 50 THEN 'Mid Cap'
            WHEN market_cap_rank <= 100 THEN 'Small Cap'
            ELSE 'Micro Cap'
        END as market_cap_category

    FROM latest_prices
    WHERE rn = 1
)

SELECT * FROM price_changes
  );

[0m22:58:30.373382 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:58:30.379435 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: BEGIN
[0m22:58:30.390857 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:58:30.407167 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:58:30.414418 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:58:30.424473 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */




  create  table "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_tmp"


    as

  (


WITH  __dbt__cte__int_crypto_hourly_aggs as (


WITH base_data AS (
    SELECT
        symbol,
        crypto_name,
        DATE_TRUNC('hour', extracted_at) AS extraction_hour,
        price_usd,
        volume_24h,
        market_cap,
        CASE WHEN price_usd <= 0 THEN 1 ELSE 0 END AS is_invalid
    FROM "crypto_warehouse"."public_staging"."stg_crypto_prices"
)

SELECT
    symbol,
    crypto_name,
    extraction_hour,
    COUNT(*) AS total_records,
    SUM(is_invalid) AS invalid_price_records,
    AVG(price_usd) AS avg_price_usd,
    MIN(price_usd) AS min_price_usd,
    MAX(price_usd) AS max_price_usd,
    STDDEV(price_usd) AS price_volatility,
    AVG(volume_24h) AS avg_volume_24h,
    AVG(market_cap) AS avg_market_cap
FROM base_data
GROUP BY symbol, crypto_name, extraction_hour
), hourly_data AS (
    SELECT
        symbol,
        crypto_name,
        extraction_hour,
        avg_price_usd,
        min_price_usd,
        max_price_usd,
        price_volatility,
        avg_volume_24h,
        avg_market_cap,
        total_records,

        -- Calculate hourly change
        LAG(avg_price_usd) OVER (
            PARTITION BY symbol
            ORDER BY extraction_hour
        ) as previous_hour_price,

        -- Data quality score
        (1.0 - (invalid_price_records::FLOAT / GREATEST(total_records, 1))) * 100 as data_quality_score

    FROM __dbt__cte__int_crypto_hourly_aggs
),

performance_metrics AS (
    SELECT
        *,
        CASE
            WHEN previous_hour_price IS NOT NULL AND previous_hour_price > 0 THEN
                ((avg_price_usd - previous_hour_price) / previous_hour_price) * 100
            ELSE NULL
        END as hourly_change_pct,

        -- Volatility category
        CASE
            WHEN price_volatility IS NULL THEN 'Unknown'
            WHEN price_volatility < avg_price_usd * 0.01 THEN 'Low Volatility'
            WHEN price_volatility < avg_price_usd * 0.05 THEN 'Medium Volatility'
            ELSE 'High Volatility'
        END as volatility_category

    FROM hourly_data
)

SELECT * FROM performance_metrics
  );

[0m22:58:30.465682 [debug] [Thread-4 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:58:30.477441 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:58:30.489792 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */

    create  index if not exists
  "2ea942464765cb3172e0fde6d09503d0"
  on "crypto_warehouse"."public_marts"."mart_pipeline_monitoring" using btree
  (stage);

[0m22:58:30.608026 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.0 seconds
[0m22:58:30.621091 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:58:30.626868 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_latest_prices" rename to "mart_crypto_latest_prices__dbt_backup"
[0m22:58:30.636072 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:58:30.651551 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:58:30.672610 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_tmp" rename to "mart_crypto_latest_prices"
[0m22:58:30.678567 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:58:30.690455 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:58:30.696334 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */

    create  index if not exists
  "4268b7bee7cdf8680308f0d8b4411ab5"
  on "crypto_warehouse"."public_marts"."mart_crypto_latest_prices" using btree
  (symbol);

[0m22:58:30.731217 [debug] [Thread-4 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:58:30.733117 [debug] [Thread-2 (]: SQL status: SELECT 10 in 0.0 seconds
[0m22:58:30.743062 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: COMMIT
[0m22:58:30.757805 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:58:30.762997 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:58:30.772431 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance" rename to "mart_crypto_hourly_performance__dbt_backup"
[0m22:58:30.778057 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: COMMIT
[0m22:58:30.790477 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:58:30.809137 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:58:30.819708 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_tmp" rename to "mart_crypto_hourly_performance"
[0m22:58:30.825637 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:58:30.837568 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:58:30.843455 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */

    create  index if not exists
  "b62bcbce92575c09545ad5b5acf8e4ee"
  on "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance" using btree
  (symbol, extraction_hour);

[0m22:58:30.864584 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:58:30.875900 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:58:30.889760 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */

    create  index if not exists
  "32cc94fd4c3e8994d0163710f33cc5a9"
  on "crypto_warehouse"."public_marts"."mart_crypto_latest_prices" using btree
  (market_cap_rank);

[0m22:58:30.978254 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m22:58:31.246552 [debug] [Thread-2 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:58:31.433035 [debug] [Thread-4 (]: Applying DROP to: "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_backup"
[0m22:58:31.427769 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 1.0 seconds
[0m22:58:31.555130 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:58:31.618289 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m22:58:31.712790 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: COMMIT
[0m22:58:31.746946 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */

    create  index if not exists
  "2473cd7bf31ed32276d1d1bfcc00a2f8"
  on "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance" using btree
  (extraction_hour);

[0m22:58:31.826271 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */
drop table if exists "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_backup" cascade
[0m22:58:31.908430 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:58:32.166726 [debug] [Thread-2 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m22:58:32.235525 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:58:32.472289 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: COMMIT
[0m22:58:32.550727 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: COMMIT
[0m22:58:32.612667 [debug] [Thread-4 (]: Timing info for model.crypto_analytics.mart_pipeline_monitoring (execute): 22:58:29.538511 => 22:58:32.608159
[0m22:58:32.841743 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: Close
[0m22:58:32.753320 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:58:32.733441 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:58:32.907888 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2f282e0-12d9-45bc-815b-bacce8eafd50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a4946a410>]}
[0m22:58:32.974699 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: COMMIT
[0m22:58:33.069936 [debug] [Thread-1 (]: Applying DROP to: "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_backup"
[0m22:58:33.264941 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m22:58:33.247358 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m22:58:33.134578 [info ] [Thread-4 (]: 3 of 5 OK created sql table model public_marts.mart_pipeline_monitoring ........ [[32mSELECT 10[0m in 3.51s]
[0m22:58:33.315181 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */
drop table if exists "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_backup" cascade
[0m22:58:33.384232 [debug] [Thread-2 (]: Applying DROP to: "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_backup"
[0m22:58:33.455547 [debug] [Thread-4 (]: Finished running node model.crypto_analytics.mart_pipeline_monitoring
[0m22:58:33.539376 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m22:58:33.555613 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:58:33.590239 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */
drop table if exists "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_backup" cascade
[0m22:58:33.621187 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.mart_crypto_latest_prices (execute): 22:58:29.956416 => 22:58:33.620353
[0m22:58:33.653753 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: Close
[0m22:58:33.669085 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2f282e0-12d9-45bc-815b-bacce8eafd50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a4928e7d0>]}
[0m22:58:33.681226 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:58:33.686947 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public_marts.mart_crypto_latest_prices ....... [[32mSELECT 5[0m in 3.99s]
[0m22:58:33.702932 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.mart_crypto_hourly_performance (execute): 22:58:30.255126 => 22:58:33.702332
[0m22:58:33.715628 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.mart_crypto_latest_prices
[0m22:58:33.723651 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: Close
[0m22:58:33.749935 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2f282e0-12d9-45bc-815b-bacce8eafd50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a494f6010>]}
[0m22:58:33.766895 [info ] [Thread-2 (]: 5 of 5 OK created sql table model public_marts.mart_crypto_hourly_performance .. [[32mSELECT 10[0m in 3.86s]
[0m22:58:33.776281 [debug] [Thread-2 (]: Finished running node model.crypto_analytics.mart_crypto_hourly_performance
[0m22:58:33.795440 [debug] [MainThread]: Using postgres connection "master"
[0m22:58:33.805989 [debug] [MainThread]: On master: BEGIN
[0m22:58:33.817876 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:58:33.835059 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:58:33.847417 [debug] [MainThread]: On master: COMMIT
[0m22:58:33.875838 [debug] [MainThread]: Using postgres connection "master"
[0m22:58:33.892559 [debug] [MainThread]: On master: COMMIT
[0m22:58:33.910098 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:58:33.935861 [debug] [MainThread]: On master: Close
[0m22:58:33.954482 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:58:33.975434 [debug] [MainThread]: Connection 'model.crypto_analytics.mart_crypto_latest_prices' was properly closed.
[0m22:58:33.992583 [debug] [MainThread]: Connection 'model.crypto_analytics.int_crypto_hourly_aggs' was properly closed.
[0m22:58:34.026204 [debug] [MainThread]: Connection 'model.crypto_analytics.mart_crypto_hourly_performance' was properly closed.
[0m22:58:34.241313 [debug] [MainThread]: Connection 'model.crypto_analytics.mart_pipeline_monitoring' was properly closed.
[0m22:58:34.545547 [info ] [MainThread]:
[0m22:58:34.771973 [info ] [MainThread]: Finished running 1 view model, 4 table models in 0 hours 0 minutes and 8.46 seconds (8.46s).
[0m22:58:34.913254 [debug] [MainThread]: Command end result
[0m22:58:37.612283 [info ] [MainThread]:
[0m22:58:37.620472 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:58:37.633401 [info ] [MainThread]:
[0m22:58:37.646275 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m22:58:37.661932 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 25.198069, "process_user_time": 12.033116, "process_kernel_time": 1.485954, "process_mem_max_rss": "124072", "process_out_blocks": "1976", "process_in_blocks": "0"}
[0m22:58:37.685046 [debug] [MainThread]: Command `dbt run` succeeded at 22:58:37.684668 after 25.22 seconds
[0m22:58:37.700693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a4bcdee90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a4ade2f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a4f839590>]}
[0m22:58:37.714190 [debug] [MainThread]: Flushing usage events
[0m23:05:43.281596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76923539d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7692353910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7692353150>]}


============================== 23:05:43.300738 | 0fbbc9f6-4487-4cad-acf1-bf324486c71c ==============================
[0m23:05:43.300738 [info ] [MainThread]: Running with dbt=1.7.0
[0m23:05:43.310534 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'debug': 'False', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /app/dbt', 'send_anonymous_usage_stats': 'True'}
[0m23:05:43.828006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0fbbc9f6-4487-4cad-acf1-bf324486c71c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7690bf00d0>]}
[0m23:05:44.020304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0fbbc9f6-4487-4cad-acf1-bf324486c71c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7690c02750>]}
[0m23:05:44.027944 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m23:05:44.173623 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m23:05:49.782937 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:05:49.787367 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:05:49.803559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0fbbc9f6-4487-4cad-acf1-bf324486c71c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76923a82d0>]}
[0m23:05:49.945748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0fbbc9f6-4487-4cad-acf1-bf324486c71c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7690b4e350>]}
[0m23:05:49.951874 [info ] [MainThread]: Found 7 models, 14 tests, 2 sources, 0 exposures, 0 metrics, 517 macros, 0 groups, 0 semantic models
[0m23:05:49.957616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fbbc9f6-4487-4cad-acf1-bf324486c71c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7690c3e5d0>]}
[0m23:05:49.968923 [info ] [MainThread]:
[0m23:05:49.975989 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:05:49.984415 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse'
[0m23:05:49.986573 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse'
[0m23:05:50.016914 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse"
[0m23:05:50.020821 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse"
[0m23:05:50.029080 [debug] [ThreadPool]: On list_crypto_warehouse: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse"} */

    select distinct nspname from pg_namespace

[0m23:05:50.034842 [debug] [ThreadPool]: On list_crypto_warehouse: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse"} */

    select distinct nspname from pg_namespace

[0m23:05:50.040492 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:05:50.050515 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:05:50.062754 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m23:05:50.071965 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m23:05:50.074120 [debug] [ThreadPool]: On list_crypto_warehouse: Close
[0m23:05:50.082966 [debug] [ThreadPool]: On list_crypto_warehouse: Close
[0m23:05:50.099856 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_warehouse, now list_crypto_warehouse_public_staging)
[0m23:05:50.101251 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_warehouse, now list_crypto_warehouse_public_marts)
[0m23:05:50.102688 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse_public_dbt_test__audit'
[0m23:05:50.118193 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_staging"
[0m23:05:50.123890 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_marts"
[0m23:05:50.134311 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_dbt_test__audit"
[0m23:05:50.139220 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: BEGIN
[0m23:05:50.147703 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: BEGIN
[0m23:05:50.152740 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: BEGIN
[0m23:05:50.157551 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:05:50.164812 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:05:50.172881 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:05:50.193515 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:05:50.209794 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:05:50.232627 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:05:50.235438 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_staging"
[0m23:05:50.244061 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_marts"
[0m23:05:50.252301 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_dbt_test__audit"
[0m23:05:50.262059 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_staging"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'

[0m23:05:50.270285 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_marts"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'

[0m23:05:50.280816 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_dbt_test__audit"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'

[0m23:05:50.295540 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m23:05:50.303364 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m23:05:50.314294 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m23:05:50.316949 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: ROLLBACK
[0m23:05:50.326948 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: ROLLBACK
[0m23:05:50.337801 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: ROLLBACK
[0m23:05:50.346923 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: Close
[0m23:05:50.353126 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: Close
[0m23:05:50.359527 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: Close
[0m23:05:50.412712 [debug] [MainThread]: Using postgres connection "master"
[0m23:05:50.420467 [debug] [MainThread]: On master: BEGIN
[0m23:05:50.430935 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:05:50.444568 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:05:50.452231 [debug] [MainThread]: Using postgres connection "master"
[0m23:05:50.460308 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:05:50.482124 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m23:05:50.490599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fbbc9f6-4487-4cad-acf1-bf324486c71c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7690b45a90>]}
[0m23:05:50.501463 [debug] [MainThread]: On master: ROLLBACK
[0m23:05:50.512048 [debug] [MainThread]: Using postgres connection "master"
[0m23:05:50.518248 [debug] [MainThread]: On master: BEGIN
[0m23:05:50.527211 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:05:50.534725 [debug] [MainThread]: On master: COMMIT
[0m23:05:50.541727 [debug] [MainThread]: Using postgres connection "master"
[0m23:05:50.550056 [debug] [MainThread]: On master: COMMIT
[0m23:05:50.558071 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:05:50.566273 [debug] [MainThread]: On master: Close
[0m23:05:50.573816 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:05:50.582779 [info ] [MainThread]:
[0m23:05:50.605173 [debug] [Thread-1 (]: Began running node model.crypto_analytics.stg_crypto_prices
[0m23:05:50.606054 [debug] [Thread-2 (]: Began running node model.crypto_analytics.stg_pipeline_runs
[0m23:05:50.614640 [info ] [Thread-1 (]: 1 of 5 START sql table model public_staging.stg_crypto_prices .................. [RUN]
[0m23:05:50.621686 [info ] [Thread-2 (]: 2 of 5 START sql view model public_staging.stg_pipeline_runs ................... [RUN]
[0m23:05:50.630776 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_dbt_test__audit, now model.crypto_analytics.stg_crypto_prices)
[0m23:05:50.638731 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_marts, now model.crypto_analytics.stg_pipeline_runs)
[0m23:05:50.648504 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics.stg_crypto_prices
[0m23:05:50.655781 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics.stg_pipeline_runs
[0m23:05:50.681467 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics.stg_crypto_prices"
[0m23:05:50.687526 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics.stg_pipeline_runs"
[0m23:05:50.733080 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.stg_pipeline_runs (compile): 23:05:50.682419 => 23:05:50.732368
[0m23:05:50.740544 [debug] [Thread-2 (]: Began executing node model.crypto_analytics.stg_pipeline_runs
[0m23:05:50.745363 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.stg_crypto_prices (compile): 23:05:50.664336 => 23:05:50.744572
[0m23:05:50.788005 [debug] [Thread-1 (]: Began executing node model.crypto_analytics.stg_crypto_prices
[0m23:05:50.974798 [debug] [Thread-2 (]: Writing runtime sql for node "model.crypto_analytics.stg_pipeline_runs"
[0m23:05:51.000120 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics.stg_crypto_prices"
[0m23:05:51.055642 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m23:05:51.063232 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m23:05:51.065025 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: BEGIN
[0m23:05:51.072288 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: BEGIN
[0m23:05:51.086110 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:05:51.097460 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:05:51.111143 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:05:51.129337 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:05:51.133776 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m23:05:51.140668 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m23:05:51.149044 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */

  create view "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_tmp"


  as (
    SELECT
    id as run_id,
    run_id as run_identifier,
    stage,
    status,
    records_processed,
    error_message,
    started_at,
    completed_at,
    CASE
        WHEN completed_at IS NOT NULL
        THEN EXTRACT(EPOCH FROM (completed_at - started_at))
        ELSE NULL
    END as duration_seconds
FROM "crypto_warehouse"."public"."pipeline_runs"
  );
[0m23:05:51.156380 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */




  create  table "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_tmp"


    as

  (


WITH source_data AS (
    SELECT
        id as price_id,
        UPPER(TRIM(symbol)) as symbol,
        TRIM(name) as crypto_name,
        current_price as price_usd,
        market_cap,
        total_volume as volume_24h,
        price_change_24h,
        price_change_percentage_24h as price_change_pct_24h,
        market_cap_rank,
        extracted_at,
        created_at,

        CASE WHEN current_price <= 0 THEN TRUE ELSE FALSE END as is_invalid_price,
        CASE WHEN market_cap <= 0 THEN TRUE ELSE FALSE END as is_invalid_market_cap,
        CASE WHEN total_volume < 0 THEN TRUE ELSE FALSE END as is_invalid_volume
    FROM "crypto_warehouse"."public"."crypto_prices_raw"
),

cleaned_data AS (
    SELECT
        *,
        DATE(extracted_at) as extraction_date,
        DATE_TRUNC('hour', extracted_at) as extraction_hour,
        CASE
            WHEN LAG(price_usd) OVER (
                PARTITION BY symbol ORDER BY extracted_at
            ) IS NOT NULL THEN
                ((price_usd - LAG(price_usd) OVER (
                    PARTITION BY symbol ORDER BY extracted_at
                )) / LAG(price_usd) OVER (
                    PARTITION BY symbol ORDER BY extracted_at
                )) * 100
        END as price_change_pct_from_previous
    FROM source_data
    WHERE NOT is_invalid_price AND NOT is_invalid_volume
)

SELECT * FROM cleaned_data
  );

[0m23:05:51.169108 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:05:51.207973 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m23:05:51.216545 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */
alter table "crypto_warehouse"."public_staging"."stg_pipeline_runs" rename to "stg_pipeline_runs__dbt_backup"
[0m23:05:51.226431 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:05:51.244111 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m23:05:51.251326 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */
alter table "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_tmp" rename to "stg_pipeline_runs"
[0m23:05:51.262239 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:05:51.368083 [debug] [Thread-1 (]: SQL status: SELECT 30 in 0.0 seconds
[0m23:05:51.385706 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: COMMIT
[0m23:05:51.396862 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m23:05:51.401015 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m23:05:51.414252 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */
alter table "crypto_warehouse"."public_staging"."stg_crypto_prices" rename to "stg_crypto_prices__dbt_backup"
[0m23:05:51.428493 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: COMMIT
[0m23:05:51.436629 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:05:51.518120 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m23:05:51.618263 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */
alter table "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_tmp" rename to "stg_crypto_prices"
[0m23:05:51.736534 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:05:51.894689 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m23:05:51.958668 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */

        CREATE INDEX IF NOT EXISTS idx_stg_crypto_prices_symbol_time ON "crypto_warehouse"."public_staging"."stg_crypto_prices" (symbol, extracted_at)

[0m23:05:52.088551 [debug] [Thread-2 (]: SQL status: COMMIT in 1.0 seconds
[0m23:05:52.303467 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m23:05:52.334519 [debug] [Thread-2 (]: Applying DROP to: "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_backup"
[0m23:05:52.413949 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: COMMIT
[0m23:05:52.438280 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m23:05:52.443768 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m23:05:52.474599 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */
drop view if exists "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_backup" cascade
[0m23:05:52.483990 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: COMMIT
[0m23:05:52.556619 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:05:52.568268 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.stg_pipeline_runs (execute): 23:05:50.753603 => 23:05:52.567647
[0m23:05:52.578319 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: Close
[0m23:05:52.586890 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fbbc9f6-4487-4cad-acf1-bf324486c71c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76908536d0>]}
[0m23:05:52.588728 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:05:52.601949 [info ] [Thread-2 (]: 2 of 5 OK created sql view model public_staging.stg_pipeline_runs .............. [[32mCREATE VIEW[0m in 1.95s]
[0m23:05:52.620220 [debug] [Thread-1 (]: Applying DROP to: "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_backup"
[0m23:05:52.630020 [debug] [Thread-2 (]: Finished running node model.crypto_analytics.stg_pipeline_runs
[0m23:05:52.646073 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m23:05:52.653295 [debug] [Thread-4 (]: Began running node model.crypto_analytics.mart_pipeline_monitoring
[0m23:05:52.663785 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */
drop table if exists "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_backup" cascade
[0m23:05:52.675597 [info ] [Thread-4 (]: 3 of 5 START sql table model public_marts.mart_pipeline_monitoring ............. [RUN]
[0m23:05:52.695028 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.crypto_analytics.mart_pipeline_monitoring'
[0m23:05:52.703922 [debug] [Thread-4 (]: Began compiling node model.crypto_analytics.mart_pipeline_monitoring
[0m23:05:52.721169 [debug] [Thread-4 (]: Writing injected SQL for node "model.crypto_analytics.mart_pipeline_monitoring"
[0m23:05:52.734173 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:05:52.748862 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.stg_crypto_prices (execute): 23:05:50.823155 => 23:05:52.748312
[0m23:05:52.764478 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: Close
[0m23:05:52.776852 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fbbc9f6-4487-4cad-acf1-bf324486c71c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7690ab50d0>]}
[0m23:05:52.785423 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public_staging.stg_crypto_prices ............. [[32mSELECT 30[0m in 2.15s]
[0m23:05:52.798266 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.stg_crypto_prices
[0m23:05:52.804689 [debug] [Thread-4 (]: Timing info for model.crypto_analytics.mart_pipeline_monitoring (compile): 23:05:52.714513 => 23:05:52.804009
[0m23:05:52.813699 [debug] [Thread-2 (]: Began running node model.crypto_analytics.int_crypto_daily_aggs
[0m23:05:52.814783 [debug] [Thread-3 (]: Began running node model.crypto_analytics.int_crypto_hourly_aggs
[0m23:05:52.815782 [debug] [Thread-1 (]: Began running node model.crypto_analytics.mart_crypto_latest_prices
[0m23:05:52.829041 [debug] [Thread-4 (]: Began executing node model.crypto_analytics.mart_pipeline_monitoring
[0m23:05:52.838802 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.stg_pipeline_runs, now model.crypto_analytics.int_crypto_daily_aggs)
[0m23:05:52.849205 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_staging, now model.crypto_analytics.int_crypto_hourly_aggs)
[0m23:05:52.870645 [info ] [Thread-1 (]: 4 of 5 START sql table model public_marts.mart_crypto_latest_prices ............ [RUN]
[0m23:05:52.897322 [debug] [Thread-4 (]: Writing runtime sql for node "model.crypto_analytics.mart_pipeline_monitoring"
[0m23:05:52.903906 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics.int_crypto_daily_aggs
[0m23:05:52.916737 [debug] [Thread-3 (]: Began compiling node model.crypto_analytics.int_crypto_hourly_aggs
[0m23:05:52.930831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.stg_crypto_prices, now model.crypto_analytics.mart_crypto_latest_prices)
[0m23:05:52.963809 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics.int_crypto_daily_aggs"
[0m23:05:52.990201 [debug] [Thread-3 (]: Writing injected SQL for node "model.crypto_analytics.int_crypto_hourly_aggs"
[0m23:05:52.993913 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics.mart_crypto_latest_prices
[0m23:05:53.034438 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics.mart_crypto_latest_prices"
[0m23:05:53.042959 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m23:05:53.062328 [debug] [Thread-3 (]: Timing info for model.crypto_analytics.int_crypto_hourly_aggs (compile): 23:05:52.970759 => 23:05:53.061660
[0m23:05:53.064426 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: BEGIN
[0m23:05:53.068502 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.int_crypto_daily_aggs (compile): 23:05:52.952009 => 23:05:53.067755
[0m23:05:53.089657 [debug] [Thread-3 (]: Finished running node model.crypto_analytics.int_crypto_hourly_aggs
[0m23:05:53.098325 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:05:53.110280 [debug] [Thread-2 (]: Finished running node model.crypto_analytics.int_crypto_daily_aggs
[0m23:05:53.113806 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.mart_crypto_latest_prices (compile): 23:05:53.025606 => 23:05:53.112918
[0m23:05:53.118639 [debug] [Thread-3 (]: Began running node model.crypto_analytics.mart_crypto_hourly_performance
[0m23:05:53.134111 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m23:05:53.150704 [debug] [Thread-1 (]: Began executing node model.crypto_analytics.mart_crypto_latest_prices
[0m23:05:53.164203 [info ] [Thread-3 (]: 5 of 5 START sql table model public_marts.mart_crypto_hourly_performance ....... [RUN]
[0m23:05:53.184890 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m23:05:53.218896 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics.mart_crypto_latest_prices"
[0m23:05:53.233362 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.int_crypto_hourly_aggs, now model.crypto_analytics.mart_crypto_hourly_performance)
[0m23:05:53.244813 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */




  create  table "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_tmp"


    as

  (


WITH pipeline_metrics AS (
    SELECT
        run_id,
        stage,
        status,
        records_processed,
        error_message,
        started_at,
        completed_at,
        EXTRACT(EPOCH FROM completed_at - started_at) AS duration_seconds,

        -- Flag to compute success rate
        CASE WHEN status = 'success' THEN 1 ELSE 0 END AS is_success,

        -- Classify performance
        CASE
            WHEN completed_at IS NULL THEN 'Running'
            WHEN EXTRACT(EPOCH FROM completed_at - started_at) < 30 THEN 'Fast'
            WHEN EXTRACT(EPOCH FROM completed_at - started_at) < 120 THEN 'Normal'
            ELSE 'Slow'
        END AS performance_category

    FROM "crypto_warehouse"."public_staging"."stg_pipeline_runs"
),

latest_status_per_day_stage AS (
    SELECT
        DATE(started_at) AS run_date,
        stage,
        FIRST_VALUE(status) OVER (
            PARTITION BY DATE(started_at), stage
            ORDER BY started_at DESC
        ) AS latest_run_status
    FROM pipeline_metrics
),

daily_summary AS (
    SELECT
        DATE(started_at) AS run_date,
        stage,

        COUNT(*) AS total_runs,
        SUM(is_success) AS successful_runs,
        SUM(records_processed) AS total_records_processed,
        AVG(duration_seconds) AS avg_duration_seconds,
        MAX(duration_seconds) AS max_duration_seconds,
        ROUND(((SUM(is_success)::FLOAT / COUNT(*)) * 100)::NUMERIC, 2) AS success_rate_pct


    FROM pipeline_metrics
    WHERE started_at >= CURRENT_DATE - INTERVAL '30 days'
    GROUP BY DATE(started_at), stage
)

-- Final result combining metrics with latest run status
SELECT
    ds.*,
    ls.latest_run_status
FROM daily_summary ds
LEFT JOIN latest_status_per_day_stage ls
  ON ds.run_date = ls.run_date AND ds.stage = ls.stage
  );

[0m23:05:53.263415 [debug] [Thread-3 (]: Began compiling node model.crypto_analytics.mart_crypto_hourly_performance
[0m23:05:53.375966 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m23:05:53.379564 [debug] [Thread-3 (]: Writing injected SQL for node "model.crypto_analytics.mart_crypto_hourly_performance"
[0m23:05:53.399358 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: BEGIN
[0m23:05:53.420482 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:05:53.440291 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:05:53.451652 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m23:05:53.468129 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */




  create  table "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_tmp"


    as

  (


WITH latest_prices AS (
    SELECT
        symbol,
        crypto_name,
        price_usd,
        market_cap,
        volume_24h,
        price_change_24h,
        price_change_pct_24h,
        market_cap_rank,
        extracted_at,

        ROW_NUMBER() OVER (
            PARTITION BY symbol
            ORDER BY extracted_at DESC
        ) as rn

    FROM "crypto_warehouse"."public_staging"."stg_crypto_prices"
    WHERE extraction_date = CURRENT_DATE
),

price_changes AS (
    SELECT
        symbol,
        crypto_name,
        price_usd as current_price,
        market_cap,
        volume_24h,
        price_change_24h,
        price_change_pct_24h,
        market_cap_rank,
        extracted_at as last_updated,

        -- Calculate additional metrics
        CASE
            WHEN price_change_pct_24h > 10 THEN 'Strong Gain'
            WHEN price_change_pct_24h > 5 THEN 'Moderate Gain'
            WHEN price_change_pct_24h > 0 THEN 'Slight Gain'
            WHEN price_change_pct_24h > -5 THEN 'Slight Loss'
            WHEN price_change_pct_24h > -10 THEN 'Moderate Loss'
            ELSE 'Strong Loss'
        END as price_trend_category,

        -- Market cap category
        CASE
            WHEN market_cap_rank <= 10 THEN 'Large Cap'
            WHEN market_cap_rank <= 50 THEN 'Mid Cap'
            WHEN market_cap_rank <= 100 THEN 'Small Cap'
            ELSE 'Micro Cap'
        END as market_cap_category

    FROM latest_prices
    WHERE rn = 1
)

SELECT * FROM price_changes
  );

[0m23:05:53.496397 [debug] [Thread-3 (]: Timing info for model.crypto_analytics.mart_crypto_hourly_performance (compile): 23:05:53.283849 => 23:05:53.495490
[0m23:05:53.503746 [debug] [Thread-3 (]: Began executing node model.crypto_analytics.mart_crypto_hourly_performance
[0m23:05:53.538963 [debug] [Thread-3 (]: Writing runtime sql for node "model.crypto_analytics.mart_crypto_hourly_performance"
[0m23:05:53.617686 [debug] [Thread-3 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m23:05:53.632398 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: BEGIN
[0m23:05:53.642614 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:05:53.656821 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:05:53.665986 [debug] [Thread-3 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m23:05:53.667693 [debug] [Thread-4 (]: SQL status: SELECT 12 in 0.0 seconds
[0m23:05:53.678936 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */




  create  table "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_tmp"


    as

  (


WITH  __dbt__cte__int_crypto_hourly_aggs as (


WITH base_data AS (
    SELECT
        symbol,
        crypto_name,
        DATE_TRUNC('hour', extracted_at) AS extraction_hour,
        price_usd,
        volume_24h,
        market_cap,
        CASE WHEN price_usd <= 0 THEN 1 ELSE 0 END AS is_invalid
    FROM "crypto_warehouse"."public_staging"."stg_crypto_prices"
)

SELECT
    symbol,
    crypto_name,
    extraction_hour,
    COUNT(*) AS total_records,
    SUM(is_invalid) AS invalid_price_records,
    AVG(price_usd) AS avg_price_usd,
    MIN(price_usd) AS min_price_usd,
    MAX(price_usd) AS max_price_usd,
    STDDEV(price_usd) AS price_volatility,
    AVG(volume_24h) AS avg_volume_24h,
    AVG(market_cap) AS avg_market_cap
FROM base_data
GROUP BY symbol, crypto_name, extraction_hour
), hourly_data AS (
    SELECT
        symbol,
        crypto_name,
        extraction_hour,
        avg_price_usd,
        min_price_usd,
        max_price_usd,
        price_volatility,
        avg_volume_24h,
        avg_market_cap,
        total_records,

        -- Calculate hourly change
        LAG(avg_price_usd) OVER (
            PARTITION BY symbol
            ORDER BY extraction_hour
        ) as previous_hour_price,

        -- Data quality score
        (1.0 - (invalid_price_records::FLOAT / GREATEST(total_records, 1))) * 100 as data_quality_score

    FROM __dbt__cte__int_crypto_hourly_aggs
),

performance_metrics AS (
    SELECT
        *,
        CASE
            WHEN previous_hour_price IS NOT NULL AND previous_hour_price > 0 THEN
                ((avg_price_usd - previous_hour_price) / previous_hour_price) * 100
            ELSE NULL
        END as hourly_change_pct,

        -- Volatility category
        CASE
            WHEN price_volatility IS NULL THEN 'Unknown'
            WHEN price_volatility < avg_price_usd * 0.01 THEN 'Low Volatility'
            WHEN price_volatility < avg_price_usd * 0.05 THEN 'Medium Volatility'
            ELSE 'High Volatility'
        END as volatility_category

    FROM hourly_data
)

SELECT * FROM performance_metrics
  );

[0m23:05:53.696276 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m23:05:53.715882 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */
alter table "crypto_warehouse"."public_marts"."mart_pipeline_monitoring" rename to "mart_pipeline_monitoring__dbt_backup"
[0m23:05:53.735584 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:05:53.754236 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m23:05:53.770047 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */
alter table "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_tmp" rename to "mart_pipeline_monitoring"
[0m23:05:53.786577 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:05:53.825605 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.0 seconds
[0m23:05:53.853879 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m23:05:53.868975 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m23:05:53.912176 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */

    create  index if not exists
  "070daeb31cbcf163140ca315e559db5c"
  on "crypto_warehouse"."public_marts"."mart_pipeline_monitoring" using btree
  (run_date);

[0m23:05:53.945397 [debug] [Thread-3 (]: SQL status: SELECT 15 in 0.0 seconds
[0m23:05:53.947604 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_latest_prices" rename to "mart_crypto_latest_prices__dbt_backup"
[0m23:05:54.156532 [debug] [Thread-4 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m23:05:54.269674 [debug] [Thread-3 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m23:05:54.313683 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:05:54.364574 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m23:05:54.398145 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance" rename to "mart_crypto_hourly_performance__dbt_backup"
[0m23:05:54.418078 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m23:05:54.452776 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */

    create  index if not exists
  "12b665758a0e236e735fe12c9b4c69e3"
  on "crypto_warehouse"."public_marts"."mart_pipeline_monitoring" using btree
  (stage);

[0m23:05:54.470464 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:05:54.489134 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_tmp" rename to "mart_crypto_latest_prices"
[0m23:05:54.524290 [debug] [Thread-3 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m23:05:54.531409 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:05:54.541670 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_tmp" rename to "mart_crypto_hourly_performance"
[0m23:05:54.552645 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m23:05:54.561294 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:05:54.567815 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */

    create  index if not exists
  "9cfad8a62a125db1d184fab04683ce23"
  on "crypto_warehouse"."public_marts"."mart_crypto_latest_prices" using btree
  (symbol);

[0m23:05:54.594885 [debug] [Thread-3 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m23:05:54.656719 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */

    create  index if not exists
  "bdbe9abe1e9e6ed94689b30cba0a6938"
  on "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance" using btree
  (symbol, extraction_hour);

[0m23:05:54.690016 [debug] [Thread-4 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m23:05:54.706053 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: COMMIT
[0m23:05:54.718118 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m23:05:54.733611 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: COMMIT
[0m23:05:54.822754 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m23:05:54.836312 [debug] [Thread-4 (]: Applying DROP to: "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_backup"
[0m23:05:54.855596 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m23:05:54.856635 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m23:05:54.866524 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */
drop table if exists "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_backup" cascade
[0m23:05:54.877622 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m23:05:54.902169 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */

    create  index if not exists
  "03a9a51ebde902787beddde806e052a5"
  on "crypto_warehouse"."public_marts"."mart_crypto_latest_prices" using btree
  (market_cap_rank);

[0m23:05:54.993808 [debug] [Thread-3 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m23:05:55.006952 [debug] [Thread-3 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m23:05:55.014697 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */

    create  index if not exists
  "f8d2b24e5942d006f588e06977a35ba8"
  on "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance" using btree
  (extraction_hour);

[0m23:05:55.045159 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:05:55.063408 [debug] [Thread-4 (]: Timing info for model.crypto_analytics.mart_pipeline_monitoring (execute): 23:05:52.886386 => 23:05:55.062729
[0m23:05:55.070903 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: Close
[0m23:05:55.079249 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fbbc9f6-4487-4cad-acf1-bf324486c71c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76907f18d0>]}
[0m23:05:55.087424 [info ] [Thread-4 (]: 3 of 5 OK created sql table model public_marts.mart_pipeline_monitoring ........ [[32mSELECT 12[0m in 2.39s]
[0m23:05:55.096570 [debug] [Thread-4 (]: Finished running node model.crypto_analytics.mart_pipeline_monitoring
[0m23:05:55.244820 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m23:05:55.266110 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: COMMIT
[0m23:05:55.273453 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m23:05:55.283847 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: COMMIT
[0m23:05:55.491417 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:05:55.513337 [debug] [Thread-3 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m23:05:55.586316 [debug] [Thread-1 (]: Applying DROP to: "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_backup"
[0m23:05:55.613517 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: COMMIT
[0m23:05:55.632946 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m23:05:55.640230 [debug] [Thread-3 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m23:05:55.647324 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */
drop table if exists "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_backup" cascade
[0m23:05:55.655001 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: COMMIT
[0m23:05:55.734991 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:05:55.797590 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.mart_crypto_latest_prices (execute): 23:05:53.199206 => 23:05:55.796855
[0m23:05:55.811650 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: Close
[0m23:05:55.814618 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m23:05:55.843079 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fbbc9f6-4487-4cad-acf1-bf324486c71c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7690b36fd0>]}
[0m23:05:55.884532 [debug] [Thread-3 (]: Applying DROP to: "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_backup"
[0m23:05:55.927351 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public_marts.mart_crypto_latest_prices ....... [[32mSELECT 5[0m in 2.91s]
[0m23:05:55.938880 [debug] [Thread-3 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m23:05:55.946769 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.mart_crypto_latest_prices
[0m23:05:55.954780 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */
drop table if exists "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_backup" cascade
[0m23:05:56.093631 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:05:56.113707 [debug] [Thread-3 (]: Timing info for model.crypto_analytics.mart_crypto_hourly_performance (execute): 23:05:53.517140 => 23:05:56.113155
[0m23:05:56.128103 [debug] [Thread-3 (]: On model.crypto_analytics.mart_crypto_hourly_performance: Close
[0m23:05:56.143419 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fbbc9f6-4487-4cad-acf1-bf324486c71c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7690c3cf10>]}
[0m23:05:56.156415 [info ] [Thread-3 (]: 5 of 5 OK created sql table model public_marts.mart_crypto_hourly_performance .. [[32mSELECT 15[0m in 2.91s]
[0m23:05:56.164822 [debug] [Thread-3 (]: Finished running node model.crypto_analytics.mart_crypto_hourly_performance
[0m23:05:56.181177 [debug] [MainThread]: Using postgres connection "master"
[0m23:05:56.217362 [debug] [MainThread]: On master: BEGIN
[0m23:05:56.239078 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:05:56.272180 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:05:56.287620 [debug] [MainThread]: On master: COMMIT
[0m23:05:56.323608 [debug] [MainThread]: Using postgres connection "master"
[0m23:05:56.346084 [debug] [MainThread]: On master: COMMIT
[0m23:05:56.360296 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:05:56.377308 [debug] [MainThread]: On master: Close
[0m23:05:56.395288 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:05:56.408444 [debug] [MainThread]: Connection 'model.crypto_analytics.int_crypto_daily_aggs' was properly closed.
[0m23:05:56.416094 [debug] [MainThread]: Connection 'model.crypto_analytics.mart_crypto_hourly_performance' was properly closed.
[0m23:05:56.427670 [debug] [MainThread]: Connection 'model.crypto_analytics.mart_crypto_latest_prices' was properly closed.
[0m23:05:56.439228 [debug] [MainThread]: Connection 'model.crypto_analytics.mart_pipeline_monitoring' was properly closed.
[0m23:05:56.446988 [info ] [MainThread]:
[0m23:05:56.458237 [info ] [MainThread]: Finished running 1 view model, 4 table models in 0 hours 0 minutes and 6.47 seconds (6.47s).
[0m23:05:56.469303 [debug] [MainThread]: Command end result
[0m23:05:56.711286 [info ] [MainThread]:
[0m23:05:56.723144 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:05:56.733641 [info ] [MainThread]:
[0m23:05:56.747793 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m23:05:56.766631 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.643169, "process_user_time": 7.852861, "process_kernel_time": 0.604066, "process_mem_max_rss": "123792", "process_out_blocks": "1976", "process_in_blocks": "0"}
[0m23:05:56.776079 [debug] [MainThread]: Command `dbt run` succeeded at 23:05:56.775768 after 13.65 seconds
[0m23:05:56.782743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76937ea050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7696d20990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7696d21410>]}
[0m23:05:56.789347 [debug] [MainThread]: Flushing usage events
[0m11:14:43.270821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcde83ae2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcde7d2b150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcde8b80dd0>]}
[0m11:14:43.270832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f715727c4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71572c7b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f715784a110>]}


============================== 11:14:43.500483 | c13b4575-cb05-4ff4-a9fa-27684cab0bcc ==============================
[0m11:14:43.500483 [info ] [MainThread]: Running with dbt=1.7.0


============================== 11:14:43.501114 | 8ff0cad3-b8e2-44f7-ac57-4ecd8d4a6b2f ==============================
[0m11:14:43.501114 [info ] [MainThread]: Running with dbt=1.7.0
[0m11:14:43.502857 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /app/dbt', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:14:43.503173 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'debug': 'False', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug --project-dir /app/dbt', 'send_anonymous_usage_stats': 'True'}
[0m11:14:43.506382 [info ] [MainThread]: dbt version: 1.7.0
[0m11:14:43.508587 [info ] [MainThread]: python version: 3.11.13
[0m11:14:43.510318 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m11:14:43.511953 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m11:14:45.513814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb52ead2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb52ea23d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb53359c90>]}


============================== 11:14:45.523155 | 01210f91-1699-4fea-8c07-a3526ae7e89c ==============================
[0m11:14:45.523155 [info ] [MainThread]: Running with dbt=1.7.0
[0m11:14:45.526509 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug --project-dir /app/dbt', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:14:45.528897 [info ] [MainThread]: dbt version: 1.7.0
[0m11:14:45.530222 [info ] [MainThread]: python version: 3.11.13
[0m11:14:45.531566 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m11:14:45.534433 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m11:14:45.596254 [info ] [MainThread]: Using profiles dir at /app
[0m11:14:45.598321 [info ] [MainThread]: Using profiles.yml file at /app/profiles.yml
[0m11:14:45.600364 [info ] [MainThread]: Using dbt_project.yml file at /app/dbt/dbt_project.yml
[0m11:14:45.647794 [info ] [MainThread]: adapter type: postgres
[0m11:14:45.649421 [info ] [MainThread]: adapter version: 1.7.0
[0m11:14:45.727550 [info ] [MainThread]: Using profiles dir at /app
[0m11:14:45.729767 [info ] [MainThread]: Using profiles.yml file at /app/profiles.yml
[0m11:14:45.732990 [info ] [MainThread]: Using dbt_project.yml file at /app/dbt/dbt_project.yml
[0m11:14:45.735764 [info ] [MainThread]: adapter type: postgres
[0m11:14:45.738632 [info ] [MainThread]: adapter version: 1.7.0
[0m11:14:45.815216 [info ] [MainThread]: Configuration:
[0m11:14:45.816740 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:14:45.818207 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:14:45.820233 [info ] [MainThread]: Required dependencies:
[0m11:14:45.822247 [debug] [MainThread]: Executing "git --help"
[0m11:14:45.892816 [info ] [MainThread]: Configuration:
[0m11:14:45.894025 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:14:45.895067 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:14:45.896043 [info ] [MainThread]: Required dependencies:
[0m11:14:45.897070 [debug] [MainThread]: Executing "git --help"
[0m11:14:46.941545 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:14:46.941582 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:14:46.944217 [debug] [MainThread]: STDERR: "b''"
[0m11:14:46.944217 [debug] [MainThread]: STDERR: "b''"
[0m11:14:46.946085 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:14:46.946127 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:14:46.947724 [info ] [MainThread]: Connection:
[0m11:14:46.947723 [info ] [MainThread]: Connection:
[0m11:14:46.949232 [info ] [MainThread]:   host: postgres
[0m11:14:46.949226 [info ] [MainThread]:   host: postgres
[0m11:14:46.950842 [info ] [MainThread]:   port: 5432
[0m11:14:46.950842 [info ] [MainThread]:   port: 5432
[0m11:14:46.952750 [info ] [MainThread]:   user: postgres
[0m11:14:46.952750 [info ] [MainThread]:   user: postgres
[0m11:14:46.954755 [info ] [MainThread]:   database: crypto_warehouse
[0m11:14:46.954847 [info ] [MainThread]:   database: crypto_warehouse
[0m11:14:46.958372 [info ] [MainThread]:   schema: public
[0m11:14:46.958633 [info ] [MainThread]:   schema: public
[0m11:14:46.961150 [info ] [MainThread]:   connect_timeout: 10
[0m11:14:46.961108 [info ] [MainThread]:   connect_timeout: 10
[0m11:14:46.972056 [info ] [MainThread]:   role: None
[0m11:14:46.975752 [info ] [MainThread]:   role: None
[0m11:14:46.977966 [info ] [MainThread]:   search_path: None
[0m11:14:46.979351 [info ] [MainThread]:   search_path: None
[0m11:14:47.017957 [info ] [MainThread]:   keepalives_idle: 0
[0m11:14:47.020167 [info ] [MainThread]:   keepalives_idle: 0
[0m11:14:47.021503 [info ] [MainThread]:   sslmode: None
[0m11:14:47.022837 [info ] [MainThread]:   sslmode: None
[0m11:14:47.027468 [info ] [MainThread]:   sslcert: None
[0m11:14:47.032110 [info ] [MainThread]:   sslcert: None
[0m11:14:47.034775 [info ] [MainThread]:   sslkey: None
[0m11:14:47.037037 [info ] [MainThread]:   sslkey: None
[0m11:14:47.039096 [info ] [MainThread]:   sslrootcert: None
[0m11:14:47.043260 [info ] [MainThread]:   sslrootcert: None
[0m11:14:47.043898 [info ] [MainThread]:   application_name: dbt
[0m11:14:47.048179 [info ] [MainThread]:   application_name: dbt
[0m11:14:47.048479 [info ] [MainThread]:   retries: 1
[0m11:14:47.050679 [info ] [MainThread]:   retries: 1
[0m11:14:47.050853 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m11:14:47.052593 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m11:14:47.055250 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m11:14:47.060180 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m11:14:47.057763 [debug] [MainThread]: Using postgres connection "debug"
[0m11:14:47.063194 [debug] [MainThread]: On debug: select 1 as id
[0m11:14:47.063192 [debug] [MainThread]: Using postgres connection "debug"
[0m11:14:47.065476 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:14:47.065476 [debug] [MainThread]: On debug: select 1 as id
[0m11:14:47.067620 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:14:47.221101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c13b4575-cb05-4ff4-a9fa-27684cab0bcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcde64901d0>]}
[0m11:14:47.292483 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m11:14:47.295561 [debug] [MainThread]: On debug: Close
[0m11:14:47.305261 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m11:14:47.312156 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m11:14:47.319859 [debug] [MainThread]: On debug: Close
[0m11:14:47.314099 [info ] [MainThread]: [32mAll checks passed![0m
[0m11:14:47.322540 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m11:14:47.325468 [info ] [MainThread]: [32mAll checks passed![0m
[0m11:14:47.487030 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.0437987, "process_user_time": 3.522068, "process_kernel_time": 0.23145, "process_mem_max_rss": "111112", "process_in_blocks": "872", "process_out_blocks": "0"}
[0m11:14:47.490481 [debug] [MainThread]: Command `dbt debug` succeeded at 11:14:47.490154 after 2.05 seconds
[0m11:14:47.490573 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 4.9006343, "process_user_time": 5.024735, "process_kernel_time": 0.569403, "process_mem_max_rss": "111428", "process_in_blocks": "27496", "process_out_blocks": "1080"}
[0m11:14:47.492740 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:14:47.493813 [debug] [MainThread]: Command `dbt debug` succeeded at 11:14:47.493449 after 4.90 seconds
[0m11:14:47.498442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb534be8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb52ee2390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb52f07850>]}
[0m11:14:47.499514 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:14:47.509398 [debug] [MainThread]: Flushing usage events
[0m11:14:47.512580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7157755f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7157173850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f715bc41910>]}
[0m11:14:47.517681 [debug] [MainThread]: Flushing usage events
[0m11:14:47.585833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c13b4575-cb05-4ff4-a9fa-27684cab0bcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcde65dae10>]}
[0m11:14:47.588918 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m11:14:47.645448 [error] [MainThread]: Encountered an error:
Runtime Error
  Failed to read package: Runtime Error
    No dbt_project.yml found at expected path /app/dbt/dbt_packages/dbt_utils/dbt_project.yml
    Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml


Error encountered in /app/dbt/dbt_packages/dbt_utils
[0m11:14:47.647913 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.0485873, "process_user_time": 5.303716, "process_kernel_time": 0.752092, "process_mem_max_rss": "111664", "process_in_blocks": "60248", "process_out_blocks": "1872", "command_success": false}
[0m11:14:47.649353 [debug] [MainThread]: Command `dbt run` failed at 11:14:47.649166 after 5.05 seconds
[0m11:14:47.650532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcde7d30e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcde7ceb590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdec6f9550>]}
[0m11:14:47.651952 [debug] [MainThread]: Flushing usage events
[0m11:14:51.612810 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m11:14:51.612809 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m11:14:51.659083 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m11:16:03.046948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f916903c490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9169512390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f916903de10>]}


============================== 11:16:03.055512 | a2d5bbf6-9707-4d2c-bdfd-22a222a7ee5d ==============================
[0m11:16:03.055512 [info ] [MainThread]: Running with dbt=1.7.0
[0m11:16:03.059033 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'debug': 'False', 'profiles_dir': '/app', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /app/dbt', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:16:03.334808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a2d5bbf6-9707-4d2c-bdfd-22a222a7ee5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91677c9f10>]}
[0m11:16:03.452231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a2d5bbf6-9707-4d2c-bdfd-22a222a7ee5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9168f6acd0>]}
[0m11:16:03.454262 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m11:16:03.480532 [error] [MainThread]: Encountered an error:
Runtime Error
  Failed to read package: Runtime Error
    No dbt_project.yml found at expected path /app/dbt/dbt_packages/dbt_utils/dbt_project.yml
    Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml


Error encountered in /app/dbt/dbt_packages/dbt_utils
[0m11:16:03.489554 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.5804695, "process_user_time": 3.543697, "process_kernel_time": 0.17968, "process_mem_max_rss": "111772", "process_out_blocks": "1880", "command_success": false, "process_in_blocks": "0"}
[0m11:16:03.494172 [debug] [MainThread]: Command `dbt run` failed at 11:16:03.493728 after 0.59 seconds
[0m11:16:03.495873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f916d9e9450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f916d9e9690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9167856cd0>]}
[0m11:16:03.497120 [debug] [MainThread]: Flushing usage events
[0m11:52:01.150695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba87b0c410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba87b4f190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba87b0ca90>]}


============================== 11:52:01.311946 | 591dddf5-dd3f-49c7-b079-d9f76efea5a5 ==============================
[0m11:52:01.311946 [info ] [MainThread]: Running with dbt=1.7.0
[0m11:52:01.313960 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/app/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /app/dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:52:02.610691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '591dddf5-dd3f-49c7-b079-d9f76efea5a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba8629d610>]}
[0m11:52:02.856160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '591dddf5-dd3f-49c7-b079-d9f76efea5a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba889715d0>]}
[0m11:52:02.858237 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m11:52:02.885898 [error] [MainThread]: Encountered an error:
Runtime Error
  Failed to read package: Runtime Error
    No dbt_project.yml found at expected path /app/dbt/dbt_packages/dbt_utils/dbt_project.yml
    Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml


Error encountered in /app/dbt/dbt_packages/dbt_utils
[0m11:52:03.386955 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.530415, "process_user_time": 4.184944, "process_kernel_time": 0.357009, "process_mem_max_rss": "111776", "process_in_blocks": "29616", "process_out_blocks": "1880", "command_success": false}
[0m11:52:03.388930 [debug] [MainThread]: Command `dbt run` failed at 11:52:03.388625 after 2.53 seconds
[0m11:52:03.390722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba889712d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba87b1b290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba87fda290>]}
[0m11:52:03.392450 [debug] [MainThread]: Flushing usage events
[0m11:56:00.839346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b39c93290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b39c93ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b39c93410>]}


============================== 11:56:00.850780 | 485b8833-0444-4ebd-a785-b21be0c34180 ==============================
[0m11:56:00.850780 [info ] [MainThread]: Running with dbt=1.7.0
[0m11:56:00.853341 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/app/dbt/logs', 'version_check': 'True', 'profiles_dir': '/app', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /app/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:56:01.185766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '485b8833-0444-4ebd-a785-b21be0c34180', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b385eb350>]}
[0m11:56:01.358952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '485b8833-0444-4ebd-a785-b21be0c34180', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b39cd1750>]}
[0m11:56:01.361019 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m11:56:01.394574 [error] [MainThread]: Encountered an error:
Runtime Error
  Failed to read package: Runtime Error
    No dbt_project.yml found at expected path /app/dbt/dbt_packages/dbt_utils/dbt_project.yml
    Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml


Error encountered in /app/dbt/dbt_packages/dbt_utils
[0m11:56:01.397592 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.6321609, "process_user_time": 4.123822, "process_kernel_time": 0.310287, "process_mem_max_rss": "112144", "process_in_blocks": "1928", "process_out_blocks": "1880", "command_success": false}
[0m11:56:01.399267 [debug] [MainThread]: Command `dbt run` failed at 11:56:01.399037 after 0.63 seconds
[0m11:56:01.400810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b39c93290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b39ca8910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b3e6a9410>]}
[0m11:56:01.402183 [debug] [MainThread]: Flushing usage events
[0m11:57:37.517325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0073779d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00737bbbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0073c4a7d0>]}


============================== 11:57:37.526176 | 263fad99-b690-4699-8bf7-31b6f49eea14 ==============================
[0m11:57:37.526176 [info ] [MainThread]: Running with dbt=1.7.0
[0m11:57:37.533034 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/app/dbt/logs', 'profiles_dir': '/app', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps --project-dir /app/dbt', 'send_anonymous_usage_stats': 'True'}
[0m11:57:37.843603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '263fad99-b690-4699-8bf7-31b6f49eea14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0073666d90>]}
[0m11:57:38.017277 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-0m7d1ulf'
[0m11:57:38.018766 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m11:57:38.868034 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m11:57:38.870561 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m11:57:39.571564 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m11:57:39.584923 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m11:57:50.951668 [info ] [MainThread]: Installed from version 1.1.1
[0m11:57:50.954360 [info ] [MainThread]: Updated version available: 1.3.0
[0m11:57:50.959412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '263fad99-b690-4699-8bf7-31b6f49eea14', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00735e3ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00735e2550>]}
[0m11:57:50.961921 [info ] [MainThread]:
[0m11:57:50.969019 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']
Update your versions in packages.yml, then run dbt deps
[0m11:57:50.973130 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 13.533787, "process_user_time": 4.000159, "process_kernel_time": 0.668331, "process_mem_max_rss": "106820", "process_in_blocks": "8", "process_out_blocks": "2080"}
[0m11:57:50.975775 [debug] [MainThread]: Command `dbt deps` succeeded at 11:57:50.975404 after 13.54 seconds
[0m11:57:50.978419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00745be950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0073c4a210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0078119650>]}
[0m11:57:50.982225 [debug] [MainThread]: Flushing usage events
[0m11:58:30.228158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5f5f028d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5f5f03090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5f5f01150>]}


============================== 11:58:30.239057 | 8ca07c67-6cf9-494a-acc9-8ae22c5fe348 ==============================
[0m11:58:30.239057 [info ] [MainThread]: Running with dbt=1.7.0
[0m11:58:30.242233 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/app/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir /app/dbt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:58:31.154236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8ca07c67-6cf9-494a-acc9-8ae22c5fe348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5f46a6a50>]}
[0m11:58:31.306203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8ca07c67-6cf9-494a-acc9-8ae22c5fe348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5f4561a10>]}
[0m11:58:31.308011 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m11:58:31.377327 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m11:58:31.387938 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:58:31.393029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8ca07c67-6cf9-494a-acc9-8ae22c5fe348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5f4718f90>]}
[0m11:58:35.649932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ca07c67-6cf9-494a-acc9-8ae22c5fe348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5f3969b90>]}
[0m11:58:35.696592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ca07c67-6cf9-494a-acc9-8ae22c5fe348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5f398d9d0>]}
[0m11:58:35.698101 [info ] [MainThread]: Found 7 models, 14 tests, 2 sources, 0 exposures, 0 metrics, 517 macros, 0 groups, 0 semantic models
[0m11:58:35.700157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ca07c67-6cf9-494a-acc9-8ae22c5fe348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5f3a13a50>]}
[0m11:58:35.707086 [info ] [MainThread]:
[0m11:58:35.715731 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:58:35.719976 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse'
[0m11:58:35.722580 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse'
[0m11:58:35.778810 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse"
[0m11:58:35.804015 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse"
[0m11:58:35.912400 [debug] [ThreadPool]: On list_crypto_warehouse: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse"} */

    select distinct nspname from pg_namespace

[0m11:58:35.975573 [debug] [ThreadPool]: On list_crypto_warehouse: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse"} */

    select distinct nspname from pg_namespace

[0m11:58:35.980725 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:58:35.982594 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:58:35.995813 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m11:58:35.998738 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m11:58:36.032168 [debug] [ThreadPool]: On list_crypto_warehouse: Close
[0m11:58:36.035936 [debug] [ThreadPool]: On list_crypto_warehouse: Close
[0m11:58:36.048170 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_warehouse, now list_crypto_warehouse_public_dbt_test__audit)
[0m11:58:36.050284 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_warehouse, now list_crypto_warehouse_public_staging)
[0m11:58:36.052330 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse_public_marts'
[0m11:58:36.076149 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_dbt_test__audit"
[0m11:58:36.081227 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_staging"
[0m11:58:36.089577 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_marts"
[0m11:58:36.092098 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: BEGIN
[0m11:58:36.094262 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: BEGIN
[0m11:58:36.102166 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: BEGIN
[0m11:58:36.113445 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:58:36.115373 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:58:36.117317 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:58:36.125891 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:58:36.133515 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:58:36.135658 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:58:36.139568 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_dbt_test__audit"
[0m11:58:36.142199 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_staging"
[0m11:58:36.144206 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_marts"
[0m11:58:36.146292 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_dbt_test__audit"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'

[0m11:58:36.148499 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_staging"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'

[0m11:58:36.150766 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_marts"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'

[0m11:58:36.273526 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m11:58:36.274123 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m11:58:36.274969 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m11:58:36.277866 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: ROLLBACK
[0m11:58:36.280667 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: ROLLBACK
[0m11:58:36.283452 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: ROLLBACK
[0m11:58:36.285183 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: Close
[0m11:58:36.286632 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: Close
[0m11:58:36.290282 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: Close
[0m11:58:36.325135 [debug] [MainThread]: Using postgres connection "master"
[0m11:58:36.326804 [debug] [MainThread]: On master: BEGIN
[0m11:58:36.328469 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:58:36.336586 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:58:36.345680 [debug] [MainThread]: Using postgres connection "master"
[0m11:58:36.347674 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:58:36.887122 [debug] [MainThread]: SQL status: SELECT 1 in 1.0 seconds
[0m11:58:36.891307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ca07c67-6cf9-494a-acc9-8ae22c5fe348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5f43af3d0>]}
[0m11:58:36.893137 [debug] [MainThread]: On master: ROLLBACK
[0m11:58:36.895001 [debug] [MainThread]: Using postgres connection "master"
[0m11:58:36.896377 [debug] [MainThread]: On master: BEGIN
[0m11:58:36.898202 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:58:36.899704 [debug] [MainThread]: On master: COMMIT
[0m11:58:36.900962 [debug] [MainThread]: Using postgres connection "master"
[0m11:58:36.902303 [debug] [MainThread]: On master: COMMIT
[0m11:58:36.905630 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:58:36.907729 [debug] [MainThread]: On master: Close
[0m11:58:36.909861 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:58:36.912239 [info ] [MainThread]:
[0m11:58:36.991894 [debug] [Thread-1 (]: Began running node model.crypto_analytics.stg_crypto_prices
[0m11:58:36.992935 [debug] [Thread-2 (]: Began running node model.crypto_analytics.stg_pipeline_runs
[0m11:58:36.994706 [info ] [Thread-1 (]: 1 of 5 START sql table model public_staging.stg_crypto_prices .................. [RUN]
[0m11:58:36.997070 [info ] [Thread-2 (]: 2 of 5 START sql view model public_staging.stg_pipeline_runs ................... [RUN]
[0m11:58:37.000438 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_staging, now model.crypto_analytics.stg_crypto_prices)
[0m11:58:37.003286 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_dbt_test__audit, now model.crypto_analytics.stg_pipeline_runs)
[0m11:58:37.005968 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics.stg_crypto_prices
[0m11:58:37.009556 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics.stg_pipeline_runs
[0m11:58:37.028663 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics.stg_crypto_prices"
[0m11:58:37.033911 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics.stg_pipeline_runs"
[0m11:58:37.171999 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.stg_crypto_prices (compile): 11:58:37.011187 => 11:58:37.171310
[0m11:58:37.174212 [debug] [Thread-1 (]: Began executing node model.crypto_analytics.stg_crypto_prices
[0m11:58:37.175162 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.stg_pipeline_runs (compile): 11:58:37.029113 => 11:58:37.174693
[0m11:58:37.204930 [debug] [Thread-2 (]: Began executing node model.crypto_analytics.stg_pipeline_runs
[0m11:58:37.268672 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics.stg_crypto_prices"
[0m11:58:37.275345 [debug] [Thread-2 (]: Writing runtime sql for node "model.crypto_analytics.stg_pipeline_runs"
[0m11:58:37.294140 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m11:58:37.296134 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: BEGIN
[0m11:58:37.297142 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m11:58:37.298346 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:58:37.299760 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: BEGIN
[0m11:58:37.303702 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:58:37.307427 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:58:37.309428 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m11:58:37.311309 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */




  create  table "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_tmp"


    as

  (


WITH source_data AS (
    SELECT
        id as price_id,
        UPPER(TRIM(symbol)) as symbol,
        TRIM(name) as crypto_name,
        current_price as price_usd,
        market_cap,
        total_volume as volume_24h,
        price_change_24h,
        price_change_percentage_24h as price_change_pct_24h,
        market_cap_rank,
        extracted_at,
        created_at,

        CASE WHEN current_price <= 0 THEN TRUE ELSE FALSE END as is_invalid_price,
        CASE WHEN market_cap <= 0 THEN TRUE ELSE FALSE END as is_invalid_market_cap,
        CASE WHEN total_volume < 0 THEN TRUE ELSE FALSE END as is_invalid_volume
    FROM "crypto_warehouse"."public"."crypto_prices_raw"
),

cleaned_data AS (
    SELECT
        *,
        DATE(extracted_at) as extraction_date,
        DATE_TRUNC('hour', extracted_at) as extraction_hour,
        CASE
            WHEN LAG(price_usd) OVER (
                PARTITION BY symbol ORDER BY extracted_at
            ) IS NOT NULL THEN
                ((price_usd - LAG(price_usd) OVER (
                    PARTITION BY symbol ORDER BY extracted_at
                )) / LAG(price_usd) OVER (
                    PARTITION BY symbol ORDER BY extracted_at
                )) * 100
        END as price_change_pct_from_previous
    FROM source_data
    WHERE NOT is_invalid_price AND NOT is_invalid_volume
)

SELECT * FROM cleaned_data
  );

[0m11:58:37.313007 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:58:37.314848 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m11:58:37.316296 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */

  create view "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_tmp"


  as (
    SELECT
    id as run_id,
    run_id as run_identifier,
    stage,
    status,
    records_processed,
    error_message,
    started_at,
    completed_at,
    CASE
        WHEN completed_at IS NOT NULL
        THEN EXTRACT(EPOCH FROM (completed_at - started_at))
        ELSE NULL
    END as duration_seconds
FROM "crypto_warehouse"."public"."pipeline_runs"
  );
[0m11:58:38.185994 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 1.0 seconds
[0m11:58:38.242854 [debug] [Thread-1 (]: SQL status: SELECT 115 in 1.0 seconds
[0m11:58:38.253345 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m11:58:38.259201 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m11:58:38.260823 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */
alter table "crypto_warehouse"."public_staging"."stg_pipeline_runs" rename to "stg_pipeline_runs__dbt_backup"
[0m11:58:38.262579 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */
alter table "crypto_warehouse"."public_staging"."stg_crypto_prices" rename to "stg_crypto_prices__dbt_backup"
[0m11:58:38.264963 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:58:38.266273 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:58:38.274370 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m11:58:38.279609 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m11:58:38.281410 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */
alter table "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_tmp" rename to "stg_pipeline_runs"
[0m11:58:38.283132 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */
alter table "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_tmp" rename to "stg_crypto_prices"
[0m11:58:38.285880 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:58:38.288408 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:58:38.324126 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m11:58:38.325823 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: COMMIT
[0m11:58:38.327349 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */

        CREATE INDEX IF NOT EXISTS idx_stg_crypto_prices_symbol_time ON "crypto_warehouse"."public_staging"."stg_crypto_prices" (symbol, extracted_at)

[0m11:58:38.328896 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m11:58:38.331087 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m11:58:38.332072 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: COMMIT
[0m11:58:38.336591 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: COMMIT
[0m11:58:38.339556 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m11:58:38.341181 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: COMMIT
[0m11:58:38.430656 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:58:38.450391 [debug] [Thread-2 (]: Applying DROP to: "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_backup"
[0m11:58:38.467800 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.stg_pipeline_runs"
[0m11:58:38.470207 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_pipeline_runs"} */
drop view if exists "crypto_warehouse"."public_staging"."stg_pipeline_runs__dbt_backup" cascade
[0m11:58:38.507820 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:58:38.515664 [debug] [Thread-1 (]: Applying DROP to: "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_backup"
[0m11:58:38.525536 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.stg_crypto_prices"
[0m11:58:38.527299 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.stg_crypto_prices"} */
drop table if exists "crypto_warehouse"."public_staging"."stg_crypto_prices__dbt_backup" cascade
[0m11:58:38.719631 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:58:38.724812 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.stg_pipeline_runs (execute): 11:58:37.221982 => 11:58:38.724335
[0m11:58:38.727256 [debug] [Thread-2 (]: On model.crypto_analytics.stg_pipeline_runs: Close
[0m11:58:38.730158 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ca07c67-6cf9-494a-acc9-8ae22c5fe348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5f374c190>]}
[0m11:58:38.733637 [info ] [Thread-2 (]: 2 of 5 OK created sql view model public_staging.stg_pipeline_runs .............. [[32mCREATE VIEW[0m in 1.73s]
[0m11:58:38.792074 [debug] [Thread-2 (]: Finished running node model.crypto_analytics.stg_pipeline_runs
[0m11:58:38.797084 [debug] [Thread-4 (]: Began running node model.crypto_analytics.mart_pipeline_monitoring
[0m11:58:38.818637 [info ] [Thread-4 (]: 3 of 5 START sql table model public_marts.mart_pipeline_monitoring ............. [RUN]
[0m11:58:38.844445 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.crypto_analytics.mart_pipeline_monitoring'
[0m11:58:38.861296 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:58:38.864524 [debug] [Thread-4 (]: Began compiling node model.crypto_analytics.mart_pipeline_monitoring
[0m11:58:38.875846 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.stg_crypto_prices (execute): 11:58:37.175976 => 11:58:38.875385
[0m11:58:38.888459 [debug] [Thread-4 (]: Writing injected SQL for node "model.crypto_analytics.mart_pipeline_monitoring"
[0m11:58:38.891516 [debug] [Thread-1 (]: On model.crypto_analytics.stg_crypto_prices: Close
[0m11:58:38.896980 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ca07c67-6cf9-494a-acc9-8ae22c5fe348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5f39b6590>]}
[0m11:58:38.909044 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public_staging.stg_crypto_prices ............. [[32mSELECT 115[0m in 1.90s]
[0m11:58:38.925228 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.stg_crypto_prices
[0m11:58:38.929317 [debug] [Thread-2 (]: Began running node model.crypto_analytics.int_crypto_daily_aggs
[0m11:58:38.930332 [debug] [Thread-3 (]: Began running node model.crypto_analytics.int_crypto_hourly_aggs
[0m11:58:38.931230 [debug] [Thread-1 (]: Began running node model.crypto_analytics.mart_crypto_latest_prices
[0m11:58:38.941699 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.stg_pipeline_runs, now model.crypto_analytics.int_crypto_daily_aggs)
[0m11:58:38.945622 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_marts, now model.crypto_analytics.int_crypto_hourly_aggs)
[0m11:58:38.948110 [info ] [Thread-1 (]: 4 of 5 START sql table model public_marts.mart_crypto_latest_prices ............ [RUN]
[0m11:58:38.961377 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics.int_crypto_daily_aggs
[0m11:58:38.965422 [debug] [Thread-3 (]: Began compiling node model.crypto_analytics.int_crypto_hourly_aggs
[0m11:58:38.975434 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.stg_crypto_prices, now model.crypto_analytics.mart_crypto_latest_prices)
[0m11:58:38.987443 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics.int_crypto_daily_aggs"
[0m11:58:38.998143 [debug] [Thread-3 (]: Writing injected SQL for node "model.crypto_analytics.int_crypto_hourly_aggs"
[0m11:58:39.038331 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics.mart_crypto_latest_prices
[0m11:58:39.061071 [debug] [Thread-4 (]: Timing info for model.crypto_analytics.mart_pipeline_monitoring (compile): 11:58:38.877404 => 11:58:39.059934
[0m11:58:39.065380 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics.mart_crypto_latest_prices"
[0m11:58:39.068745 [debug] [Thread-4 (]: Began executing node model.crypto_analytics.mart_pipeline_monitoring
[0m11:58:39.070227 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.int_crypto_daily_aggs (compile): 11:58:38.977759 => 11:58:39.069538
[0m11:58:39.072932 [debug] [Thread-3 (]: Timing info for model.crypto_analytics.int_crypto_hourly_aggs (compile): 11:58:38.991530 => 11:58:39.072238
[0m11:58:39.094455 [debug] [Thread-4 (]: Writing runtime sql for node "model.crypto_analytics.mart_pipeline_monitoring"
[0m11:58:39.097087 [debug] [Thread-2 (]: Finished running node model.crypto_analytics.int_crypto_daily_aggs
[0m11:58:39.102237 [debug] [Thread-3 (]: Finished running node model.crypto_analytics.int_crypto_hourly_aggs
[0m11:58:39.103962 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.mart_crypto_latest_prices (compile): 11:58:39.049933 => 11:58:39.103331
[0m11:58:39.108724 [debug] [Thread-2 (]: Began running node model.crypto_analytics.mart_crypto_hourly_performance
[0m11:58:39.110656 [debug] [Thread-1 (]: Began executing node model.crypto_analytics.mart_crypto_latest_prices
[0m11:58:39.115657 [info ] [Thread-2 (]: 5 of 5 START sql table model public_marts.mart_crypto_hourly_performance ....... [RUN]
[0m11:58:39.158217 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_analytics.mart_crypto_latest_prices"
[0m11:58:39.161627 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.int_crypto_daily_aggs, now model.crypto_analytics.mart_crypto_hourly_performance)
[0m11:58:39.166893 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m11:58:39.170395 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics.mart_crypto_hourly_performance
[0m11:58:39.174066 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: BEGIN
[0m11:58:39.229398 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:58:39.227564 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics.mart_crypto_hourly_performance"
[0m11:58:39.243937 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m11:58:39.247899 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m11:58:39.249594 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m11:58:39.255027 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */




  create  table "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_tmp"


    as

  (


WITH pipeline_metrics AS (
    SELECT
        run_id,
        stage,
        status,
        records_processed,
        error_message,
        started_at,
        completed_at,
        EXTRACT(EPOCH FROM completed_at - started_at) AS duration_seconds,

        -- Flag to compute success rate
        CASE WHEN status = 'success' THEN 1 ELSE 0 END AS is_success,

        -- Classify performance
        CASE
            WHEN completed_at IS NULL THEN 'Running'
            WHEN EXTRACT(EPOCH FROM completed_at - started_at) < 30 THEN 'Fast'
            WHEN EXTRACT(EPOCH FROM completed_at - started_at) < 120 THEN 'Normal'
            ELSE 'Slow'
        END AS performance_category

    FROM "crypto_warehouse"."public_staging"."stg_pipeline_runs"
),

latest_status_per_day_stage AS (
    SELECT
        DATE(started_at) AS run_date,
        stage,
        FIRST_VALUE(status) OVER (
            PARTITION BY DATE(started_at), stage
            ORDER BY started_at DESC
        ) AS latest_run_status
    FROM pipeline_metrics
),

daily_summary AS (
    SELECT
        DATE(started_at) AS run_date,
        stage,

        COUNT(*) AS total_runs,
        SUM(is_success) AS successful_runs,
        SUM(records_processed) AS total_records_processed,
        AVG(duration_seconds) AS avg_duration_seconds,
        MAX(duration_seconds) AS max_duration_seconds,
        ROUND(((SUM(is_success)::FLOAT / COUNT(*)) * 100)::NUMERIC, 2) AS success_rate_pct


    FROM pipeline_metrics
    WHERE started_at >= CURRENT_DATE - INTERVAL '30 days'
    GROUP BY DATE(started_at), stage
)

-- Final result combining metrics with latest run status
SELECT
    ds.*,
    ls.latest_run_status
FROM daily_summary ds
LEFT JOIN latest_status_per_day_stage ls
  ON ds.run_date = ls.run_date AND ds.stage = ls.stage
  );

[0m11:58:39.256455 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.mart_crypto_hourly_performance (compile): 11:58:39.176151 => 11:58:39.255969
[0m11:58:39.258042 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: BEGIN
[0m11:58:39.262482 [debug] [Thread-2 (]: Began executing node model.crypto_analytics.mart_crypto_hourly_performance
[0m11:58:39.264986 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:58:39.278216 [debug] [Thread-2 (]: Writing runtime sql for node "model.crypto_analytics.mart_crypto_hourly_performance"
[0m11:58:39.287957 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:58:39.295436 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m11:58:39.302398 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */




  create  table "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_tmp"


    as

  (


WITH latest_prices AS (
    SELECT
        symbol,
        crypto_name,
        price_usd,
        market_cap,
        volume_24h,
        price_change_24h,
        price_change_pct_24h,
        market_cap_rank,
        extracted_at,

        ROW_NUMBER() OVER (
            PARTITION BY symbol
            ORDER BY extracted_at DESC
        ) as rn

    FROM "crypto_warehouse"."public_staging"."stg_crypto_prices"
    WHERE extraction_date = CURRENT_DATE
),

price_changes AS (
    SELECT
        symbol,
        crypto_name,
        price_usd as current_price,
        market_cap,
        volume_24h,
        price_change_24h,
        price_change_pct_24h,
        market_cap_rank,
        extracted_at as last_updated,

        -- Calculate additional metrics
        CASE
            WHEN price_change_pct_24h > 10 THEN 'Strong Gain'
            WHEN price_change_pct_24h > 5 THEN 'Moderate Gain'
            WHEN price_change_pct_24h > 0 THEN 'Slight Gain'
            WHEN price_change_pct_24h > -5 THEN 'Slight Loss'
            WHEN price_change_pct_24h > -10 THEN 'Moderate Loss'
            ELSE 'Strong Loss'
        END as price_trend_category,

        -- Market cap category
        CASE
            WHEN market_cap_rank <= 10 THEN 'Large Cap'
            WHEN market_cap_rank <= 50 THEN 'Mid Cap'
            WHEN market_cap_rank <= 100 THEN 'Small Cap'
            ELSE 'Micro Cap'
        END as market_cap_category

    FROM latest_prices
    WHERE rn = 1
)

SELECT * FROM price_changes
  );

[0m11:58:39.318696 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m11:58:39.320562 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: BEGIN
[0m11:58:39.322231 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:58:39.329852 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:58:39.332131 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m11:58:39.339174 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */




  create  table "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_tmp"


    as

  (


WITH  __dbt__cte__int_crypto_hourly_aggs as (


WITH base_data AS (
    SELECT
        symbol,
        crypto_name,
        DATE_TRUNC('hour', extracted_at) AS extraction_hour,
        price_usd,
        volume_24h,
        market_cap,
        CASE WHEN price_usd <= 0 THEN 1 ELSE 0 END AS is_invalid
    FROM "crypto_warehouse"."public_staging"."stg_crypto_prices"
)

SELECT
    symbol,
    crypto_name,
    extraction_hour,
    COUNT(*) AS total_records,
    SUM(is_invalid) AS invalid_price_records,
    AVG(price_usd) AS avg_price_usd,
    MIN(price_usd) AS min_price_usd,
    MAX(price_usd) AS max_price_usd,
    STDDEV(price_usd) AS price_volatility,
    AVG(volume_24h) AS avg_volume_24h,
    AVG(market_cap) AS avg_market_cap
FROM base_data
GROUP BY symbol, crypto_name, extraction_hour
), hourly_data AS (
    SELECT
        symbol,
        crypto_name,
        extraction_hour,
        avg_price_usd,
        min_price_usd,
        max_price_usd,
        price_volatility,
        avg_volume_24h,
        avg_market_cap,
        total_records,

        -- Calculate hourly change
        LAG(avg_price_usd) OVER (
            PARTITION BY symbol
            ORDER BY extraction_hour
        ) as previous_hour_price,

        -- Data quality score
        (1.0 - (invalid_price_records::FLOAT / GREATEST(total_records, 1))) * 100 as data_quality_score

    FROM __dbt__cte__int_crypto_hourly_aggs
),

performance_metrics AS (
    SELECT
        *,
        CASE
            WHEN previous_hour_price IS NOT NULL AND previous_hour_price > 0 THEN
                ((avg_price_usd - previous_hour_price) / previous_hour_price) * 100
            ELSE NULL
        END as hourly_change_pct,

        -- Volatility category
        CASE
            WHEN price_volatility IS NULL THEN 'Unknown'
            WHEN price_volatility < avg_price_usd * 0.01 THEN 'Low Volatility'
            WHEN price_volatility < avg_price_usd * 0.05 THEN 'Medium Volatility'
            ELSE 'High Volatility'
        END as volatility_category

    FROM hourly_data
)

SELECT * FROM performance_metrics
  );

[0m11:58:39.764454 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.0 seconds
[0m11:58:39.772254 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m11:58:39.773944 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_latest_prices" rename to "mart_crypto_latest_prices__dbt_backup"
[0m11:58:39.776111 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:58:39.785000 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m11:58:39.786685 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_tmp" rename to "mart_crypto_latest_prices"
[0m11:58:39.788694 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:58:39.806348 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m11:58:39.808015 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */

    create  index if not exists
  "353b4e35c3d9f82690adbaf35775795a"
  on "crypto_warehouse"."public_marts"."mart_crypto_latest_prices" using btree
  (symbol);

[0m11:58:40.120115 [debug] [Thread-2 (]: SQL status: SELECT 20 in 1.0 seconds
[0m11:58:40.128676 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m11:58:40.130446 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance" rename to "mart_crypto_hourly_performance__dbt_backup"
[0m11:58:40.132720 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:58:40.138569 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m11:58:40.140136 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */
alter table "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_tmp" rename to "mart_crypto_hourly_performance"
[0m11:58:40.144951 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:58:40.157013 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m11:58:40.158987 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */

    create  index if not exists
  "d66f1f668dde1e69dbb7abc50635b316"
  on "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance" using btree
  (symbol, extraction_hour);

[0m11:58:40.363341 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 1.0 seconds
[0m11:58:40.368641 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m11:58:40.370419 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */

    create  index if not exists
  "1364435212e0150e641a06b81adb0bb8"
  on "crypto_warehouse"."public_marts"."mart_crypto_latest_prices" using btree
  (market_cap_rank);

[0m11:58:40.382735 [debug] [Thread-4 (]: SQL status: SELECT 47 in 1.0 seconds
[0m11:58:40.388859 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m11:58:40.390378 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */
alter table "crypto_warehouse"."public_marts"."mart_pipeline_monitoring" rename to "mart_pipeline_monitoring__dbt_backup"
[0m11:58:40.392369 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:58:40.405641 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m11:58:40.407351 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */
alter table "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_tmp" rename to "mart_pipeline_monitoring"
[0m11:58:40.409445 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:58:40.418153 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m11:58:40.419798 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */

    create  index if not exists
  "412f73f764c299b1184701ea0041dca6"
  on "crypto_warehouse"."public_marts"."mart_pipeline_monitoring" using btree
  (run_date);

[0m11:58:40.687277 [debug] [Thread-2 (]: SQL status: CREATE INDEX in 1.0 seconds
[0m11:58:40.692317 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m11:58:40.694194 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */

    create  index if not exists
  "6f7de2f92612cedc95855856336b4690"
  on "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance" using btree
  (extraction_hour);

[0m11:58:40.865066 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m11:58:40.866185 [debug] [Thread-4 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m11:58:40.870561 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: COMMIT
[0m11:58:40.874395 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m11:58:40.876052 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m11:58:40.877474 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */

    create  index if not exists
  "961643adb571b308ee278b96af94e6ed"
  on "crypto_warehouse"."public_marts"."mart_pipeline_monitoring" using btree
  (stage);

[0m11:58:40.879189 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: COMMIT
[0m11:58:41.042135 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:58:41.048482 [debug] [Thread-1 (]: Applying DROP to: "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_backup"
[0m11:58:41.050847 [debug] [Thread-1 (]: Using postgres connection "model.crypto_analytics.mart_crypto_latest_prices"
[0m11:58:41.052303 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_latest_prices"} */
drop table if exists "crypto_warehouse"."public_marts"."mart_crypto_latest_prices__dbt_backup" cascade
[0m11:58:41.120512 [debug] [Thread-2 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m11:58:41.124502 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: COMMIT
[0m11:58:41.126278 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m11:58:41.127871 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: COMMIT
[0m11:58:41.212774 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:58:41.216642 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.mart_crypto_latest_prices (execute): 11:58:39.119796 => 11:58:41.216277
[0m11:58:41.218294 [debug] [Thread-1 (]: On model.crypto_analytics.mart_crypto_latest_prices: Close
[0m11:58:41.221299 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ca07c67-6cf9-494a-acc9-8ae22c5fe348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5f063d390>]}
[0m11:58:41.223821 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public_marts.mart_crypto_latest_prices ....... [[32mSELECT 5[0m in 2.25s]
[0m11:58:41.226368 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.mart_crypto_latest_prices
[0m11:58:41.311364 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:58:41.432537 [debug] [Thread-4 (]: SQL status: CREATE INDEX in 1.0 seconds
[0m11:58:41.517448 [debug] [Thread-2 (]: Applying DROP to: "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_backup"
[0m11:58:41.523903 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: COMMIT
[0m11:58:41.528212 [debug] [Thread-2 (]: Using postgres connection "model.crypto_analytics.mart_crypto_hourly_performance"
[0m11:58:41.563341 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m11:58:41.569647 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_crypto_hourly_performance"} */
drop table if exists "crypto_warehouse"."public_marts"."mart_crypto_hourly_performance__dbt_backup" cascade
[0m11:58:41.572076 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: COMMIT
[0m11:58:41.619853 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m11:58:41.629607 [debug] [Thread-4 (]: Applying DROP to: "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_backup"
[0m11:58:41.632381 [debug] [Thread-4 (]: Using postgres connection "model.crypto_analytics.mart_pipeline_monitoring"
[0m11:58:41.634011 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "model.crypto_analytics.mart_pipeline_monitoring"} */
drop table if exists "crypto_warehouse"."public_marts"."mart_pipeline_monitoring__dbt_backup" cascade
[0m11:58:41.687325 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:58:41.690484 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.mart_crypto_hourly_performance (execute): 11:58:39.267285 => 11:58:41.690154
[0m11:58:41.691887 [debug] [Thread-2 (]: On model.crypto_analytics.mart_crypto_hourly_performance: Close
[0m11:58:41.693882 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ca07c67-6cf9-494a-acc9-8ae22c5fe348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5f39b6590>]}
[0m11:58:41.695975 [info ] [Thread-2 (]: 5 of 5 OK created sql table model public_marts.mart_crypto_hourly_performance .. [[32mSELECT 20[0m in 2.53s]
[0m11:58:41.701221 [debug] [Thread-2 (]: Finished running node model.crypto_analytics.mart_crypto_hourly_performance
[0m11:58:41.731468 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:58:41.735057 [debug] [Thread-4 (]: Timing info for model.crypto_analytics.mart_pipeline_monitoring (execute): 11:58:39.074176 => 11:58:41.734701
[0m11:58:41.736564 [debug] [Thread-4 (]: On model.crypto_analytics.mart_pipeline_monitoring: Close
[0m11:58:41.738837 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ca07c67-6cf9-494a-acc9-8ae22c5fe348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5f3893a90>]}
[0m11:58:41.741181 [info ] [Thread-4 (]: 3 of 5 OK created sql table model public_marts.mart_pipeline_monitoring ........ [[32mSELECT 47[0m in 2.90s]
[0m11:58:41.745263 [debug] [Thread-4 (]: Finished running node model.crypto_analytics.mart_pipeline_monitoring
[0m11:58:41.754183 [debug] [MainThread]: Using postgres connection "master"
[0m11:58:41.756311 [debug] [MainThread]: On master: BEGIN
[0m11:58:41.758230 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:58:41.766866 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:58:41.777623 [debug] [MainThread]: On master: COMMIT
[0m11:58:41.793436 [debug] [MainThread]: Using postgres connection "master"
[0m11:58:41.811324 [debug] [MainThread]: On master: COMMIT
[0m11:58:41.815059 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:58:41.817269 [debug] [MainThread]: On master: Close
[0m11:58:41.820148 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:58:41.827220 [debug] [MainThread]: Connection 'model.crypto_analytics.mart_crypto_latest_prices' was properly closed.
[0m11:58:41.829291 [debug] [MainThread]: Connection 'model.crypto_analytics.mart_crypto_hourly_performance' was properly closed.
[0m11:58:41.831966 [debug] [MainThread]: Connection 'model.crypto_analytics.int_crypto_hourly_aggs' was properly closed.
[0m11:58:41.834423 [debug] [MainThread]: Connection 'model.crypto_analytics.mart_pipeline_monitoring' was properly closed.
[0m11:58:41.837688 [info ] [MainThread]:
[0m11:58:41.841260 [info ] [MainThread]: Finished running 1 view model, 4 table models in 0 hours 0 minutes and 6.12 seconds (6.12s).
[0m11:58:41.854588 [debug] [MainThread]: Command end result
[0m11:58:41.904279 [info ] [MainThread]:
[0m11:58:41.906288 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:58:41.909071 [info ] [MainThread]:
[0m11:58:41.911380 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m11:58:41.914731 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.774558, "process_user_time": 8.184005, "process_kernel_time": 0.487854, "process_mem_max_rss": "130824", "process_in_blocks": "328", "process_out_blocks": "1976"}
[0m11:58:41.917539 [debug] [MainThread]: Command `dbt run` succeeded at 11:58:41.917237 after 11.78 seconds
[0m11:58:41.919287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5f5f48e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5f5f13110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5fa8ac890>]}
[0m11:58:41.921245 [debug] [MainThread]: Flushing usage events
[0m11:59:19.062710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc948acc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc948acb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc948aec90>]}


============================== 11:59:19.078847 | 1a7e2e1b-b3d2-4659-b92d-825f8cf273d3 ==============================
[0m11:59:19.078847 [info ] [MainThread]: Running with dbt=1.7.0
[0m11:59:19.089217 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/app/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --project-dir /app/dbt', 'send_anonymous_usage_stats': 'True'}
[0m11:59:19.829531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a7e2e1b-b3d2-4659-b92d-825f8cf273d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc948a7850>]}
[0m11:59:20.019393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a7e2e1b-b3d2-4659-b92d-825f8cf273d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc9492d9d0>]}
[0m11:59:20.021200 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m11:59:20.084053 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m11:59:22.300174 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:59:22.301897 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:59:22.319914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a7e2e1b-b3d2-4659-b92d-825f8cf273d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc94f728d0>]}
[0m11:59:22.388047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a7e2e1b-b3d2-4659-b92d-825f8cf273d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc9309e290>]}
[0m11:59:22.390157 [info ] [MainThread]: Found 7 models, 14 tests, 2 sources, 0 exposures, 0 metrics, 517 macros, 0 groups, 0 semantic models
[0m11:59:22.455451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a7e2e1b-b3d2-4659-b92d-825f8cf273d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc93054a10>]}
[0m11:59:22.463978 [info ] [MainThread]:
[0m11:59:22.503757 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:59:22.509533 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse'
[0m11:59:22.557867 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse"
[0m11:59:22.559640 [debug] [ThreadPool]: On list_crypto_warehouse: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse"} */

    select distinct nspname from pg_namespace

[0m11:59:22.565736 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:59:22.576501 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m11:59:22.584955 [debug] [ThreadPool]: On list_crypto_warehouse: Close
[0m11:59:22.592281 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_warehouse, now list_crypto_warehouse_public_staging)
[0m11:59:22.594377 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse_public_marts'
[0m11:59:22.601953 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse_public_dbt_test__audit'
[0m11:59:22.626771 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_staging"
[0m11:59:22.641891 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_marts"
[0m11:59:22.648880 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_dbt_test__audit"
[0m11:59:22.650727 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: BEGIN
[0m11:59:22.653109 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: BEGIN
[0m11:59:22.655219 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: BEGIN
[0m11:59:22.657489 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:59:22.659938 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:59:22.672405 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:59:22.697373 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:59:22.708535 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_staging"
[0m11:59:22.713936 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:59:22.717147 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:59:22.719303 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_staging"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'

[0m11:59:22.721669 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_dbt_test__audit"
[0m11:59:22.724354 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_marts"
[0m11:59:22.732768 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m11:59:22.734956 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_dbt_test__audit"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'

[0m11:59:22.737323 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_marts"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'

[0m11:59:22.767629 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: ROLLBACK
[0m11:59:22.778107 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m11:59:22.784230 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m11:59:22.785649 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: Close
[0m11:59:22.789207 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: ROLLBACK
[0m11:59:22.793790 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: ROLLBACK
[0m11:59:22.802373 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: Close
[0m11:59:22.804469 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: Close
[0m11:59:22.829842 [debug] [MainThread]: Using postgres connection "master"
[0m11:59:22.831916 [debug] [MainThread]: On master: BEGIN
[0m11:59:22.833673 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:59:22.844224 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:59:22.853297 [debug] [MainThread]: Using postgres connection "master"
[0m11:59:22.860698 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:59:22.908609 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m11:59:22.912599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a7e2e1b-b3d2-4659-b92d-825f8cf273d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc948f5310>]}
[0m11:59:22.916365 [debug] [MainThread]: On master: ROLLBACK
[0m11:59:22.919081 [debug] [MainThread]: Using postgres connection "master"
[0m11:59:22.920254 [debug] [MainThread]: On master: BEGIN
[0m11:59:22.922030 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:59:22.923206 [debug] [MainThread]: On master: COMMIT
[0m11:59:22.924342 [debug] [MainThread]: Using postgres connection "master"
[0m11:59:22.925375 [debug] [MainThread]: On master: COMMIT
[0m11:59:22.926631 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:59:22.930476 [debug] [MainThread]: On master: Close
[0m11:59:22.932611 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:59:22.937729 [info ] [MainThread]:
[0m11:59:22.971736 [debug] [Thread-1 (]: Began running node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30
[0m11:59:22.972681 [debug] [Thread-2 (]: Began running node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7
[0m11:59:22.973898 [debug] [Thread-3 (]: Began running node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300
[0m11:59:22.975566 [debug] [Thread-4 (]: Began running node test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd
[0m11:59:22.989687 [info ] [Thread-1 (]: 1 of 14 START test dbt_utils_accepted_range_stg_crypto_prices_market_cap__0 .... [RUN]
[0m11:59:23.003086 [info ] [Thread-2 (]: 2 of 14 START test dbt_utils_accepted_range_stg_crypto_prices_price_usd__0 ..... [RUN]
[0m11:59:23.006341 [info ] [Thread-3 (]: 3 of 14 START test dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0 .... [RUN]
[0m11:59:23.016611 [info ] [Thread-4 (]: 4 of 14 START test dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP  [RUN]
[0m11:59:23.022151 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_dbt_test__audit, now test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30)
[0m11:59:23.025155 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_marts, now test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7)
[0m11:59:23.033645 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_staging, now test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300)
[0m11:59:23.325537 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd'
[0m11:59:23.339729 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30
[0m11:59:23.341879 [debug] [Thread-2 (]: Began compiling node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7
[0m11:59:23.392818 [debug] [Thread-3 (]: Began compiling node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300
[0m11:59:23.398468 [debug] [Thread-4 (]: Began compiling node test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd
[0m11:59:23.484408 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30"
[0m11:59:23.489593 [debug] [Thread-2 (]: Writing injected SQL for node "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7"
[0m11:59:23.498275 [debug] [Thread-3 (]: Writing injected SQL for node "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300"
[0m11:59:23.579601 [debug] [Thread-4 (]: Writing injected SQL for node "test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd"
[0m11:59:23.597412 [debug] [Thread-2 (]: Timing info for test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7 (compile): 11:59:23.427803 => 11:59:23.596557
[0m11:59:23.599305 [debug] [Thread-2 (]: Began executing node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7
[0m11:59:23.644210 [debug] [Thread-2 (]: Applying DROP to: "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_price_usd__0"
[0m11:59:23.656579 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7"
[0m11:59:23.658034 [debug] [Thread-2 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7"} */
drop table if exists "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_price_usd__0" cascade
[0m11:59:23.659405 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:59:23.674766 [debug] [Thread-1 (]: Timing info for test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30 (compile): 11:59:23.400080 => 11:59:23.674029
[0m11:59:23.680828 [debug] [Thread-1 (]: Began executing node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30
[0m11:59:23.682916 [debug] [Thread-3 (]: Timing info for test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300 (compile): 11:59:23.475639 => 11:59:23.682191
[0m11:59:23.689836 [debug] [Thread-4 (]: Timing info for test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd (compile): 11:59:23.504561 => 11:59:23.689305
[0m11:59:23.701713 [debug] [Thread-1 (]: Applying DROP to: "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_market_cap__0"
[0m11:59:23.703210 [debug] [Thread-3 (]: Began executing node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300
[0m11:59:23.704379 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:59:23.706126 [debug] [Thread-4 (]: Began executing node test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd
[0m11:59:23.709296 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30"
[0m11:59:23.726543 [debug] [Thread-3 (]: Applying DROP to: "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0"
[0m11:59:23.734054 [debug] [Thread-2 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_price_usd__0"
[0m11:59:23.838320 [debug] [Thread-4 (]: Applying DROP to: "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_expression_is_true_s_7b822a4db60249ec680888478d412bb7"
[0m11:59:23.839377 [debug] [Thread-1 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30"} */
drop table if exists "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_market_cap__0" cascade
[0m11:59:23.841568 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300"
[0m11:59:23.872663 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd"
[0m11:59:23.875236 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7"
[0m11:59:23.880262 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:59:23.882313 [debug] [Thread-3 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300"} */
drop table if exists "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0" cascade
[0m11:59:23.884200 [debug] [Thread-4 (]: On test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd"} */
drop table if exists "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_expression_is_true_s_7b822a4db60249ec680888478d412bb7" cascade
[0m11:59:23.885751 [debug] [Thread-2 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7: BEGIN
[0m11:59:23.890086 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:59:23.891886 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:59:23.896845 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:59:23.902290 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:59:23.906406 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:59:23.907438 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7"
[0m11:59:23.915651 [debug] [Thread-1 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_market_cap__0"
[0m11:59:23.916833 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:59:23.919691 [debug] [Thread-3 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0"
[0m11:59:23.921654 [debug] [Thread-2 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7"} */





  create  table "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_price_usd__0"


    as

  (


with meet_condition as(
  select *
  from "crypto_warehouse"."public_staging"."stg_crypto_prices"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not price_usd >= 0
)

select *
from validation_errors


  );


[0m11:59:23.924742 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30"
[0m11:59:23.929901 [debug] [Thread-4 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_expression_is_true_s_7b822a4db60249ec680888478d412bb7"
[0m11:59:23.933139 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300"
[0m11:59:23.936067 [debug] [Thread-1 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30: BEGIN
[0m11:59:23.939395 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd"
[0m11:59:23.941161 [debug] [Thread-3 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300: BEGIN
[0m11:59:23.945668 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:59:23.947598 [debug] [Thread-4 (]: On test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd: BEGIN
[0m11:59:23.950005 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:59:23.951095 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30"
[0m11:59:23.952959 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m11:59:23.953794 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300"
[0m11:59:23.955315 [debug] [Thread-1 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30"} */





  create  table "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_market_cap__0"


    as

  (


with meet_condition as(
  select *
  from "crypto_warehouse"."public_staging"."stg_crypto_prices"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not market_cap >= 0
)

select *
from validation_errors


  );


[0m11:59:23.956691 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd"
[0m11:59:23.958012 [debug] [Thread-3 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300"} */





  create  table "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0"


    as

  (


with meet_condition as(
  select *
  from "crypto_warehouse"."public_staging"."stg_crypto_prices"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not volume_24h >= 0
)

select *
from validation_errors


  );


[0m11:59:23.962408 [debug] [Thread-4 (]: On test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd"} */





  create  table "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_expression_is_true_s_7b822a4db60249ec680888478d412bb7"


    as

  (




select
    *
from "crypto_warehouse"."public_staging"."stg_crypto_prices"

where not(extracted_at  <= CURRENT_TIMESTAMP)


  );


[0m11:59:24.446012 [debug] [Thread-2 (]: SQL status: SELECT 0 in 1.0 seconds
[0m11:59:24.449040 [debug] [Thread-2 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7: COMMIT
[0m11:59:24.450680 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7"
[0m11:59:24.452573 [debug] [Thread-2 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7: COMMIT
[0m11:59:24.889852 [debug] [Thread-4 (]: SQL status: SELECT 0 in 1.0 seconds
[0m11:59:24.891150 [debug] [Thread-3 (]: SQL status: SELECT 0 in 1.0 seconds
[0m11:59:24.892192 [debug] [Thread-1 (]: SQL status: SELECT 0 in 1.0 seconds
[0m11:59:24.897116 [debug] [Thread-4 (]: On test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd: COMMIT
[0m11:59:24.900860 [debug] [Thread-3 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300: COMMIT
[0m11:59:24.903277 [debug] [Thread-1 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30: COMMIT
[0m11:59:24.905227 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd"
[0m11:59:24.906897 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300"
[0m11:59:24.912214 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30"
[0m11:59:24.914022 [debug] [Thread-4 (]: On test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd: COMMIT
[0m11:59:24.915870 [debug] [Thread-3 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300: COMMIT
[0m11:59:24.917560 [debug] [Thread-1 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30: COMMIT
[0m11:59:25.033223 [debug] [Thread-2 (]: SQL status: COMMIT in 1.0 seconds
[0m11:59:25.046336 [debug] [Thread-2 (]: Writing runtime sql for node "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7"
[0m11:59:25.073778 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7"
[0m11:59:25.078215 [debug] [Thread-2 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7: BEGIN
[0m11:59:25.080560 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:59:25.082450 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7"
[0m11:59:25.084643 [debug] [Thread-2 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (

        select *
        from "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_price_usd__0"


    ) dbt_internal_test
[0m11:59:25.087480 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:59:25.093710 [debug] [Thread-2 (]: Timing info for test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7 (execute): 11:59:23.600664 => 11:59:25.092839
[0m11:59:25.098663 [debug] [Thread-2 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7: ROLLBACK
[0m11:59:25.101475 [debug] [Thread-2 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7: Close
[0m11:59:25.105351 [info ] [Thread-2 (]: 2 of 14 PASS dbt_utils_accepted_range_stg_crypto_prices_price_usd__0 ........... [[32mPASS[0m in 2.08s]
[0m11:59:25.118886 [debug] [Thread-2 (]: Finished running node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7
[0m11:59:25.122153 [debug] [Thread-2 (]: Began running node test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5
[0m11:59:25.127231 [info ] [Thread-2 (]: 5 of 14 START test not_null_stg_crypto_prices_extracted_at ..................... [RUN]
[0m11:59:25.133543 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7, now test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5)
[0m11:59:25.137929 [debug] [Thread-2 (]: Began compiling node test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5
[0m11:59:25.217214 [debug] [Thread-2 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5"
[0m11:59:25.218442 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m11:59:25.219586 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m11:59:25.220604 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:59:25.263319 [debug] [Thread-4 (]: Writing runtime sql for node "test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd"
[0m11:59:25.272269 [debug] [Thread-3 (]: Writing runtime sql for node "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300"
[0m11:59:25.425753 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30"
[0m11:59:25.685660 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300"
[0m11:59:25.751400 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd"
[0m11:59:25.754972 [debug] [Thread-3 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300: BEGIN
[0m11:59:25.759461 [debug] [Thread-2 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5 (compile): 11:59:25.176565 => 11:59:25.758007
[0m11:59:25.761004 [debug] [Thread-4 (]: On test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd: BEGIN
[0m11:59:25.769726 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:59:25.773077 [debug] [Thread-2 (]: Began executing node test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5
[0m11:59:25.774575 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30"
[0m11:59:25.777648 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m11:59:25.780691 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300"
[0m11:59:25.803457 [debug] [Thread-2 (]: Applying DROP to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_extracted_at"
[0m11:59:25.805029 [debug] [Thread-1 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30: BEGIN
[0m11:59:25.807726 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd"
[0m11:59:25.810480 [debug] [Thread-3 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (

        select *
        from "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0"


    ) dbt_internal_test
[0m11:59:25.813646 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5"
[0m11:59:25.816721 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:59:25.818507 [debug] [Thread-4 (]: On test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (

        select *
        from "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_expression_is_true_s_7b822a4db60249ec680888478d412bb7"


    ) dbt_internal_test
[0m11:59:25.822139 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:59:25.823929 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5"} */
drop table if exists "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_extracted_at" cascade
[0m11:59:25.826751 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30"
[0m11:59:25.830451 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:59:25.834164 [debug] [Thread-3 (]: Timing info for test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300 (execute): 11:59:23.711939 => 11:59:25.833440
[0m11:59:25.836491 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:59:25.838611 [debug] [Thread-1 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (

        select *
        from "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_market_cap__0"


    ) dbt_internal_test
[0m11:59:25.844239 [debug] [Thread-4 (]: Timing info for test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd (execute): 11:59:23.735462 => 11:59:25.843435
[0m11:59:25.846745 [debug] [Thread-3 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300: ROLLBACK
[0m11:59:25.856744 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:59:25.857770 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:59:25.859840 [debug] [Thread-4 (]: On test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd: ROLLBACK
[0m11:59:25.862334 [debug] [Thread-3 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300: Close
[0m11:59:25.866454 [debug] [Thread-1 (]: Timing info for test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30 (execute): 11:59:23.684064 => 11:59:25.865897
[0m11:59:25.870355 [debug] [Thread-2 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_extracted_at"
[0m11:59:25.873123 [debug] [Thread-4 (]: On test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd: Close
[0m11:59:25.876059 [info ] [Thread-3 (]: 3 of 14 PASS dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0 .......... [[32mPASS[0m in 2.84s]
[0m11:59:25.883878 [debug] [Thread-1 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30: ROLLBACK
[0m11:59:25.898022 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5"
[0m11:59:25.901641 [info ] [Thread-4 (]: 4 of 14 PASS dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP  [[32mPASS[0m in 2.58s]
[0m11:59:25.909381 [debug] [Thread-3 (]: Finished running node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300
[0m11:59:25.931995 [debug] [Thread-1 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30: Close
[0m11:59:25.938519 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5: BEGIN
[0m11:59:25.944609 [debug] [Thread-4 (]: Finished running node test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd
[0m11:59:25.947474 [debug] [Thread-3 (]: Began running node test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79
[0m11:59:25.953217 [info ] [Thread-1 (]: 1 of 14 PASS dbt_utils_accepted_range_stg_crypto_prices_market_cap__0 .......... [[32mPASS[0m in 2.93s]
[0m11:59:25.959764 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:59:25.962238 [debug] [Thread-4 (]: Began running node test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f
[0m11:59:25.966406 [info ] [Thread-3 (]: 6 of 14 START test not_null_stg_crypto_prices_market_cap ....................... [RUN]
[0m11:59:25.973909 [debug] [Thread-1 (]: Finished running node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30
[0m11:59:25.977478 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5"
[0m11:59:25.979904 [info ] [Thread-4 (]: 7 of 14 START test not_null_stg_crypto_prices_price_id ......................... [RUN]
[0m11:59:25.984126 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300, now test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79)
[0m11:59:25.986958 [debug] [Thread-1 (]: Began running node test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf
[0m11:59:25.989790 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5"} */





  create  table "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_extracted_at"


    as

  (






select *
from "crypto_warehouse"."public_staging"."stg_crypto_prices"
where extracted_at is null



  );


[0m11:59:25.993289 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd, now test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f)
[0m11:59:25.995793 [debug] [Thread-3 (]: Began compiling node test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79
[0m11:59:25.998263 [info ] [Thread-1 (]: 8 of 14 START test not_null_stg_crypto_prices_price_usd ........................ [RUN]
[0m11:59:26.002200 [debug] [Thread-4 (]: Began compiling node test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f
[0m11:59:26.017092 [debug] [Thread-3 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79"
[0m11:59:26.019710 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30, now test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf)
[0m11:59:26.031977 [debug] [Thread-4 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f"
[0m11:59:26.035907 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf
[0m11:59:26.050122 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf"
[0m11:59:26.063008 [debug] [Thread-3 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79 (compile): 11:59:26.004836 => 11:59:26.062245
[0m11:59:26.064621 [debug] [Thread-4 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f (compile): 11:59:26.021496 => 11:59:26.063981
[0m11:59:26.066481 [debug] [Thread-3 (]: Began executing node test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79
[0m11:59:26.070434 [debug] [Thread-4 (]: Began executing node test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f
[0m11:59:26.078645 [debug] [Thread-1 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf (compile): 11:59:26.039594 => 11:59:26.077897
[0m11:59:26.088519 [debug] [Thread-3 (]: Applying DROP to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_market_cap"
[0m11:59:26.109607 [debug] [Thread-4 (]: Applying DROP to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_price_id"
[0m11:59:26.112154 [debug] [Thread-1 (]: Began executing node test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf
[0m11:59:26.116165 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79"
[0m11:59:26.118761 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f"
[0m11:59:26.139222 [debug] [Thread-1 (]: Applying DROP to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_price_usd"
[0m11:59:26.141851 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79"} */
drop table if exists "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_market_cap" cascade
[0m11:59:26.144270 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f"} */
drop table if exists "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_price_id" cascade
[0m11:59:26.148073 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf"
[0m11:59:26.150400 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:59:26.152157 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:59:26.153592 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf"} */
drop table if exists "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_price_usd" cascade
[0m11:59:26.164150 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:59:26.167221 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:59:26.171385 [debug] [Thread-3 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_market_cap"
[0m11:59:26.172674 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:59:26.176291 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79"
[0m11:59:26.177292 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:59:26.179763 [debug] [Thread-4 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_price_id"
[0m11:59:26.181691 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79: BEGIN
[0m11:59:26.185217 [debug] [Thread-1 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_price_usd"
[0m11:59:26.187977 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f"
[0m11:59:26.193795 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf"
[0m11:59:26.194634 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:59:26.195988 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f: BEGIN
[0m11:59:26.199360 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf: BEGIN
[0m11:59:26.205082 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79"
[0m11:59:26.209864 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m11:59:26.211643 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:59:26.214171 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79"} */





  create  table "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_market_cap"


    as

  (






select *
from "crypto_warehouse"."public_staging"."stg_crypto_prices"
where market_cap is null



  );


[0m11:59:26.217535 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f"
[0m11:59:26.218230 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.0 seconds
[0m11:59:26.219526 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf"
[0m11:59:26.221796 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f"} */





  create  table "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_price_id"


    as

  (






select *
from "crypto_warehouse"."public_staging"."stg_crypto_prices"
where price_id is null



  );


[0m11:59:26.225542 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5: COMMIT
[0m11:59:26.227205 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf"} */





  create  table "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_price_usd"


    as

  (






select *
from "crypto_warehouse"."public_staging"."stg_crypto_prices"
where price_usd is null



  );


[0m11:59:26.230608 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5"
[0m11:59:26.236334 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5: COMMIT
[0m11:59:26.318306 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:59:26.320493 [debug] [Thread-2 (]: Writing runtime sql for node "test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5"
[0m11:59:26.332869 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5"
[0m11:59:26.335469 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5: BEGIN
[0m11:59:26.337081 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:59:26.338404 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5"
[0m11:59:26.340557 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (

        select *
        from "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_extracted_at"


    ) dbt_internal_test
[0m11:59:26.343000 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:59:26.346581 [debug] [Thread-2 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5 (execute): 11:59:25.782717 => 11:59:26.345935
[0m11:59:26.349210 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5: ROLLBACK
[0m11:59:26.351845 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5: Close
[0m11:59:26.354758 [info ] [Thread-2 (]: 5 of 14 PASS not_null_stg_crypto_prices_extracted_at ........................... [[32mPASS[0m in 1.22s]
[0m11:59:26.358896 [debug] [Thread-2 (]: Finished running node test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5
[0m11:59:26.360724 [debug] [Thread-2 (]: Began running node test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a
[0m11:59:26.362204 [info ] [Thread-2 (]: 9 of 14 START test not_null_stg_crypto_prices_symbol ........................... [RUN]
[0m11:59:26.366912 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5, now test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a)
[0m11:59:26.370204 [debug] [Thread-2 (]: Began compiling node test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a
[0m11:59:26.383550 [debug] [Thread-2 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a"
[0m11:59:26.398335 [debug] [Thread-2 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a (compile): 11:59:26.371601 => 11:59:26.397565
[0m11:59:26.401184 [debug] [Thread-2 (]: Began executing node test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a
[0m11:59:26.410275 [debug] [Thread-2 (]: Applying DROP to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_symbol"
[0m11:59:26.412340 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a"
[0m11:59:26.415072 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a"} */
drop table if exists "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_symbol" cascade
[0m11:59:26.417661 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:59:26.425696 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:59:26.428442 [debug] [Thread-2 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_symbol"
[0m11:59:26.433123 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a"
[0m11:59:26.435807 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a: BEGIN
[0m11:59:26.437698 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:59:26.439364 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a"
[0m11:59:26.443599 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a"} */





  create  table "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_symbol"


    as

  (






select *
from "crypto_warehouse"."public_staging"."stg_crypto_prices"
where symbol is null



  );


[0m11:59:26.514507 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m11:59:26.518089 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf: COMMIT
[0m11:59:26.519961 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf"
[0m11:59:26.521695 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf: COMMIT
[0m11:59:26.749667 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:59:26.752037 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf"
[0m11:59:26.765993 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf"
[0m11:59:26.767582 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf: BEGIN
[0m11:59:26.769364 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:59:26.770774 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf"
[0m11:59:26.772313 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (

        select *
        from "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_price_usd"


    ) dbt_internal_test
[0m11:59:26.774888 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:59:26.778008 [debug] [Thread-1 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf (execute): 11:59:26.120255 => 11:59:26.777640
[0m11:59:26.779851 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf: ROLLBACK
[0m11:59:26.781800 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf: Close
[0m11:59:26.785786 [info ] [Thread-1 (]: 8 of 14 PASS not_null_stg_crypto_prices_price_usd .............................. [[32mPASS[0m in 0.77s]
[0m11:59:26.787562 [debug] [Thread-3 (]: SQL status: SELECT 0 in 1.0 seconds
[0m11:59:26.788736 [debug] [Thread-4 (]: SQL status: SELECT 0 in 1.0 seconds
[0m11:59:26.791782 [debug] [Thread-1 (]: Finished running node test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf
[0m11:59:26.795694 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79: COMMIT
[0m11:59:26.799726 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f: COMMIT
[0m11:59:26.802085 [debug] [Thread-1 (]: Began running node test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438
[0m11:59:26.804519 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79"
[0m11:59:26.807066 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f"
[0m11:59:26.809932 [info ] [Thread-1 (]: 10 of 14 START test not_null_stg_crypto_prices_volume_24h ...................... [RUN]
[0m11:59:26.817145 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79: COMMIT
[0m11:59:26.821928 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f: COMMIT
[0m11:59:26.825444 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf, now test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438)
[0m11:59:26.830109 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438
[0m11:59:26.838103 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438"
[0m11:59:26.862961 [debug] [Thread-1 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438 (compile): 11:59:26.831537 => 11:59:26.862417
[0m11:59:26.865005 [debug] [Thread-1 (]: Began executing node test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438
[0m11:59:26.879716 [debug] [Thread-1 (]: Applying DROP to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_volume_24h"
[0m11:59:26.882570 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438"
[0m11:59:26.884449 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438"} */
drop table if exists "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_volume_24h" cascade
[0m11:59:26.886324 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:59:26.894925 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:59:26.899223 [debug] [Thread-1 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_volume_24h"
[0m11:59:26.902044 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438"
[0m11:59:26.903986 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438: BEGIN
[0m11:59:26.906598 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:59:26.908555 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438"
[0m11:59:26.910554 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438"} */





  create  table "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_volume_24h"


    as

  (






select *
from "crypto_warehouse"."public_staging"."stg_crypto_prices"
where volume_24h is null



  );


[0m11:59:26.993587 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m11:59:26.995719 [debug] [Thread-3 (]: Writing runtime sql for node "test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79"
[0m11:59:27.006867 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79"
[0m11:59:27.008639 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79: BEGIN
[0m11:59:27.010360 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:59:27.011842 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79"
[0m11:59:27.013282 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (

        select *
        from "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_market_cap"


    ) dbt_internal_test
[0m11:59:27.015654 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:59:27.018796 [debug] [Thread-3 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79 (execute): 11:59:26.072611 => 11:59:27.018354
[0m11:59:27.020225 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79: ROLLBACK
[0m11:59:27.023989 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79: Close
[0m11:59:27.027340 [info ] [Thread-3 (]: 6 of 14 PASS not_null_stg_crypto_prices_market_cap ............................. [[32mPASS[0m in 1.04s]
[0m11:59:27.030704 [debug] [Thread-3 (]: Finished running node test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79
[0m11:59:27.033019 [debug] [Thread-3 (]: Began running node test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39
[0m11:59:27.034950 [info ] [Thread-3 (]: 11 of 14 START test not_null_stg_pipeline_runs_run_id .......................... [RUN]
[0m11:59:27.037677 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79, now test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39)
[0m11:59:27.042631 [debug] [Thread-3 (]: Began compiling node test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39
[0m11:59:27.052608 [debug] [Thread-3 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39"
[0m11:59:27.062378 [debug] [Thread-2 (]: SQL status: SELECT 0 in 1.0 seconds
[0m11:59:27.066289 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a: COMMIT
[0m11:59:27.069591 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a"
[0m11:59:27.070778 [debug] [Thread-3 (]: Timing info for test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39 (compile): 11:59:27.045392 => 11:59:27.070238
[0m11:59:27.074232 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a: COMMIT
[0m11:59:27.076333 [debug] [Thread-3 (]: Began executing node test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39
[0m11:59:27.089760 [debug] [Thread-3 (]: Applying DROP to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_run_id"
[0m11:59:27.092748 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39"
[0m11:59:27.094866 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39"} */
drop table if exists "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_run_id" cascade
[0m11:59:27.096774 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:59:27.103894 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:59:27.109600 [debug] [Thread-3 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_run_id"
[0m11:59:27.112283 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39"
[0m11:59:27.114096 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39: BEGIN
[0m11:59:27.116694 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:59:27.118300 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39"
[0m11:59:27.119842 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39"} */





  create  table "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_run_id"


    as

  (






select *
from "crypto_warehouse"."public_staging"."stg_pipeline_runs"
where run_id is null



  );


[0m11:59:27.167317 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m11:59:27.170596 [debug] [Thread-4 (]: Writing runtime sql for node "test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f"
[0m11:59:27.184604 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f"
[0m11:59:27.186454 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f: BEGIN
[0m11:59:27.188193 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m11:59:27.191936 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f"
[0m11:59:27.194219 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (

        select *
        from "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_price_id"


    ) dbt_internal_test
[0m11:59:27.197211 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:59:27.204839 [debug] [Thread-4 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f (execute): 11:59:26.090498 => 11:59:27.204027
[0m11:59:27.209965 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f: ROLLBACK
[0m11:59:27.212708 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f: Close
[0m11:59:27.216687 [info ] [Thread-4 (]: 7 of 14 PASS not_null_stg_crypto_prices_price_id ............................... [[32mPASS[0m in 1.22s]
[0m11:59:27.222128 [debug] [Thread-4 (]: Finished running node test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f
[0m11:59:27.227335 [debug] [Thread-4 (]: Began running node test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e
[0m11:59:27.229779 [info ] [Thread-4 (]: 12 of 14 START test not_null_stg_pipeline_runs_stage ........................... [RUN]
[0m11:59:27.234279 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f, now test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e)
[0m11:59:27.236668 [debug] [Thread-4 (]: Began compiling node test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e
[0m11:59:27.257966 [debug] [Thread-4 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e"
[0m11:59:27.273840 [debug] [Thread-4 (]: Timing info for test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e (compile): 11:59:27.239161 => 11:59:27.272920
[0m11:59:27.275051 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:59:27.276278 [debug] [Thread-4 (]: Began executing node test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e
[0m11:59:27.280115 [debug] [Thread-2 (]: Writing runtime sql for node "test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a"
[0m11:59:27.291211 [debug] [Thread-4 (]: Applying DROP to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_stage"
[0m11:59:27.294581 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e"
[0m11:59:27.299839 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e"} */
drop table if exists "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_stage" cascade
[0m11:59:27.301754 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:59:27.307084 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m11:59:27.313028 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438: COMMIT
[0m11:59:27.314592 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a"
[0m11:59:27.316991 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438"
[0m11:59:27.318961 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a: BEGIN
[0m11:59:27.320085 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:59:27.321129 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438: COMMIT
[0m11:59:27.324125 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:59:27.326410 [debug] [Thread-4 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_stage"
[0m11:59:27.330065 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a"
[0m11:59:27.334266 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e"
[0m11:59:27.335880 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (

        select *
        from "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_symbol"


    ) dbt_internal_test
[0m11:59:27.337222 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e: BEGIN
[0m11:59:27.341245 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:59:27.345539 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m11:59:27.349321 [debug] [Thread-2 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a (execute): 11:59:26.402265 => 11:59:27.348908
[0m11:59:27.350698 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e"
[0m11:59:27.352045 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a: ROLLBACK
[0m11:59:27.353305 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e"} */





  create  table "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_stage"


    as

  (






select *
from "crypto_warehouse"."public_staging"."stg_pipeline_runs"
where stage is null



  );


[0m11:59:27.355280 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a: Close
[0m11:59:27.360208 [info ] [Thread-2 (]: 9 of 14 PASS not_null_stg_crypto_prices_symbol ................................. [[32mPASS[0m in 0.99s]
[0m11:59:27.369307 [debug] [Thread-2 (]: Finished running node test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a
[0m11:59:27.373105 [debug] [Thread-2 (]: Began running node test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd
[0m11:59:27.375346 [info ] [Thread-2 (]: 13 of 14 START test not_null_stg_pipeline_runs_status .......................... [RUN]
[0m11:59:27.378731 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a, now test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd)
[0m11:59:27.383128 [debug] [Thread-2 (]: Began compiling node test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd
[0m11:59:27.424504 [debug] [Thread-2 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd"
[0m11:59:27.518517 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:59:27.724168 [debug] [Thread-3 (]: SQL status: SELECT 0 in 1.0 seconds
[0m11:59:27.744605 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438"
[0m11:59:27.750070 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39: COMMIT
[0m11:59:27.753809 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39"
[0m11:59:27.757234 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39: COMMIT
[0m11:59:27.763472 [debug] [Thread-2 (]: Timing info for test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd (compile): 11:59:27.385250 => 11:59:27.762371
[0m11:59:27.766623 [debug] [Thread-2 (]: Began executing node test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd
[0m11:59:27.775093 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438"
[0m11:59:27.787412 [debug] [Thread-2 (]: Applying DROP to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_status"
[0m11:59:27.789331 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438: BEGIN
[0m11:59:27.792720 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd"
[0m11:59:27.795393 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:59:27.796747 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd"} */
drop table if exists "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_status" cascade
[0m11:59:27.798890 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438"
[0m11:59:27.800711 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:59:27.802178 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (

        select *
        from "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_volume_24h"


    ) dbt_internal_test
[0m11:59:27.810915 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:59:27.812016 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:59:27.814749 [debug] [Thread-2 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_status"
[0m11:59:27.818991 [debug] [Thread-1 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438 (execute): 11:59:26.866337 => 11:59:27.818465
[0m11:59:27.822792 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd"
[0m11:59:27.825052 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438: ROLLBACK
[0m11:59:27.827089 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd: BEGIN
[0m11:59:27.829217 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438: Close
[0m11:59:27.830817 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:59:27.834780 [info ] [Thread-1 (]: 10 of 14 PASS not_null_stg_crypto_prices_volume_24h ............................ [[32mPASS[0m in 1.01s]
[0m11:59:27.837251 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd"
[0m11:59:27.840947 [debug] [Thread-1 (]: Finished running node test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438
[0m11:59:27.842999 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd"} */





  create  table "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_status"


    as

  (






select *
from "crypto_warehouse"."public_staging"."stg_pipeline_runs"
where status is null



  );


[0m11:59:27.845117 [debug] [Thread-1 (]: Began running node test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43
[0m11:59:27.850153 [info ] [Thread-1 (]: 14 of 14 START test unique_stg_crypto_prices_price_id .......................... [RUN]
[0m11:59:27.854967 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438, now test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43)
[0m11:59:27.858269 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43
[0m11:59:27.882727 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43"
[0m11:59:27.898983 [debug] [Thread-1 (]: Timing info for test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43 (compile): 11:59:27.859745 => 11:59:27.898094
[0m11:59:27.901073 [debug] [Thread-1 (]: Began executing node test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43
[0m11:59:27.914729 [debug] [Thread-1 (]: Applying DROP to: "crypto_warehouse"."public_dbt_test__audit"."unique_stg_crypto_prices_price_id"
[0m11:59:27.918037 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43"
[0m11:59:27.918959 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m11:59:27.920441 [debug] [Thread-1 (]: On test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43"} */
drop table if exists "crypto_warehouse"."public_dbt_test__audit"."unique_stg_crypto_prices_price_id" cascade
[0m11:59:27.923864 [debug] [Thread-3 (]: Writing runtime sql for node "test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39"
[0m11:59:27.925675 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:59:27.936243 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:59:27.945064 [debug] [Thread-1 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."unique_stg_crypto_prices_price_id"
[0m11:59:27.951948 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43"
[0m11:59:27.955834 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39"
[0m11:59:27.957241 [debug] [Thread-1 (]: On test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43: BEGIN
[0m11:59:27.959002 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39: BEGIN
[0m11:59:27.961371 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:59:27.962908 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:59:27.964465 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43"
[0m11:59:27.966193 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39"
[0m11:59:27.968268 [debug] [Thread-1 (]: On test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43"} */





  create  table "crypto_warehouse"."public_dbt_test__audit"."unique_stg_crypto_prices_price_id"


    as

  (




select
    price_id as unique_field,
    count(*) as n_records

from "crypto_warehouse"."public_staging"."stg_crypto_prices"
where price_id is not null
group by price_id
having count(*) > 1



  );


[0m11:59:27.970703 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (

        select *
        from "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_run_id"


    ) dbt_internal_test
[0m11:59:27.975909 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:59:27.980099 [debug] [Thread-3 (]: Timing info for test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39 (execute): 11:59:27.078695 => 11:59:27.979461
[0m11:59:27.981972 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39: ROLLBACK
[0m11:59:27.984355 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39: Close
[0m11:59:27.992015 [info ] [Thread-3 (]: 11 of 14 PASS not_null_stg_pipeline_runs_run_id ................................ [[32mPASS[0m in 0.95s]
[0m11:59:27.998497 [debug] [Thread-3 (]: Finished running node test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39
[0m11:59:28.018343 [debug] [Thread-4 (]: SQL status: SELECT 0 in 1.0 seconds
[0m11:59:28.019562 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m11:59:28.040069 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e: COMMIT
[0m11:59:28.057116 [debug] [Thread-1 (]: On test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43: COMMIT
[0m11:59:28.072106 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e"
[0m11:59:28.091548 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43"
[0m11:59:28.106979 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e: COMMIT
[0m11:59:28.116396 [debug] [Thread-1 (]: On test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43: COMMIT
[0m11:59:28.278192 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m11:59:28.282446 [debug] [Thread-4 (]: Writing runtime sql for node "test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e"
[0m11:59:28.327075 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e"
[0m11:59:28.329218 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e: BEGIN
[0m11:59:28.334513 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m11:59:28.345656 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e"
[0m11:59:28.348570 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (

        select *
        from "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_stage"


    ) dbt_internal_test
[0m11:59:28.351779 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:59:28.371173 [debug] [Thread-4 (]: Timing info for test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e (execute): 11:59:27.282788 => 11:59:28.370193
[0m11:59:28.375865 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e: ROLLBACK
[0m11:59:28.377139 [debug] [Thread-2 (]: SQL status: SELECT 0 in 1.0 seconds
[0m11:59:28.383819 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e: Close
[0m11:59:28.387501 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd: COMMIT
[0m11:59:28.395349 [info ] [Thread-4 (]: 12 of 14 PASS not_null_stg_pipeline_runs_stage ................................. [[32mPASS[0m in 1.16s]
[0m11:59:28.399102 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd"
[0m11:59:28.405126 [debug] [Thread-4 (]: Finished running node test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e
[0m11:59:28.410847 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd: COMMIT
[0m11:59:28.418068 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:59:28.429797 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43"
[0m11:59:28.446891 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43"
[0m11:59:28.449526 [debug] [Thread-1 (]: On test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43: BEGIN
[0m11:59:28.451745 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:59:28.454254 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43"
[0m11:59:28.457232 [debug] [Thread-1 (]: On test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (

        select *
        from "crypto_warehouse"."public_dbt_test__audit"."unique_stg_crypto_prices_price_id"


    ) dbt_internal_test
[0m11:59:28.460350 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:59:28.469584 [debug] [Thread-1 (]: Timing info for test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43 (execute): 11:59:27.902840 => 11:59:28.469063
[0m11:59:28.471617 [debug] [Thread-1 (]: On test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43: ROLLBACK
[0m11:59:28.473720 [debug] [Thread-1 (]: On test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43: Close
[0m11:59:28.476930 [info ] [Thread-1 (]: 14 of 14 PASS unique_stg_crypto_prices_price_id ................................ [[32mPASS[0m in 0.62s]
[0m11:59:28.480352 [debug] [Thread-1 (]: Finished running node test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43
[0m11:59:28.519654 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:59:28.522569 [debug] [Thread-2 (]: Writing runtime sql for node "test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd"
[0m11:59:28.536112 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd"
[0m11:59:28.539537 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd: BEGIN
[0m11:59:28.541408 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:59:28.543197 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd"
[0m11:59:28.545446 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (

        select *
        from "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_status"


    ) dbt_internal_test
[0m11:59:28.548313 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:59:28.552348 [debug] [Thread-2 (]: Timing info for test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd (execute): 11:59:27.768386 => 11:59:28.551764
[0m11:59:28.557218 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd: ROLLBACK
[0m11:59:28.559690 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd: Close
[0m11:59:28.562781 [info ] [Thread-2 (]: 13 of 14 PASS not_null_stg_pipeline_runs_status ................................ [[32mPASS[0m in 1.18s]
[0m11:59:28.566979 [debug] [Thread-2 (]: Finished running node test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd
[0m11:59:28.587595 [debug] [MainThread]: Using postgres connection "master"
[0m11:59:28.601347 [debug] [MainThread]: On master: BEGIN
[0m11:59:28.612801 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:59:28.620586 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:59:28.622508 [debug] [MainThread]: On master: COMMIT
[0m11:59:28.625713 [debug] [MainThread]: Using postgres connection "master"
[0m11:59:28.627613 [debug] [MainThread]: On master: COMMIT
[0m11:59:28.635390 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:59:28.640456 [debug] [MainThread]: On master: Close
[0m11:59:28.658510 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:59:28.660632 [debug] [MainThread]: Connection 'test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39' was properly closed.
[0m11:59:28.662543 [debug] [MainThread]: Connection 'test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd' was properly closed.
[0m11:59:28.664749 [debug] [MainThread]: Connection 'test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43' was properly closed.
[0m11:59:28.666446 [debug] [MainThread]: Connection 'test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e' was properly closed.
[0m11:59:28.676574 [info ] [MainThread]:
[0m11:59:28.684707 [info ] [MainThread]: Finished running 14 tests in 0 hours 0 minutes and 6.17 seconds (6.17s).
[0m11:59:28.694545 [debug] [MainThread]: Command end result
[0m11:59:28.752377 [info ] [MainThread]:
[0m11:59:28.756316 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:59:28.759249 [info ] [MainThread]:
[0m11:59:28.762534 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
[0m11:59:28.767142 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 9.806151, "process_user_time": 7.464479, "process_kernel_time": 0.817206, "process_mem_max_rss": "124452", "process_out_blocks": "1976", "process_in_blocks": "0"}
[0m11:59:28.769467 [debug] [MainThread]: Command `dbt test` succeeded at 11:59:28.769090 after 9.81 seconds
[0m11:59:28.771934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc9942d710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc948f4e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc94c92950>]}
[0m11:59:28.773898 [debug] [MainThread]: Flushing usage events
[0m12:44:01.436364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36f9fab310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36f9fabad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36f9fab710>]}
[0m12:44:01.436349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9534266490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f953425fe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95342a7590>]}


============================== 12:44:01.620751 | a767b34a-719a-41e0-ad38-1dc82a2b64aa ==============================
[0m12:44:01.620751 [info ] [MainThread]: Running with dbt=1.7.0


============================== 12:44:01.621565 | 2af308cf-60e8-491d-8ae6-b4b6160443ec ==============================
[0m12:44:01.621565 [info ] [MainThread]: Running with dbt=1.7.0
[0m12:44:01.623363 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/app/dbt/logs', 'profiles_dir': '/app', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug --project-dir /app/dbt', 'send_anonymous_usage_stats': 'True'}
[0m12:44:01.623585 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/app/dbt/logs', 'version_check': 'True', 'profiles_dir': '/app', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir /app/dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:44:01.626662 [info ] [MainThread]: dbt version: 1.7.0
[0m12:44:01.628559 [info ] [MainThread]: python version: 3.11.13
[0m12:44:01.630360 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m12:44:01.632011 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m12:44:03.030795 [info ] [MainThread]: Using profiles dir at /app
[0m12:44:03.033142 [info ] [MainThread]: Using profiles.yml file at /app/profiles.yml
[0m12:44:03.035431 [info ] [MainThread]: Using dbt_project.yml file at /app/dbt/dbt_project.yml
[0m12:44:03.134298 [info ] [MainThread]: adapter type: postgres
[0m12:44:03.136923 [info ] [MainThread]: adapter version: 1.7.0
[0m12:44:03.284095 [info ] [MainThread]: Configuration:
[0m12:44:03.287055 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:44:03.290283 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:44:03.292301 [info ] [MainThread]: Required dependencies:
[0m12:44:03.294328 [debug] [MainThread]: Executing "git --help"
[0m12:44:03.724069 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:44:03.727790 [debug] [MainThread]: STDERR: "b''"
[0m12:44:03.729677 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:44:03.731591 [info ] [MainThread]: Connection:
[0m12:44:03.733638 [info ] [MainThread]:   host: postgres
[0m12:44:03.735552 [info ] [MainThread]:   port: 5432
[0m12:44:03.737231 [info ] [MainThread]:   user: postgres
[0m12:44:03.738817 [info ] [MainThread]:   database: crypto_warehouse
[0m12:44:03.740364 [info ] [MainThread]:   schema: public
[0m12:44:03.742000 [info ] [MainThread]:   connect_timeout: 10
[0m12:44:03.743630 [info ] [MainThread]:   role: None
[0m12:44:03.745111 [info ] [MainThread]:   search_path: None
[0m12:44:03.746573 [info ] [MainThread]:   keepalives_idle: 0
[0m12:44:03.748014 [info ] [MainThread]:   sslmode: None
[0m12:44:03.749439 [info ] [MainThread]:   sslcert: None
[0m12:44:03.750905 [info ] [MainThread]:   sslkey: None
[0m12:44:03.752427 [info ] [MainThread]:   sslrootcert: None
[0m12:44:03.753914 [info ] [MainThread]:   application_name: dbt
[0m12:44:03.755304 [info ] [MainThread]:   retries: 1
[0m12:44:03.756707 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m12:44:03.758320 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m12:44:03.759804 [debug] [MainThread]: Using postgres connection "debug"
[0m12:44:03.761279 [debug] [MainThread]: On debug: select 1 as id
[0m12:44:03.762745 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:44:03.894965 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m12:44:03.898067 [debug] [MainThread]: On debug: Close
[0m12:44:03.900063 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:44:03.904634 [info ] [MainThread]: [32mAll checks passed![0m
[0m12:44:03.948301 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.8219628, "process_user_time": 4.046061, "process_kernel_time": 0.329679, "process_mem_max_rss": "111156", "process_in_blocks": "6432", "process_out_blocks": "256"}
[0m12:44:03.950326 [debug] [MainThread]: Command `dbt debug` succeeded at 12:44:03.950008 after 2.82 seconds
[0m12:44:03.952442 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:44:03.955021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36f9fbbe10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36f8908050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36fba671d0>]}
[0m12:44:03.957200 [debug] [MainThread]: Flushing usage events
[0m12:44:04.308197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2af308cf-60e8-491d-8ae6-b4b6160443ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9532a0f390>]}
[0m12:44:04.465986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2af308cf-60e8-491d-8ae6-b4b6160443ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f953679b710>]}
[0m12:44:04.468141 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m12:44:04.595378 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m12:44:07.267261 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 48 files changed.
[0m12:44:07.268914 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/staging/stg_crypto_prices.sql
[0m12:44:07.270407 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/mutually_exclusive_ranges.sql
[0m12:44:07.271821 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/haversine_distance.sql
[0m12:44:07.273163 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/union.sql
[0m12:44:07.274550 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_filtered_columns_in_relation.sql
[0m12:44:07.275841 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/equality.sql
[0m12:44:07.277697 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_tables_by_pattern_sql.sql
[0m12:44:07.280449 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/nullcheck_table.sql
[0m12:44:07.283588 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/relationships_where.sql
[0m12:44:07.286015 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/unique_combination_of_columns.sql
[0m12:44:07.287753 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/marts/mart_pipeline_monitoring.sql
[0m12:44:07.289496 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/safe_divide.sql
[0m12:44:07.291058 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/expression_is_true.sql
[0m12:44:07.292597 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/generate_series.sql
[0m12:44:07.293823 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/star.sql
[0m12:44:07.295422 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/not_null_proportion.sql
[0m12:44:07.296706 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_relations_by_prefix.sql
[0m12:44:07.297959 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/pivot.sql
[0m12:44:07.299229 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/recency.sql
[0m12:44:07.300554 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/staging/stg_pipeline_runs.sql
[0m12:44:07.301817 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/safe_subtract.sql
[0m12:44:07.303176 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/web/get_url_parameter.sql
[0m12:44:07.304939 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/intermediate/int_crypto_hourly_aggs.sql
[0m12:44:07.306538 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/surrogate_key.sql
[0m12:44:07.308080 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/marts/mart_crypto_latest_prices.sql
[0m12:44:07.309567 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/not_constant.sql
[0m12:44:07.311176 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/jinja_helpers/_is_ephemeral.sql
[0m12:44:07.312819 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/jinja_helpers/slugify.sql
[0m12:44:07.314777 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_query_results_as_dict.sql
[0m12:44:07.316606 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/width_bucket.sql
[0m12:44:07.318096 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/nullcheck.sql
[0m12:44:07.319510 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/fewer_rows_than.sql
[0m12:44:07.320928 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/not_accepted_values.sql
[0m12:44:07.322428 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/intermediate/int_crypto_daily_aggs.sql
[0m12:44:07.323703 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_relations_by_pattern.sql
[0m12:44:07.325289 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/accepted_range.sql
[0m12:44:07.326700 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_table_types_sql.sql
[0m12:44:07.328033 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/at_least_one.sql
[0m12:44:07.329787 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/marts/mart_crypto_hourly_performance.sql
[0m12:44:07.331121 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/sequential_values.sql
[0m12:44:07.332443 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_tables_by_prefix_sql.sql
[0m12:44:07.333739 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/equal_rowcount.sql
[0m12:44:07.335019 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/not_empty_string.sql
[0m12:44:07.336238 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/unpivot.sql
[0m12:44:07.337515 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/groupby.sql
[0m12:44:07.338809 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/generate_surrogate_key.sql
[0m12:44:07.340081 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/safe_add.sql
[0m12:44:07.341354 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_single_value.sql
[0m12:44:07.572516 [error] [MainThread]: Encountered an error:
Compilation Error
  unexpected EOF, expected }}, got "max_value }{%- endif %}
  )
  
  select *
  from validation_errors
  
  {% endmacro %}"
[0m12:44:07.574995 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.448549, "process_user_time": 4.769909, "process_kernel_time": 0.752101, "process_mem_max_rss": "114660", "process_in_blocks": "75632", "process_out_blocks": "1872", "command_success": false}
[0m12:44:07.577437 [debug] [MainThread]: Command `dbt run` failed at 12:44:07.577014 after 6.45 seconds
[0m12:44:07.580120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95342671d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9534267fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95327fe950>]}
[0m12:44:07.582656 [debug] [MainThread]: Flushing usage events
[0m12:44:07.997294 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m12:44:11.591027 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m12:51:59.454428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13ed100450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13ed0fbad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13ed143cd0>]}


============================== 12:51:59.463453 | f1d60f6b-a008-4465-8c5a-61215752e169 ==============================
[0m12:51:59.463453 [info ] [MainThread]: Running with dbt=1.7.0
[0m12:51:59.465350 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/app', 'log_path': '/app/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /app/dbt', 'send_anonymous_usage_stats': 'True'}
[0m12:51:59.708778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f1d60f6b-a008-4465-8c5a-61215752e169', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13ed04e690>]}
[0m12:51:59.835259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f1d60f6b-a008-4465-8c5a-61215752e169', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13ed002610>]}
[0m12:51:59.837433 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m12:51:59.878057 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m12:52:01.105398 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 48 files changed.
[0m12:52:01.107068 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/pivot.sql
[0m12:52:01.108502 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/marts/mart_crypto_latest_prices.sql
[0m12:52:01.109875 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/marts/mart_pipeline_monitoring.sql
[0m12:52:01.111227 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/web/get_url_parameter.sql
[0m12:52:01.112526 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/unpivot.sql
[0m12:52:01.113752 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/not_constant.sql
[0m12:52:01.115346 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/expression_is_true.sql
[0m12:52:01.117057 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/safe_divide.sql
[0m12:52:01.119954 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/nullcheck.sql
[0m12:52:01.121533 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/star.sql
[0m12:52:01.122865 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_query_results_as_dict.sql
[0m12:52:01.124203 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/width_bucket.sql
[0m12:52:01.125560 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_single_value.sql
[0m12:52:01.126838 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/marts/mart_crypto_hourly_performance.sql
[0m12:52:01.128014 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/staging/stg_crypto_prices.sql
[0m12:52:01.129263 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_relations_by_prefix.sql
[0m12:52:01.130409 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/nullcheck_table.sql
[0m12:52:01.131652 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/mutually_exclusive_ranges.sql
[0m12:52:01.132894 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/equality.sql
[0m12:52:01.134962 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/jinja_helpers/_is_ephemeral.sql
[0m12:52:01.136618 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/generate_surrogate_key.sql
[0m12:52:01.138221 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/haversine_distance.sql
[0m12:52:01.139529 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/surrogate_key.sql
[0m12:52:01.140782 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/not_empty_string.sql
[0m12:52:01.142269 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/generate_series.sql
[0m12:52:01.143624 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_tables_by_prefix_sql.sql
[0m12:52:01.144938 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/relationships_where.sql
[0m12:52:01.146296 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/jinja_helpers/slugify.sql
[0m12:52:01.147514 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_filtered_columns_in_relation.sql
[0m12:52:01.148810 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/staging/stg_pipeline_runs.sql
[0m12:52:01.150446 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/not_accepted_values.sql
[0m12:52:01.151961 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_relations_by_pattern.sql
[0m12:52:01.153247 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/accepted_range.sql
[0m12:52:01.154491 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/intermediate/int_crypto_hourly_aggs.sql
[0m12:52:01.155810 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/sequential_values.sql
[0m12:52:01.157881 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/unique_combination_of_columns.sql
[0m12:52:01.159626 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/safe_subtract.sql
[0m12:52:01.161097 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_table_types_sql.sql
[0m12:52:01.162402 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/recency.sql
[0m12:52:01.163681 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/at_least_one.sql
[0m12:52:01.165021 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/equal_rowcount.sql
[0m12:52:01.166282 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/groupby.sql
[0m12:52:01.167502 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/union.sql
[0m12:52:01.168896 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_tables_by_pattern_sql.sql
[0m12:52:01.170162 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/intermediate/int_crypto_daily_aggs.sql
[0m12:52:01.171400 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/safe_add.sql
[0m12:52:01.172650 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/not_null_proportion.sql
[0m12:52:01.174582 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/fewer_rows_than.sql
[0m12:52:01.325590 [error] [MainThread]: Encountered an error:
Compilation Error
  unexpected EOF, expected }}, got "max_value }{%- endif %}
  )
  
  select *
  from validation_errors
  
  {% endmacro %}"
[0m12:52:01.328621 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.9428415, "process_user_time": 5.090392, "process_kernel_time": 0.747122, "process_mem_max_rss": "114744", "process_out_blocks": "1880", "command_success": false, "process_in_blocks": "0"}
[0m12:52:01.330548 [debug] [MainThread]: Command `dbt run` failed at 12:52:01.330328 after 1.94 seconds
[0m12:52:01.332072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13ed113390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13ed10c210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13f1a9d590>]}
[0m12:52:01.333569 [debug] [MainThread]: Flushing usage events
[0m13:04:57.568657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc50f45cc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc50f49f850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc50f457d50>]}


============================== 13:04:57.579243 | dd3390a7-f5ce-4ad6-ab30-29089326f46d ==============================
[0m13:04:57.579243 [info ] [MainThread]: Running with dbt=1.7.0
[0m13:04:57.582526 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/app/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /app/dbt', 'send_anonymous_usage_stats': 'True'}
[0m13:04:57.939718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd3390a7-f5ce-4ad6-ab30-29089326f46d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc50f49f8d0>]}
[0m13:04:58.157978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd3390a7-f5ce-4ad6-ab30-29089326f46d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc50f38a810>]}
[0m13:04:58.161586 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m13:04:58.238094 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m13:05:00.216512 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 48 files changed.
[0m13:05:00.218635 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/marts/mart_crypto_hourly_performance.sql
[0m13:05:00.220530 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_query_results_as_dict.sql
[0m13:05:00.222436 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/nullcheck_table.sql
[0m13:05:00.224236 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/equality.sql
[0m13:05:00.229259 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/accepted_range.sql
[0m13:05:00.231897 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/groupby.sql
[0m13:05:00.233905 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/staging/stg_crypto_prices.sql
[0m13:05:00.235617 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/marts/mart_crypto_latest_prices.sql
[0m13:05:00.237299 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/star.sql
[0m13:05:00.238994 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_relations_by_pattern.sql
[0m13:05:00.240854 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/pivot.sql
[0m13:05:00.243514 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/unpivot.sql
[0m13:05:00.245660 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/intermediate/int_crypto_hourly_aggs.sql
[0m13:05:00.247838 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/recency.sql
[0m13:05:00.249985 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/generate_surrogate_key.sql
[0m13:05:00.256473 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/safe_add.sql
[0m13:05:00.259060 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/marts/mart_pipeline_monitoring.sql
[0m13:05:00.261480 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/relationships_where.sql
[0m13:05:00.263882 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/nullcheck.sql
[0m13:05:00.265828 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/not_accepted_values.sql
[0m13:05:00.268016 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/web/get_url_parameter.sql
[0m13:05:00.276311 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_table_types_sql.sql
[0m13:05:00.280687 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/jinja_helpers/_is_ephemeral.sql
[0m13:05:00.282914 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/safe_subtract.sql
[0m13:05:00.284673 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/expression_is_true.sql
[0m13:05:00.286604 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/haversine_distance.sql
[0m13:05:00.295229 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/safe_divide.sql
[0m13:05:00.301731 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/width_bucket.sql
[0m13:05:00.310589 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/not_empty_string.sql
[0m13:05:00.316803 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/surrogate_key.sql
[0m13:05:00.322984 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_single_value.sql
[0m13:05:00.332180 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/mutually_exclusive_ranges.sql
[0m13:05:00.334254 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/sequential_values.sql
[0m13:05:00.336379 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/unique_combination_of_columns.sql
[0m13:05:00.339060 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/fewer_rows_than.sql
[0m13:05:00.343570 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/jinja_helpers/slugify.sql
[0m13:05:00.346440 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/staging/stg_pipeline_runs.sql
[0m13:05:00.349526 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/generate_series.sql
[0m13:05:00.351800 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/not_constant.sql
[0m13:05:00.354130 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_filtered_columns_in_relation.sql
[0m13:05:00.355974 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/union.sql
[0m13:05:00.361526 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/not_null_proportion.sql
[0m13:05:00.364097 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/equal_rowcount.sql
[0m13:05:00.367654 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_relations_by_prefix.sql
[0m13:05:00.369607 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_tables_by_pattern_sql.sql
[0m13:05:00.371227 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/intermediate/int_crypto_daily_aggs.sql
[0m13:05:00.372689 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_tables_by_prefix_sql.sql
[0m13:05:00.374313 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/at_least_one.sql
[0m13:05:00.392478 [error] [MainThread]: Encountered an error:
Compilation Error
  unexpected EOF, expected }}, got "max_value }{%- endif %}
  )
  
  select *
  from validation_errors
  
  {% endmacro %}"
[0m13:05:00.397360 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.9092557, "process_user_time": 8.063991, "process_kernel_time": 1.762397, "process_mem_max_rss": "114520", "process_out_blocks": "1880", "command_success": false, "process_in_blocks": "0"}
[0m13:05:00.399523 [debug] [MainThread]: Command `dbt run` failed at 13:05:00.399276 after 2.91 seconds
[0m13:05:00.401048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc50f45f210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc50f45ff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc510eaf110>]}
[0m13:05:00.403929 [debug] [MainThread]: Flushing usage events
[0m13:13:19.731138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea97982910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea97950b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea979539d0>]}


============================== 13:13:19.735822 | a7847482-17a9-463c-b96a-77251d9fffe3 ==============================
[0m13:13:19.735822 [info ] [MainThread]: Running with dbt=1.7.0
[0m13:13:19.737549 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'debug': 'False', 'warn_error': 'None', 'log_path': '/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /app/dbt', 'send_anonymous_usage_stats': 'True'}
[0m13:13:20.106220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7847482-17a9-463c-b96a-77251d9fffe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea961d1a90>]}
[0m13:13:20.265345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a7847482-17a9-463c-b96a-77251d9fffe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea9624e450>]}
[0m13:13:20.267222 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m13:13:20.316481 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m13:13:22.506568 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 48 files changed.
[0m13:13:22.509098 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/not_null_proportion.sql
[0m13:13:22.511365 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/recency.sql
[0m13:13:22.513572 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/unique_combination_of_columns.sql
[0m13:13:22.516866 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/jinja_helpers/_is_ephemeral.sql
[0m13:13:22.518816 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/safe_divide.sql
[0m13:13:22.521532 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/sequential_values.sql
[0m13:13:22.523657 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/intermediate/int_crypto_hourly_aggs.sql
[0m13:13:22.525726 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/accepted_range.sql
[0m13:13:22.527548 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/relationships_where.sql
[0m13:13:22.529277 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/web/get_url_parameter.sql
[0m13:13:22.531077 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/fewer_rows_than.sql
[0m13:13:22.532911 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_single_value.sql
[0m13:13:22.534521 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/staging/stg_crypto_prices.sql
[0m13:13:22.537104 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/jinja_helpers/slugify.sql
[0m13:13:22.545916 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/marts/mart_crypto_latest_prices.sql
[0m13:13:22.548134 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/safe_add.sql
[0m13:13:22.550463 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/not_empty_string.sql
[0m13:13:22.552948 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/union.sql
[0m13:13:22.560698 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/equal_rowcount.sql
[0m13:13:22.562980 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_relations_by_prefix.sql
[0m13:13:22.566337 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/intermediate/int_crypto_daily_aggs.sql
[0m13:13:22.568701 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/expression_is_true.sql
[0m13:13:22.576629 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/width_bucket.sql
[0m13:13:22.579043 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/groupby.sql
[0m13:13:22.581251 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/marts/mart_crypto_hourly_performance.sql
[0m13:13:22.583795 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/nullcheck.sql
[0m13:13:22.590991 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/not_accepted_values.sql
[0m13:13:22.594947 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_tables_by_pattern_sql.sql
[0m13:13:22.596680 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_relations_by_pattern.sql
[0m13:13:22.598575 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/surrogate_key.sql
[0m13:13:22.600439 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_query_results_as_dict.sql
[0m13:13:22.602105 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/star.sql
[0m13:13:22.604494 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/equality.sql
[0m13:13:22.606338 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/generate_surrogate_key.sql
[0m13:13:22.608886 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/mutually_exclusive_ranges.sql
[0m13:13:22.610609 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/nullcheck_table.sql
[0m13:13:22.612127 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_filtered_columns_in_relation.sql
[0m13:13:22.614330 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/generate_series.sql
[0m13:13:22.616450 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_tables_by_prefix_sql.sql
[0m13:13:22.618696 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/not_constant.sql
[0m13:13:22.621140 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/haversine_distance.sql
[0m13:13:22.623116 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_table_types_sql.sql
[0m13:13:22.624753 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/pivot.sql
[0m13:13:22.626497 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/marts/mart_pipeline_monitoring.sql
[0m13:13:22.628480 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/at_least_one.sql
[0m13:13:22.630208 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/unpivot.sql
[0m13:13:22.631951 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/safe_subtract.sql
[0m13:13:22.634084 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/staging/stg_pipeline_runs.sql
[0m13:13:22.731526 [error] [MainThread]: Encountered an error:
Compilation Error
  unexpected EOF, expected }}, got "max_value }{%- endif %}
  )
  
  select *
  from validation_errors
  
  {% endmacro %}"
[0m13:13:22.734655 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.0926409, "process_user_time": 4.983898, "process_kernel_time": 0.455844, "process_mem_max_rss": "114108", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:13:22.737086 [debug] [MainThread]: Command `dbt run` failed at 13:13:22.736655 after 3.10 seconds
[0m13:13:22.738938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea97947750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea979422d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea9c309490>]}
[0m13:13:22.740697 [debug] [MainThread]: Flushing usage events
[0m13:21:04.334440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3bff1a7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3c14c1450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3bfa46ed0>]}


============================== 13:21:04.346070 | 22a95d33-ac4a-4bf5-9fb4-630ef84eb053 ==============================
[0m13:21:04.346070 [info ] [MainThread]: Running with dbt=1.7.0
[0m13:21:04.348624 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/app', 'log_path': '/app/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /app/dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:21:04.693228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '22a95d33-ac4a-4bf5-9fb4-630ef84eb053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3bf972110>]}
[0m13:21:04.848715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '22a95d33-ac4a-4bf5-9fb4-630ef84eb053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3c003fad0>]}
[0m13:21:04.850722 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m13:21:04.894001 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m13:21:05.946285 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 48 files changed.
[0m13:21:05.947863 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_tables_by_prefix_sql.sql
[0m13:21:05.949620 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/unique_combination_of_columns.sql
[0m13:21:05.951168 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/haversine_distance.sql
[0m13:21:05.952488 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/width_bucket.sql
[0m13:21:05.953878 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/marts/mart_crypto_latest_prices.sql
[0m13:21:05.955285 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/safe_divide.sql
[0m13:21:05.956761 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/expression_is_true.sql
[0m13:21:05.958903 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/unpivot.sql
[0m13:21:05.966974 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/not_empty_string.sql
[0m13:21:05.968576 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/staging/stg_crypto_prices.sql
[0m13:21:05.970412 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_single_value.sql
[0m13:21:05.971891 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_query_results_as_dict.sql
[0m13:21:05.973302 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/equal_rowcount.sql
[0m13:21:05.975078 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/safe_add.sql
[0m13:21:05.976616 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/web/get_url_parameter.sql
[0m13:21:05.978059 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/safe_subtract.sql
[0m13:21:05.979607 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_relations_by_prefix.sql
[0m13:21:05.981228 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/intermediate/int_crypto_daily_aggs.sql
[0m13:21:05.982666 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/marts/mart_pipeline_monitoring.sql
[0m13:21:05.984257 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_tables_by_pattern_sql.sql
[0m13:21:05.985664 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/not_constant.sql
[0m13:21:05.987314 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/equality.sql
[0m13:21:05.988890 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/pivot.sql
[0m13:21:05.990387 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/not_accepted_values.sql
[0m13:21:05.991801 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_relations_by_pattern.sql
[0m13:21:05.993234 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/intermediate/int_crypto_hourly_aggs.sql
[0m13:21:05.994553 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_table_types_sql.sql
[0m13:21:05.996045 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_filtered_columns_in_relation.sql
[0m13:21:05.997264 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/star.sql
[0m13:21:05.998728 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/groupby.sql
[0m13:21:06.000122 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/mutually_exclusive_ranges.sql
[0m13:21:06.001964 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/jinja_helpers/_is_ephemeral.sql
[0m13:21:06.003388 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/relationships_where.sql
[0m13:21:06.005114 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/surrogate_key.sql
[0m13:21:06.006648 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/jinja_helpers/slugify.sql
[0m13:21:06.008651 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/generate_surrogate_key.sql
[0m13:21:06.010556 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/union.sql
[0m13:21:06.012511 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/at_least_one.sql
[0m13:21:06.014482 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/marts/mart_crypto_hourly_performance.sql
[0m13:21:06.016637 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/fewer_rows_than.sql
[0m13:21:06.018993 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/staging/stg_pipeline_runs.sql
[0m13:21:06.021148 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/recency.sql
[0m13:21:06.023560 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/not_null_proportion.sql
[0m13:21:06.025552 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/sequential_values.sql
[0m13:21:06.027647 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/nullcheck.sql
[0m13:21:06.029624 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/nullcheck_table.sql
[0m13:21:06.032018 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/accepted_range.sql
[0m13:21:06.034631 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/generate_series.sql
[0m13:21:06.231559 [error] [MainThread]: Encountered an error:
Compilation Error
  unexpected EOF, expected }}, got "max_value }{%- endif %}
  )
  
  select *
  from validation_errors
  
  {% endmacro %}"
[0m13:21:06.233936 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.9817109, "process_user_time": 7.32076, "process_kernel_time": 0.884249, "process_mem_max_rss": "114736", "process_out_blocks": "1880", "command_success": false, "process_in_blocks": "0"}
[0m13:21:06.235564 [debug] [MainThread]: Command `dbt run` failed at 13:21:06.235353 after 1.98 seconds
[0m13:21:06.237102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3bfa46c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3bfa47e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3bdfe5350>]}
[0m13:21:06.238487 [debug] [MainThread]: Flushing usage events
[0m13:25:08.816445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f566e7206d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f566ed1b610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f566e720650>]}


============================== 13:25:08.828284 | 35b2c6e7-c975-440b-862d-29892ac887a4 ==============================
[0m13:25:08.828284 [info ] [MainThread]: Running with dbt=1.7.0
[0m13:25:08.830038 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'debug': 'False', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir /app/dbt', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:25:09.286900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '35b2c6e7-c975-440b-862d-29892ac887a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f566ced2790>]}
[0m13:25:09.494043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '35b2c6e7-c975-440b-862d-29892ac887a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f566e622950>]}
[0m13:25:09.496891 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m13:25:09.554132 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m13:25:11.257390 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 48 files changed.
[0m13:25:11.262115 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/jinja_helpers/slugify.sql
[0m13:25:11.264839 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/sequential_values.sql
[0m13:25:11.266767 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/not_constant.sql
[0m13:25:11.270661 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_tables_by_prefix_sql.sql
[0m13:25:11.273297 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_query_results_as_dict.sql
[0m13:25:11.284078 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_single_value.sql
[0m13:25:11.296813 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/at_least_one.sql
[0m13:25:11.301040 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/safe_add.sql
[0m13:25:11.303939 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/nullcheck_table.sql
[0m13:25:11.306399 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_table_types_sql.sql
[0m13:25:11.308617 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/staging/stg_pipeline_runs.sql
[0m13:25:11.315503 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/not_empty_string.sql
[0m13:25:11.318823 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/web/get_url_parameter.sql
[0m13:25:11.321674 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/width_bucket.sql
[0m13:25:11.323609 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/not_null_proportion.sql
[0m13:25:11.328628 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/fewer_rows_than.sql
[0m13:25:11.333177 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/unpivot.sql
[0m13:25:11.335983 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/expression_is_true.sql
[0m13:25:11.351398 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/mutually_exclusive_ranges.sql
[0m13:25:11.356838 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/haversine_distance.sql
[0m13:25:11.386378 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/accepted_range.sql
[0m13:25:11.389215 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/union.sql
[0m13:25:11.402118 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/safe_divide.sql
[0m13:25:11.405605 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/safe_subtract.sql
[0m13:25:11.407649 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/marts/mart_crypto_latest_prices.sql
[0m13:25:11.411413 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/recency.sql
[0m13:25:11.414757 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/surrogate_key.sql
[0m13:25:11.423027 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_relations_by_pattern.sql
[0m13:25:11.425995 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/jinja_helpers/_is_ephemeral.sql
[0m13:25:11.434849 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/generate_surrogate_key.sql
[0m13:25:11.437797 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/staging/stg_crypto_prices.sql
[0m13:25:11.440083 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/marts/mart_pipeline_monitoring.sql
[0m13:25:11.442084 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/marts/mart_crypto_hourly_performance.sql
[0m13:25:11.446326 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/star.sql
[0m13:25:11.449569 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/nullcheck.sql
[0m13:25:11.451670 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/unique_combination_of_columns.sql
[0m13:25:11.454154 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/groupby.sql
[0m13:25:11.456619 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/generate_series.sql
[0m13:25:11.458385 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/equality.sql
[0m13:25:11.462936 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/equal_rowcount.sql
[0m13:25:11.464827 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/pivot.sql
[0m13:25:11.466580 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_relations_by_prefix.sql
[0m13:25:11.469399 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/intermediate/int_crypto_hourly_aggs.sql
[0m13:25:11.472338 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/intermediate/int_crypto_daily_aggs.sql
[0m13:25:11.481617 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/not_accepted_values.sql
[0m13:25:11.483628 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/relationships_where.sql
[0m13:25:11.486724 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_tables_by_pattern_sql.sql
[0m13:25:11.490740 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_filtered_columns_in_relation.sql
[0m13:25:11.653166 [error] [MainThread]: Encountered an error:
Compilation Error
  unexpected EOF, expected }}, got "max_value }{%- endif %}
  )
  
  select *
  from validation_errors
  
  {% endmacro %}"
[0m13:25:11.655467 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.9180803, "process_user_time": 10.879983, "process_kernel_time": 3.780907, "process_mem_max_rss": "114764", "process_out_blocks": "1880", "command_success": false, "process_in_blocks": "0"}
[0m13:25:11.656973 [debug] [MainThread]: Command `dbt run` failed at 13:25:11.656777 after 2.92 seconds
[0m13:25:11.658253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56730bd190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f566cbbb350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f566cd23210>]}
[0m13:25:11.660406 [debug] [MainThread]: Flushing usage events
[0m15:52:53.235783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2713d6ca50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27153e6d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2713d43ad0>]}


============================== 15:52:53.284419 | 4c19ef1a-93bc-44fc-96cb-65fd1132ffe5 ==============================
[0m15:52:53.284419 [info ] [MainThread]: Running with dbt=1.7.0
[0m15:52:53.286422 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/app', 'log_path': '/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /app/dbt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:52:55.296127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c19ef1a-93bc-44fc-96cb-65fd1132ffe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2713db2d90>]}
[0m15:52:55.552513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4c19ef1a-93bc-44fc-96cb-65fd1132ffe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f271263ac10>]}
[0m15:52:55.554400 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m15:52:55.603569 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m15:52:57.541503 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 48 files changed.
[0m15:52:57.543106 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/nullcheck_table.sql
[0m15:52:57.544661 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/staging/stg_crypto_prices.sql
[0m15:52:57.545996 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/equality.sql
[0m15:52:57.547221 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/star.sql
[0m15:52:57.548399 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/not_empty_string.sql
[0m15:52:57.549916 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/jinja_helpers/_is_ephemeral.sql
[0m15:52:57.551142 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/safe_add.sql
[0m15:52:57.552307 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/expression_is_true.sql
[0m15:52:57.553494 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/nullcheck.sql
[0m15:52:57.554662 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/not_constant.sql
[0m15:52:57.555974 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_single_value.sql
[0m15:52:57.557478 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_filtered_columns_in_relation.sql
[0m15:52:57.558737 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/surrogate_key.sql
[0m15:52:57.559884 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/pivot.sql
[0m15:52:57.561019 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_query_results_as_dict.sql
[0m15:52:57.562320 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/marts/mart_pipeline_monitoring.sql
[0m15:52:57.563521 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/generate_surrogate_key.sql
[0m15:52:57.564775 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/safe_subtract.sql
[0m15:52:57.565979 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/intermediate/int_crypto_hourly_aggs.sql
[0m15:52:57.567393 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/not_accepted_values.sql
[0m15:52:57.568912 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_relations_by_prefix.sql
[0m15:52:57.570304 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/haversine_distance.sql
[0m15:52:57.571627 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_relations_by_pattern.sql
[0m15:52:57.573227 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/marts/mart_crypto_hourly_performance.sql
[0m15:52:57.574624 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/relationships_where.sql
[0m15:52:57.575941 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/unique_combination_of_columns.sql
[0m15:52:57.577120 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/union.sql
[0m15:52:57.578365 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/width_bucket.sql
[0m15:52:57.579657 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/accepted_range.sql
[0m15:52:57.580806 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/unpivot.sql
[0m15:52:57.582189 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/sequential_values.sql
[0m15:52:57.583456 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_tables_by_prefix_sql.sql
[0m15:52:57.584753 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/web/get_url_parameter.sql
[0m15:52:57.586179 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/generate_series.sql
[0m15:52:57.587431 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/groupby.sql
[0m15:52:57.589241 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/jinja_helpers/slugify.sql
[0m15:52:57.590815 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/safe_divide.sql
[0m15:52:57.592490 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/not_null_proportion.sql
[0m15:52:57.594025 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_table_types_sql.sql
[0m15:52:57.595533 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/fewer_rows_than.sql
[0m15:52:57.596956 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/mutually_exclusive_ranges.sql
[0m15:52:57.598325 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/at_least_one.sql
[0m15:52:57.599797 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/staging/stg_pipeline_runs.sql
[0m15:52:57.601415 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/marts/mart_crypto_latest_prices.sql
[0m15:52:57.602947 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/intermediate/int_crypto_daily_aggs.sql
[0m15:52:57.604636 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/equal_rowcount.sql
[0m15:52:57.605985 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_tables_by_pattern_sql.sql
[0m15:52:57.607389 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/recency.sql
[0m15:52:57.737568 [error] [MainThread]: Encountered an error:
Compilation Error
  unexpected EOF, expected }}, got "max_value }{%- endif %}
  )
  
  select *
  from validation_errors
  
  {% endmacro %}"
[0m15:52:58.058921 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.9211946, "process_user_time": 6.685349, "process_kernel_time": 1.83847, "process_mem_max_rss": "114508", "process_in_blocks": "25392", "process_out_blocks": "1880", "command_success": false}
[0m15:52:58.060955 [debug] [MainThread]: Command `dbt run` failed at 15:52:58.060708 after 4.92 seconds
[0m15:52:58.062820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2713d59a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27123b8310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27188c9710>]}
[0m15:52:58.064490 [debug] [MainThread]: Flushing usage events
[0m15:53:02.327944 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m15:54:01.419127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f73e78310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f73e6fad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f73e6e710>]}


============================== 15:54:01.424018 | 7379888e-2026-42bb-ba15-3ff00058652c ==============================
[0m15:54:01.424018 [info ] [MainThread]: Running with dbt=1.7.0
[0m15:54:01.425644 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'version_check': 'True', 'debug': 'False', 'log_path': '/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /app/dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:54:01.718247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7379888e-2026-42bb-ba15-3ff00058652c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f727a76d0>]}
[0m15:54:01.861670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7379888e-2026-42bb-ba15-3ff00058652c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f727822d0>]}
[0m15:54:01.863574 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m15:54:01.915101 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m15:54:03.730068 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 48 files changed.
[0m15:54:03.732455 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/jinja_helpers/_is_ephemeral.sql
[0m15:54:03.734384 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/not_null_proportion.sql
[0m15:54:03.736227 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_single_value.sql
[0m15:54:03.737619 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/unpivot.sql
[0m15:54:03.739080 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/surrogate_key.sql
[0m15:54:03.740809 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/staging/stg_crypto_prices.sql
[0m15:54:03.742373 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/width_bucket.sql
[0m15:54:03.744167 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_tables_by_pattern_sql.sql
[0m15:54:03.745652 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/nullcheck.sql
[0m15:54:03.747252 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/jinja_helpers/slugify.sql
[0m15:54:03.748932 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/at_least_one.sql
[0m15:54:03.750596 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/nullcheck_table.sql
[0m15:54:03.752390 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/safe_subtract.sql
[0m15:54:03.754089 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/safe_divide.sql
[0m15:54:03.756266 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/marts/mart_crypto_hourly_performance.sql
[0m15:54:03.758481 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/sequential_values.sql
[0m15:54:03.760461 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/marts/mart_crypto_latest_prices.sql
[0m15:54:03.762430 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/groupby.sql
[0m15:54:03.764276 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/mutually_exclusive_ranges.sql
[0m15:54:03.766092 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/expression_is_true.sql
[0m15:54:03.767720 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/union.sql
[0m15:54:03.769586 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/generate_surrogate_key.sql
[0m15:54:03.771137 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/not_empty_string.sql
[0m15:54:03.772481 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/fewer_rows_than.sql
[0m15:54:03.773874 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/equal_rowcount.sql
[0m15:54:03.775354 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/safe_add.sql
[0m15:54:03.776789 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/intermediate/int_crypto_hourly_aggs.sql
[0m15:54:03.778185 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_filtered_columns_in_relation.sql
[0m15:54:03.779598 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/not_accepted_values.sql
[0m15:54:03.781087 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/staging/stg_pipeline_runs.sql
[0m15:54:03.782754 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_tables_by_prefix_sql.sql
[0m15:54:03.784966 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/equality.sql
[0m15:54:03.787814 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/relationships_where.sql
[0m15:54:03.790147 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/unique_combination_of_columns.sql
[0m15:54:03.792769 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/generate_series.sql
[0m15:54:03.794683 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_relations_by_prefix.sql
[0m15:54:03.796491 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/pivot.sql
[0m15:54:03.798453 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/recency.sql
[0m15:54:03.800614 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_table_types_sql.sql
[0m15:54:03.802380 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/haversine_distance.sql
[0m15:54:03.803952 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_query_results_as_dict.sql
[0m15:54:03.805640 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/marts/mart_pipeline_monitoring.sql
[0m15:54:03.807550 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/accepted_range.sql
[0m15:54:03.809544 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/not_constant.sql
[0m15:54:03.811433 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_relations_by_pattern.sql
[0m15:54:03.813295 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/web/get_url_parameter.sql
[0m15:54:03.815114 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/intermediate/int_crypto_daily_aggs.sql
[0m15:54:03.816942 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/star.sql
[0m15:54:04.057612 [error] [MainThread]: Encountered an error:
Compilation Error
  unexpected EOF, expected }}, got "max_value }{%- endif %}
  )
  
  select *
  from validation_errors
  
  {% endmacro %}"
[0m15:54:04.061116 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.7090008, "process_user_time": 4.253127, "process_kernel_time": 0.575611, "process_mem_max_rss": "114580", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:54:04.063177 [debug] [MainThread]: Command `dbt run` failed at 15:54:04.062870 after 2.71 seconds
[0m15:54:04.064853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f73e8e9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f73ec0150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f78851810>]}
[0m15:54:04.066471 [debug] [MainThread]: Flushing usage events
[0m15:54:14.116948 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m16:36:35.544034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29235b9210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29235b3e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f292385c2d0>]}
[0m16:36:35.544068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2200433d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd22002f350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd22007f150>]}


============================== 16:36:35.598498 | ca377f52-3f19-4c52-81b0-8723fb3e9ff1 ==============================
[0m16:36:35.598498 [info ] [MainThread]: Running with dbt=1.7.0


============================== 16:36:35.613507 | 26d532ff-b18e-4975-9e29-1890f7d0b3c3 ==============================
[0m16:36:35.613507 [info ] [MainThread]: Running with dbt=1.7.0
[0m16:36:35.623322 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'version_check': 'True', 'debug': 'False', 'log_path': '/app/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test --project-dir /app/dbt', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:36:35.619417 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/app/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug --project-dir /app/dbt', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:36:35.628017 [info ] [MainThread]: dbt version: 1.7.0
[0m16:36:35.631239 [info ] [MainThread]: python version: 3.11.13
[0m16:36:35.633007 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m16:36:35.635053 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m16:36:37.027002 [info ] [MainThread]: Using profiles dir at /app
[0m16:36:37.028263 [info ] [MainThread]: Using profiles.yml file at /app/profiles.yml
[0m16:36:37.029475 [info ] [MainThread]: Using dbt_project.yml file at /app/dbt/dbt_project.yml
[0m16:36:37.070546 [info ] [MainThread]: adapter type: postgres
[0m16:36:37.072146 [info ] [MainThread]: adapter version: 1.7.0
[0m16:36:37.276907 [info ] [MainThread]: Configuration:
[0m16:36:37.278432 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:36:37.279762 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:36:37.281095 [info ] [MainThread]: Required dependencies:
[0m16:36:37.283616 [debug] [MainThread]: Executing "git --help"
[0m16:36:38.001371 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:36:38.003428 [debug] [MainThread]: STDERR: "b''"
[0m16:36:38.004893 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:36:38.006581 [info ] [MainThread]: Connection:
[0m16:36:38.007969 [info ] [MainThread]:   host: postgres
[0m16:36:38.009993 [info ] [MainThread]:   port: 5432
[0m16:36:38.011492 [info ] [MainThread]:   user: postgres
[0m16:36:38.012987 [info ] [MainThread]:   database: crypto_warehouse
[0m16:36:38.014453 [info ] [MainThread]:   schema: public
[0m16:36:38.016336 [info ] [MainThread]:   connect_timeout: 10
[0m16:36:38.017829 [info ] [MainThread]:   role: None
[0m16:36:38.019387 [info ] [MainThread]:   search_path: None
[0m16:36:38.020890 [info ] [MainThread]:   keepalives_idle: 0
[0m16:36:38.022258 [info ] [MainThread]:   sslmode: None
[0m16:36:38.023612 [info ] [MainThread]:   sslcert: None
[0m16:36:38.024952 [info ] [MainThread]:   sslkey: None
[0m16:36:38.026985 [info ] [MainThread]:   sslrootcert: None
[0m16:36:38.028826 [info ] [MainThread]:   application_name: dbt
[0m16:36:38.030518 [info ] [MainThread]:   retries: 1
[0m16:36:38.032378 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m16:36:38.034302 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m16:36:38.035919 [debug] [MainThread]: Using postgres connection "debug"
[0m16:36:38.037531 [debug] [MainThread]: On debug: select 1 as id
[0m16:36:38.039272 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:36:38.531350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca377f52-3f19-4c52-81b0-8723fb3e9ff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2921d52210>]}
[0m16:36:38.679526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca377f52-3f19-4c52-81b0-8723fb3e9ff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29234e67d0>]}
[0m16:36:38.681659 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m16:36:38.842526 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m16:36:39.327358 [debug] [MainThread]: SQL status: SELECT 1 in 1.0 seconds
[0m16:36:39.383731 [debug] [MainThread]: On debug: Close
[0m16:36:39.394817 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:36:39.399836 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:36:39.601663 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 4.6850963, "process_user_time": 4.184185, "process_kernel_time": 0.462624, "process_mem_max_rss": "111352", "process_in_blocks": "28712", "process_out_blocks": "1072"}
[0m16:36:39.604556 [debug] [MainThread]: Command `dbt debug` succeeded at 16:36:39.604230 after 4.69 seconds
[0m16:36:39.606296 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:36:39.607924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd21e7ffed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd21ff8fb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd22002edd0>]}
[0m16:36:39.609545 [debug] [MainThread]: Flushing usage events
[0m16:36:41.879722 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 48 files changed.
[0m16:36:41.882036 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/equality.sql
[0m16:36:41.884158 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/intermediate/int_crypto_daily_aggs.sql
[0m16:36:41.886158 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/accepted_range.sql
[0m16:36:41.887976 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/groupby.sql
[0m16:36:41.889694 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_tables_by_prefix_sql.sql
[0m16:36:41.892470 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/equal_rowcount.sql
[0m16:36:41.894853 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/safe_subtract.sql
[0m16:36:41.896815 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/pivot.sql
[0m16:36:41.898485 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/nullcheck_table.sql
[0m16:36:41.900177 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/expression_is_true.sql
[0m16:36:41.902636 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/jinja_helpers/_is_ephemeral.sql
[0m16:36:41.904332 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/sequential_values.sql
[0m16:36:41.905869 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/staging/stg_crypto_prices.sql
[0m16:36:41.907503 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/safe_divide.sql
[0m16:36:41.909254 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/at_least_one.sql
[0m16:36:41.911758 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_filtered_columns_in_relation.sql
[0m16:36:41.913900 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/haversine_distance.sql
[0m16:36:41.915614 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/marts/mart_crypto_hourly_performance.sql
[0m16:36:41.917258 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/width_bucket.sql
[0m16:36:41.919298 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/not_accepted_values.sql
[0m16:36:41.921428 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/surrogate_key.sql
[0m16:36:41.923347 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_relations_by_prefix.sql
[0m16:36:41.925197 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_relations_by_pattern.sql
[0m16:36:41.927093 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_table_types_sql.sql
[0m16:36:41.929212 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/unpivot.sql
[0m16:36:41.931781 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/generate_series.sql
[0m16:36:41.933995 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/unique_combination_of_columns.sql
[0m16:36:41.936111 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/mutually_exclusive_ranges.sql
[0m16:36:41.938023 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/intermediate/int_crypto_hourly_aggs.sql
[0m16:36:41.939733 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/marts/mart_crypto_latest_prices.sql
[0m16:36:41.941384 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/fewer_rows_than.sql
[0m16:36:41.943584 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/not_empty_string.sql
[0m16:36:41.946191 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_query_results_as_dict.sql
[0m16:36:41.948555 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/star.sql
[0m16:36:41.950954 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/nullcheck.sql
[0m16:36:41.952935 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_tables_by_pattern_sql.sql
[0m16:36:41.954861 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/safe_add.sql
[0m16:36:41.957014 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/jinja_helpers/slugify.sql
[0m16:36:41.958800 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/not_null_proportion.sql
[0m16:36:41.960896 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/recency.sql
[0m16:36:41.963924 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/generate_surrogate_key.sql
[0m16:36:41.966358 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_single_value.sql
[0m16:36:41.968886 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/union.sql
[0m16:36:41.971285 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/relationships_where.sql
[0m16:36:41.973705 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/not_constant.sql
[0m16:36:41.977215 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/marts/mart_pipeline_monitoring.sql
[0m16:36:41.979695 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/web/get_url_parameter.sql
[0m16:36:41.981811 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/staging/stg_pipeline_runs.sql
[0m16:36:41.990063 [error] [MainThread]: Encountered an error:
Compilation Error
  unexpected EOF, expected }}, got "max_value }{%- endif %}
  )
  
  select *
  from validation_errors
  
  {% endmacro %}"
[0m16:36:41.994551 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 7.077862, "process_user_time": 5.074872, "process_kernel_time": 0.933433, "process_mem_max_rss": "114212", "process_in_blocks": "78528", "process_out_blocks": "1880", "command_success": false}
[0m16:36:41.998936 [debug] [MainThread]: Command `dbt test` failed at 16:36:41.998486 after 7.08 seconds
[0m16:36:42.001573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29235c6d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2927f65690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2927f65190>]}
[0m16:36:42.003576 [debug] [MainThread]: Flushing usage events
[0m16:40:16.018244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa166a2c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa166a30d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa166d6f90>]}


============================== 16:40:16.065210 | a4e49eb9-6b8e-45fa-b97a-e5affd14a63a ==============================
[0m16:40:16.065210 [info ] [MainThread]: Running with dbt=1.7.0
[0m16:40:16.071315 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps --project-dir /app/dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:40:16.343487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a4e49eb9-6b8e-45fa-b97a-e5affd14a63a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa165322d0>]}
[0m16:40:17.599261 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-fnqg7iht'
[0m16:40:17.607383 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:40:18.759817 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:40:18.763282 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m16:40:19.018264 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m16:40:19.041035 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m16:40:33.080821 [info ] [MainThread]: Installed from version 1.1.1
[0m16:40:33.087652 [info ] [MainThread]: Updated version available: 1.3.0
[0m16:40:33.091038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a4e49eb9-6b8e-45fa-b97a-e5affd14a63a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa16533150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa16694710>]}
[0m16:40:33.093274 [info ] [MainThread]: 
[0m16:40:33.097493 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m16:40:33.102395 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 17.21459, "process_user_time": 6.725773, "process_kernel_time": 1.186901, "process_mem_max_rss": "106856", "process_in_blocks": "8", "process_out_blocks": "2080"}
[0m16:40:33.104966 [debug] [MainThread]: Command `dbt deps` succeeded at 16:40:33.104621 after 17.22 seconds
[0m16:40:33.107547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa166d6950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa174fd950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa1b031650>]}
[0m16:40:33.109518 [debug] [MainThread]: Flushing usage events
[0m16:40:37.135085 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m16:43:27.738452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0588bace90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05897c5190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0587d46510>]}


============================== 16:43:27.747681 | 1625a9b9-10c8-41d7-ac4e-991dd288edf6 ==============================
[0m16:43:27.747681 [info ] [MainThread]: Running with dbt=1.7.0
[0m16:43:27.750538 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'debug': 'False', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --project-dir /app/dbt', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:43:27.933614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1625a9b9-10c8-41d7-ac4e-991dd288edf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0587bf7f50>]}
[0m16:43:27.943076 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-rce_f2p7'
[0m16:43:27.944694 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:43:29.071185 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:43:29.074148 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m16:43:29.973817 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m16:43:29.993117 [info ] [MainThread]: Updating lock file in file path: /app/dbt/package-lock.yml
[0m16:43:30.365558 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-hy9_r0i9'
[0m16:43:30.372842 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m16:43:46.665308 [info ] [MainThread]: Installed from version 1.3.0
[0m16:43:46.670431 [info ] [MainThread]: Up to date!
[0m16:43:46.685953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1625a9b9-10c8-41d7-ac4e-991dd288edf6', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0587d8c7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0587d44150>]}
[0m16:43:46.692053 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 19.036795, "process_user_time": 4.167459, "process_kernel_time": 0.820863, "process_mem_max_rss": "106760", "process_out_blocks": "2056", "process_in_blocks": "0"}
[0m16:43:46.797869 [debug] [MainThread]: Command `dbt deps` succeeded at 16:43:46.797448 after 19.14 seconds
[0m16:43:46.808416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f058833fa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05896d5910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0588216810>]}
[0m16:43:46.816805 [debug] [MainThread]: Flushing usage events
[0m16:44:20.322321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f565575b6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5655c164d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56565ad810>]}


============================== 16:44:20.334183 | 6da0be5a-8f7e-4749-ba97-49a6e5c0979c ==============================
[0m16:44:20.334183 [info ] [MainThread]: Running with dbt=1.7.0
[0m16:44:20.336872 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/app/dbt/logs', 'version_check': 'True', 'profiles_dir': '/app', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt docs generate --project-dir /app/dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:44:20.650602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6da0be5a-8f7e-4749-ba97-49a6e5c0979c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f565578dc10>]}
[0m16:44:20.823237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6da0be5a-8f7e-4749-ba97-49a6e5c0979c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5655654310>]}
[0m16:44:20.825180 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m16:44:20.890126 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m16:44:22.703070 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 14 files changed.
[0m16:44:22.704929 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_tables_by_pattern_sql.sql
[0m16:44:22.706546 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/deduplicate.sql
[0m16:44:22.707862 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/not_null_proportion.sql
[0m16:44:22.709127 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/at_least_one.sql
[0m16:44:22.710440 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/intermediate/int_crypto_daily_aggs.sql
[0m16:44:22.711854 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/jinja_helpers/slugify.sql
[0m16:44:22.713300 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/unpivot.sql
[0m16:44:22.717717 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/intermediate/int_crypto_hourly_aggs.sql
[0m16:44:22.719575 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/marts/mart_pipeline_monitoring.sql
[0m16:44:22.721371 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/staging/stg_pipeline_runs.sql
[0m16:44:22.722871 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/marts/mart_crypto_hourly_performance.sql
[0m16:44:22.724323 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/staging/stg_crypto_prices.sql
[0m16:44:22.725726 [debug] [MainThread]: Partial parsing: updated file: crypto_analytics://models/marts/mart_crypto_latest_prices.sql
[0m16:44:22.727002 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/equality.sql
[0m16:44:23.697609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6da0be5a-8f7e-4749-ba97-49a6e5c0979c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5653abd550>]}
[0m16:44:23.710660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6da0be5a-8f7e-4749-ba97-49a6e5c0979c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5653cc3810>]}
[0m16:44:23.713064 [info ] [MainThread]: Found 7 models, 14 tests, 2 sources, 0 exposures, 0 metrics, 519 macros, 0 groups, 0 semantic models
[0m16:44:23.715631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6da0be5a-8f7e-4749-ba97-49a6e5c0979c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5653ad0050>]}
[0m16:44:23.720715 [info ] [MainThread]: 
[0m16:44:23.724631 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:44:23.730439 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse_public_marts'
[0m16:44:23.732343 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse_public_staging'
[0m16:44:23.736883 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse_public_dbt_test__audit'
[0m16:44:23.776007 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_staging"
[0m16:44:23.774764 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_marts"
[0m16:44:23.782364 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_dbt_test__audit"
[0m16:44:23.783869 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: BEGIN
[0m16:44:23.785201 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: BEGIN
[0m16:44:23.786450 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: BEGIN
[0m16:44:23.787647 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:44:23.788755 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:44:23.789904 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:44:23.854387 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:44:23.856049 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:44:23.856941 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:44:23.857846 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_marts"
[0m16:44:23.859149 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_dbt_test__audit"
[0m16:44:23.860381 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_staging"
[0m16:44:23.861887 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_marts"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m16:44:23.864940 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_dbt_test__audit"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'
  
[0m16:44:23.867429 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_staging"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m16:44:30.039042 [debug] [ThreadPool]: SQL status: SELECT 2 in 6.0 seconds
[0m16:44:30.040226 [debug] [ThreadPool]: SQL status: SELECT 14 in 6.0 seconds
[0m16:44:30.041353 [debug] [ThreadPool]: SQL status: SELECT 3 in 6.0 seconds
[0m16:44:30.049538 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: ROLLBACK
[0m16:44:30.065261 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: ROLLBACK
[0m16:44:30.078527 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: ROLLBACK
[0m16:44:30.084496 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: Close
[0m16:44:30.090381 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: Close
[0m16:44:30.093148 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: Close
[0m16:44:30.161727 [debug] [MainThread]: Using postgres connection "master"
[0m16:44:30.174774 [debug] [MainThread]: On master: BEGIN
[0m16:44:30.199630 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:44:30.216682 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:44:30.227631 [debug] [MainThread]: Using postgres connection "master"
[0m16:44:30.265662 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:44:31.581369 [debug] [MainThread]: SQL status: SELECT 1 in 1.0 seconds
[0m16:44:31.585310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6da0be5a-8f7e-4749-ba97-49a6e5c0979c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5653a97d10>]}
[0m16:44:31.588000 [debug] [MainThread]: On master: ROLLBACK
[0m16:44:31.590184 [debug] [MainThread]: On master: Close
[0m16:44:31.592837 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:44:31.599815 [info ] [MainThread]: 
[0m16:44:31.751806 [debug] [Thread-1 (]: Began running node model.crypto_analytics.stg_crypto_prices
[0m16:44:31.752832 [debug] [Thread-2 (]: Began running node model.crypto_analytics.stg_pipeline_runs
[0m16:44:31.783980 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_marts, now model.crypto_analytics.stg_crypto_prices)
[0m16:44:31.789865 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_dbt_test__audit, now model.crypto_analytics.stg_pipeline_runs)
[0m16:44:31.792497 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics.stg_crypto_prices
[0m16:44:31.795713 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics.stg_pipeline_runs
[0m16:44:31.840052 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics.stg_crypto_prices"
[0m16:44:31.850662 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics.stg_pipeline_runs"
[0m16:44:31.894917 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.stg_pipeline_runs (compile): 16:44:31.841459 => 16:44:31.894270
[0m16:44:31.896891 [debug] [Thread-2 (]: Began executing node model.crypto_analytics.stg_pipeline_runs
[0m16:44:31.901314 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.stg_pipeline_runs (execute): 16:44:31.900653 => 16:44:31.900696
[0m16:44:31.910705 [debug] [Thread-2 (]: Finished running node model.crypto_analytics.stg_pipeline_runs
[0m16:44:31.916978 [debug] [Thread-4 (]: Began running node model.crypto_analytics.mart_pipeline_monitoring
[0m16:44:31.918169 [debug] [Thread-3 (]: Began running node test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39
[0m16:44:31.919293 [debug] [Thread-2 (]: Began running node test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e
[0m16:44:31.923029 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.stg_crypto_prices (compile): 16:44:31.797808 => 16:44:31.922417
[0m16:44:31.926540 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.crypto_analytics.mart_pipeline_monitoring'
[0m16:44:31.930288 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_staging, now test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39)
[0m16:44:31.948514 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.stg_pipeline_runs, now test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e)
[0m16:44:31.951352 [debug] [Thread-1 (]: Began executing node model.crypto_analytics.stg_crypto_prices
[0m16:44:31.958800 [debug] [Thread-4 (]: Began compiling node model.crypto_analytics.mart_pipeline_monitoring
[0m16:44:31.961900 [debug] [Thread-3 (]: Began compiling node test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39
[0m16:44:31.964852 [debug] [Thread-2 (]: Began compiling node test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e
[0m16:44:31.967380 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.stg_crypto_prices (execute): 16:44:31.966721 => 16:44:31.966750
[0m16:44:31.984103 [debug] [Thread-4 (]: Writing injected SQL for node "model.crypto_analytics.mart_pipeline_monitoring"
[0m16:45:04.767175 [debug] [Thread-3 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39"
[0m16:45:05.215323 [debug] [Thread-2 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e"
[0m16:45:05.248257 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.stg_crypto_prices
[0m16:45:11.821307 [debug] [Thread-1 (]: Began running node test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd
[0m16:45:12.244919 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.stg_crypto_prices, now test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd)
[0m16:45:12.422847 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd
[0m16:45:12.376892 [debug] [Thread-4 (]: Timing info for model.crypto_analytics.mart_pipeline_monitoring (compile): 16:44:31.975326 => 16:45:12.376198
[0m16:45:12.297168 [debug] [Thread-2 (]: Timing info for test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e (compile): 16:45:05.136372 => 16:45:12.296497
[0m16:45:12.762662 [debug] [Thread-3 (]: Timing info for test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39 (compile): 16:45:04.735675 => 16:45:12.761897
[0m16:45:12.872238 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd"
[0m16:45:13.061313 [debug] [Thread-4 (]: Began executing node model.crypto_analytics.mart_pipeline_monitoring
[0m16:45:13.438661 [debug] [Thread-2 (]: Began executing node test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e
[0m16:45:13.582082 [debug] [Thread-3 (]: Began executing node test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39
[0m16:45:14.210477 [debug] [Thread-4 (]: Timing info for model.crypto_analytics.mart_pipeline_monitoring (execute): 16:45:14.209846 => 16:45:14.209885
[0m16:45:14.268542 [debug] [Thread-2 (]: Timing info for test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e (execute): 16:45:14.267840 => 16:45:14.267874
[0m16:45:14.307018 [debug] [Thread-3 (]: Timing info for test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39 (execute): 16:45:14.306269 => 16:45:14.306302
[0m16:45:14.364739 [debug] [Thread-4 (]: Finished running node model.crypto_analytics.mart_pipeline_monitoring
[0m16:45:14.409725 [debug] [Thread-2 (]: Finished running node test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e
[0m16:45:14.549307 [debug] [Thread-3 (]: Finished running node test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39
[0m16:45:14.560218 [debug] [Thread-1 (]: Timing info for test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd (compile): 16:45:12.841984 => 16:45:14.559564
[0m16:45:14.561475 [debug] [Thread-4 (]: Began running node model.crypto_analytics.int_crypto_daily_aggs
[0m16:45:14.588118 [debug] [Thread-2 (]: Began running node model.crypto_analytics.int_crypto_hourly_aggs
[0m16:45:14.884531 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e, now model.crypto_analytics.int_crypto_hourly_aggs)
[0m16:45:14.696698 [debug] [Thread-1 (]: Began executing node test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd
[0m16:45:14.777646 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.mart_pipeline_monitoring, now model.crypto_analytics.int_crypto_daily_aggs)
[0m16:45:14.648675 [debug] [Thread-3 (]: Began running node model.crypto_analytics.mart_crypto_latest_prices
[0m16:45:14.951729 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics.int_crypto_hourly_aggs
[0m16:45:15.388055 [debug] [Thread-1 (]: Timing info for test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd (execute): 16:45:15.387444 => 16:45:15.387472
[0m16:45:15.502612 [debug] [Thread-4 (]: Began compiling node model.crypto_analytics.int_crypto_daily_aggs
[0m16:45:15.591812 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39, now model.crypto_analytics.mart_crypto_latest_prices)
[0m16:45:15.857351 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics.int_crypto_hourly_aggs"
[0m16:45:16.136669 [debug] [Thread-1 (]: Finished running node test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd
[0m16:45:16.313902 [debug] [Thread-4 (]: Writing injected SQL for node "model.crypto_analytics.int_crypto_daily_aggs"
[0m16:45:16.329121 [debug] [Thread-3 (]: Began compiling node model.crypto_analytics.mart_crypto_latest_prices
[0m16:45:16.388480 [debug] [Thread-1 (]: Began running node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30
[0m16:45:16.452619 [debug] [Thread-3 (]: Writing injected SQL for node "model.crypto_analytics.mart_crypto_latest_prices"
[0m16:45:16.470038 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd, now test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30)
[0m16:45:16.503948 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30
[0m16:45:16.525579 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.int_crypto_hourly_aggs (compile): 16:45:15.837241 => 16:45:16.524959
[0m16:45:16.555279 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30"
[0m16:45:16.569109 [debug] [Thread-4 (]: Timing info for model.crypto_analytics.int_crypto_daily_aggs (compile): 16:45:16.296045 => 16:45:16.568078
[0m16:45:16.610812 [debug] [Thread-2 (]: Finished running node model.crypto_analytics.int_crypto_hourly_aggs
[0m16:45:16.706211 [debug] [Thread-3 (]: Timing info for model.crypto_analytics.mart_crypto_latest_prices (compile): 16:45:16.433487 => 16:45:16.705613
[0m16:45:16.743932 [debug] [Thread-4 (]: Finished running node model.crypto_analytics.int_crypto_daily_aggs
[0m16:45:16.775384 [debug] [Thread-2 (]: Began running node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7
[0m16:45:16.821154 [debug] [Thread-3 (]: Began executing node model.crypto_analytics.mart_crypto_latest_prices
[0m16:45:16.886589 [debug] [Thread-4 (]: Began running node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300
[0m16:45:16.928583 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.int_crypto_hourly_aggs, now test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7)
[0m16:45:16.940070 [debug] [Thread-3 (]: Timing info for model.crypto_analytics.mart_crypto_latest_prices (execute): 16:45:16.939422 => 16:45:16.939454
[0m16:45:16.945133 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.int_crypto_daily_aggs, now test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300)
[0m16:45:16.952819 [debug] [Thread-2 (]: Began compiling node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7
[0m16:45:16.955286 [debug] [Thread-1 (]: Timing info for test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30 (compile): 16:45:16.532211 => 16:45:16.954410
[0m16:45:16.958468 [debug] [Thread-3 (]: Finished running node model.crypto_analytics.mart_crypto_latest_prices
[0m16:45:17.194213 [debug] [Thread-4 (]: Began compiling node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300
[0m16:45:17.222427 [debug] [Thread-2 (]: Writing injected SQL for node "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7"
[0m16:45:17.236425 [debug] [Thread-1 (]: Began executing node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30
[0m16:45:17.244436 [debug] [Thread-3 (]: Began running node test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd
[0m16:45:17.255616 [debug] [Thread-4 (]: Writing injected SQL for node "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300"
[0m16:45:17.276975 [debug] [Thread-1 (]: Timing info for test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30 (execute): 16:45:17.276235 => 16:45:17.276266
[0m16:45:17.280063 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.mart_crypto_latest_prices, now test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd)
[0m16:45:17.294937 [debug] [Thread-1 (]: Finished running node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30
[0m16:45:17.299168 [debug] [Thread-3 (]: Began compiling node test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd
[0m16:45:17.307303 [debug] [Thread-1 (]: Began running node test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5
[0m16:45:17.311229 [debug] [Thread-2 (]: Timing info for test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7 (compile): 16:45:17.196745 => 16:45:17.310406
[0m16:45:17.318737 [debug] [Thread-4 (]: Timing info for test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300 (compile): 16:45:17.246102 => 16:45:17.318080
[0m16:45:17.350030 [debug] [Thread-3 (]: Writing injected SQL for node "test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd"
[0m16:45:17.763744 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30, now test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5)
[0m16:45:17.766070 [debug] [Thread-2 (]: Began executing node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7
[0m16:45:17.774088 [debug] [Thread-4 (]: Began executing node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300
[0m16:45:17.779266 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5
[0m16:45:17.782788 [debug] [Thread-2 (]: Timing info for test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7 (execute): 16:45:17.781997 => 16:45:17.782028
[0m16:45:17.785533 [debug] [Thread-4 (]: Timing info for test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300 (execute): 16:45:17.784812 => 16:45:17.784835
[0m16:45:17.809080 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5"
[0m16:45:17.824654 [debug] [Thread-2 (]: Finished running node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7
[0m16:45:17.826510 [debug] [Thread-3 (]: Timing info for test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd (compile): 16:45:17.312643 => 16:45:17.825435
[0m16:45:17.830601 [debug] [Thread-4 (]: Finished running node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300
[0m16:45:17.836550 [debug] [Thread-2 (]: Began running node test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79
[0m16:45:17.839995 [debug] [Thread-3 (]: Began executing node test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd
[0m16:45:17.845027 [debug] [Thread-4 (]: Began running node test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f
[0m16:45:17.848855 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7, now test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79)
[0m16:45:17.852031 [debug] [Thread-3 (]: Timing info for test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd (execute): 16:45:17.850813 => 16:45:17.850836
[0m16:45:17.855354 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300, now test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f)
[0m16:45:17.856552 [debug] [Thread-1 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5 (compile): 16:45:17.787410 => 16:45:17.855957
[0m16:45:17.859433 [debug] [Thread-2 (]: Began compiling node test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79
[0m16:45:17.863157 [debug] [Thread-3 (]: Finished running node test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd
[0m16:45:17.865245 [debug] [Thread-4 (]: Began compiling node test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f
[0m16:45:17.867537 [debug] [Thread-1 (]: Began executing node test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5
[0m16:45:17.884169 [debug] [Thread-2 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79"
[0m16:45:17.886261 [debug] [Thread-3 (]: Began running node test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf
[0m16:45:17.901887 [debug] [Thread-4 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f"
[0m16:45:17.904254 [debug] [Thread-1 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5 (execute): 16:45:17.903636 => 16:45:17.903662
[0m16:45:17.909029 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd, now test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf)
[0m16:45:17.916562 [debug] [Thread-1 (]: Finished running node test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5
[0m16:45:17.924552 [debug] [Thread-1 (]: Began running node test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a
[0m16:45:17.923299 [debug] [Thread-2 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79 (compile): 16:45:17.869392 => 16:45:17.922577
[0m16:45:17.920562 [debug] [Thread-3 (]: Began compiling node test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf
[0m16:45:17.930102 [debug] [Thread-4 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f (compile): 16:45:17.888716 => 16:45:17.929325
[0m16:45:17.931663 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5, now test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a)
[0m16:45:17.937922 [debug] [Thread-2 (]: Began executing node test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79
[0m16:45:17.949134 [debug] [Thread-3 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf"
[0m16:45:17.951725 [debug] [Thread-4 (]: Began executing node test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f
[0m16:45:17.954848 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a
[0m16:45:17.957843 [debug] [Thread-2 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79 (execute): 16:45:17.957013 => 16:45:17.957036
[0m16:45:17.965296 [debug] [Thread-4 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f (execute): 16:45:17.964669 => 16:45:17.964692
[0m16:45:17.986347 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a"
[0m16:45:17.997786 [debug] [Thread-3 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf (compile): 16:45:17.939661 => 16:45:17.996846
[0m16:45:18.000351 [debug] [Thread-2 (]: Finished running node test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79
[0m16:45:18.006609 [debug] [Thread-4 (]: Finished running node test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f
[0m16:45:18.010821 [debug] [Thread-3 (]: Began executing node test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf
[0m16:45:18.015119 [debug] [Thread-2 (]: Began running node test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438
[0m16:45:18.017465 [debug] [Thread-4 (]: Began running node test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43
[0m16:45:18.024563 [debug] [Thread-3 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf (execute): 16:45:18.023918 => 16:45:18.023941
[0m16:45:18.027207 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79, now test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438)
[0m16:45:18.031880 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f, now test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43)
[0m16:45:18.057116 [debug] [Thread-3 (]: Finished running node test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf
[0m16:45:18.061824 [debug] [Thread-2 (]: Began compiling node test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438
[0m16:45:18.081205 [debug] [Thread-4 (]: Began compiling node test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43
[0m16:45:18.087437 [debug] [Thread-3 (]: Began running node model.crypto_analytics.mart_crypto_hourly_performance
[0m16:45:18.103277 [debug] [Thread-1 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a (compile): 16:45:17.966893 => 16:45:18.102550
[0m16:45:18.119012 [debug] [Thread-2 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438"
[0m16:45:18.171871 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf, now model.crypto_analytics.mart_crypto_hourly_performance)
[0m16:45:18.174096 [debug] [Thread-4 (]: Writing injected SQL for node "test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43"
[0m16:45:18.176366 [debug] [Thread-1 (]: Began executing node test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a
[0m16:45:18.182305 [debug] [Thread-3 (]: Began compiling node model.crypto_analytics.mart_crypto_hourly_performance
[0m16:45:18.187105 [debug] [Thread-1 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a (execute): 16:45:18.186004 => 16:45:18.186029
[0m16:45:18.202196 [debug] [Thread-2 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438 (compile): 16:45:18.089974 => 16:45:18.201510
[0m16:45:18.212895 [debug] [Thread-1 (]: Finished running node test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a
[0m16:45:18.222084 [debug] [Thread-4 (]: Timing info for test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43 (compile): 16:45:18.120828 => 16:45:18.221453
[0m16:45:18.234641 [debug] [Thread-2 (]: Began executing node test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438
[0m16:45:18.250881 [debug] [Thread-3 (]: Writing injected SQL for node "model.crypto_analytics.mart_crypto_hourly_performance"
[0m16:45:18.253536 [debug] [Thread-4 (]: Began executing node test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43
[0m16:45:18.255673 [debug] [Thread-2 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438 (execute): 16:45:18.255064 => 16:45:18.255083
[0m16:45:18.259919 [debug] [Thread-4 (]: Timing info for test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43 (execute): 16:45:18.259011 => 16:45:18.259035
[0m16:45:18.263201 [debug] [Thread-2 (]: Finished running node test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438
[0m16:45:18.266973 [debug] [Thread-4 (]: Finished running node test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43
[0m16:45:18.271331 [debug] [Thread-3 (]: Timing info for model.crypto_analytics.mart_crypto_hourly_performance (compile): 16:45:18.189416 => 16:45:18.270724
[0m16:45:18.273126 [debug] [Thread-3 (]: Began executing node model.crypto_analytics.mart_crypto_hourly_performance
[0m16:45:18.275277 [debug] [Thread-3 (]: Timing info for model.crypto_analytics.mart_crypto_hourly_performance (execute): 16:45:18.274692 => 16:45:18.274713
[0m16:45:18.277829 [debug] [Thread-3 (]: Finished running node model.crypto_analytics.mart_crypto_hourly_performance
[0m16:45:18.281773 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:45:18.283588 [debug] [MainThread]: Connection 'test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a' was properly closed.
[0m16:45:18.285581 [debug] [MainThread]: Connection 'model.crypto_analytics.mart_crypto_hourly_performance' was properly closed.
[0m16:45:18.288980 [debug] [MainThread]: Connection 'test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438' was properly closed.
[0m16:45:18.291532 [debug] [MainThread]: Connection 'test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43' was properly closed.
[0m16:45:18.304396 [debug] [MainThread]: Command end result
[0m16:45:19.310727 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m16:45:19.311977 [info ] [MainThread]: Building catalog
[0m16:45:19.320669 [debug] [ThreadPool]: Acquiring new postgres connection 'crypto_warehouse.information_schema'
[0m16:45:19.338865 [debug] [ThreadPool]: Using postgres connection "crypto_warehouse.information_schema"
[0m16:45:19.340737 [debug] [ThreadPool]: On crypto_warehouse.information_schema: BEGIN
[0m16:45:19.344565 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:45:19.361946 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:45:19.363965 [debug] [ThreadPool]: Using postgres connection "crypto_warehouse.information_schema"
[0m16:45:19.366104 [debug] [ThreadPool]: On crypto_warehouse.information_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "crypto_warehouse.information_schema"} */

    
    

    select
        'crypto_warehouse' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_stg_crypto_prices_price_id')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('dbt_utils_expression_is_true_s_7b822a4db60249ec680888478d412bb7')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('dbt_utils_accepted_range_stg_crypto_prices_price_usd__0')) or (upper(sch.nspname) = upper('public_staging') and
           upper(tbl.relname) = upper('stg_pipeline_runs')) or (upper(sch.nspname) = upper('public_marts') and
           upper(tbl.relname) = upper('mart_crypto_hourly_performance')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_stg_crypto_prices_price_usd')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('unique_stg_crypto_prices_price_id')) or (upper(sch.nspname) = upper('public_marts') and
           upper(tbl.relname) = upper('mart_pipeline_monitoring')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_stg_pipeline_runs_run_id')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_stg_pipeline_runs_status')) or (upper(sch.nspname) = upper('public_marts') and
           upper(tbl.relname) = upper('mart_crypto_latest_prices')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_stg_crypto_prices_volume_24h')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_stg_crypto_prices_extracted_at')) or (upper(sch.nspname) = upper('public_staging') and
           upper(tbl.relname) = upper('stg_crypto_prices')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_stg_crypto_prices_symbol')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_stg_pipeline_runs_stage')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_stg_crypto_prices_market_cap')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('dbt_utils_accepted_range_stg_crypto_prices_market_cap__0')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m16:45:19.496539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa47b7a30d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa47be45a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa47b97af90>]}


============================== 16:45:19.500900 | d4b85dd2-7127-4764-ac54-4229c9bde38a ==============================
[0m16:45:19.500900 [info ] [MainThread]: Running with dbt=1.7.0
[0m16:45:19.502541 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug --project-dir /app/dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:45:19.505755 [info ] [MainThread]: dbt version: 1.7.0
[0m16:45:19.507634 [info ] [MainThread]: python version: 3.11.13
[0m16:45:19.509191 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m16:45:19.510672 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m16:45:19.653283 [info ] [MainThread]: Using profiles dir at /app
[0m16:45:19.658188 [info ] [MainThread]: Using profiles.yml file at /app/profiles.yml
[0m16:45:19.661151 [info ] [MainThread]: Using dbt_project.yml file at /app/dbt/dbt_project.yml
[0m16:45:19.665462 [info ] [MainThread]: adapter type: postgres
[0m16:45:19.667254 [info ] [MainThread]: adapter version: 1.7.0
[0m16:45:19.785874 [info ] [MainThread]: Configuration:
[0m16:45:19.787697 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:45:19.789206 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:45:19.790517 [info ] [MainThread]: Required dependencies:
[0m16:45:19.791838 [debug] [MainThread]: Executing "git --help"
[0m16:45:19.795485 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:45:19.797748 [debug] [MainThread]: STDERR: "b''"
[0m16:45:19.799224 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:45:19.800486 [info ] [MainThread]: Connection:
[0m16:45:19.801867 [info ] [MainThread]:   host: postgres
[0m16:45:19.803163 [info ] [MainThread]:   port: 5432
[0m16:45:19.804380 [info ] [MainThread]:   user: postgres
[0m16:45:19.805684 [info ] [MainThread]:   database: crypto_warehouse
[0m16:45:19.806910 [info ] [MainThread]:   schema: public
[0m16:45:19.808134 [info ] [MainThread]:   connect_timeout: 10
[0m16:45:19.809491 [info ] [MainThread]:   role: None
[0m16:45:19.810712 [info ] [MainThread]:   search_path: None
[0m16:45:19.811936 [info ] [MainThread]:   keepalives_idle: 0
[0m16:45:19.813121 [info ] [MainThread]:   sslmode: None
[0m16:45:19.815941 [info ] [MainThread]:   sslcert: None
[0m16:45:19.817403 [info ] [MainThread]:   sslkey: None
[0m16:45:19.818774 [info ] [MainThread]:   sslrootcert: None
[0m16:45:19.820028 [info ] [MainThread]:   application_name: dbt
[0m16:45:19.821227 [info ] [MainThread]:   retries: 1
[0m16:45:19.822819 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m16:45:19.824532 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m16:45:19.825809 [debug] [MainThread]: Using postgres connection "debug"
[0m16:45:19.827045 [debug] [MainThread]: On debug: select 1 as id
[0m16:45:19.828398 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:45:19.834410 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m16:45:19.836835 [debug] [MainThread]: On debug: Close
[0m16:45:19.838570 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:45:19.840442 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:45:19.842548 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.4128678, "process_user_time": 10.036678, "process_kernel_time": 0.718484, "process_mem_max_rss": "111124", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:45:19.844098 [debug] [MainThread]: Command `dbt debug` succeeded at 16:45:19.843895 after 0.41 seconds
[0m16:45:19.845380 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:45:19.846682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa47b7a2150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa47a10bd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa47a08d390>]}
[0m16:45:19.848057 [debug] [MainThread]: Flushing usage events
[0m16:45:27.670374 [debug] [ThreadPool]: SQL status: SELECT 259 in 8.0 seconds
[0m16:45:27.906151 [debug] [ThreadPool]: On crypto_warehouse.information_schema: ROLLBACK
[0m16:45:28.208571 [debug] [ThreadPool]: On crypto_warehouse.information_schema: Close
[0m16:45:28.351253 [info ] [MainThread]: Catalog written to /app/dbt/target/catalog.json
[0m16:45:28.356978 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 68.12852, "process_user_time": 7.049025, "process_kernel_time": 0.777465, "process_mem_max_rss": "127068", "process_in_blocks": "3944", "process_out_blocks": "1976"}
[0m16:45:28.367708 [debug] [MainThread]: Command `dbt docs generate` succeeded at 16:45:28.367204 after 68.14 seconds
[0m16:45:28.370121 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m16:45:28.372080 [debug] [MainThread]: Connection 'crypto_warehouse.information_schema' was properly closed.
[0m16:45:28.374327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5655c16850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f565a0dc8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f565578d450>]}
[0m16:45:28.404471 [debug] [MainThread]: Flushing usage events
[0m16:46:18.628845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7014c1e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7014c3b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7014c1110>]}


============================== 16:46:19.066097 | b0aa4efd-a5e6-44dd-9b6d-8c494b644956 ==============================
[0m16:46:19.066097 [info ] [MainThread]: Running with dbt=1.7.0
[0m16:46:25.202040 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'debug': 'False', 'warn_error': 'None', 'log_path': '/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt docs serve --project-dir /app/dbt --port 8080', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:46:26.496736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0aa4efd-a5e6-44dd-9b6d-8c494b644956', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6ffd99150>]}
[0m16:46:26.849009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b0aa4efd-a5e6-44dd-9b6d-8c494b644956', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc702b5aed0>]}
[0m16:46:53.235473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe801bf5290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe80208dd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe80208d690>]}


============================== 16:46:53.241034 | 056239aa-d949-46eb-92d0-f3b5fedf6605 ==============================
[0m16:46:53.241034 [info ] [MainThread]: Running with dbt=1.7.0
[0m16:46:53.243080 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/app/dbt/logs', 'profiles_dir': '/app', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug --project-dir /app/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:46:53.246351 [info ] [MainThread]: dbt version: 1.7.0
[0m16:46:53.247832 [info ] [MainThread]: python version: 3.11.13
[0m16:46:53.249181 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m16:46:53.250416 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m16:46:53.542632 [info ] [MainThread]: Using profiles dir at /app
[0m16:46:53.545043 [info ] [MainThread]: Using profiles.yml file at /app/profiles.yml
[0m16:46:53.548091 [info ] [MainThread]: Using dbt_project.yml file at /app/dbt/dbt_project.yml
[0m16:46:53.550434 [info ] [MainThread]: adapter type: postgres
[0m16:46:53.553705 [info ] [MainThread]: adapter version: 1.7.0
[0m16:46:53.770202 [info ] [MainThread]: Configuration:
[0m16:46:53.771805 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:46:53.773259 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:46:53.774753 [info ] [MainThread]: Required dependencies:
[0m16:46:53.776450 [debug] [MainThread]: Executing "git --help"
[0m16:46:53.782162 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:46:53.785026 [debug] [MainThread]: STDERR: "b''"
[0m16:46:53.786648 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:46:53.788304 [info ] [MainThread]: Connection:
[0m16:46:53.792025 [info ] [MainThread]:   host: postgres
[0m16:46:53.793667 [info ] [MainThread]:   port: 5432
[0m16:46:53.795466 [info ] [MainThread]:   user: postgres
[0m16:46:53.796829 [info ] [MainThread]:   database: crypto_warehouse
[0m16:46:53.798122 [info ] [MainThread]:   schema: public
[0m16:46:53.799713 [info ] [MainThread]:   connect_timeout: 10
[0m16:46:53.802085 [info ] [MainThread]:   role: None
[0m16:46:53.804538 [info ] [MainThread]:   search_path: None
[0m16:46:53.805896 [info ] [MainThread]:   keepalives_idle: 0
[0m16:46:53.807311 [info ] [MainThread]:   sslmode: None
[0m16:46:53.808887 [info ] [MainThread]:   sslcert: None
[0m16:46:53.810322 [info ] [MainThread]:   sslkey: None
[0m16:46:53.811635 [info ] [MainThread]:   sslrootcert: None
[0m16:46:53.813197 [info ] [MainThread]:   application_name: dbt
[0m16:46:53.814613 [info ] [MainThread]:   retries: 1
[0m16:46:53.816166 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m16:46:53.821951 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m16:46:53.823965 [debug] [MainThread]: Using postgres connection "debug"
[0m16:46:53.825455 [debug] [MainThread]: On debug: select 1 as id
[0m16:46:53.827881 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:46:53.836638 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m16:46:53.841879 [debug] [MainThread]: On debug: Close
[0m16:46:53.844740 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:46:53.848277 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:46:53.853178 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.68917006, "process_user_time": 4.64892, "process_kernel_time": 0.150288, "process_mem_max_rss": "110960", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:46:53.856862 [debug] [MainThread]: Command `dbt debug` succeeded at 16:46:53.856291 after 0.69 seconds
[0m16:46:53.858902 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:46:53.861293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe801c3bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe801c3b7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe80324aa90>]}
[0m16:46:53.870121 [debug] [MainThread]: Flushing usage events
[0m16:47:03.894607 [error] [MainThread]: Encountered an error:

[0m16:47:04.676126 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 90, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 75, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 197, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 244, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/main.py", line 324, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/serve.py", line 28, in run
    httpd.serve_forever()
  File "/usr/local/lib/python3.11/socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m16:47:04.681228 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 46.177025, "process_user_time": 5.135666, "process_kernel_time": 0.425099, "process_mem_max_rss": "112352", "process_in_blocks": "256", "process_out_blocks": "1880", "command_success": false}
[0m16:47:04.685587 [debug] [MainThread]: Command `dbt docs serve` failed at 16:47:04.685172 after 46.18 seconds
[0m16:47:04.688108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7014d9710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7014cf410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7014bb650>]}
[0m16:47:04.691461 [debug] [MainThread]: Flushing usage events
[0m16:47:54.240676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4efaec6150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4efa9fd850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4efa9fddd0>]}


============================== 16:47:54.258082 | 5966ed76-dbb3-401a-9a3d-0bf691a21c64 ==============================
[0m16:47:54.258082 [info ] [MainThread]: Running with dbt=1.7.0
[0m16:47:54.262290 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'version_check': 'True', 'debug': 'False', 'log_path': '/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate --project-dir /app/dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:47:54.588073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5966ed76-dbb3-401a-9a3d-0bf691a21c64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4efaa071d0>]}
[0m16:47:54.728689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5966ed76-dbb3-401a-9a3d-0bf691a21c64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4efaa071d0>]}
[0m16:47:54.730689 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m16:47:54.786424 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m16:47:56.513854 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:47:56.516424 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:47:56.551054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5966ed76-dbb3-401a-9a3d-0bf691a21c64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ef90039d0>]}
[0m16:47:56.644613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5966ed76-dbb3-401a-9a3d-0bf691a21c64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ef8fcfc10>]}
[0m16:47:56.646537 [info ] [MainThread]: Found 7 models, 14 tests, 2 sources, 0 exposures, 0 metrics, 519 macros, 0 groups, 0 semantic models
[0m16:47:56.650044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5966ed76-dbb3-401a-9a3d-0bf691a21c64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ef8fabd90>]}
[0m16:47:56.660838 [info ] [MainThread]: 
[0m16:47:56.685156 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:47:56.694374 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse_public_marts'
[0m16:47:56.697266 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse_public_staging'
[0m16:47:56.699268 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse_public_dbt_test__audit'
[0m16:47:56.792625 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_marts"
[0m16:47:56.802527 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_staging"
[0m16:47:56.813691 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_dbt_test__audit"
[0m16:47:56.816264 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: BEGIN
[0m16:47:56.820339 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: BEGIN
[0m16:47:56.823125 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: BEGIN
[0m16:47:56.828752 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:47:56.831569 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:47:56.836524 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:47:56.846178 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:47:56.856813 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:47:56.864299 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_marts"
[0m16:47:56.883094 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_staging"
[0m16:47:56.891066 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:47:56.892277 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_marts"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m16:47:56.895456 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_staging"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m16:47:56.898736 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_dbt_test__audit"
[0m16:47:56.908586 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m16:47:56.917184 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m16:47:56.921056 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_dbt_test__audit"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'
  
[0m16:47:56.926274 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: ROLLBACK
[0m16:47:56.932238 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: ROLLBACK
[0m16:47:56.940134 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: Close
[0m16:47:56.941783 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m16:47:56.944319 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: Close
[0m16:47:56.952905 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: ROLLBACK
[0m16:47:56.962314 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: Close
[0m16:47:56.987080 [debug] [MainThread]: Using postgres connection "master"
[0m16:47:56.989305 [debug] [MainThread]: On master: BEGIN
[0m16:47:56.992909 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:47:57.004642 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:47:57.008097 [debug] [MainThread]: Using postgres connection "master"
[0m16:47:57.011000 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:47:57.034188 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m16:47:57.040080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5966ed76-dbb3-401a-9a3d-0bf691a21c64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4efb8d3e10>]}
[0m16:47:57.042643 [debug] [MainThread]: On master: ROLLBACK
[0m16:47:57.045198 [debug] [MainThread]: On master: Close
[0m16:47:57.048217 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:47:57.061480 [info ] [MainThread]: 
[0m16:47:57.095988 [debug] [Thread-1 (]: Began running node model.crypto_analytics.stg_crypto_prices
[0m16:47:57.097283 [debug] [Thread-2 (]: Began running node model.crypto_analytics.stg_pipeline_runs
[0m16:47:57.099928 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_dbt_test__audit, now model.crypto_analytics.stg_crypto_prices)
[0m16:47:57.108848 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_staging, now model.crypto_analytics.stg_pipeline_runs)
[0m16:47:57.115581 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics.stg_crypto_prices
[0m16:47:57.132817 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics.stg_pipeline_runs
[0m16:47:57.170340 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics.stg_crypto_prices"
[0m16:47:57.177395 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics.stg_pipeline_runs"
[0m16:47:57.190242 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.stg_pipeline_runs (compile): 16:47:57.171045 => 16:47:57.188781
[0m16:47:57.193500 [debug] [Thread-2 (]: Began executing node model.crypto_analytics.stg_pipeline_runs
[0m16:47:57.196044 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.stg_crypto_prices (compile): 16:47:57.141780 => 16:47:57.195187
[0m16:47:57.197902 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.stg_pipeline_runs (execute): 16:47:57.197179 => 16:47:57.197220
[0m16:47:57.200385 [debug] [Thread-1 (]: Began executing node model.crypto_analytics.stg_crypto_prices
[0m16:47:57.204524 [debug] [Thread-2 (]: Finished running node model.crypto_analytics.stg_pipeline_runs
[0m16:47:57.207896 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.stg_crypto_prices (execute): 16:47:57.207152 => 16:47:57.207186
[0m16:47:57.211414 [debug] [Thread-4 (]: Began running node model.crypto_analytics.mart_pipeline_monitoring
[0m16:47:57.212534 [debug] [Thread-3 (]: Began running node test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39
[0m16:47:57.213556 [debug] [Thread-2 (]: Began running node test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e
[0m16:47:57.216519 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.stg_crypto_prices
[0m16:47:57.220218 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.crypto_analytics.mart_pipeline_monitoring'
[0m16:47:57.223378 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_marts, now test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39)
[0m16:47:57.227128 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.stg_pipeline_runs, now test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e)
[0m16:47:57.230845 [debug] [Thread-1 (]: Began running node test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd
[0m16:47:57.233750 [debug] [Thread-4 (]: Began compiling node model.crypto_analytics.mart_pipeline_monitoring
[0m16:47:57.237365 [debug] [Thread-3 (]: Began compiling node test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39
[0m16:47:57.239667 [debug] [Thread-2 (]: Began compiling node test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e
[0m16:47:57.243469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.stg_crypto_prices, now test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd)
[0m16:47:57.255194 [debug] [Thread-4 (]: Writing injected SQL for node "model.crypto_analytics.mart_pipeline_monitoring"
[0m16:47:57.319024 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd
[0m16:47:57.321476 [debug] [Thread-3 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39"
[0m16:47:57.325713 [debug] [Thread-2 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e"
[0m16:47:57.342337 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd"
[0m16:47:57.350690 [debug] [Thread-4 (]: Timing info for model.crypto_analytics.mart_pipeline_monitoring (compile): 16:47:57.245914 => 16:47:57.349870
[0m16:47:57.359305 [debug] [Thread-4 (]: Began executing node model.crypto_analytics.mart_pipeline_monitoring
[0m16:47:57.360783 [debug] [Thread-3 (]: Timing info for test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39 (compile): 16:47:57.257138 => 16:47:57.360110
[0m16:47:57.363592 [debug] [Thread-4 (]: Timing info for model.crypto_analytics.mart_pipeline_monitoring (execute): 16:47:57.362793 => 16:47:57.362833
[0m16:47:57.364977 [debug] [Thread-1 (]: Timing info for test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd (compile): 16:47:57.329165 => 16:47:57.364198
[0m16:47:57.366481 [debug] [Thread-2 (]: Timing info for test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e (compile): 16:47:57.289068 => 16:47:57.365913
[0m16:47:57.371129 [debug] [Thread-3 (]: Began executing node test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39
[0m16:47:57.375880 [debug] [Thread-4 (]: Finished running node model.crypto_analytics.mart_pipeline_monitoring
[0m16:47:57.378193 [debug] [Thread-1 (]: Began executing node test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd
[0m16:47:57.379997 [debug] [Thread-2 (]: Began executing node test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e
[0m16:47:57.381939 [debug] [Thread-3 (]: Timing info for test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39 (execute): 16:47:57.381507 => 16:47:57.381529
[0m16:47:57.384361 [debug] [Thread-4 (]: Began running node model.crypto_analytics.int_crypto_daily_aggs
[0m16:47:57.389927 [debug] [Thread-1 (]: Timing info for test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd (execute): 16:47:57.389131 => 16:47:57.389168
[0m16:47:57.392737 [debug] [Thread-2 (]: Timing info for test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e (execute): 16:47:57.391969 => 16:47:57.391998
[0m16:47:57.395943 [debug] [Thread-3 (]: Finished running node test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39
[0m16:47:57.397972 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.mart_pipeline_monitoring, now model.crypto_analytics.int_crypto_daily_aggs)
[0m16:47:57.401000 [debug] [Thread-1 (]: Finished running node test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd
[0m16:47:57.406481 [debug] [Thread-2 (]: Finished running node test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e
[0m16:47:57.408418 [debug] [Thread-3 (]: Began running node model.crypto_analytics.int_crypto_hourly_aggs
[0m16:47:57.410405 [debug] [Thread-4 (]: Began compiling node model.crypto_analytics.int_crypto_daily_aggs
[0m16:47:57.412329 [debug] [Thread-1 (]: Began running node model.crypto_analytics.mart_crypto_latest_prices
[0m16:47:57.414773 [debug] [Thread-2 (]: Began running node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30
[0m16:47:57.416976 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39, now model.crypto_analytics.int_crypto_hourly_aggs)
[0m16:47:57.428599 [debug] [Thread-4 (]: Writing injected SQL for node "model.crypto_analytics.int_crypto_daily_aggs"
[0m16:47:57.430478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd, now model.crypto_analytics.mart_crypto_latest_prices)
[0m16:47:57.432747 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e, now test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30)
[0m16:47:57.438238 [debug] [Thread-3 (]: Began compiling node model.crypto_analytics.int_crypto_hourly_aggs
[0m16:47:57.442084 [debug] [Thread-1 (]: Began compiling node model.crypto_analytics.mart_crypto_latest_prices
[0m16:47:57.444186 [debug] [Thread-2 (]: Began compiling node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30
[0m16:47:57.456476 [debug] [Thread-3 (]: Writing injected SQL for node "model.crypto_analytics.int_crypto_hourly_aggs"
[0m16:47:57.474707 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_analytics.mart_crypto_latest_prices"
[0m16:47:57.483944 [debug] [Thread-4 (]: Timing info for model.crypto_analytics.int_crypto_daily_aggs (compile): 16:47:57.421514 => 16:47:57.483087
[0m16:47:57.500968 [debug] [Thread-2 (]: Writing injected SQL for node "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30"
[0m16:47:57.509736 [debug] [Thread-4 (]: Finished running node model.crypto_analytics.int_crypto_daily_aggs
[0m16:47:57.521739 [debug] [Thread-4 (]: Began running node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7
[0m16:47:57.526101 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.int_crypto_daily_aggs, now test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7)
[0m16:47:57.527530 [debug] [Thread-3 (]: Timing info for model.crypto_analytics.int_crypto_hourly_aggs (compile): 16:47:57.446126 => 16:47:57.526842
[0m16:47:57.529268 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.mart_crypto_latest_prices (compile): 16:47:57.457807 => 16:47:57.528548
[0m16:47:57.530701 [debug] [Thread-4 (]: Began compiling node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7
[0m16:47:57.534641 [debug] [Thread-3 (]: Finished running node model.crypto_analytics.int_crypto_hourly_aggs
[0m16:47:57.537081 [debug] [Thread-2 (]: Timing info for test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30 (compile): 16:47:57.477612 => 16:47:57.536415
[0m16:47:57.538384 [debug] [Thread-1 (]: Began executing node model.crypto_analytics.mart_crypto_latest_prices
[0m16:47:57.548102 [debug] [Thread-4 (]: Writing injected SQL for node "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7"
[0m16:47:57.549860 [debug] [Thread-3 (]: Began running node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300
[0m16:47:57.553521 [debug] [Thread-2 (]: Began executing node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30
[0m16:47:57.555918 [debug] [Thread-1 (]: Timing info for model.crypto_analytics.mart_crypto_latest_prices (execute): 16:47:57.555285 => 16:47:57.555311
[0m16:47:57.559872 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.int_crypto_hourly_aggs, now test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300)
[0m16:47:57.563319 [debug] [Thread-2 (]: Timing info for test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30 (execute): 16:47:57.562361 => 16:47:57.562393
[0m16:47:57.567179 [debug] [Thread-1 (]: Finished running node model.crypto_analytics.mart_crypto_latest_prices
[0m16:47:57.569556 [debug] [Thread-3 (]: Began compiling node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300
[0m16:47:57.573190 [debug] [Thread-2 (]: Finished running node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30
[0m16:47:57.575719 [debug] [Thread-1 (]: Began running node test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd
[0m16:47:57.577096 [debug] [Thread-4 (]: Timing info for test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7 (compile): 16:47:57.539800 => 16:47:57.576467
[0m16:47:57.593591 [debug] [Thread-2 (]: Began running node test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5
[0m16:47:57.592575 [debug] [Thread-3 (]: Writing injected SQL for node "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300"
[0m16:47:57.596515 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_analytics.mart_crypto_latest_prices, now test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd)
[0m16:47:57.598676 [debug] [Thread-4 (]: Began executing node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7
[0m16:47:57.603395 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30, now test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5)
[0m16:47:57.607143 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd
[0m16:47:57.609702 [debug] [Thread-4 (]: Timing info for test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7 (execute): 16:47:57.608915 => 16:47:57.608938
[0m16:47:57.612781 [debug] [Thread-2 (]: Began compiling node test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5
[0m16:47:57.648089 [debug] [Thread-3 (]: Timing info for test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300 (compile): 16:47:57.578296 => 16:47:57.647338
[0m16:47:57.650700 [debug] [Thread-4 (]: Finished running node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7
[0m16:47:57.644695 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd"
[0m16:47:57.680904 [debug] [Thread-2 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5"
[0m16:47:57.681763 [debug] [Thread-3 (]: Began executing node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300
[0m16:47:57.684015 [debug] [Thread-4 (]: Began running node test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79
[0m16:47:57.689913 [debug] [Thread-3 (]: Timing info for test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300 (execute): 16:47:57.689190 => 16:47:57.689214
[0m16:47:57.693439 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7, now test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79)
[0m16:47:57.700093 [debug] [Thread-3 (]: Finished running node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300
[0m16:47:57.705928 [debug] [Thread-1 (]: Timing info for test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd (compile): 16:47:57.616892 => 16:47:57.705286
[0m16:47:57.707539 [debug] [Thread-4 (]: Began compiling node test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79
[0m16:47:57.710522 [debug] [Thread-3 (]: Began running node test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f
[0m16:47:57.711908 [debug] [Thread-2 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5 (compile): 16:47:57.669890 => 16:47:57.711334
[0m16:47:57.713973 [debug] [Thread-1 (]: Began executing node test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd
[0m16:47:57.724962 [debug] [Thread-4 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79"
[0m16:47:57.726762 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300, now test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f)
[0m16:47:57.729013 [debug] [Thread-2 (]: Began executing node test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5
[0m16:47:57.731467 [debug] [Thread-1 (]: Timing info for test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd (execute): 16:47:57.730924 => 16:47:57.730945
[0m16:47:57.737197 [debug] [Thread-3 (]: Began compiling node test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f
[0m16:47:57.739770 [debug] [Thread-2 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5 (execute): 16:47:57.739065 => 16:47:57.739090
[0m16:47:57.742677 [debug] [Thread-1 (]: Finished running node test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd
[0m16:47:57.758997 [debug] [Thread-3 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f"
[0m16:47:57.762519 [debug] [Thread-2 (]: Finished running node test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5
[0m16:47:57.763327 [debug] [Thread-4 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79 (compile): 16:47:57.715672 => 16:47:57.762957
[0m16:47:57.764977 [debug] [Thread-1 (]: Began running node test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf
[0m16:47:57.769950 [debug] [Thread-2 (]: Began running node test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a
[0m16:47:57.772390 [debug] [Thread-4 (]: Began executing node test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79
[0m16:47:57.775131 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd, now test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf)
[0m16:47:57.777978 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5, now test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a)
[0m16:47:57.804831 [debug] [Thread-4 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79 (execute): 16:47:57.803907 => 16:47:57.803949
[0m16:47:57.806487 [debug] [Thread-3 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f (compile): 16:47:57.744893 => 16:47:57.805800
[0m16:47:57.808001 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf
[0m16:47:57.809736 [debug] [Thread-2 (]: Began compiling node test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a
[0m16:47:57.813370 [debug] [Thread-4 (]: Finished running node test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79
[0m16:47:57.815112 [debug] [Thread-3 (]: Began executing node test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f
[0m16:47:57.920942 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf"
[0m16:47:57.933744 [debug] [Thread-2 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a"
[0m16:47:57.949198 [debug] [Thread-4 (]: Began running node test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438
[0m16:47:57.972573 [debug] [Thread-3 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f (execute): 16:47:57.965409 => 16:47:57.965435
[0m16:47:57.979159 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79, now test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438)
[0m16:47:57.983289 [debug] [Thread-3 (]: Finished running node test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f
[0m16:47:57.988694 [debug] [Thread-4 (]: Began compiling node test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438
[0m16:47:57.993372 [debug] [Thread-2 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a (compile): 16:47:57.922824 => 16:47:57.992223
[0m16:47:57.994710 [debug] [Thread-3 (]: Began running node test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43
[0m16:47:57.995787 [debug] [Thread-1 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf (compile): 16:47:57.816566 => 16:47:57.995249
[0m16:47:58.009033 [debug] [Thread-4 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438"
[0m16:47:58.010771 [debug] [Thread-2 (]: Began executing node test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a
[0m16:47:58.013504 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f, now test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43)
[0m16:47:58.015773 [debug] [Thread-1 (]: Began executing node test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf
[0m16:47:58.024461 [debug] [Thread-2 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a (execute): 16:47:58.023458 => 16:47:58.023494
[0m16:47:58.026691 [debug] [Thread-3 (]: Began compiling node test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43
[0m16:47:58.029220 [debug] [Thread-1 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf (execute): 16:47:58.028457 => 16:47:58.028480
[0m16:47:58.032595 [debug] [Thread-2 (]: Finished running node test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a
[0m16:47:58.046965 [debug] [Thread-4 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438 (compile): 16:47:57.997289 => 16:47:58.046366
[0m16:47:58.076332 [debug] [Thread-1 (]: Finished running node test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf
[0m16:47:58.078343 [debug] [Thread-3 (]: Writing injected SQL for node "test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43"
[0m16:47:58.080720 [debug] [Thread-2 (]: Began running node model.crypto_analytics.mart_crypto_hourly_performance
[0m16:47:58.082461 [debug] [Thread-4 (]: Began executing node test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438
[0m16:47:58.094971 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a, now model.crypto_analytics.mart_crypto_hourly_performance)
[0m16:47:58.097553 [debug] [Thread-4 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438 (execute): 16:47:58.096736 => 16:47:58.096757
[0m16:47:58.104475 [debug] [Thread-2 (]: Began compiling node model.crypto_analytics.mart_crypto_hourly_performance
[0m16:47:58.108847 [debug] [Thread-4 (]: Finished running node test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438
[0m16:47:58.118062 [debug] [Thread-3 (]: Timing info for test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43 (compile): 16:47:58.041070 => 16:47:58.117391
[0m16:47:58.183093 [debug] [Thread-2 (]: Writing injected SQL for node "model.crypto_analytics.mart_crypto_hourly_performance"
[0m16:47:58.184548 [debug] [Thread-3 (]: Began executing node test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43
[0m16:47:58.193567 [debug] [Thread-3 (]: Timing info for test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43 (execute): 16:47:58.192884 => 16:47:58.192910
[0m16:47:58.197616 [debug] [Thread-3 (]: Finished running node test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43
[0m16:47:58.226981 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.mart_crypto_hourly_performance (compile): 16:47:58.112133 => 16:47:58.226161
[0m16:47:58.229105 [debug] [Thread-2 (]: Began executing node model.crypto_analytics.mart_crypto_hourly_performance
[0m16:47:58.231296 [debug] [Thread-2 (]: Timing info for model.crypto_analytics.mart_crypto_hourly_performance (execute): 16:47:58.230639 => 16:47:58.230660
[0m16:47:58.236860 [debug] [Thread-2 (]: Finished running node model.crypto_analytics.mart_crypto_hourly_performance
[0m16:47:58.243603 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:47:58.247198 [debug] [MainThread]: Connection 'test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43' was properly closed.
[0m16:47:58.250898 [debug] [MainThread]: Connection 'model.crypto_analytics.mart_crypto_hourly_performance' was properly closed.
[0m16:47:58.252850 [debug] [MainThread]: Connection 'test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf' was properly closed.
[0m16:47:58.254646 [debug] [MainThread]: Connection 'test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438' was properly closed.
[0m16:47:58.276920 [debug] [MainThread]: Command end result
[0m16:47:58.358226 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m16:47:58.359873 [info ] [MainThread]: Building catalog
[0m16:47:58.368535 [debug] [ThreadPool]: Acquiring new postgres connection 'crypto_warehouse.information_schema'
[0m16:47:58.389640 [debug] [ThreadPool]: Using postgres connection "crypto_warehouse.information_schema"
[0m16:47:58.392570 [debug] [ThreadPool]: On crypto_warehouse.information_schema: BEGIN
[0m16:47:58.395069 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:47:58.405304 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:47:58.408254 [debug] [ThreadPool]: Using postgres connection "crypto_warehouse.information_schema"
[0m16:47:58.417374 [debug] [ThreadPool]: On crypto_warehouse.information_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "crypto_warehouse.information_schema"} */

    
    

    select
        'crypto_warehouse' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_stg_crypto_prices_symbol')) or (upper(sch.nspname) = upper('public_staging') and
           upper(tbl.relname) = upper('stg_pipeline_runs')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_stg_crypto_prices_volume_24h')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('dbt_utils_expression_is_true_s_7b822a4db60249ec680888478d412bb7')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('unique_stg_crypto_prices_price_id')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('dbt_utils_accepted_range_stg_crypto_prices_market_cap__0')) or (upper(sch.nspname) = upper('public_marts') and
           upper(tbl.relname) = upper('mart_pipeline_monitoring')) or (upper(sch.nspname) = upper('public_marts') and
           upper(tbl.relname) = upper('mart_crypto_hourly_performance')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_stg_crypto_prices_price_id')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_stg_pipeline_runs_status')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('dbt_utils_accepted_range_stg_crypto_prices_price_usd__0')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_stg_crypto_prices_price_usd')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_stg_pipeline_runs_run_id')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_stg_crypto_prices_market_cap')) or (upper(sch.nspname) = upper('public_marts') and
           upper(tbl.relname) = upper('mart_crypto_latest_prices')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_stg_crypto_prices_extracted_at')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_stg_pipeline_runs_stage')) or (upper(sch.nspname) = upper('public_staging') and
           upper(tbl.relname) = upper('stg_crypto_prices')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m16:47:58.439413 [debug] [ThreadPool]: SQL status: SELECT 259 in 0.0 seconds
[0m16:47:58.485743 [debug] [ThreadPool]: On crypto_warehouse.information_schema: ROLLBACK
[0m16:47:58.492473 [debug] [ThreadPool]: On crypto_warehouse.information_schema: Close
[0m16:47:58.622496 [info ] [MainThread]: Catalog written to /app/dbt/target/catalog.json
[0m16:47:58.628259 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 4.6631384, "process_user_time": 6.90512, "process_kernel_time": 0.677173, "process_mem_max_rss": "122224", "process_out_blocks": "1976", "process_in_blocks": "0"}
[0m16:47:58.630136 [debug] [MainThread]: Command `dbt docs generate` succeeded at 16:47:58.629912 after 4.67 seconds
[0m16:47:58.632334 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m16:47:58.638020 [debug] [MainThread]: Connection 'crypto_warehouse.information_schema' was properly closed.
[0m16:47:58.640237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4efbe1e950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4eff390910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4eff256dd0>]}
[0m16:47:58.642285 [debug] [MainThread]: Flushing usage events
[0m16:48:31.135430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe16f975210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe170800e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe16f975350>]}


============================== 16:48:31.640200 | fb7cc303-e276-4fc6-8375-255e5b8a545d ==============================
[0m16:48:31.640200 [info ] [MainThread]: Running with dbt=1.7.0
[0m16:48:31.646297 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve --project-dir /app/dbt --port 8080', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:48:32.534560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb7cc303-e276-4fc6-8375-255e5b8a545d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe16e256410>]}
[0m16:48:32.740138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb7cc303-e276-4fc6-8375-255e5b8a545d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe16e22b290>]}
[0m16:49:01.973558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd57a5d0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd57f09b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd57a5cc10>]}


============================== 16:49:01.990815 | 679e2d94-e476-4aee-a230-aed59953d7b7 ==============================
[0m16:49:01.990815 [info ] [MainThread]: Running with dbt=1.7.0
[0m16:49:01.992941 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug --project-dir /app/dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:49:01.997489 [info ] [MainThread]: dbt version: 1.7.0
[0m16:49:01.999231 [info ] [MainThread]: python version: 3.11.13
[0m16:49:02.001984 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m16:49:02.004465 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m16:49:02.186696 [info ] [MainThread]: Using profiles dir at /app
[0m16:49:02.189346 [info ] [MainThread]: Using profiles.yml file at /app/profiles.yml
[0m16:49:02.191135 [info ] [MainThread]: Using dbt_project.yml file at /app/dbt/dbt_project.yml
[0m16:49:02.194833 [info ] [MainThread]: adapter type: postgres
[0m16:49:02.197072 [info ] [MainThread]: adapter version: 1.7.0
[0m16:49:02.379948 [info ] [MainThread]: Configuration:
[0m16:49:02.381515 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:49:02.383084 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:49:02.384606 [info ] [MainThread]: Required dependencies:
[0m16:49:02.388300 [debug] [MainThread]: Executing "git --help"
[0m16:49:02.393079 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:49:02.396044 [debug] [MainThread]: STDERR: "b''"
[0m16:49:02.397532 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:49:02.399181 [info ] [MainThread]: Connection:
[0m16:49:02.400568 [info ] [MainThread]:   host: postgres
[0m16:49:02.401903 [info ] [MainThread]:   port: 5432
[0m16:49:02.403205 [info ] [MainThread]:   user: postgres
[0m16:49:02.404548 [info ] [MainThread]:   database: crypto_warehouse
[0m16:49:02.406053 [info ] [MainThread]:   schema: public
[0m16:49:02.407617 [info ] [MainThread]:   connect_timeout: 10
[0m16:49:02.410223 [info ] [MainThread]:   role: None
[0m16:49:02.412779 [info ] [MainThread]:   search_path: None
[0m16:49:02.414494 [info ] [MainThread]:   keepalives_idle: 0
[0m16:49:02.415883 [info ] [MainThread]:   sslmode: None
[0m16:49:02.417225 [info ] [MainThread]:   sslcert: None
[0m16:49:02.418754 [info ] [MainThread]:   sslkey: None
[0m16:49:02.420312 [info ] [MainThread]:   sslrootcert: None
[0m16:49:02.421996 [info ] [MainThread]:   application_name: dbt
[0m16:49:02.423311 [info ] [MainThread]:   retries: 1
[0m16:49:02.424686 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m16:49:02.428498 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m16:49:02.430074 [debug] [MainThread]: Using postgres connection "debug"
[0m16:49:02.431357 [debug] [MainThread]: On debug: select 1 as id
[0m16:49:02.432641 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:49:02.440179 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m16:49:02.445289 [debug] [MainThread]: On debug: Close
[0m16:49:02.447906 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:49:02.450426 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:49:02.452878 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.68954, "process_user_time": 4.732283, "process_kernel_time": 0.229625, "process_mem_max_rss": "110988", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:49:02.454648 [debug] [MainThread]: Command `dbt debug` succeeded at 16:49:02.454416 after 0.69 seconds
[0m16:49:02.456065 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:49:02.460328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd57ab7dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd57ab7e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd57ad4310>]}
[0m16:49:02.462709 [debug] [MainThread]: Flushing usage events
[0m16:49:43.259787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7c17aab10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7c1c61b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7c17ab390>]}


============================== 16:49:43.273834 | d7e1c6b0-6f8a-4580-b3b2-b0611365d984 ==============================
[0m16:49:43.273834 [info ] [MainThread]: Running with dbt=1.7.0
[0m16:49:43.276214 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'debug': 'False', 'warn_error': 'None', 'log_path': '/app/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug --project-dir /app/dbt', 'send_anonymous_usage_stats': 'True'}
[0m16:49:43.279584 [info ] [MainThread]: dbt version: 1.7.0
[0m16:49:43.283159 [info ] [MainThread]: python version: 3.11.13
[0m16:49:43.285263 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m16:49:43.287289 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m16:49:43.433879 [info ] [MainThread]: Using profiles dir at /app
[0m16:49:43.435611 [info ] [MainThread]: Using profiles.yml file at /app/profiles.yml
[0m16:49:43.437065 [info ] [MainThread]: Using dbt_project.yml file at /app/dbt/dbt_project.yml
[0m16:49:43.438790 [info ] [MainThread]: adapter type: postgres
[0m16:49:43.440321 [info ] [MainThread]: adapter version: 1.7.0
[0m16:49:43.566697 [info ] [MainThread]: Configuration:
[0m16:49:43.568237 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:49:43.569663 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:49:43.570983 [info ] [MainThread]: Required dependencies:
[0m16:49:43.572301 [debug] [MainThread]: Executing "git --help"
[0m16:49:43.576140 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:49:43.577830 [debug] [MainThread]: STDERR: "b''"
[0m16:49:43.580890 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:49:43.582673 [info ] [MainThread]: Connection:
[0m16:49:43.584174 [info ] [MainThread]:   host: postgres
[0m16:49:43.585536 [info ] [MainThread]:   port: 5432
[0m16:49:43.586763 [info ] [MainThread]:   user: postgres
[0m16:49:43.588109 [info ] [MainThread]:   database: crypto_warehouse
[0m16:49:43.589456 [info ] [MainThread]:   schema: public
[0m16:49:43.590927 [info ] [MainThread]:   connect_timeout: 10
[0m16:49:43.592501 [info ] [MainThread]:   role: None
[0m16:49:43.593783 [info ] [MainThread]:   search_path: None
[0m16:49:43.595561 [info ] [MainThread]:   keepalives_idle: 0
[0m16:49:43.596888 [info ] [MainThread]:   sslmode: None
[0m16:49:43.598137 [info ] [MainThread]:   sslcert: None
[0m16:49:43.599425 [info ] [MainThread]:   sslkey: None
[0m16:49:43.601184 [info ] [MainThread]:   sslrootcert: None
[0m16:49:43.602561 [info ] [MainThread]:   application_name: dbt
[0m16:49:43.604873 [info ] [MainThread]:   retries: 1
[0m16:49:43.607136 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m16:49:43.608782 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m16:49:43.610198 [debug] [MainThread]: Using postgres connection "debug"
[0m16:49:43.611730 [debug] [MainThread]: On debug: select 1 as id
[0m16:49:43.613081 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:49:43.620387 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m16:49:43.623446 [debug] [MainThread]: On debug: Close
[0m16:49:43.625700 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:49:43.628410 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:49:43.631989 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.44719332, "process_user_time": 8.933515, "process_kernel_time": 0.287515, "process_mem_max_rss": "111288", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:49:43.640876 [debug] [MainThread]: Command `dbt debug` succeeded at 16:49:43.640513 after 0.46 seconds
[0m16:49:43.644037 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:49:43.646243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7c2c71810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7c60da890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7bff1c610>]}
[0m16:49:43.648939 [debug] [MainThread]: Flushing usage events
[0m16:50:19.624407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f491c8f4b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f491c8f46d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f491c8f69d0>]}


============================== 16:50:19.631920 | bbf82b41-9acb-4ef7-9e15-ae69e2b17ad7 ==============================
[0m16:50:19.631920 [info ] [MainThread]: Running with dbt=1.7.0
[0m16:50:19.634749 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/app', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug --project-dir /app/dbt', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:50:19.638102 [info ] [MainThread]: dbt version: 1.7.0
[0m16:50:19.640870 [info ] [MainThread]: python version: 3.11.13
[0m16:50:19.642678 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m16:50:19.644639 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m16:50:19.920931 [info ] [MainThread]: Using profiles dir at /app
[0m16:50:19.923269 [info ] [MainThread]: Using profiles.yml file at /app/profiles.yml
[0m16:50:19.926727 [info ] [MainThread]: Using dbt_project.yml file at /app/dbt/dbt_project.yml
[0m16:50:19.929284 [info ] [MainThread]: adapter type: postgres
[0m16:50:19.931310 [info ] [MainThread]: adapter version: 1.7.0
[0m16:50:20.186055 [info ] [MainThread]: Configuration:
[0m16:50:20.189722 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:50:20.192114 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:50:20.198987 [info ] [MainThread]: Required dependencies:
[0m16:50:20.201208 [debug] [MainThread]: Executing "git --help"
[0m16:50:20.207444 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:50:20.210455 [debug] [MainThread]: STDERR: "b''"
[0m16:50:20.212360 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:50:20.214771 [info ] [MainThread]: Connection:
[0m16:50:20.216861 [info ] [MainThread]:   host: postgres
[0m16:50:20.218454 [info ] [MainThread]:   port: 5432
[0m16:50:20.220802 [info ] [MainThread]:   user: postgres
[0m16:50:20.222370 [info ] [MainThread]:   database: crypto_warehouse
[0m16:50:20.224108 [info ] [MainThread]:   schema: public
[0m16:50:20.225783 [info ] [MainThread]:   connect_timeout: 10
[0m16:50:20.227351 [info ] [MainThread]:   role: None
[0m16:50:20.229713 [info ] [MainThread]:   search_path: None
[0m16:50:20.231597 [info ] [MainThread]:   keepalives_idle: 0
[0m16:50:20.233455 [info ] [MainThread]:   sslmode: None
[0m16:50:20.235761 [info ] [MainThread]:   sslcert: None
[0m16:50:20.237787 [info ] [MainThread]:   sslkey: None
[0m16:50:20.239915 [info ] [MainThread]:   sslrootcert: None
[0m16:50:20.241771 [info ] [MainThread]:   application_name: dbt
[0m16:50:20.243558 [info ] [MainThread]:   retries: 1
[0m16:50:20.245255 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m16:50:20.247274 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m16:50:20.250322 [debug] [MainThread]: Using postgres connection "debug"
[0m16:50:20.252303 [debug] [MainThread]: On debug: select 1 as id
[0m16:50:20.254220 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:50:20.262828 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m16:50:20.265995 [debug] [MainThread]: On debug: Close
[0m16:50:20.267939 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:50:20.271002 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:50:20.273754 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.81024945, "process_user_time": 5.48308, "process_kernel_time": 0.280157, "process_mem_max_rss": "111184", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:50:20.275779 [debug] [MainThread]: Command `dbt debug` succeeded at 16:50:20.275446 after 0.81 seconds
[0m16:50:20.277354 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:50:20.279133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f491c731f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f491b019050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f491cdb5a50>]}
[0m16:50:20.281250 [debug] [MainThread]: Flushing usage events
[0m16:51:00.199316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9ef6bdb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9efb75b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9ef6bd910>]}


============================== 16:51:00.243913 | 8ee55f6f-b596-42f0-b551-4151ea72977c ==============================
[0m16:51:00.243913 [info ] [MainThread]: Running with dbt=1.7.0
[0m16:51:00.252651 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'profiles_dir': '/app', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug --project-dir /app/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:51:00.257540 [info ] [MainThread]: dbt version: 1.7.0
[0m16:51:00.259917 [info ] [MainThread]: python version: 3.11.13
[0m16:51:00.286152 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m16:51:00.288735 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m16:51:00.691553 [info ] [MainThread]: Using profiles dir at /app
[0m16:51:00.694103 [info ] [MainThread]: Using profiles.yml file at /app/profiles.yml
[0m16:51:00.717512 [info ] [MainThread]: Using dbt_project.yml file at /app/dbt/dbt_project.yml
[0m16:51:00.720942 [info ] [MainThread]: adapter type: postgres
[0m16:51:00.723709 [info ] [MainThread]: adapter version: 1.7.0
[0m16:51:00.955688 [info ] [MainThread]: Configuration:
[0m16:51:00.957428 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:51:00.960282 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:51:00.961900 [info ] [MainThread]: Required dependencies:
[0m16:51:00.966489 [debug] [MainThread]: Executing "git --help"
[0m16:51:00.972056 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:51:00.974321 [debug] [MainThread]: STDERR: "b''"
[0m16:51:00.975837 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:51:00.977186 [info ] [MainThread]: Connection:
[0m16:51:00.978627 [info ] [MainThread]:   host: postgres
[0m16:51:00.982293 [info ] [MainThread]:   port: 5432
[0m16:51:00.984676 [info ] [MainThread]:   user: postgres
[0m16:51:00.986485 [info ] [MainThread]:   database: crypto_warehouse
[0m16:51:00.987835 [info ] [MainThread]:   schema: public
[0m16:51:00.989832 [info ] [MainThread]:   connect_timeout: 10
[0m16:51:00.991159 [info ] [MainThread]:   role: None
[0m16:51:00.992427 [info ] [MainThread]:   search_path: None
[0m16:51:00.993799 [info ] [MainThread]:   keepalives_idle: 0
[0m16:51:00.995128 [info ] [MainThread]:   sslmode: None
[0m16:51:00.997717 [info ] [MainThread]:   sslcert: None
[0m16:51:00.999871 [info ] [MainThread]:   sslkey: None
[0m16:51:01.001392 [info ] [MainThread]:   sslrootcert: None
[0m16:51:01.002718 [info ] [MainThread]:   application_name: dbt
[0m16:51:01.003986 [info ] [MainThread]:   retries: 1
[0m16:51:01.005506 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m16:51:01.009219 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m16:51:01.011167 [debug] [MainThread]: Using postgres connection "debug"
[0m16:51:01.013773 [debug] [MainThread]: On debug: select 1 as id
[0m16:51:01.015697 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:51:01.023767 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m16:51:01.026394 [debug] [MainThread]: On debug: Close
[0m16:51:01.028081 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:51:01.036536 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:51:01.039859 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.1858774, "process_user_time": 7.885906, "process_kernel_time": 0.36726, "process_mem_max_rss": "110984", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:51:01.042408 [debug] [MainThread]: Command `dbt debug` succeeded at 16:51:01.042025 after 1.19 seconds
[0m16:51:01.044284 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:51:01.048152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9f42016d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9ede92790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9f1cce910>]}
[0m16:51:01.050025 [debug] [MainThread]: Flushing usage events
[0m16:51:36.676743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb42819aad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb42817a7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb428184190>]}


============================== 16:51:36.684086 | 97698944-1937-4f5a-baf9-d92d6c9f3662 ==============================
[0m16:51:36.684086 [info ] [MainThread]: Running with dbt=1.7.0
[0m16:51:36.687799 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/app', 'log_path': '/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt debug --project-dir /app/dbt', 'send_anonymous_usage_stats': 'True'}
[0m16:51:36.693018 [info ] [MainThread]: dbt version: 1.7.0
[0m16:51:36.695233 [info ] [MainThread]: python version: 3.11.13
[0m16:51:36.697723 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m16:51:36.699504 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m16:51:36.864259 [info ] [MainThread]: Using profiles dir at /app
[0m16:51:36.866102 [info ] [MainThread]: Using profiles.yml file at /app/profiles.yml
[0m16:51:36.867430 [info ] [MainThread]: Using dbt_project.yml file at /app/dbt/dbt_project.yml
[0m16:51:36.868953 [info ] [MainThread]: adapter type: postgres
[0m16:51:36.871169 [info ] [MainThread]: adapter version: 1.7.0
[0m16:51:36.996575 [info ] [MainThread]: Configuration:
[0m16:51:36.998199 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:51:36.999580 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:51:37.000893 [info ] [MainThread]: Required dependencies:
[0m16:51:37.002393 [debug] [MainThread]: Executing "git --help"
[0m16:51:37.006865 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:51:37.009177 [debug] [MainThread]: STDERR: "b''"
[0m16:51:37.010716 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:51:37.012255 [info ] [MainThread]: Connection:
[0m16:51:37.013820 [info ] [MainThread]:   host: postgres
[0m16:51:37.016195 [info ] [MainThread]:   port: 5432
[0m16:51:37.017766 [info ] [MainThread]:   user: postgres
[0m16:51:37.019138 [info ] [MainThread]:   database: crypto_warehouse
[0m16:51:37.020524 [info ] [MainThread]:   schema: public
[0m16:51:37.022229 [info ] [MainThread]:   connect_timeout: 10
[0m16:51:37.023595 [info ] [MainThread]:   role: None
[0m16:51:37.024840 [info ] [MainThread]:   search_path: None
[0m16:51:37.026362 [info ] [MainThread]:   keepalives_idle: 0
[0m16:51:37.027768 [info ] [MainThread]:   sslmode: None
[0m16:51:37.029474 [info ] [MainThread]:   sslcert: None
[0m16:51:37.031150 [info ] [MainThread]:   sslkey: None
[0m16:51:37.032703 [info ] [MainThread]:   sslrootcert: None
[0m16:51:37.034183 [info ] [MainThread]:   application_name: dbt
[0m16:51:37.035707 [info ] [MainThread]:   retries: 1
[0m16:51:37.037223 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m16:51:37.039732 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m16:51:37.041807 [debug] [MainThread]: Using postgres connection "debug"
[0m16:51:37.043780 [debug] [MainThread]: On debug: select 1 as id
[0m16:51:37.045585 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:51:37.053406 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m16:51:37.056539 [debug] [MainThread]: On debug: Close
[0m16:51:37.058173 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:51:37.060167 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:51:37.063255 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.46148664, "process_user_time": 4.34866, "process_kernel_time": 0.159218, "process_mem_max_rss": "111284", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:51:37.065474 [debug] [MainThread]: Command `dbt debug` succeeded at 16:51:37.065245 after 0.46 seconds
[0m16:51:37.066834 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:51:37.068386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4268fbf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb428fe2850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb42a789f90>]}
[0m16:51:37.070498 [debug] [MainThread]: Flushing usage events
[0m16:52:13.990952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f497d241050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f497d240b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f497d240450>]}


============================== 16:52:13.997130 | 0da23009-974d-4dcf-b912-d66aa28c4cee ==============================
[0m16:52:13.997130 [info ] [MainThread]: Running with dbt=1.7.0
[0m16:52:14.003457 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/app/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug --project-dir /app/dbt', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:52:14.007174 [info ] [MainThread]: dbt version: 1.7.0
[0m16:52:14.009209 [info ] [MainThread]: python version: 3.11.13
[0m16:52:14.011164 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m16:52:14.013359 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m16:52:14.519959 [info ] [MainThread]: Using profiles dir at /app
[0m16:52:14.522092 [info ] [MainThread]: Using profiles.yml file at /app/profiles.yml
[0m16:52:14.523479 [info ] [MainThread]: Using dbt_project.yml file at /app/dbt/dbt_project.yml
[0m16:52:14.525172 [info ] [MainThread]: adapter type: postgres
[0m16:52:14.527012 [info ] [MainThread]: adapter version: 1.7.0
[0m16:52:14.693573 [info ] [MainThread]: Configuration:
[0m16:52:14.695364 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:52:14.697071 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:52:14.701374 [info ] [MainThread]: Required dependencies:
[0m16:52:14.704150 [debug] [MainThread]: Executing "git --help"
[0m16:52:14.709262 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:52:14.721604 [debug] [MainThread]: STDERR: "b''"
[0m16:52:14.727127 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:52:14.883531 [info ] [MainThread]: Connection:
[0m16:52:14.890419 [info ] [MainThread]:   host: postgres
[0m16:52:14.903304 [info ] [MainThread]:   port: 5432
[0m16:52:14.906093 [info ] [MainThread]:   user: postgres
[0m16:52:14.917851 [info ] [MainThread]:   database: crypto_warehouse
[0m16:52:14.920353 [info ] [MainThread]:   schema: public
[0m16:52:14.922442 [info ] [MainThread]:   connect_timeout: 10
[0m16:52:14.924405 [info ] [MainThread]:   role: None
[0m16:52:14.926889 [info ] [MainThread]:   search_path: None
[0m16:52:14.928971 [info ] [MainThread]:   keepalives_idle: 0
[0m16:52:14.931736 [info ] [MainThread]:   sslmode: None
[0m16:52:14.937032 [info ] [MainThread]:   sslcert: None
[0m16:52:14.939293 [info ] [MainThread]:   sslkey: None
[0m16:52:14.941431 [info ] [MainThread]:   sslrootcert: None
[0m16:52:14.943052 [info ] [MainThread]:   application_name: dbt
[0m16:52:14.944742 [info ] [MainThread]:   retries: 1
[0m16:52:14.946605 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m16:52:14.949449 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m16:52:14.951306 [debug] [MainThread]: Using postgres connection "debug"
[0m16:52:14.952890 [debug] [MainThread]: On debug: select 1 as id
[0m16:52:14.954524 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:52:14.966451 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m16:52:14.973387 [debug] [MainThread]: On debug: Close
[0m16:52:14.984874 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:52:14.988755 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:52:14.992043 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.0957148, "process_user_time": 4.978746, "process_kernel_time": 0.199949, "process_mem_max_rss": "111528", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:52:14.994584 [debug] [MainThread]: Command `dbt debug` succeeded at 16:52:14.994180 after 1.10 seconds
[0m16:52:15.010576 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:52:15.013598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f497ba02c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f498193ef10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f497d0b14d0>]}
[0m16:52:15.016292 [debug] [MainThread]: Flushing usage events
[0m16:52:20.573779 [error] [MainThread]: Encountered an error:

[0m16:52:20.582779 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 90, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 75, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 197, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 244, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/main.py", line 324, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/serve.py", line 28, in run
    httpd.serve_forever()
  File "/usr/local/lib/python3.11/socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m16:52:20.592782 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 229.5622, "process_user_time": 4.612528, "process_kernel_time": 0.310956, "process_mem_max_rss": "112192", "process_out_blocks": "1880", "command_success": false, "process_in_blocks": "0"}
[0m16:52:20.602689 [debug] [MainThread]: Command `dbt docs serve` failed at 16:52:20.602303 after 229.57 seconds
[0m16:52:20.604803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe16f96a650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe16f974490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe16e1c6810>]}
[0m16:52:20.606770 [debug] [MainThread]: Flushing usage events
[0m16:52:51.163127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97e050dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97e04ba90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97e0506d0>]}


============================== 16:52:51.173434 | cb220ad7-e0dc-4882-b16c-c5472fdfdda4 ==============================
[0m16:52:51.173434 [info ] [MainThread]: Running with dbt=1.7.0
[0m16:52:51.177586 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/app/dbt/logs', 'debug': 'False', 'profiles_dir': '/app', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --project-dir /app/dbt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:52:51.549645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb220ad7-e0dc-4882-b16c-c5472fdfdda4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97c7ee850>]}
[0m16:52:51.701235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb220ad7-e0dc-4882-b16c-c5472fdfdda4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97c6b8810>]}
[0m16:52:51.704283 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m16:52:51.769243 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m16:52:54.304997 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:52:54.307087 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:52:54.319287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb220ad7-e0dc-4882-b16c-c5472fdfdda4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97c657a90>]}
[0m16:52:54.367940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb220ad7-e0dc-4882-b16c-c5472fdfdda4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97c717d10>]}
[0m16:52:54.370665 [info ] [MainThread]: Found 7 models, 14 tests, 2 sources, 0 exposures, 0 metrics, 519 macros, 0 groups, 0 semantic models
[0m16:52:54.376716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb220ad7-e0dc-4882-b16c-c5472fdfdda4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97c6e2e50>]}
[0m16:52:54.382443 [info ] [MainThread]: 
[0m16:52:54.395850 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:52:54.416974 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse'
[0m16:52:54.451899 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse"
[0m16:52:54.453605 [debug] [ThreadPool]: On list_crypto_warehouse: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m16:52:54.456447 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:52:54.467349 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m16:52:54.471524 [debug] [ThreadPool]: On list_crypto_warehouse: Close
[0m16:52:54.477946 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_warehouse, now list_crypto_warehouse_public_dbt_test__audit)
[0m16:52:54.481270 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse_public_staging'
[0m16:52:54.484091 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_warehouse_public_marts'
[0m16:52:54.502980 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_dbt_test__audit"
[0m16:52:54.507318 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_staging"
[0m16:52:54.515494 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_marts"
[0m16:52:54.519469 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: BEGIN
[0m16:52:54.521416 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: BEGIN
[0m16:52:54.526614 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: BEGIN
[0m16:52:54.529009 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:52:54.531400 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:52:54.535725 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:52:54.544614 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:52:54.547168 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:52:54.557336 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:52:54.563839 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_dbt_test__audit"
[0m16:52:54.570974 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_staging"
[0m16:52:54.579304 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_staging"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m16:52:54.576244 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_dbt_test__audit"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'
  
[0m16:52:54.573951 [debug] [ThreadPool]: Using postgres connection "list_crypto_warehouse_public_marts"
[0m16:52:54.592033 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m16:52:54.593564 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "list_crypto_warehouse_public_marts"} */
select
      'crypto_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'crypto_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'crypto_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m16:52:54.594537 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m16:52:54.606328 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: ROLLBACK
[0m16:52:54.613622 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: ROLLBACK
[0m16:52:54.614588 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m16:52:54.621246 [debug] [ThreadPool]: On list_crypto_warehouse_public_dbt_test__audit: Close
[0m16:52:54.623411 [debug] [ThreadPool]: On list_crypto_warehouse_public_staging: Close
[0m16:52:54.626550 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: ROLLBACK
[0m16:52:54.649182 [debug] [ThreadPool]: On list_crypto_warehouse_public_marts: Close
[0m16:52:54.662496 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:54.666430 [debug] [MainThread]: On master: BEGIN
[0m16:52:54.668920 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:52:54.674800 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:52:54.676726 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:54.679092 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:52:54.693833 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m16:52:54.696414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb220ad7-e0dc-4882-b16c-c5472fdfdda4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97c7fbbd0>]}
[0m16:52:54.699228 [debug] [MainThread]: On master: ROLLBACK
[0m16:52:54.701937 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:54.703373 [debug] [MainThread]: On master: BEGIN
[0m16:52:54.705242 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:52:54.706657 [debug] [MainThread]: On master: COMMIT
[0m16:52:54.708231 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:54.710030 [debug] [MainThread]: On master: COMMIT
[0m16:52:54.712141 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:52:54.713620 [debug] [MainThread]: On master: Close
[0m16:52:54.718890 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:52:54.722163 [info ] [MainThread]: 
[0m16:52:54.776359 [debug] [Thread-1 (]: Began running node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30
[0m16:52:54.783809 [debug] [Thread-3 (]: Began running node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300
[0m16:52:54.785212 [debug] [Thread-2 (]: Began running node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7
[0m16:52:54.787144 [debug] [Thread-4 (]: Began running node test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd
[0m16:52:54.788585 [info ] [Thread-1 (]: 1 of 14 START test dbt_utils_accepted_range_stg_crypto_prices_market_cap__0 .... [RUN]
[0m16:52:54.791542 [info ] [Thread-3 (]: 3 of 14 START test dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0 .... [RUN]
[0m16:52:54.795105 [info ] [Thread-2 (]: 2 of 14 START test dbt_utils_accepted_range_stg_crypto_prices_price_usd__0 ..... [RUN]
[0m16:52:54.818654 [info ] [Thread-4 (]: 4 of 14 START test dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP  [RUN]
[0m16:52:54.842289 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_marts, now test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30)
[0m16:52:54.846547 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_dbt_test__audit, now test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300)
[0m16:52:54.892034 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_crypto_warehouse_public_staging, now test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7)
[0m16:52:54.912552 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd'
[0m16:52:54.929206 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30
[0m16:52:54.945621 [debug] [Thread-3 (]: Began compiling node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300
[0m16:52:54.952690 [debug] [Thread-2 (]: Began compiling node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7
[0m16:52:54.955963 [debug] [Thread-4 (]: Began compiling node test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd
[0m16:52:55.036077 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30"
[0m16:52:55.039611 [debug] [Thread-3 (]: Writing injected SQL for node "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300"
[0m16:52:55.055624 [debug] [Thread-2 (]: Writing injected SQL for node "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7"
[0m16:52:55.105551 [debug] [Thread-4 (]: Writing injected SQL for node "test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd"
[0m16:52:55.110213 [debug] [Thread-1 (]: Timing info for test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30 (compile): 16:52:54.958072 => 16:52:55.109321
[0m16:52:55.113914 [debug] [Thread-2 (]: Timing info for test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7 (compile): 16:52:55.040341 => 16:52:55.113060
[0m16:52:55.118593 [debug] [Thread-3 (]: Timing info for test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300 (compile): 16:52:54.987970 => 16:52:55.117426
[0m16:52:55.120378 [debug] [Thread-1 (]: Began executing node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30
[0m16:52:55.123022 [debug] [Thread-2 (]: Began executing node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7
[0m16:52:55.124368 [debug] [Thread-4 (]: Timing info for test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd (compile): 16:52:55.057804 => 16:52:55.123692
[0m16:52:55.126121 [debug] [Thread-3 (]: Began executing node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300
[0m16:52:55.218656 [debug] [Thread-4 (]: Began executing node test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd
[0m16:52:55.219781 [debug] [Thread-1 (]: Applying DROP to: "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_market_cap__0"
[0m16:52:55.233046 [debug] [Thread-2 (]: Applying DROP to: "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_price_usd__0"
[0m16:52:55.255373 [debug] [Thread-3 (]: Applying DROP to: "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0"
[0m16:52:55.389918 [debug] [Thread-4 (]: Applying DROP to: "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_expression_is_true_s_7b822a4db60249ec680888478d412bb7"
[0m16:52:55.406539 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30"
[0m16:52:55.409534 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7"
[0m16:52:55.412583 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300"
[0m16:52:55.417070 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd"
[0m16:52:55.419632 [debug] [Thread-1 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30"} */
drop table if exists "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_market_cap__0" cascade
[0m16:52:55.421858 [debug] [Thread-2 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7"} */
drop table if exists "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_price_usd__0" cascade
[0m16:52:55.423735 [debug] [Thread-3 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300"} */
drop table if exists "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0" cascade
[0m16:52:55.426492 [debug] [Thread-4 (]: On test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd"} */
drop table if exists "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_expression_is_true_s_7b822a4db60249ec680888478d412bb7" cascade
[0m16:52:55.428857 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:52:55.431429 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:52:55.433240 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:52:55.435528 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:52:55.638309 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:52:55.639230 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:52:55.640250 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:52:55.641067 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:52:55.645640 [debug] [Thread-3 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0"
[0m16:52:55.648676 [debug] [Thread-4 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_expression_is_true_s_7b822a4db60249ec680888478d412bb7"
[0m16:52:55.651367 [debug] [Thread-2 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_price_usd__0"
[0m16:52:55.653885 [debug] [Thread-1 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_market_cap__0"
[0m16:52:55.698315 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd"
[0m16:52:55.703227 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300"
[0m16:52:55.706248 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7"
[0m16:52:55.709175 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30"
[0m16:52:55.711313 [debug] [Thread-4 (]: On test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd: BEGIN
[0m16:52:55.713363 [debug] [Thread-3 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300: BEGIN
[0m16:52:55.715095 [debug] [Thread-2 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7: BEGIN
[0m16:52:55.716908 [debug] [Thread-1 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30: BEGIN
[0m16:52:55.719237 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m16:52:55.721853 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m16:52:55.723866 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m16:52:55.725779 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:52:55.727010 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd"
[0m16:52:55.728527 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300"
[0m16:52:55.730358 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7"
[0m16:52:55.732263 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30"
[0m16:52:55.733914 [debug] [Thread-4 (]: On test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd"} */

        
  
    

  create  table "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_expression_is_true_s_7b822a4db60249ec680888478d412bb7"
  
  
    as
  
  (
    



select
    *
from "crypto_warehouse"."public_staging"."stg_crypto_prices"

where not(extracted_at  <= CURRENT_TIMESTAMP)


  );
  
    
[0m16:52:55.735587 [debug] [Thread-3 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300"} */

        
  
    

  create  table "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0"
  
  
    as
  
  (
    

with meet_condition as(
  select *
  from "crypto_warehouse"."public_staging"."stg_crypto_prices"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not volume_24h >= 0
)

select *
from validation_errors


  );
  
    
[0m16:52:55.738096 [debug] [Thread-2 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7"} */

        
  
    

  create  table "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_price_usd__0"
  
  
    as
  
  (
    

with meet_condition as(
  select *
  from "crypto_warehouse"."public_staging"."stg_crypto_prices"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not price_usd >= 0
)

select *
from validation_errors


  );
  
    
[0m16:52:55.741021 [debug] [Thread-1 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30"} */

        
  
    

  create  table "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_market_cap__0"
  
  
    as
  
  (
    

with meet_condition as(
  select *
  from "crypto_warehouse"."public_staging"."stg_crypto_prices"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not market_cap >= 0
)

select *
from validation_errors


  );
  
    
[0m16:52:56.596649 [debug] [Thread-4 (]: SQL status: SELECT 0 in 1.0 seconds
[0m16:52:56.599422 [debug] [Thread-4 (]: On test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd: COMMIT
[0m16:52:56.600981 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd"
[0m16:52:56.602869 [debug] [Thread-4 (]: On test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd: COMMIT
[0m16:52:56.678010 [debug] [Thread-2 (]: SQL status: SELECT 0 in 1.0 seconds
[0m16:52:56.679138 [debug] [Thread-3 (]: SQL status: SELECT 0 in 1.0 seconds
[0m16:52:56.679790 [debug] [Thread-1 (]: SQL status: SELECT 0 in 1.0 seconds
[0m16:52:56.681905 [debug] [Thread-2 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7: COMMIT
[0m16:52:56.684201 [debug] [Thread-3 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300: COMMIT
[0m16:52:56.686591 [debug] [Thread-1 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30: COMMIT
[0m16:52:56.688275 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7"
[0m16:52:56.689873 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300"
[0m16:52:56.691830 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30"
[0m16:52:56.693750 [debug] [Thread-2 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7: COMMIT
[0m16:52:56.695655 [debug] [Thread-3 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300: COMMIT
[0m16:52:56.698057 [debug] [Thread-1 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30: COMMIT
[0m16:52:56.819083 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m16:52:56.826250 [debug] [Thread-4 (]: Writing runtime sql for node "test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd"
[0m16:52:56.839406 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd"
[0m16:52:56.841638 [debug] [Thread-4 (]: On test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd: BEGIN
[0m16:52:56.843491 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m16:52:56.845102 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd"
[0m16:52:56.846599 [debug] [Thread-4 (]: On test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_expression_is_true_s_7b822a4db60249ec680888478d412bb7"
    
      
    ) dbt_internal_test
[0m16:52:56.916598 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m16:52:56.917243 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m16:52:56.917897 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:52:56.919617 [debug] [Thread-3 (]: Writing runtime sql for node "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300"
[0m16:52:56.921790 [debug] [Thread-2 (]: Writing runtime sql for node "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7"
[0m16:52:56.924500 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30"
[0m16:52:56.935127 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7"
[0m16:52:56.936227 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30"
[0m16:52:56.938106 [debug] [Thread-2 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7: BEGIN
[0m16:52:56.939326 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300"
[0m16:52:56.940558 [debug] [Thread-1 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30: BEGIN
[0m16:52:56.942645 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m16:52:56.943880 [debug] [Thread-3 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300: BEGIN
[0m16:52:56.945911 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:52:56.947994 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7"
[0m16:52:56.950078 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m16:52:56.951364 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30"
[0m16:52:56.952918 [debug] [Thread-2 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_price_usd__0"
    
      
    ) dbt_internal_test
[0m16:52:56.954633 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300"
[0m16:52:56.956192 [debug] [Thread-1 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_market_cap__0"
    
      
    ) dbt_internal_test
[0m16:52:56.958981 [debug] [Thread-3 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "crypto_warehouse"."public_dbt_test__audit"."dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0"
    
      
    ) dbt_internal_test
[0m16:52:57.019129 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:52:57.020071 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:52:57.020872 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:52:57.021763 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:52:57.025743 [debug] [Thread-4 (]: Timing info for test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd (execute): 16:52:55.256503 => 16:52:57.025308
[0m16:52:57.029945 [debug] [Thread-3 (]: Timing info for test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300 (execute): 16:52:55.234900 => 16:52:57.029546
[0m16:52:57.033262 [debug] [Thread-1 (]: Timing info for test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30 (execute): 16:52:55.127868 => 16:52:57.032871
[0m16:52:57.036179 [debug] [Thread-2 (]: Timing info for test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7 (execute): 16:52:55.150772 => 16:52:57.035793
[0m16:52:57.037771 [debug] [Thread-4 (]: On test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd: ROLLBACK
[0m16:52:57.039475 [debug] [Thread-3 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300: ROLLBACK
[0m16:52:57.041189 [debug] [Thread-1 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30: ROLLBACK
[0m16:52:57.042789 [debug] [Thread-2 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7: ROLLBACK
[0m16:52:57.045220 [debug] [Thread-4 (]: On test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd: Close
[0m16:52:57.047019 [debug] [Thread-3 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300: Close
[0m16:52:57.048939 [debug] [Thread-1 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30: Close
[0m16:52:57.051371 [debug] [Thread-2 (]: On test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7: Close
[0m16:52:57.054434 [info ] [Thread-4 (]: 4 of 14 PASS dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP  [[32mPASS[0m in 2.14s]
[0m16:52:57.061040 [info ] [Thread-3 (]: 3 of 14 PASS dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0 .......... [[32mPASS[0m in 2.21s]
[0m16:52:57.068757 [info ] [Thread-1 (]: 1 of 14 PASS dbt_utils_accepted_range_stg_crypto_prices_market_cap__0 .......... [[32mPASS[0m in 2.23s]
[0m16:52:57.074109 [info ] [Thread-2 (]: 2 of 14 PASS dbt_utils_accepted_range_stg_crypto_prices_price_usd__0 ........... [[32mPASS[0m in 2.18s]
[0m16:52:57.085020 [debug] [Thread-4 (]: Finished running node test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd
[0m16:52:57.087393 [debug] [Thread-3 (]: Finished running node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300
[0m16:52:57.089296 [debug] [Thread-1 (]: Finished running node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30
[0m16:52:57.091687 [debug] [Thread-2 (]: Finished running node test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7
[0m16:52:57.094560 [debug] [Thread-4 (]: Began running node test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5
[0m16:52:57.099406 [debug] [Thread-3 (]: Began running node test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79
[0m16:52:57.102127 [debug] [Thread-1 (]: Began running node test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f
[0m16:52:57.104622 [debug] [Thread-2 (]: Began running node test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf
[0m16:52:57.107711 [info ] [Thread-4 (]: 5 of 14 START test not_null_stg_crypto_prices_extracted_at ..................... [RUN]
[0m16:52:57.111114 [info ] [Thread-3 (]: 6 of 14 START test not_null_stg_crypto_prices_market_cap ....................... [RUN]
[0m16:52:57.120901 [info ] [Thread-1 (]: 7 of 14 START test not_null_stg_crypto_prices_price_id ......................... [RUN]
[0m16:52:57.125745 [info ] [Thread-2 (]: 8 of 14 START test not_null_stg_crypto_prices_price_usd ........................ [RUN]
[0m16:52:57.132620 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.dbt_utils_expression_is_true_stg_crypto_prices_extracted_at___column_name_CURRENT_TIMESTAMP.02988f1ebd, now test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5)
[0m16:52:57.137342 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_volume_24h__0.42b2bee300, now test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79)
[0m16:52:57.139518 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_market_cap__0.cf16a85f30, now test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f)
[0m16:52:57.141865 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.dbt_utils_accepted_range_stg_crypto_prices_price_usd__0.53435e2de7, now test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf)
[0m16:52:57.143670 [debug] [Thread-4 (]: Began compiling node test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5
[0m16:52:57.148351 [debug] [Thread-3 (]: Began compiling node test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79
[0m16:52:57.151937 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f
[0m16:52:57.153741 [debug] [Thread-2 (]: Began compiling node test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf
[0m16:52:57.170675 [debug] [Thread-4 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5"
[0m16:52:57.177288 [debug] [Thread-3 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79"
[0m16:52:57.187250 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f"
[0m16:52:57.195506 [debug] [Thread-2 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf"
[0m16:52:57.209861 [debug] [Thread-4 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5 (compile): 16:52:57.155402 => 16:52:57.209153
[0m16:52:57.215306 [debug] [Thread-1 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f (compile): 16:52:57.180696 => 16:52:57.213116
[0m16:52:57.219872 [debug] [Thread-2 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf (compile): 16:52:57.188225 => 16:52:57.218602
[0m16:52:57.221864 [debug] [Thread-4 (]: Began executing node test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5
[0m16:52:57.224445 [debug] [Thread-1 (]: Began executing node test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f
[0m16:52:57.227101 [debug] [Thread-2 (]: Began executing node test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf
[0m16:52:57.235191 [debug] [Thread-3 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79 (compile): 16:52:57.171414 => 16:52:57.234552
[0m16:52:57.248914 [debug] [Thread-4 (]: Applying DROP to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_extracted_at"
[0m16:52:57.264347 [debug] [Thread-1 (]: Applying DROP to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_price_id"
[0m16:52:57.274415 [debug] [Thread-2 (]: Applying DROP to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_price_usd"
[0m16:52:57.275808 [debug] [Thread-3 (]: Began executing node test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79
[0m16:52:57.278647 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5"
[0m16:52:57.281058 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f"
[0m16:52:57.283719 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf"
[0m16:52:57.292084 [debug] [Thread-3 (]: Applying DROP to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_market_cap"
[0m16:52:57.293430 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5"} */
drop table if exists "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_extracted_at" cascade
[0m16:52:57.295245 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f"} */
drop table if exists "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_price_id" cascade
[0m16:52:57.297223 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf"} */
drop table if exists "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_price_usd" cascade
[0m16:52:57.299585 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79"
[0m16:52:57.301267 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:52:57.302750 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:52:57.304116 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:52:57.305619 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79"} */
drop table if exists "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_market_cap" cascade
[0m16:52:57.315295 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:52:57.317363 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:52:57.320971 [debug] [Thread-4 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_extracted_at"
[0m16:52:57.326134 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5"
[0m16:52:57.328362 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5: BEGIN
[0m16:52:57.330548 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m16:52:57.332118 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5"
[0m16:52:57.333604 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5"} */

        
  
    

  create  table "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_extracted_at"
  
  
    as
  
  (
    
    
    



select *
from "crypto_warehouse"."public_staging"."stg_crypto_prices"
where extracted_at is null



  );
  
    
[0m16:52:57.364228 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:52:57.367007 [debug] [Thread-3 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_market_cap"
[0m16:52:57.369320 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79"
[0m16:52:57.370795 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79: BEGIN
[0m16:52:57.372629 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m16:52:57.374369 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79"
[0m16:52:57.375632 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:52:57.377238 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79"} */

        
  
    

  create  table "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_market_cap"
  
  
    as
  
  (
    
    
    



select *
from "crypto_warehouse"."public_staging"."stg_crypto_prices"
where market_cap is null



  );
  
    
[0m16:52:57.380661 [debug] [Thread-1 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_price_id"
[0m16:52:57.385007 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f"
[0m16:52:57.386596 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f: BEGIN
[0m16:52:57.388446 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:52:57.389938 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f"
[0m16:52:57.392083 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f"} */

        
  
    

  create  table "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_price_id"
  
  
    as
  
  (
    
    
    



select *
from "crypto_warehouse"."public_staging"."stg_crypto_prices"
where price_id is null



  );
  
    
[0m16:52:57.393276 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:52:57.397513 [debug] [Thread-2 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_price_usd"
[0m16:52:57.399894 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf"
[0m16:52:57.401430 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf: BEGIN
[0m16:52:57.403257 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m16:52:57.404788 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf"
[0m16:52:57.406292 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf"} */

        
  
    

  create  table "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_price_usd"
  
  
    as
  
  (
    
    
    



select *
from "crypto_warehouse"."public_staging"."stg_crypto_prices"
where price_usd is null



  );
  
    
[0m16:52:57.841850 [debug] [Thread-4 (]: SQL status: SELECT 0 in 1.0 seconds
[0m16:52:57.844943 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5: COMMIT
[0m16:52:57.847171 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5"
[0m16:52:57.848992 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5: COMMIT
[0m16:52:58.563724 [debug] [Thread-3 (]: SQL status: SELECT 0 in 1.0 seconds
[0m16:52:58.566418 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79: COMMIT
[0m16:52:58.568007 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79"
[0m16:52:58.569668 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79: COMMIT
[0m16:52:58.697478 [debug] [Thread-4 (]: SQL status: COMMIT in 1.0 seconds
[0m16:52:58.699629 [debug] [Thread-4 (]: Writing runtime sql for node "test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5"
[0m16:52:58.712794 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5"
[0m16:52:58.714297 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5: BEGIN
[0m16:52:58.716508 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m16:52:58.718506 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5"
[0m16:52:58.720563 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_extracted_at"
    
      
    ) dbt_internal_test
[0m16:52:58.723592 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:52:58.727102 [debug] [Thread-4 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5 (execute): 16:52:57.235729 => 16:52:58.726616
[0m16:52:58.728820 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5: ROLLBACK
[0m16:52:58.730618 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5: Close
[0m16:52:58.732953 [info ] [Thread-4 (]: 5 of 14 PASS not_null_stg_crypto_prices_extracted_at ........................... [[32mPASS[0m in 1.60s]
[0m16:52:58.737387 [debug] [Thread-4 (]: Finished running node test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5
[0m16:52:58.739544 [debug] [Thread-4 (]: Began running node test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a
[0m16:52:58.741481 [info ] [Thread-4 (]: 9 of 14 START test not_null_stg_crypto_prices_symbol ........................... [RUN]
[0m16:52:58.745129 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.not_null_stg_crypto_prices_extracted_at.5482d7ece5, now test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a)
[0m16:52:58.749826 [debug] [Thread-4 (]: Began compiling node test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a
[0m16:52:58.759906 [debug] [Thread-4 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a"
[0m16:52:58.778127 [debug] [Thread-4 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a (compile): 16:52:58.752647 => 16:52:58.777601
[0m16:52:58.781518 [debug] [Thread-4 (]: Began executing node test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a
[0m16:52:58.790536 [debug] [Thread-4 (]: Applying DROP to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_symbol"
[0m16:52:58.795858 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a"
[0m16:52:58.798566 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a"} */
drop table if exists "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_symbol" cascade
[0m16:52:58.800544 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:52:58.808028 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:52:58.812612 [debug] [Thread-4 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_symbol"
[0m16:52:58.815361 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a"
[0m16:52:58.816852 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a: BEGIN
[0m16:52:58.818996 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m16:52:58.820713 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a"
[0m16:52:58.822454 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a"} */

        
  
    

  create  table "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_symbol"
  
  
    as
  
  (
    
    
    



select *
from "crypto_warehouse"."public_staging"."stg_crypto_prices"
where symbol is null



  );
  
    
[0m16:52:59.151714 [debug] [Thread-2 (]: SQL status: SELECT 0 in 2.0 seconds
[0m16:52:59.152900 [debug] [Thread-1 (]: SQL status: SELECT 0 in 2.0 seconds
[0m16:52:59.155486 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf: COMMIT
[0m16:52:59.157807 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f: COMMIT
[0m16:52:59.159976 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf"
[0m16:52:59.161757 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f"
[0m16:52:59.163310 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf: COMMIT
[0m16:52:59.165315 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f: COMMIT
[0m16:52:59.169073 [debug] [Thread-3 (]: SQL status: COMMIT in 1.0 seconds
[0m16:52:59.172802 [debug] [Thread-3 (]: Writing runtime sql for node "test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79"
[0m16:52:59.186507 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79"
[0m16:52:59.187996 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79: BEGIN
[0m16:52:59.189834 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m16:52:59.191540 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79"
[0m16:52:59.193100 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_market_cap"
    
      
    ) dbt_internal_test
[0m16:52:59.195795 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:52:59.198827 [debug] [Thread-3 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79 (execute): 16:52:57.285201 => 16:52:59.198414
[0m16:52:59.200580 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79: ROLLBACK
[0m16:52:59.203366 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79: Close
[0m16:52:59.206107 [info ] [Thread-3 (]: 6 of 14 PASS not_null_stg_crypto_prices_market_cap ............................. [[32mPASS[0m in 2.07s]
[0m16:52:59.210523 [debug] [Thread-3 (]: Finished running node test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79
[0m16:52:59.212681 [debug] [Thread-3 (]: Began running node test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438
[0m16:52:59.214449 [info ] [Thread-3 (]: 10 of 14 START test not_null_stg_crypto_prices_volume_24h ...................... [RUN]
[0m16:52:59.217718 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.not_null_stg_crypto_prices_market_cap.e697c7fa79, now test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438)
[0m16:52:59.220477 [debug] [Thread-3 (]: Began compiling node test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438
[0m16:52:59.233233 [debug] [Thread-3 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438"
[0m16:52:59.253917 [debug] [Thread-3 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438 (compile): 16:52:59.223368 => 16:52:59.253276
[0m16:52:59.256934 [debug] [Thread-3 (]: Began executing node test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438
[0m16:52:59.274067 [debug] [Thread-3 (]: Applying DROP to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_volume_24h"
[0m16:52:59.277643 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438"
[0m16:52:59.279565 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438"} */
drop table if exists "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_volume_24h" cascade
[0m16:52:59.281353 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:52:59.289102 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:52:59.294053 [debug] [Thread-3 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_volume_24h"
[0m16:52:59.296481 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438"
[0m16:52:59.297977 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438: BEGIN
[0m16:52:59.300705 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m16:52:59.302959 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438"
[0m16:52:59.304498 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438"} */

        
  
    

  create  table "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_volume_24h"
  
  
    as
  
  (
    
    
    



select *
from "crypto_warehouse"."public_staging"."stg_crypto_prices"
where volume_24h is null



  );
  
    
[0m16:53:00.005306 [debug] [Thread-4 (]: SQL status: SELECT 0 in 1.0 seconds
[0m16:53:00.008632 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a: COMMIT
[0m16:53:00.011238 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a"
[0m16:53:00.013658 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a: COMMIT
[0m16:53:00.291001 [debug] [Thread-2 (]: SQL status: COMMIT in 1.0 seconds
[0m16:53:00.294914 [debug] [Thread-2 (]: Writing runtime sql for node "test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf"
[0m16:53:00.311179 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf"
[0m16:53:00.313440 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf: BEGIN
[0m16:53:00.316031 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m16:53:00.320292 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf"
[0m16:53:00.323240 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_price_usd"
    
      
    ) dbt_internal_test
[0m16:53:00.327456 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:53:00.443348 [debug] [Thread-2 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf (execute): 16:52:57.265511 => 16:53:00.442642
[0m16:53:00.445775 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf: ROLLBACK
[0m16:53:00.448908 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf: Close
[0m16:53:00.453569 [info ] [Thread-2 (]: 8 of 14 PASS not_null_stg_crypto_prices_price_usd .............................. [[32mPASS[0m in 3.31s]
[0m16:53:00.460023 [debug] [Thread-2 (]: Finished running node test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf
[0m16:53:00.463671 [debug] [Thread-2 (]: Began running node test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39
[0m16:53:00.466417 [info ] [Thread-2 (]: 11 of 14 START test not_null_stg_pipeline_runs_run_id .......................... [RUN]
[0m16:53:00.470264 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.not_null_stg_crypto_prices_price_usd.76be438ecf, now test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39)
[0m16:53:00.482630 [debug] [Thread-2 (]: Began compiling node test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39
[0m16:53:00.497838 [debug] [Thread-2 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39"
[0m16:53:00.521989 [debug] [Thread-2 (]: Timing info for test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39 (compile): 16:53:00.484353 => 16:53:00.520846
[0m16:53:00.526849 [debug] [Thread-2 (]: Began executing node test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39
[0m16:53:00.539567 [debug] [Thread-2 (]: Applying DROP to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_run_id"
[0m16:53:00.544516 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39"
[0m16:53:00.546806 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39"} */
drop table if exists "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_run_id" cascade
[0m16:53:00.548506 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:53:00.557217 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:53:00.563682 [debug] [Thread-2 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_run_id"
[0m16:53:00.566658 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39"
[0m16:53:00.568841 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39: BEGIN
[0m16:53:00.572094 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m16:53:00.575475 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39"
[0m16:53:00.578038 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39"} */

        
  
    

  create  table "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_run_id"
  
  
    as
  
  (
    
    
    



select *
from "crypto_warehouse"."public_staging"."stg_pipeline_runs"
where run_id is null



  );
  
    
[0m16:53:00.807069 [debug] [Thread-1 (]: SQL status: COMMIT in 2.0 seconds
[0m16:53:00.808137 [debug] [Thread-4 (]: SQL status: COMMIT in 1.0 seconds
[0m16:53:00.810815 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f"
[0m16:53:00.815093 [debug] [Thread-4 (]: Writing runtime sql for node "test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a"
[0m16:53:01.020682 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f"
[0m16:53:01.021833 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a"
[0m16:53:01.023786 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f: BEGIN
[0m16:53:01.026156 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a: BEGIN
[0m16:53:01.028389 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:53:01.030831 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m16:53:01.032373 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f"
[0m16:53:01.033878 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a"
[0m16:53:01.035431 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_price_id"
    
      
    ) dbt_internal_test
[0m16:53:01.037024 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_symbol"
    
      
    ) dbt_internal_test
[0m16:53:01.039985 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:53:01.040878 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:53:01.044046 [debug] [Thread-1 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f (execute): 16:52:57.249875 => 16:53:01.043659
[0m16:53:01.047859 [debug] [Thread-4 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a (execute): 16:52:58.783773 => 16:53:01.047319
[0m16:53:01.049531 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f: ROLLBACK
[0m16:53:01.052353 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a: ROLLBACK
[0m16:53:01.054427 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f: Close
[0m16:53:01.056644 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a: Close
[0m16:53:01.059433 [info ] [Thread-1 (]: 7 of 14 PASS not_null_stg_crypto_prices_price_id ............................... [[32mPASS[0m in 3.92s]
[0m16:53:01.067804 [debug] [Thread-1 (]: Finished running node test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f
[0m16:53:01.062521 [info ] [Thread-4 (]: 9 of 14 PASS not_null_stg_crypto_prices_symbol ................................. [[32mPASS[0m in 2.32s]
[0m16:53:01.070139 [debug] [Thread-1 (]: Began running node test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e
[0m16:53:01.072184 [debug] [Thread-4 (]: Finished running node test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a
[0m16:53:01.074075 [info ] [Thread-1 (]: 12 of 14 START test not_null_stg_pipeline_runs_stage ........................... [RUN]
[0m16:53:01.076421 [debug] [Thread-4 (]: Began running node test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd
[0m16:53:01.079794 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.not_null_stg_crypto_prices_price_id.ebe047615f, now test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e)
[0m16:53:01.083156 [info ] [Thread-4 (]: 13 of 14 START test not_null_stg_pipeline_runs_status .......................... [RUN]
[0m16:53:01.088023 [debug] [Thread-1 (]: Began compiling node test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e
[0m16:53:01.092136 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.not_null_stg_crypto_prices_symbol.911b36645a, now test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd)
[0m16:53:01.104248 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e"
[0m16:53:01.105641 [debug] [Thread-4 (]: Began compiling node test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd
[0m16:53:01.127239 [debug] [Thread-4 (]: Writing injected SQL for node "test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd"
[0m16:53:01.134888 [debug] [Thread-1 (]: Timing info for test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e (compile): 16:53:01.095097 => 16:53:01.132605
[0m16:53:01.137404 [debug] [Thread-1 (]: Began executing node test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e
[0m16:53:01.138598 [debug] [Thread-4 (]: Timing info for test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd (compile): 16:53:01.113231 => 16:53:01.138121
[0m16:53:01.150413 [debug] [Thread-1 (]: Applying DROP to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_stage"
[0m16:53:01.151715 [debug] [Thread-4 (]: Began executing node test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd
[0m16:53:01.154446 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e"
[0m16:53:01.164942 [debug] [Thread-4 (]: Applying DROP to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_status"
[0m16:53:01.166273 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e"} */
drop table if exists "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_stage" cascade
[0m16:53:01.168292 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd"
[0m16:53:01.170546 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:53:01.172261 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd"} */
drop table if exists "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_status" cascade
[0m16:53:01.176658 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:53:01.182131 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:53:01.185598 [debug] [Thread-1 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_stage"
[0m16:53:01.187096 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:53:01.188863 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e"
[0m16:53:01.191963 [debug] [Thread-4 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_status"
[0m16:53:01.193617 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e: BEGIN
[0m16:53:01.198291 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd"
[0m16:53:01.200726 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:53:01.201770 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd: BEGIN
[0m16:53:01.203722 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e"
[0m16:53:01.206684 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m16:53:01.208276 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e"} */

        
  
    

  create  table "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_stage"
  
  
    as
  
  (
    
    
    



select *
from "crypto_warehouse"."public_staging"."stg_pipeline_runs"
where stage is null



  );
  
    
[0m16:53:01.210883 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd"
[0m16:53:01.215039 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd"} */

        
  
    

  create  table "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_status"
  
  
    as
  
  (
    
    
    



select *
from "crypto_warehouse"."public_staging"."stg_pipeline_runs"
where status is null



  );
  
    
[0m16:53:01.307849 [debug] [Thread-3 (]: SQL status: SELECT 0 in 2.0 seconds
[0m16:53:01.310874 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438: COMMIT
[0m16:53:01.312435 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438"
[0m16:53:01.313862 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438: COMMIT
[0m16:53:03.860513 [debug] [Thread-3 (]: SQL status: COMMIT in 3.0 seconds
[0m16:53:03.862734 [debug] [Thread-3 (]: Writing runtime sql for node "test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438"
[0m16:53:03.879156 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438"
[0m16:53:03.881308 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438: BEGIN
[0m16:53:03.883707 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m16:53:03.885806 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438"
[0m16:53:03.887976 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_crypto_prices_volume_24h"
    
      
    ) dbt_internal_test
[0m16:53:03.891045 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:53:03.896336 [debug] [Thread-3 (]: Timing info for test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438 (execute): 16:52:59.261118 => 16:53:03.895577
[0m16:53:03.898643 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438: ROLLBACK
[0m16:53:03.901483 [debug] [Thread-3 (]: On test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438: Close
[0m16:53:03.905886 [info ] [Thread-3 (]: 10 of 14 PASS not_null_stg_crypto_prices_volume_24h ............................ [[32mPASS[0m in 4.69s]
[0m16:53:03.911962 [debug] [Thread-3 (]: Finished running node test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438
[0m16:53:03.914519 [debug] [Thread-3 (]: Began running node test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43
[0m16:53:03.916646 [info ] [Thread-3 (]: 14 of 14 START test unique_stg_crypto_prices_price_id .......................... [RUN]
[0m16:53:03.920006 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.crypto_analytics.not_null_stg_crypto_prices_volume_24h.ce0de85438, now test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43)
[0m16:53:03.924171 [debug] [Thread-3 (]: Began compiling node test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43
[0m16:53:03.946663 [debug] [Thread-3 (]: Writing injected SQL for node "test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43"
[0m16:53:03.975158 [debug] [Thread-3 (]: Timing info for test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43 (compile): 16:53:03.927287 => 16:53:03.974328
[0m16:53:03.977672 [debug] [Thread-3 (]: Began executing node test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43
[0m16:53:03.992598 [debug] [Thread-3 (]: Applying DROP to: "crypto_warehouse"."public_dbt_test__audit"."unique_stg_crypto_prices_price_id"
[0m16:53:03.995622 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43"
[0m16:53:03.998134 [debug] [Thread-3 (]: On test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43"} */
drop table if exists "crypto_warehouse"."public_dbt_test__audit"."unique_stg_crypto_prices_price_id" cascade
[0m16:53:04.002483 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:53:04.010016 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:53:04.012691 [debug] [Thread-3 (]: Applying CREATE to: "crypto_warehouse"."public_dbt_test__audit"."unique_stg_crypto_prices_price_id"
[0m16:53:04.015103 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43"
[0m16:53:04.021080 [debug] [Thread-3 (]: On test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43: BEGIN
[0m16:53:04.023707 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m16:53:04.026039 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43"
[0m16:53:04.028005 [debug] [Thread-3 (]: On test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43"} */

        
  
    

  create  table "crypto_warehouse"."public_dbt_test__audit"."unique_stg_crypto_prices_price_id"
  
  
    as
  
  (
    
    
    

select
    price_id as unique_field,
    count(*) as n_records

from "crypto_warehouse"."public_staging"."stg_crypto_prices"
where price_id is not null
group by price_id
having count(*) > 1



  );
  
    
[0m16:53:04.032095 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.0 seconds
[0m16:53:04.035180 [debug] [Thread-3 (]: On test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43: COMMIT
[0m16:53:04.036646 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43"
[0m16:53:04.039377 [debug] [Thread-3 (]: On test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43: COMMIT
[0m16:53:04.106106 [debug] [Thread-1 (]: SQL status: SELECT 0 in 3.0 seconds
[0m16:53:04.108386 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e: COMMIT
[0m16:53:04.109854 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e"
[0m16:53:04.111229 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e: COMMIT
[0m16:53:04.350894 [debug] [Thread-4 (]: SQL status: SELECT 0 in 3.0 seconds
[0m16:53:04.354052 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd: COMMIT
[0m16:53:04.355808 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd"
[0m16:53:04.357387 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd: COMMIT
[0m16:53:04.442486 [debug] [Thread-2 (]: SQL status: SELECT 0 in 4.0 seconds
[0m16:53:04.446533 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39: COMMIT
[0m16:53:04.448765 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39"
[0m16:53:04.451205 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39: COMMIT
[0m16:53:04.595684 [debug] [Thread-3 (]: SQL status: COMMIT in 1.0 seconds
[0m16:53:04.598145 [debug] [Thread-3 (]: Writing runtime sql for node "test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43"
[0m16:53:04.614040 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43"
[0m16:53:04.615847 [debug] [Thread-3 (]: On test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43: BEGIN
[0m16:53:04.617929 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m16:53:04.619758 [debug] [Thread-3 (]: Using postgres connection "test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43"
[0m16:53:04.621633 [debug] [Thread-3 (]: On test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "crypto_warehouse"."public_dbt_test__audit"."unique_stg_crypto_prices_price_id"
    
      
    ) dbt_internal_test
[0m16:53:04.624357 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:53:04.627437 [debug] [Thread-3 (]: Timing info for test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43 (execute): 16:53:03.979440 => 16:53:04.627061
[0m16:53:04.629012 [debug] [Thread-3 (]: On test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43: ROLLBACK
[0m16:53:04.630924 [debug] [Thread-3 (]: On test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43: Close
[0m16:53:04.635430 [info ] [Thread-3 (]: 14 of 14 PASS unique_stg_crypto_prices_price_id ................................ [[32mPASS[0m in 0.72s]
[0m16:53:04.641129 [debug] [Thread-3 (]: Finished running node test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43
[0m16:53:05.005268 [debug] [Thread-4 (]: SQL status: COMMIT in 1.0 seconds
[0m16:53:05.006325 [debug] [Thread-1 (]: SQL status: COMMIT in 1.0 seconds
[0m16:53:05.007459 [debug] [Thread-2 (]: SQL status: COMMIT in 1.0 seconds
[0m16:53:05.009317 [debug] [Thread-4 (]: Writing runtime sql for node "test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd"
[0m16:53:05.011610 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e"
[0m16:53:05.013937 [debug] [Thread-2 (]: Writing runtime sql for node "test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39"
[0m16:53:05.029259 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39"
[0m16:53:05.031968 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39: BEGIN
[0m16:53:05.033146 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd"
[0m16:53:05.033910 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e"
[0m16:53:05.035562 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m16:53:05.037126 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd: BEGIN
[0m16:53:05.039519 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e: BEGIN
[0m16:53:05.042046 [debug] [Thread-2 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39"
[0m16:53:05.051661 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m16:53:05.063974 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:53:05.065464 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_run_id"
    
      
    ) dbt_internal_test
[0m16:53:05.067424 [debug] [Thread-4 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd"
[0m16:53:05.069364 [debug] [Thread-1 (]: Using postgres connection "test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e"
[0m16:53:05.072493 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_status"
    
      
    ) dbt_internal_test
[0m16:53:05.073726 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:53:05.075300 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "crypto_analytics", "target_name": "dev", "node_id": "test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "crypto_warehouse"."public_dbt_test__audit"."not_null_stg_pipeline_runs_stage"
    
      
    ) dbt_internal_test
[0m16:53:05.078143 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:53:05.080654 [debug] [Thread-2 (]: Timing info for test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39 (execute): 16:53:00.528998 => 16:53:05.080293
[0m16:53:05.083567 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:53:05.085844 [debug] [Thread-4 (]: Timing info for test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd (execute): 16:53:01.156079 => 16:53:05.085474
[0m16:53:05.087915 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39: ROLLBACK
[0m16:53:05.091124 [debug] [Thread-1 (]: Timing info for test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e (execute): 16:53:01.139648 => 16:53:05.090726
[0m16:53:05.093936 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd: ROLLBACK
[0m16:53:05.096198 [debug] [Thread-2 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39: Close
[0m16:53:05.097650 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e: ROLLBACK
[0m16:53:05.099920 [debug] [Thread-4 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd: Close
[0m16:53:05.102229 [info ] [Thread-2 (]: 11 of 14 PASS not_null_stg_pipeline_runs_run_id ................................ [[32mPASS[0m in 4.63s]
[0m16:53:05.111592 [debug] [Thread-2 (]: Finished running node test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39
[0m16:53:05.108168 [info ] [Thread-4 (]: 13 of 14 PASS not_null_stg_pipeline_runs_status ................................ [[32mPASS[0m in 4.02s]
[0m16:53:05.104865 [debug] [Thread-1 (]: On test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e: Close
[0m16:53:05.117299 [debug] [Thread-4 (]: Finished running node test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd
[0m16:53:05.123828 [info ] [Thread-1 (]: 12 of 14 PASS not_null_stg_pipeline_runs_stage ................................. [[32mPASS[0m in 4.04s]
[0m16:53:05.136634 [debug] [Thread-1 (]: Finished running node test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e
[0m16:53:05.150426 [debug] [MainThread]: Using postgres connection "master"
[0m16:53:05.154850 [debug] [MainThread]: On master: BEGIN
[0m16:53:05.157171 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:53:05.164573 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:53:05.168635 [debug] [MainThread]: On master: COMMIT
[0m16:53:05.171545 [debug] [MainThread]: Using postgres connection "master"
[0m16:53:05.173038 [debug] [MainThread]: On master: COMMIT
[0m16:53:05.174852 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:53:05.176474 [debug] [MainThread]: On master: Close
[0m16:53:05.180702 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:53:05.185825 [debug] [MainThread]: Connection 'test.crypto_analytics.unique_stg_crypto_prices_price_id.5c220dbd43' was properly closed.
[0m16:53:05.188203 [debug] [MainThread]: Connection 'test.crypto_analytics.not_null_stg_pipeline_runs_run_id.23e7a8be39' was properly closed.
[0m16:53:05.189866 [debug] [MainThread]: Connection 'test.crypto_analytics.not_null_stg_pipeline_runs_stage.70763a193e' was properly closed.
[0m16:53:05.191622 [debug] [MainThread]: Connection 'test.crypto_analytics.not_null_stg_pipeline_runs_status.cdc48aadcd' was properly closed.
[0m16:53:05.193148 [info ] [MainThread]: 
[0m16:53:05.195923 [info ] [MainThread]: Finished running 14 tests in 0 hours 0 minutes and 10.80 seconds (10.80s).
[0m16:53:05.206678 [debug] [MainThread]: Command end result
[0m16:53:05.250905 [info ] [MainThread]: 
[0m16:53:05.254040 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:53:05.257045 [info ] [MainThread]: 
[0m16:53:05.260355 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
[0m16:53:05.264526 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 14.183385, "process_user_time": 5.806517, "process_kernel_time": 0.687343, "process_mem_max_rss": "124096", "process_out_blocks": "1976", "process_in_blocks": "0"}
[0m16:53:05.270813 [debug] [MainThread]: Command `dbt test` succeeded at 16:53:05.270277 after 14.19 seconds
[0m16:53:05.273118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9829ed650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9829ec790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9829ed850>]}
[0m16:53:05.275128 [debug] [MainThread]: Flushing usage events
[0m16:53:09.281913 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
